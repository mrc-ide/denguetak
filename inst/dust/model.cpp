// Generated by odin.dust (version 0.3.4) - do not edit
template <typename real_type, typename container>
__host__ __device__ real_type odin_sum1(const container x, size_t from, size_t to);
template <typename real_type, typename container>
__host__ __device__ real_type odin_sum2(const container x, int from_i, int to_i, int from_j, int to_j, int dim_x_1);
template <typename real_type, typename container>
__host__ __device__ real_type odin_sum3(const container x, int from_i, int to_i, int from_j, int to_j, int from_k, int to_k, int dim_x_1, int dim_x_12);
// [[dust::class(model)]]
// [[dust::time_type(discrete)]]
// [[dust::param(age_rate_d, has_default = FALSE, default_value = NULL, rank = 2, min = -Inf, max = Inf, integer = FALSE)]]
// [[dust::param(age_removal_d, has_default = FALSE, default_value = NULL, rank = 2, min = -Inf, max = Inf, integer = FALSE)]]
// [[dust::param(Beta_mh_mean, has_default = FALSE, default_value = NULL, rank = 0, min = -Inf, max = Inf, integer = FALSE)]]
// [[dust::param(Beta_mh_season, has_default = FALSE, default_value = NULL, rank = 0, min = -Inf, max = Inf, integer = FALSE)]]
// [[dust::param(births_d, has_default = FALSE, default_value = NULL, rank = 2, min = -Inf, max = Inf, integer = FALSE)]]
// [[dust::param(CALIB_YEAR, has_default = FALSE, default_value = NULL, rank = 0, min = -Inf, max = Inf, integer = FALSE)]]
// [[dust::param(cfr, has_default = FALSE, default_value = NULL, rank = 0, min = -Inf, max = Inf, integer = FALSE)]]
// [[dust::param(coverage_d, has_default = FALSE, default_value = NULL, rank = 2, min = -Inf, max = Inf, integer = FALSE)]]
// [[dust::param(daly_dis, has_default = FALSE, default_value = NULL, rank = 0, min = -Inf, max = Inf, integer = FALSE)]]
// [[dust::param(daly_sdis, has_default = FALSE, default_value = NULL, rank = 0, min = -Inf, max = Inf, integer = FALSE)]]
// [[dust::param(delta, has_default = FALSE, default_value = NULL, rank = 0, min = -Inf, max = Inf, integer = FALSE)]]
// [[dust::param(dis_pri, has_default = FALSE, default_value = NULL, rank = 1, min = -Inf, max = Inf, integer = FALSE)]]
// [[dust::param(dis_quart, has_default = FALSE, default_value = NULL, rank = 1, min = -Inf, max = Inf, integer = FALSE)]]
// [[dust::param(dis_sec, has_default = FALSE, default_value = NULL, rank = 1, min = -Inf, max = Inf, integer = FALSE)]]
// [[dust::param(dis_tert, has_default = FALSE, default_value = NULL, rank = 1, min = -Inf, max = Inf, integer = FALSE)]]
// [[dust::param(disc_fact, has_default = FALSE, default_value = NULL, rank = 0, min = -Inf, max = Inf, integer = FALSE)]]
// [[dust::param(disc_fact_vacc, has_default = FALSE, default_value = NULL, rank = 0, min = -Inf, max = Inf, integer = FALSE)]]
// [[dust::param(DoVEInf, has_default = FALSE, default_value = NULL, rank = 0, min = -Inf, max = Inf, integer = FALSE)]]
// [[dust::param(dur_cross_prot, has_default = FALSE, default_value = NULL, rank = 0, min = -Inf, max = Inf, integer = FALSE)]]
// [[dust::param(eip, has_default = FALSE, default_value = NULL, rank = 0, min = -Inf, max = Inf, integer = FALSE)]]
// [[dust::param(epsilon, has_default = FALSE, default_value = NULL, rank = 0, min = -Inf, max = Inf, integer = FALSE)]]
// [[dust::param(EQUILIB_YEARS, has_default = FALSE, default_value = NULL, rank = 0, min = -Inf, max = Inf, integer = FALSE)]]
// [[dust::param(extInf, has_default = FALSE, default_value = NULL, rank = 0, min = -Inf, max = Inf, integer = FALSE)]]
// [[dust::param(FIRST_YEAR, has_default = FALSE, default_value = NULL, rank = 0, min = -Inf, max = Inf, integer = FALSE)]]
// [[dust::param(hl, has_default = FALSE, default_value = NULL, rank = 1, min = -Inf, max = Inf, integer = FALSE)]]
// [[dust::param(hs, has_default = FALSE, default_value = NULL, rank = 1, min = -Inf, max = Inf, integer = FALSE)]]
// [[dust::param(incub, has_default = FALSE, default_value = NULL, rank = 0, min = -Inf, max = Inf, integer = FALSE)]]
// [[dust::param(inf_per, has_default = FALSE, default_value = NULL, rank = 0, min = -Inf, max = Inf, integer = FALSE)]]
// [[dust::param(kappa, has_default = FALSE, default_value = NULL, rank = 0, min = -Inf, max = Inf, integer = FALSE)]]
// [[dust::param(Kc_season, has_default = FALSE, default_value = NULL, rank = 0, min = -Inf, max = Inf, integer = FALSE)]]
// [[dust::param(L_dis, has_default = FALSE, default_value = NULL, rank = 2, min = -Inf, max = Inf, integer = FALSE)]]
// [[dust::param(L_sdis, has_default = FALSE, default_value = NULL, rank = 2, min = -Inf, max = Inf, integer = FALSE)]]
// [[dust::param(LAST_YEAR, has_default = FALSE, default_value = NULL, rank = 0, min = -Inf, max = Inf, integer = FALSE)]]
// [[dust::param(life_expec_d, has_default = FALSE, default_value = NULL, rank = 2, min = -Inf, max = Inf, integer = FALSE)]]
// [[dust::param(max_ve_decay_time, has_default = FALSE, default_value = NULL, rank = 0, min = -Inf, max = Inf, integer = FALSE)]]
// [[dust::param(Mwt, has_default = FALSE, default_value = NULL, rank = 0, min = -Inf, max = Inf, integer = FALSE)]]
// [[dust::param(N_sim, has_default = FALSE, default_value = NULL, rank = 0, min = -Inf, max = Inf, integer = FALSE)]]
// [[dust::param(nc0, has_default = FALSE, default_value = NULL, rank = 2, min = -Inf, max = Inf, integer = FALSE)]]
// [[dust::param(nc50_age_intercept, has_default = FALSE, default_value = NULL, rank = 0, min = -Inf, max = Inf, integer = FALSE)]]
// [[dust::param(nc50_age_slope, has_default = FALSE, default_value = NULL, rank = 0, min = -Inf, max = Inf, integer = FALSE)]]
// [[dust::param(nc50_dis, has_default = FALSE, default_value = NULL, rank = 2, min = -Inf, max = Inf, integer = FALSE)]]
// [[dust::param(nc50_sdis, has_default = FALSE, default_value = NULL, rank = 2, min = -Inf, max = Inf, integer = FALSE)]]
// [[dust::param(omega, has_default = FALSE, default_value = NULL, rank = 0, min = -Inf, max = Inf, integer = FALSE)]]
// [[dust::param(phi_dis_enhance, has_default = FALSE, default_value = NULL, rank = 0, min = -Inf, max = Inf, integer = FALSE)]]
// [[dust::param(pop_size_d, has_default = FALSE, default_value = NULL, rank = 1, min = -Inf, max = Inf, integer = FALSE)]]
// [[dust::param(R0_req, has_default = FALSE, default_value = NULL, rank = 0, min = -Inf, max = Inf, integer = FALSE)]]
// [[dust::param(Rel_R01, has_default = FALSE, default_value = NULL, rank = 0, min = -Inf, max = Inf, integer = FALSE)]]
// [[dust::param(Rel_R02, has_default = FALSE, default_value = NULL, rank = 0, min = -Inf, max = Inf, integer = FALSE)]]
// [[dust::param(Rel_R03, has_default = FALSE, default_value = NULL, rank = 0, min = -Inf, max = Inf, integer = FALSE)]]
// [[dust::param(Rel_R04, has_default = FALSE, default_value = NULL, rank = 0, min = -Inf, max = Inf, integer = FALSE)]]
// [[dust::param(Rm, has_default = FALSE, default_value = NULL, rank = 0, min = -Inf, max = Inf, integer = FALSE)]]
// [[dust::param(sdis_pri, has_default = FALSE, default_value = NULL, rank = 1, min = -Inf, max = Inf, integer = FALSE)]]
// [[dust::param(sdis_quart, has_default = FALSE, default_value = NULL, rank = 1, min = -Inf, max = Inf, integer = FALSE)]]
// [[dust::param(sdis_sec, has_default = FALSE, default_value = NULL, rank = 1, min = -Inf, max = Inf, integer = FALSE)]]
// [[dust::param(sdis_tert, has_default = FALSE, default_value = NULL, rank = 1, min = -Inf, max = Inf, integer = FALSE)]]
// [[dust::param(sigma, has_default = FALSE, default_value = NULL, rank = 0, min = -Inf, max = Inf, integer = FALSE)]]
// [[dust::param(ts, has_default = FALSE, default_value = NULL, rank = 1, min = -Inf, max = Inf, integer = FALSE)]]
// [[dust::param(VACC_END_YEAR, has_default = FALSE, default_value = NULL, rank = 0, min = -Inf, max = Inf, integer = FALSE)]]
// [[dust::param(VACC_YEAR, has_default = FALSE, default_value = NULL, rank = 0, min = -Inf, max = Inf, integer = FALSE)]]
// [[dust::param(VaccOn, has_default = FALSE, default_value = NULL, rank = 0, min = -Inf, max = Inf, integer = FALSE)]]
// [[dust::param(VaccRoutineAge, has_default = FALSE, default_value = NULL, rank = 0, min = -Inf, max = Inf, integer = FALSE)]]
// [[dust::param(ws, has_default = FALSE, default_value = NULL, rank = 1, min = -Inf, max = Inf, integer = FALSE)]]
// [[dust::param(YL, has_default = FALSE, default_value = NULL, rank = 0, min = -Inf, max = Inf, integer = FALSE)]]
// [[dust::param(ZeroVE, has_default = FALSE, default_value = NULL, rank = 0, min = -Inf, max = Inf, integer = FALSE)]]
class model {
public:
  using real_type = double;
  using rng_state_type = dust::random::generator<real_type>;
  using data_type = dust::no_data;
  struct shared_type {
    real_type Acrit;
    real_type age_per;
    std::vector<real_type> age_rate_d;
    std::vector<real_type> age_removal_d;
    std::vector<real_type> ageb;
    std::vector<real_type> agec;
    real_type Beta_hm;
    real_type Beta_hm_1;
    real_type Beta_hm_2;
    real_type Beta_hm_3;
    real_type Beta_hm_4;
    real_type Beta_mh_mean;
    real_type Beta_mh_season;
    std::vector<real_type> births_d;
    real_type CALIB_YEAR;
    real_type cfr;
    std::vector<real_type> coverage_d;
    real_type daly_dis;
    real_type daly_sdis;
    real_type delta;
    real_type delta_wb;
    int dim_age_I1;
    int dim_age_I1_1;
    int dim_age_I1_2;
    int dim_age_I12;
    int dim_age_I12_1;
    int dim_age_I12_2;
    int dim_age_I123;
    int dim_age_I123_1;
    int dim_age_I123_2;
    int dim_age_I1234;
    int dim_age_I1234_1;
    int dim_age_I1234_2;
    int dim_age_I124;
    int dim_age_I124_1;
    int dim_age_I124_2;
    int dim_age_I1243;
    int dim_age_I1243_1;
    int dim_age_I1243_2;
    int dim_age_I13;
    int dim_age_I13_1;
    int dim_age_I13_2;
    int dim_age_I132;
    int dim_age_I132_1;
    int dim_age_I132_2;
    int dim_age_I134;
    int dim_age_I134_1;
    int dim_age_I134_2;
    int dim_age_I1342;
    int dim_age_I1342_1;
    int dim_age_I1342_2;
    int dim_age_I14;
    int dim_age_I14_1;
    int dim_age_I14_2;
    int dim_age_I142;
    int dim_age_I142_1;
    int dim_age_I142_2;
    int dim_age_I143;
    int dim_age_I143_1;
    int dim_age_I143_2;
    int dim_age_I2;
    int dim_age_I2_1;
    int dim_age_I2_2;
    int dim_age_I21;
    int dim_age_I21_1;
    int dim_age_I21_2;
    int dim_age_I23;
    int dim_age_I23_1;
    int dim_age_I23_2;
    int dim_age_I231;
    int dim_age_I231_1;
    int dim_age_I231_2;
    int dim_age_I234;
    int dim_age_I234_1;
    int dim_age_I234_2;
    int dim_age_I2341;
    int dim_age_I2341_1;
    int dim_age_I2341_2;
    int dim_age_I24;
    int dim_age_I24_1;
    int dim_age_I24_2;
    int dim_age_I241;
    int dim_age_I241_1;
    int dim_age_I241_2;
    int dim_age_I243;
    int dim_age_I243_1;
    int dim_age_I243_2;
    int dim_age_I3;
    int dim_age_I3_1;
    int dim_age_I3_2;
    int dim_age_I31;
    int dim_age_I31_1;
    int dim_age_I31_2;
    int dim_age_I32;
    int dim_age_I32_1;
    int dim_age_I32_2;
    int dim_age_I34;
    int dim_age_I34_1;
    int dim_age_I34_2;
    int dim_age_I341;
    int dim_age_I341_1;
    int dim_age_I341_2;
    int dim_age_I342;
    int dim_age_I342_1;
    int dim_age_I342_2;
    int dim_age_I4;
    int dim_age_I4_1;
    int dim_age_I4_2;
    int dim_age_I41;
    int dim_age_I41_1;
    int dim_age_I41_2;
    int dim_age_I42;
    int dim_age_I42_1;
    int dim_age_I42_2;
    int dim_age_I43;
    int dim_age_I43_1;
    int dim_age_I43_2;
    int dim_age_R1;
    int dim_age_R1_1;
    int dim_age_R1_2;
    int dim_age_R12;
    int dim_age_R12_1;
    int dim_age_R12_2;
    int dim_age_R123;
    int dim_age_R123_1;
    int dim_age_R123_2;
    int dim_age_R1234;
    int dim_age_R1234_1;
    int dim_age_R1234_2;
    int dim_age_R124;
    int dim_age_R124_1;
    int dim_age_R124_2;
    int dim_age_R13;
    int dim_age_R13_1;
    int dim_age_R13_2;
    int dim_age_R134;
    int dim_age_R134_1;
    int dim_age_R134_2;
    int dim_age_R14;
    int dim_age_R14_1;
    int dim_age_R14_2;
    int dim_age_R2;
    int dim_age_R2_1;
    int dim_age_R2_2;
    int dim_age_R23;
    int dim_age_R23_1;
    int dim_age_R23_2;
    int dim_age_R234;
    int dim_age_R234_1;
    int dim_age_R234_2;
    int dim_age_R24;
    int dim_age_R24_1;
    int dim_age_R24_2;
    int dim_age_R3;
    int dim_age_R3_1;
    int dim_age_R3_2;
    int dim_age_R34;
    int dim_age_R34_1;
    int dim_age_R34_2;
    int dim_age_R4;
    int dim_age_R4_1;
    int dim_age_R4_2;
    int dim_age_rate_d;
    int dim_age_rate_d_1;
    int dim_age_rate_d_2;
    int dim_age_removal_d;
    int dim_age_removal_d_1;
    int dim_age_removal_d_2;
    int dim_age_S;
    int dim_age_S_1;
    int dim_age_S_2;
    int dim_ageb;
    int dim_agec;
    int dim_agert;
    int dim_births_d;
    int dim_births_d_1;
    int dim_births_d_2;
    int dim_coverage_d;
    int dim_coverage_d_1;
    int dim_coverage_d_2;
    int dim_cum_infection_pri;
    int dim_cum_infection_priV;
    int dim_cum_infection_sec;
    int dim_cum_infection_secV;
    int dim_cum_infection_tq;
    int dim_cum_infection_tqV;
    int dim_cur_age_rate;
    int dim_death;
    int dim_deathrt;
    int dim_dis_pri;
    int dim_dis_quart;
    int dim_dis_sec;
    int dim_dis_sero_pop;
    int dim_dis_sero_unvacc;
    int dim_dis_sero_vacc;
    int dim_dis_sero_vacc_neg;
    int dim_dis_sero_vacc_pos;
    int dim_dis_tert;
    int dim_disc_yll_all;
    int dim_disc_yll_all_1;
    int dim_disc_yll_all_2;
    int dim_disease_sero;
    int dim_disease_sero_1;
    int dim_disease_sero_12;
    int dim_disease_sero_2;
    int dim_disease_sero_3;
    int dim_disease_sero_vacc_pri;
    int dim_disease_sero_vacc_pri_1;
    int dim_disease_sero_vacc_pri_2;
    int dim_FOI1a;
    int dim_FOI2a;
    int dim_FOI3a;
    int dim_FOI4a;
    int dim_FOIas;
    int dim_hl;
    int dim_hs;
    int dim_I1;
    int dim_I1_1;
    int dim_I1_2;
    int dim_I12;
    int dim_I12_1;
    int dim_I12_2;
    int dim_I123;
    int dim_I123_1;
    int dim_I123_2;
    int dim_I1234;
    int dim_I1234_1;
    int dim_I1234_2;
    int dim_I124;
    int dim_I124_1;
    int dim_I124_2;
    int dim_I1243;
    int dim_I1243_1;
    int dim_I1243_2;
    int dim_I13;
    int dim_I13_1;
    int dim_I13_2;
    int dim_I132;
    int dim_I132_1;
    int dim_I132_2;
    int dim_I134;
    int dim_I134_1;
    int dim_I134_2;
    int dim_I1342;
    int dim_I1342_1;
    int dim_I1342_2;
    int dim_I14;
    int dim_I14_1;
    int dim_I14_2;
    int dim_I142;
    int dim_I142_1;
    int dim_I142_2;
    int dim_I143;
    int dim_I143_1;
    int dim_I143_2;
    int dim_I2;
    int dim_I2_1;
    int dim_I2_2;
    int dim_I21;
    int dim_I21_1;
    int dim_I21_2;
    int dim_I23;
    int dim_I23_1;
    int dim_I23_2;
    int dim_I231;
    int dim_I231_1;
    int dim_I231_2;
    int dim_I234;
    int dim_I234_1;
    int dim_I234_2;
    int dim_I2341;
    int dim_I2341_1;
    int dim_I2341_2;
    int dim_I24;
    int dim_I24_1;
    int dim_I24_2;
    int dim_I241;
    int dim_I241_1;
    int dim_I241_2;
    int dim_I243;
    int dim_I243_1;
    int dim_I243_2;
    int dim_I3;
    int dim_I3_1;
    int dim_I3_2;
    int dim_I31;
    int dim_I31_1;
    int dim_I31_2;
    int dim_I32;
    int dim_I32_1;
    int dim_I32_2;
    int dim_I34;
    int dim_I34_1;
    int dim_I34_2;
    int dim_I341;
    int dim_I341_1;
    int dim_I341_2;
    int dim_I342;
    int dim_I342_1;
    int dim_I342_2;
    int dim_I4;
    int dim_I4_1;
    int dim_I4_2;
    int dim_I41;
    int dim_I41_1;
    int dim_I41_2;
    int dim_I42;
    int dim_I42_1;
    int dim_I42_2;
    int dim_I43;
    int dim_I43_1;
    int dim_I43_2;
    int dim_inf_1;
    int dim_inf_1_1;
    int dim_inf_1_2;
    int dim_inf_12;
    int dim_inf_12_1;
    int dim_inf_12_2;
    int dim_inf_123;
    int dim_inf_123_1;
    int dim_inf_123_2;
    int dim_inf_1234;
    int dim_inf_1234_1;
    int dim_inf_1234_2;
    int dim_inf_124;
    int dim_inf_124_1;
    int dim_inf_124_2;
    int dim_inf_1243;
    int dim_inf_1243_1;
    int dim_inf_1243_2;
    int dim_inf_13;
    int dim_inf_13_1;
    int dim_inf_13_2;
    int dim_inf_132;
    int dim_inf_132_1;
    int dim_inf_132_2;
    int dim_inf_134;
    int dim_inf_134_1;
    int dim_inf_134_2;
    int dim_inf_1342;
    int dim_inf_1342_1;
    int dim_inf_1342_2;
    int dim_inf_14;
    int dim_inf_14_1;
    int dim_inf_14_2;
    int dim_inf_142;
    int dim_inf_142_1;
    int dim_inf_142_2;
    int dim_inf_143;
    int dim_inf_143_1;
    int dim_inf_143_2;
    int dim_inf_2;
    int dim_inf_2_1;
    int dim_inf_2_2;
    int dim_inf_21;
    int dim_inf_21_1;
    int dim_inf_21_2;
    int dim_inf_23;
    int dim_inf_23_1;
    int dim_inf_23_2;
    int dim_inf_231;
    int dim_inf_231_1;
    int dim_inf_231_2;
    int dim_inf_234;
    int dim_inf_234_1;
    int dim_inf_234_2;
    int dim_inf_2341;
    int dim_inf_2341_1;
    int dim_inf_2341_2;
    int dim_inf_24;
    int dim_inf_24_1;
    int dim_inf_24_2;
    int dim_inf_241;
    int dim_inf_241_1;
    int dim_inf_241_2;
    int dim_inf_243;
    int dim_inf_243_1;
    int dim_inf_243_2;
    int dim_inf_3;
    int dim_inf_3_1;
    int dim_inf_3_2;
    int dim_inf_31;
    int dim_inf_31_1;
    int dim_inf_31_2;
    int dim_inf_32;
    int dim_inf_32_1;
    int dim_inf_32_2;
    int dim_inf_34;
    int dim_inf_34_1;
    int dim_inf_34_2;
    int dim_inf_341;
    int dim_inf_341_1;
    int dim_inf_341_2;
    int dim_inf_342;
    int dim_inf_342_1;
    int dim_inf_342_2;
    int dim_inf_4;
    int dim_inf_4_1;
    int dim_inf_4_2;
    int dim_inf_41;
    int dim_inf_41_1;
    int dim_inf_41_2;
    int dim_inf_42;
    int dim_inf_42_1;
    int dim_inf_42_2;
    int dim_inf_43;
    int dim_inf_43_1;
    int dim_inf_43_2;
    int dim_infection_pri;
    int dim_infection_pri_1;
    int dim_infection_pri_2;
    int dim_infection_sec;
    int dim_infection_sec_1;
    int dim_infection_sec_2;
    int dim_infection_tq;
    int dim_infection_tq_1;
    int dim_infection_tq_2;
    int dim_infV_1;
    int dim_infV_1_1;
    int dim_infV_1_2;
    int dim_infV_2;
    int dim_infV_2_1;
    int dim_infV_2_2;
    int dim_infV_3;
    int dim_infV_3_1;
    int dim_infV_3_2;
    int dim_infV_4;
    int dim_infV_4_1;
    int dim_infV_4_2;
    int dim_init_life_expec;
    int dim_L_dis;
    int dim_L_dis_1;
    int dim_L_dis_2;
    int dim_L_sdis;
    int dim_L_sdis_1;
    int dim_L_sdis_2;
    int dim_life_expec;
    int dim_life_expec_d;
    int dim_life_expec_d_1;
    int dim_life_expec_d_2;
    int dim_mean_age;
    int dim_n_I1;
    int dim_n_I1_1;
    int dim_n_I1_2;
    int dim_n_I12;
    int dim_n_I12_1;
    int dim_n_I12_2;
    int dim_n_I123;
    int dim_n_I123_1;
    int dim_n_I123_2;
    int dim_n_I1234;
    int dim_n_I1234_1;
    int dim_n_I1234_2;
    int dim_n_I124;
    int dim_n_I124_1;
    int dim_n_I124_2;
    int dim_n_I1243;
    int dim_n_I1243_1;
    int dim_n_I1243_2;
    int dim_n_I13;
    int dim_n_I13_1;
    int dim_n_I13_2;
    int dim_n_I132;
    int dim_n_I132_1;
    int dim_n_I132_2;
    int dim_n_I134;
    int dim_n_I134_1;
    int dim_n_I134_2;
    int dim_n_I1342;
    int dim_n_I1342_1;
    int dim_n_I1342_2;
    int dim_n_I14;
    int dim_n_I14_1;
    int dim_n_I14_2;
    int dim_n_I142;
    int dim_n_I142_1;
    int dim_n_I142_2;
    int dim_n_I143;
    int dim_n_I143_1;
    int dim_n_I143_2;
    int dim_n_I2;
    int dim_n_I2_1;
    int dim_n_I2_2;
    int dim_n_I21;
    int dim_n_I21_1;
    int dim_n_I21_2;
    int dim_n_I23;
    int dim_n_I23_1;
    int dim_n_I23_2;
    int dim_n_I231;
    int dim_n_I231_1;
    int dim_n_I231_2;
    int dim_n_I234;
    int dim_n_I234_1;
    int dim_n_I234_2;
    int dim_n_I2341;
    int dim_n_I2341_1;
    int dim_n_I2341_2;
    int dim_n_I24;
    int dim_n_I24_1;
    int dim_n_I24_2;
    int dim_n_I241;
    int dim_n_I241_1;
    int dim_n_I241_2;
    int dim_n_I243;
    int dim_n_I243_1;
    int dim_n_I243_2;
    int dim_n_I3;
    int dim_n_I3_1;
    int dim_n_I3_2;
    int dim_n_I31;
    int dim_n_I31_1;
    int dim_n_I31_2;
    int dim_n_I32;
    int dim_n_I32_1;
    int dim_n_I32_2;
    int dim_n_I34;
    int dim_n_I34_1;
    int dim_n_I34_2;
    int dim_n_I341;
    int dim_n_I341_1;
    int dim_n_I341_2;
    int dim_n_I342;
    int dim_n_I342_1;
    int dim_n_I342_2;
    int dim_n_I4;
    int dim_n_I4_1;
    int dim_n_I4_2;
    int dim_n_I41;
    int dim_n_I41_1;
    int dim_n_I41_2;
    int dim_n_I42;
    int dim_n_I42_1;
    int dim_n_I42_2;
    int dim_n_I43;
    int dim_n_I43_1;
    int dim_n_I43_2;
    int dim_N_init_age;
    int dim_N_init_age0;
    int dim_n_R1;
    int dim_n_R1_1;
    int dim_n_R1_2;
    int dim_n_R12;
    int dim_n_R12_1;
    int dim_n_R12_2;
    int dim_n_R123;
    int dim_n_R123_1;
    int dim_n_R123_2;
    int dim_n_R1234;
    int dim_n_R1234_1;
    int dim_n_R1234_2;
    int dim_n_R124;
    int dim_n_R124_1;
    int dim_n_R124_2;
    int dim_n_R13;
    int dim_n_R13_1;
    int dim_n_R13_2;
    int dim_n_R134;
    int dim_n_R134_1;
    int dim_n_R134_2;
    int dim_n_R14;
    int dim_n_R14_1;
    int dim_n_R14_2;
    int dim_n_R2;
    int dim_n_R2_1;
    int dim_n_R2_2;
    int dim_n_R23;
    int dim_n_R23_1;
    int dim_n_R23_2;
    int dim_n_R234;
    int dim_n_R234_1;
    int dim_n_R234_2;
    int dim_n_R24;
    int dim_n_R24_1;
    int dim_n_R24_2;
    int dim_n_R3;
    int dim_n_R3_1;
    int dim_n_R3_2;
    int dim_n_R34;
    int dim_n_R34_1;
    int dim_n_R34_2;
    int dim_n_R4;
    int dim_n_R4_1;
    int dim_n_R4_2;
    int dim_n_S;
    int dim_n_S_1;
    int dim_n_S_2;
    int dim_nc;
    int dim_nc_1;
    int dim_nc_12;
    int dim_nc_2;
    int dim_nc_3;
    int dim_nc_cu;
    int dim_nc_cu_1;
    int dim_nc_cu_2;
    int dim_nc0;
    int dim_nc0_1;
    int dim_nc0_2;
    int dim_nc50_age;
    int dim_nc50_dis;
    int dim_nc50_dis_1;
    int dim_nc50_dis_2;
    int dim_nc50_sdis;
    int dim_nc50_sdis_1;
    int dim_nc50_sdis_2;
    int dim_ncu_I1;
    int dim_ncu_I12;
    int dim_ncu_I123;
    int dim_ncu_I1234;
    int dim_ncu_I124;
    int dim_ncu_I1243;
    int dim_ncu_I13;
    int dim_ncu_I132;
    int dim_ncu_I134;
    int dim_ncu_I1342;
    int dim_ncu_I14;
    int dim_ncu_I142;
    int dim_ncu_I143;
    int dim_ncu_I2;
    int dim_ncu_I21;
    int dim_ncu_I23;
    int dim_ncu_I231;
    int dim_ncu_I234;
    int dim_ncu_I2341;
    int dim_ncu_I24;
    int dim_ncu_I241;
    int dim_ncu_I243;
    int dim_ncu_I3;
    int dim_ncu_I31;
    int dim_ncu_I32;
    int dim_ncu_I34;
    int dim_ncu_I341;
    int dim_ncu_I342;
    int dim_ncu_I4;
    int dim_ncu_I41;
    int dim_ncu_I42;
    int dim_ncu_I43;
    int dim_ncu_R1;
    int dim_ncu_R12;
    int dim_ncu_R123;
    int dim_ncu_R1234;
    int dim_ncu_R124;
    int dim_ncu_R13;
    int dim_ncu_R134;
    int dim_ncu_R14;
    int dim_ncu_R2;
    int dim_ncu_R23;
    int dim_ncu_R234;
    int dim_ncu_R24;
    int dim_ncu_R3;
    int dim_ncu_R34;
    int dim_ncu_R4;
    int dim_ncu_S;
    int dim_nnveai;
    int dim_Ntotal;
    int dim_Ntotal_1;
    int dim_Ntotal_2;
    int dim_Ntotal_all;
    int dim_Ntotal_nv;
    int dim_Ntotal_nvS;
    int dim_Ntotal_out;
    int dim_Ntotal_v;
    int dim_Ntotal_vS;
    int dim_num_child_vacc_age;
    int dim_num_child_vacc_age_neg;
    int dim_num_cu_vacc_age;
    int dim_num_cu_vacc_age_neg;
    int dim_nvacc_I1;
    int dim_nvacc_I1_1;
    int dim_nvacc_I1_2;
    int dim_nvacc_I12;
    int dim_nvacc_I12_1;
    int dim_nvacc_I12_2;
    int dim_nvacc_I123;
    int dim_nvacc_I123_1;
    int dim_nvacc_I123_2;
    int dim_nvacc_I1234;
    int dim_nvacc_I1234_1;
    int dim_nvacc_I1234_2;
    int dim_nvacc_I124;
    int dim_nvacc_I124_1;
    int dim_nvacc_I124_2;
    int dim_nvacc_I1243;
    int dim_nvacc_I1243_1;
    int dim_nvacc_I1243_2;
    int dim_nvacc_I13;
    int dim_nvacc_I13_1;
    int dim_nvacc_I13_2;
    int dim_nvacc_I132;
    int dim_nvacc_I132_1;
    int dim_nvacc_I132_2;
    int dim_nvacc_I134;
    int dim_nvacc_I134_1;
    int dim_nvacc_I134_2;
    int dim_nvacc_I1342;
    int dim_nvacc_I1342_1;
    int dim_nvacc_I1342_2;
    int dim_nvacc_I14;
    int dim_nvacc_I14_1;
    int dim_nvacc_I14_2;
    int dim_nvacc_I142;
    int dim_nvacc_I142_1;
    int dim_nvacc_I142_2;
    int dim_nvacc_I143;
    int dim_nvacc_I143_1;
    int dim_nvacc_I143_2;
    int dim_nvacc_I2;
    int dim_nvacc_I2_1;
    int dim_nvacc_I2_2;
    int dim_nvacc_I21;
    int dim_nvacc_I21_1;
    int dim_nvacc_I21_2;
    int dim_nvacc_I23;
    int dim_nvacc_I23_1;
    int dim_nvacc_I23_2;
    int dim_nvacc_I231;
    int dim_nvacc_I231_1;
    int dim_nvacc_I231_2;
    int dim_nvacc_I234;
    int dim_nvacc_I234_1;
    int dim_nvacc_I234_2;
    int dim_nvacc_I2341;
    int dim_nvacc_I2341_1;
    int dim_nvacc_I2341_2;
    int dim_nvacc_I24;
    int dim_nvacc_I24_1;
    int dim_nvacc_I24_2;
    int dim_nvacc_I241;
    int dim_nvacc_I241_1;
    int dim_nvacc_I241_2;
    int dim_nvacc_I243;
    int dim_nvacc_I243_1;
    int dim_nvacc_I243_2;
    int dim_nvacc_I3;
    int dim_nvacc_I3_1;
    int dim_nvacc_I3_2;
    int dim_nvacc_I31;
    int dim_nvacc_I31_1;
    int dim_nvacc_I31_2;
    int dim_nvacc_I32;
    int dim_nvacc_I32_1;
    int dim_nvacc_I32_2;
    int dim_nvacc_I34;
    int dim_nvacc_I34_1;
    int dim_nvacc_I34_2;
    int dim_nvacc_I341;
    int dim_nvacc_I341_1;
    int dim_nvacc_I341_2;
    int dim_nvacc_I342;
    int dim_nvacc_I342_1;
    int dim_nvacc_I342_2;
    int dim_nvacc_I4;
    int dim_nvacc_I4_1;
    int dim_nvacc_I4_2;
    int dim_nvacc_I41;
    int dim_nvacc_I41_1;
    int dim_nvacc_I41_2;
    int dim_nvacc_I42;
    int dim_nvacc_I42_1;
    int dim_nvacc_I42_2;
    int dim_nvacc_I43;
    int dim_nvacc_I43_1;
    int dim_nvacc_I43_2;
    int dim_nvacc_R1;
    int dim_nvacc_R1_1;
    int dim_nvacc_R1_2;
    int dim_nvacc_R12;
    int dim_nvacc_R12_1;
    int dim_nvacc_R12_2;
    int dim_nvacc_R123;
    int dim_nvacc_R123_1;
    int dim_nvacc_R123_2;
    int dim_nvacc_R1234;
    int dim_nvacc_R1234_1;
    int dim_nvacc_R1234_2;
    int dim_nvacc_R124;
    int dim_nvacc_R124_1;
    int dim_nvacc_R124_2;
    int dim_nvacc_R13;
    int dim_nvacc_R13_1;
    int dim_nvacc_R13_2;
    int dim_nvacc_R134;
    int dim_nvacc_R134_1;
    int dim_nvacc_R134_2;
    int dim_nvacc_R14;
    int dim_nvacc_R14_1;
    int dim_nvacc_R14_2;
    int dim_nvacc_R2;
    int dim_nvacc_R2_1;
    int dim_nvacc_R2_2;
    int dim_nvacc_R23;
    int dim_nvacc_R23_1;
    int dim_nvacc_R23_2;
    int dim_nvacc_R234;
    int dim_nvacc_R234_1;
    int dim_nvacc_R234_2;
    int dim_nvacc_R24;
    int dim_nvacc_R24_1;
    int dim_nvacc_R24_2;
    int dim_nvacc_R3;
    int dim_nvacc_R3_1;
    int dim_nvacc_R3_2;
    int dim_nvacc_R34;
    int dim_nvacc_R34_1;
    int dim_nvacc_R34_2;
    int dim_nvacc_R4;
    int dim_nvacc_R4_1;
    int dim_nvacc_R4_2;
    int dim_nvacc_S;
    int dim_nvacc_S_1;
    int dim_nvacc_S_2;
    int dim_nveai;
    int dim_O_I1;
    int dim_O_I1_1;
    int dim_O_I1_2;
    int dim_O_I12;
    int dim_O_I12_1;
    int dim_O_I12_2;
    int dim_O_I123;
    int dim_O_I123_1;
    int dim_O_I123_2;
    int dim_O_I1234;
    int dim_O_I1234_1;
    int dim_O_I1234_2;
    int dim_O_I124;
    int dim_O_I124_1;
    int dim_O_I124_2;
    int dim_O_I1243;
    int dim_O_I1243_1;
    int dim_O_I1243_2;
    int dim_O_I13;
    int dim_O_I13_1;
    int dim_O_I13_2;
    int dim_O_I132;
    int dim_O_I132_1;
    int dim_O_I132_2;
    int dim_O_I134;
    int dim_O_I134_1;
    int dim_O_I134_2;
    int dim_O_I1342;
    int dim_O_I1342_1;
    int dim_O_I1342_2;
    int dim_O_I14;
    int dim_O_I14_1;
    int dim_O_I14_2;
    int dim_O_I142;
    int dim_O_I142_1;
    int dim_O_I142_2;
    int dim_O_I143;
    int dim_O_I143_1;
    int dim_O_I143_2;
    int dim_O_I2;
    int dim_O_I2_1;
    int dim_O_I2_2;
    int dim_O_I21;
    int dim_O_I21_1;
    int dim_O_I21_2;
    int dim_O_I23;
    int dim_O_I23_1;
    int dim_O_I23_2;
    int dim_O_I231;
    int dim_O_I231_1;
    int dim_O_I231_2;
    int dim_O_I234;
    int dim_O_I234_1;
    int dim_O_I234_2;
    int dim_O_I2341;
    int dim_O_I2341_1;
    int dim_O_I2341_2;
    int dim_O_I24;
    int dim_O_I24_1;
    int dim_O_I24_2;
    int dim_O_I241;
    int dim_O_I241_1;
    int dim_O_I241_2;
    int dim_O_I243;
    int dim_O_I243_1;
    int dim_O_I243_2;
    int dim_O_I3;
    int dim_O_I3_1;
    int dim_O_I3_2;
    int dim_O_I31;
    int dim_O_I31_1;
    int dim_O_I31_2;
    int dim_O_I32;
    int dim_O_I32_1;
    int dim_O_I32_2;
    int dim_O_I34;
    int dim_O_I34_1;
    int dim_O_I34_2;
    int dim_O_I341;
    int dim_O_I341_1;
    int dim_O_I341_2;
    int dim_O_I342;
    int dim_O_I342_1;
    int dim_O_I342_2;
    int dim_O_I4;
    int dim_O_I4_1;
    int dim_O_I4_2;
    int dim_O_I41;
    int dim_O_I41_1;
    int dim_O_I41_2;
    int dim_O_I42;
    int dim_O_I42_1;
    int dim_O_I42_2;
    int dim_O_I43;
    int dim_O_I43_1;
    int dim_O_I43_2;
    int dim_O_R1;
    int dim_O_R1_1;
    int dim_O_R1_2;
    int dim_O_R12;
    int dim_O_R12_1;
    int dim_O_R12_2;
    int dim_O_R123;
    int dim_O_R123_1;
    int dim_O_R123_2;
    int dim_O_R1234;
    int dim_O_R1234_1;
    int dim_O_R1234_2;
    int dim_O_R124;
    int dim_O_R124_1;
    int dim_O_R124_2;
    int dim_O_R13;
    int dim_O_R13_1;
    int dim_O_R13_2;
    int dim_O_R134;
    int dim_O_R134_1;
    int dim_O_R134_2;
    int dim_O_R14;
    int dim_O_R14_1;
    int dim_O_R14_2;
    int dim_O_R2;
    int dim_O_R2_1;
    int dim_O_R2_2;
    int dim_O_R23;
    int dim_O_R23_1;
    int dim_O_R23_2;
    int dim_O_R234;
    int dim_O_R234_1;
    int dim_O_R234_2;
    int dim_O_R24;
    int dim_O_R24_1;
    int dim_O_R24_2;
    int dim_O_R3;
    int dim_O_R3_1;
    int dim_O_R3_2;
    int dim_O_R34;
    int dim_O_R34_1;
    int dim_O_R34_2;
    int dim_O_R4;
    int dim_O_R4_1;
    int dim_O_R4_2;
    int dim_O_S;
    int dim_O_S_1;
    int dim_O_S_2;
    int dim_out_dis_all_pop;
    int dim_out_dis_all_unvacc;
    int dim_out_dis_all_vacc;
    int dim_out_dis_all_vacc_neg;
    int dim_out_dis_all_vacc_pos;
    int dim_out_dis_sero_pop;
    int dim_out_dis_sero_pop_1;
    int dim_out_dis_sero_pop_2;
    int dim_out_dis_sero_unvacc;
    int dim_out_dis_sero_unvacc_1;
    int dim_out_dis_sero_unvacc_2;
    int dim_out_dis_sero_vacc;
    int dim_out_dis_sero_vacc_1;
    int dim_out_dis_sero_vacc_2;
    int dim_out_dis_sero_vacc_neg;
    int dim_out_dis_sero_vacc_neg_1;
    int dim_out_dis_sero_vacc_neg_2;
    int dim_out_dis_sero_vacc_pos;
    int dim_out_dis_sero_vacc_pos_1;
    int dim_out_dis_sero_vacc_pos_2;
    int dim_out_disc_dis_all_pop;
    int dim_out_disc_dis_all_vacc;
    int dim_out_disc_nvacc_all_pop;
    int dim_out_disc_sdis_all_pop;
    int dim_out_disc_sdis_all_vacc;
    int dim_out_disc_yll_all_pop;
    int dim_out_disc_yll_all_vacc;
    int dim_out_nc;
    int dim_out_nc_1;
    int dim_out_nc_12;
    int dim_out_nc_2;
    int dim_out_nc_3;
    int dim_out_nvacc_all_neg;
    int dim_out_nvacc_all_pop;
    int dim_out_nvacc_all_pos;
    int dim_out_prop_seroneg_at_9;
    int dim_out_prop_seroneg_at_vca;
    int dim_out_RR;
    int dim_out_RR_1;
    int dim_out_RR_12;
    int dim_out_RR_2;
    int dim_out_RR_3;
    int dim_out_sdis_all_pop;
    int dim_out_sdis_all_unvacc;
    int dim_out_sdis_all_vacc;
    int dim_out_sdis_all_vacc_neg;
    int dim_out_sdis_all_vacc_pos;
    int dim_out_sdis_sero_pop;
    int dim_out_sdis_sero_pop_1;
    int dim_out_sdis_sero_pop_2;
    int dim_out_sdis_sero_unvacc;
    int dim_out_sdis_sero_unvacc_1;
    int dim_out_sdis_sero_unvacc_2;
    int dim_out_sdis_sero_vacc;
    int dim_out_sdis_sero_vacc_1;
    int dim_out_sdis_sero_vacc_2;
    int dim_out_sdis_sero_vacc_neg;
    int dim_out_sdis_sero_vacc_neg_1;
    int dim_out_sdis_sero_vacc_neg_2;
    int dim_out_sdis_sero_vacc_pos;
    int dim_out_sdis_sero_vacc_pos_1;
    int dim_out_sdis_sero_vacc_pos_2;
    int dim_out_time_from_last_dose;
    int dim_out_update_switch;
    int dim_out_yll_all_pop;
    int dim_out_yll_all_unvacc;
    int dim_out_yll_all_vacc;
    int dim_out_yll_all_vacc_neg;
    int dim_out_yll_all_vacc_pos;
    int dim_out_yll_sero_pop;
    int dim_out_yll_sero_pop_1;
    int dim_out_yll_sero_pop_2;
    int dim_out_yll_sero_unvacc;
    int dim_out_yll_sero_unvacc_1;
    int dim_out_yll_sero_unvacc_2;
    int dim_out_yll_sero_vacc;
    int dim_out_yll_sero_vacc_1;
    int dim_out_yll_sero_vacc_2;
    int dim_out_yll_sero_vacc_neg;
    int dim_out_yll_sero_vacc_neg_1;
    int dim_out_yll_sero_vacc_neg_2;
    int dim_out_yll_sero_vacc_pos;
    int dim_out_yll_sero_vacc_pos_1;
    int dim_out_yll_sero_vacc_pos_2;
    int dim_phi_pri;
    int dim_phi_quart;
    int dim_phi_scale;
    int dim_phi_sec;
    int dim_phi_tert;
    int dim_pop_size_d;
    int dim_R1;
    int dim_R1_1;
    int dim_R1_2;
    int dim_R12;
    int dim_R12_1;
    int dim_R12_2;
    int dim_R123;
    int dim_R123_1;
    int dim_R123_2;
    int dim_R1234;
    int dim_R1234_1;
    int dim_R1234_2;
    int dim_R124;
    int dim_R124_1;
    int dim_R124_2;
    int dim_R13;
    int dim_R13_1;
    int dim_R13_2;
    int dim_R134;
    int dim_R134_1;
    int dim_R134_2;
    int dim_R14;
    int dim_R14_1;
    int dim_R14_2;
    int dim_R2;
    int dim_R2_1;
    int dim_R2_2;
    int dim_R23;
    int dim_R23_1;
    int dim_R23_2;
    int dim_R234;
    int dim_R234_1;
    int dim_R234_2;
    int dim_R24;
    int dim_R24_1;
    int dim_R24_2;
    int dim_R3;
    int dim_R3_1;
    int dim_R3_2;
    int dim_R34;
    int dim_R34_1;
    int dim_R34_2;
    int dim_R4;
    int dim_R4_1;
    int dim_R4_2;
    int dim_recov_1;
    int dim_recov_1_1;
    int dim_recov_1_2;
    int dim_recov_12;
    int dim_recov_12_1;
    int dim_recov_12_2;
    int dim_recov_123;
    int dim_recov_123_1;
    int dim_recov_123_2;
    int dim_recov_1234;
    int dim_recov_1234_1;
    int dim_recov_1234_2;
    int dim_recov_124;
    int dim_recov_124_1;
    int dim_recov_124_2;
    int dim_recov_1243;
    int dim_recov_1243_1;
    int dim_recov_1243_2;
    int dim_recov_13;
    int dim_recov_13_1;
    int dim_recov_13_2;
    int dim_recov_132;
    int dim_recov_132_1;
    int dim_recov_132_2;
    int dim_recov_134;
    int dim_recov_134_1;
    int dim_recov_134_2;
    int dim_recov_1342;
    int dim_recov_1342_1;
    int dim_recov_1342_2;
    int dim_recov_14;
    int dim_recov_14_1;
    int dim_recov_14_2;
    int dim_recov_142;
    int dim_recov_142_1;
    int dim_recov_142_2;
    int dim_recov_143;
    int dim_recov_143_1;
    int dim_recov_143_2;
    int dim_recov_2;
    int dim_recov_2_1;
    int dim_recov_2_2;
    int dim_recov_21;
    int dim_recov_21_1;
    int dim_recov_21_2;
    int dim_recov_23;
    int dim_recov_23_1;
    int dim_recov_23_2;
    int dim_recov_231;
    int dim_recov_231_1;
    int dim_recov_231_2;
    int dim_recov_234;
    int dim_recov_234_1;
    int dim_recov_234_2;
    int dim_recov_2341;
    int dim_recov_2341_1;
    int dim_recov_2341_2;
    int dim_recov_24;
    int dim_recov_24_1;
    int dim_recov_24_2;
    int dim_recov_241;
    int dim_recov_241_1;
    int dim_recov_241_2;
    int dim_recov_243;
    int dim_recov_243_1;
    int dim_recov_243_2;
    int dim_recov_3;
    int dim_recov_3_1;
    int dim_recov_3_2;
    int dim_recov_31;
    int dim_recov_31_1;
    int dim_recov_31_2;
    int dim_recov_32;
    int dim_recov_32_1;
    int dim_recov_32_2;
    int dim_recov_34;
    int dim_recov_34_1;
    int dim_recov_34_2;
    int dim_recov_341;
    int dim_recov_341_1;
    int dim_recov_341_2;
    int dim_recov_342;
    int dim_recov_342_1;
    int dim_recov_342_2;
    int dim_recov_4;
    int dim_recov_4_1;
    int dim_recov_4_2;
    int dim_recov_41;
    int dim_recov_41_1;
    int dim_recov_41_2;
    int dim_recov_42;
    int dim_recov_42_1;
    int dim_recov_42_2;
    int dim_recov_43;
    int dim_recov_43_1;
    int dim_recov_43_2;
    int dim_rho1;
    int dim_rho1_1;
    int dim_rho1_2;
    int dim_rho12;
    int dim_rho12_1;
    int dim_rho12_2;
    int dim_rho123;
    int dim_rho123_1;
    int dim_rho123_2;
    int dim_rho1234;
    int dim_rho1234_1;
    int dim_rho1234_2;
    int dim_rho124;
    int dim_rho124_1;
    int dim_rho124_2;
    int dim_rho1243;
    int dim_rho1243_1;
    int dim_rho1243_2;
    int dim_rho13;
    int dim_rho13_1;
    int dim_rho13_2;
    int dim_rho132;
    int dim_rho132_1;
    int dim_rho132_2;
    int dim_rho134;
    int dim_rho134_1;
    int dim_rho134_2;
    int dim_rho1342;
    int dim_rho1342_1;
    int dim_rho1342_2;
    int dim_rho14;
    int dim_rho14_1;
    int dim_rho14_2;
    int dim_rho142;
    int dim_rho142_1;
    int dim_rho142_2;
    int dim_rho143;
    int dim_rho143_1;
    int dim_rho143_2;
    int dim_rho2;
    int dim_rho2_1;
    int dim_rho2_2;
    int dim_rho21;
    int dim_rho21_1;
    int dim_rho21_2;
    int dim_rho23;
    int dim_rho23_1;
    int dim_rho23_2;
    int dim_rho231;
    int dim_rho231_1;
    int dim_rho231_2;
    int dim_rho234;
    int dim_rho234_1;
    int dim_rho234_2;
    int dim_rho2341;
    int dim_rho2341_1;
    int dim_rho2341_2;
    int dim_rho24;
    int dim_rho24_1;
    int dim_rho24_2;
    int dim_rho241;
    int dim_rho241_1;
    int dim_rho241_2;
    int dim_rho243;
    int dim_rho243_1;
    int dim_rho243_2;
    int dim_rho3;
    int dim_rho3_1;
    int dim_rho3_2;
    int dim_rho31;
    int dim_rho31_1;
    int dim_rho31_2;
    int dim_rho32;
    int dim_rho32_1;
    int dim_rho32_2;
    int dim_rho34;
    int dim_rho34_1;
    int dim_rho34_2;
    int dim_rho341;
    int dim_rho341_1;
    int dim_rho341_2;
    int dim_rho342;
    int dim_rho342_1;
    int dim_rho342_2;
    int dim_rho4;
    int dim_rho4_1;
    int dim_rho4_2;
    int dim_rho41;
    int dim_rho41_1;
    int dim_rho41_2;
    int dim_rho42;
    int dim_rho42_1;
    int dim_rho42_2;
    int dim_rho43;
    int dim_rho43_1;
    int dim_rho43_2;
    int dim_RR_dis;
    int dim_RR_dis_1;
    int dim_RR_dis_12;
    int dim_RR_dis_2;
    int dim_RR_dis_3;
    int dim_RR_dis_cu;
    int dim_RR_dis_cu_1;
    int dim_RR_dis_cu_12;
    int dim_RR_dis_cu_2;
    int dim_RR_dis_cu_3;
    int dim_RR_dis_vc;
    int dim_RR_dis_vc_1;
    int dim_RR_dis_vc_12;
    int dim_RR_dis_vc_2;
    int dim_RR_dis_vc_3;
    int dim_RR_inf;
    int dim_RR_inf_1;
    int dim_RR_inf_12;
    int dim_RR_inf_2;
    int dim_RR_inf_3;
    int dim_RR_sdis;
    int dim_RR_sdis_1;
    int dim_RR_sdis_12;
    int dim_RR_sdis_2;
    int dim_RR_sdis_3;
    int dim_RR_sdis_cu;
    int dim_RR_sdis_cu_1;
    int dim_RR_sdis_cu_12;
    int dim_RR_sdis_cu_2;
    int dim_RR_sdis_cu_3;
    int dim_RR_sdis_vc;
    int dim_RR_sdis_vc_1;
    int dim_RR_sdis_vc_12;
    int dim_RR_sdis_vc_2;
    int dim_RR_sdis_vc_3;
    int dim_S;
    int dim_S_1;
    int dim_S_2;
    int dim_sdis_pri;
    int dim_sdis_quart;
    int dim_sdis_sec;
    int dim_sdis_sero_pop;
    int dim_sdis_sero_unvacc;
    int dim_sdis_sero_vacc;
    int dim_sdis_sero_vacc_neg;
    int dim_sdis_sero_vacc_pos;
    int dim_sdis_tert;
    int dim_sdisease_sero;
    int dim_sdisease_sero_1;
    int dim_sdisease_sero_12;
    int dim_sdisease_sero_2;
    int dim_sdisease_sero_3;
    int dim_sdisease_sero_vacc_pri;
    int dim_sdisease_sero_vacc_pri_1;
    int dim_sdisease_sero_vacc_pri_2;
    int dim_suscinitpop;
    int dim_time_from_last_dose;
    int dim_time_from_last_dose_base;
    int dim_ts;
    int dim_vacc_ct;
    int dim_vacc_cu_age_weight;
    int dim_vacc_noncov;
    int dim_vacc_noncov_1;
    int dim_vacc_noncov_2;
    int dim_vacc_noncov_S;
    int dim_vacc_noncov_S_1;
    int dim_vacc_noncov_S_2;
    int dim_vcu_noncov;
    int dim_vcu_noncov_1;
    int dim_vcu_noncov_2;
    int dim_vcu_noncov_S;
    int dim_vcu_noncov_S_1;
    int dim_vcu_noncov_S_2;
    int dim_VE_seroneg1n;
    int dim_VE_seroneg1p;
    int dim_vw_I1;
    int dim_vw_I12;
    int dim_vw_I123;
    int dim_vw_I1234;
    int dim_vw_I124;
    int dim_vw_I1243;
    int dim_vw_I13;
    int dim_vw_I132;
    int dim_vw_I134;
    int dim_vw_I1342;
    int dim_vw_I14;
    int dim_vw_I142;
    int dim_vw_I143;
    int dim_vw_I2;
    int dim_vw_I21;
    int dim_vw_I23;
    int dim_vw_I231;
    int dim_vw_I234;
    int dim_vw_I2341;
    int dim_vw_I24;
    int dim_vw_I241;
    int dim_vw_I243;
    int dim_vw_I3;
    int dim_vw_I31;
    int dim_vw_I32;
    int dim_vw_I34;
    int dim_vw_I341;
    int dim_vw_I342;
    int dim_vw_I4;
    int dim_vw_I41;
    int dim_vw_I42;
    int dim_vw_I43;
    int dim_vw_R1;
    int dim_vw_R12;
    int dim_vw_R123;
    int dim_vw_R1234;
    int dim_vw_R124;
    int dim_vw_R13;
    int dim_vw_R134;
    int dim_vw_R14;
    int dim_vw_R2;
    int dim_vw_R23;
    int dim_vw_R234;
    int dim_vw_R24;
    int dim_vw_R3;
    int dim_vw_R34;
    int dim_vw_R4;
    int dim_vw_S;
    int dim_ws;
    int dim_Y1;
    int dim_Y1_1;
    int dim_Y1_2;
    int dim_Y2;
    int dim_Y2_1;
    int dim_Y2_2;
    int dim_Y3;
    int dim_Y3_1;
    int dim_Y3_2;
    int dim_Y4;
    int dim_Y4_1;
    int dim_Y4_2;
    int dim_yll_sero;
    int dim_yll_sero_1;
    int dim_yll_sero_12;
    int dim_yll_sero_2;
    int dim_yll_sero_3;
    int dim_yll_sero_pop;
    int dim_yll_sero_unvacc;
    int dim_yll_sero_vacc;
    int dim_yll_sero_vacc_neg;
    int dim_yll_sero_vacc_pos;
    int dim_yll_sero_vacc_pri;
    int dim_yll_sero_vacc_pri_1;
    int dim_yll_sero_vacc_pri_2;
    std::vector<real_type> dis_pri;
    std::vector<real_type> dis_quart;
    std::vector<real_type> dis_sec;
    std::vector<real_type> dis_tert;
    real_type disc_fact;
    real_type disc_fact_vacc;
    real_type DoVEInf;
    real_type DT;
    real_type dur_cross_prot;
    real_type eip;
    real_type epsilon;
    real_type eq_FOI1;
    real_type eq_FOI2;
    real_type eq_FOI3;
    real_type eq_FOI4;
    real_type EQUILIB_YEARS;
    real_type extInf;
    real_type extInfRand;
    real_type FIRST_YEAR;
    real_type FOIagescale;
    std::vector<real_type> FOIas;
    real_type gamma;
    std::vector<real_type> hl;
    std::vector<real_type> hs;
    real_type incub;
    real_type inf_per;
    std::vector<real_type> init_life_expec;
    real_type init_lifespan;
    std::vector<real_type> initial_cum_infection_pri;
    std::vector<real_type> initial_cum_infection_priV;
    std::vector<real_type> initial_cum_infection_sec;
    std::vector<real_type> initial_cum_infection_secV;
    std::vector<real_type> initial_cum_infection_tq;
    std::vector<real_type> initial_cum_infection_tqV;
    real_type initial_cum_prop_seroneg_at_9;
    real_type initial_cum_prop_seroneg_at_vca;
    real_type initial_exposed1;
    real_type initial_exposed2;
    real_type initial_exposed3;
    real_type initial_exposed4;
    std::vector<real_type> initial_I1;
    std::vector<real_type> initial_I12;
    std::vector<real_type> initial_I123;
    std::vector<real_type> initial_I1234;
    std::vector<real_type> initial_I124;
    std::vector<real_type> initial_I1243;
    std::vector<real_type> initial_I13;
    std::vector<real_type> initial_I132;
    std::vector<real_type> initial_I134;
    std::vector<real_type> initial_I1342;
    std::vector<real_type> initial_I14;
    std::vector<real_type> initial_I142;
    std::vector<real_type> initial_I143;
    std::vector<real_type> initial_I2;
    std::vector<real_type> initial_I21;
    std::vector<real_type> initial_I23;
    std::vector<real_type> initial_I231;
    std::vector<real_type> initial_I234;
    std::vector<real_type> initial_I2341;
    std::vector<real_type> initial_I24;
    std::vector<real_type> initial_I241;
    std::vector<real_type> initial_I243;
    std::vector<real_type> initial_I3;
    std::vector<real_type> initial_I31;
    std::vector<real_type> initial_I32;
    std::vector<real_type> initial_I34;
    std::vector<real_type> initial_I341;
    std::vector<real_type> initial_I342;
    std::vector<real_type> initial_I4;
    std::vector<real_type> initial_I41;
    std::vector<real_type> initial_I42;
    std::vector<real_type> initial_I43;
    real_type initial_inc_FOI1;
    real_type initial_inc_FOI2;
    real_type initial_inc_FOI3;
    real_type initial_inc_FOI4;
    real_type initial_infectious1;
    real_type initial_infectious2;
    real_type initial_infectious3;
    real_type initial_infectious4;
    real_type initial_Lwb;
    real_type initial_Lwt;
    real_type initial_Mwb_E1;
    real_type initial_Mwb_E2;
    real_type initial_Mwb_E3;
    real_type initial_Mwb_E4;
    real_type initial_Mwb_I1;
    real_type initial_Mwb_I2;
    real_type initial_Mwb_I3;
    real_type initial_Mwb_I4;
    real_type initial_Mwb_S;
    real_type initial_Mwt_E1;
    real_type initial_Mwt_E2;
    real_type initial_Mwt_E3;
    real_type initial_Mwt_E4;
    real_type initial_Mwt_I1;
    real_type initial_Mwt_I2;
    real_type initial_Mwt_I3;
    real_type initial_Mwt_I4;
    real_type initial_Mwt_S;
    real_type initial_NT_out;
    real_type initial_NTnv_out;
    std::vector<real_type> initial_Ntotal_out;
    real_type initial_NTv_out;
    real_type initial_NTvE_out;
    real_type initial_NTvS_out;
    std::vector<real_type> initial_out_dis_all_pop;
    std::vector<real_type> initial_out_dis_all_unvacc;
    std::vector<real_type> initial_out_dis_all_vacc;
    std::vector<real_type> initial_out_dis_all_vacc_neg;
    std::vector<real_type> initial_out_dis_all_vacc_pos;
    std::vector<real_type> initial_out_dis_sero_pop;
    std::vector<real_type> initial_out_dis_sero_unvacc;
    std::vector<real_type> initial_out_dis_sero_vacc;
    std::vector<real_type> initial_out_dis_sero_vacc_neg;
    std::vector<real_type> initial_out_dis_sero_vacc_pos;
    std::vector<real_type> initial_out_disc_dis_all_pop;
    std::vector<real_type> initial_out_disc_dis_all_vacc;
    std::vector<real_type> initial_out_disc_nvacc_all_pop;
    std::vector<real_type> initial_out_disc_sdis_all_pop;
    std::vector<real_type> initial_out_disc_sdis_all_vacc;
    std::vector<real_type> initial_out_disc_yll_all_pop;
    std::vector<real_type> initial_out_disc_yll_all_vacc;
    std::vector<real_type> initial_out_nc;
    std::vector<real_type> initial_out_nvacc_all_neg;
    std::vector<real_type> initial_out_nvacc_all_pop;
    std::vector<real_type> initial_out_nvacc_all_pos;
    std::vector<real_type> initial_out_prop_seroneg_at_9;
    std::vector<real_type> initial_out_prop_seroneg_at_vca;
    std::vector<real_type> initial_out_RR;
    std::vector<real_type> initial_out_sdis_all_pop;
    std::vector<real_type> initial_out_sdis_all_unvacc;
    std::vector<real_type> initial_out_sdis_all_vacc;
    std::vector<real_type> initial_out_sdis_all_vacc_neg;
    std::vector<real_type> initial_out_sdis_all_vacc_pos;
    std::vector<real_type> initial_out_sdis_sero_pop;
    std::vector<real_type> initial_out_sdis_sero_unvacc;
    std::vector<real_type> initial_out_sdis_sero_vacc;
    std::vector<real_type> initial_out_sdis_sero_vacc_neg;
    std::vector<real_type> initial_out_sdis_sero_vacc_pos;
    std::vector<real_type> initial_out_time_from_last_dose;
    std::vector<real_type> initial_out_yll_all_pop;
    std::vector<real_type> initial_out_yll_all_unvacc;
    std::vector<real_type> initial_out_yll_all_vacc;
    std::vector<real_type> initial_out_yll_all_vacc_neg;
    std::vector<real_type> initial_out_yll_all_vacc_pos;
    std::vector<real_type> initial_out_yll_sero_pop;
    std::vector<real_type> initial_out_yll_sero_unvacc;
    std::vector<real_type> initial_out_yll_sero_vacc;
    std::vector<real_type> initial_out_yll_sero_vacc_neg;
    std::vector<real_type> initial_out_yll_sero_vacc_pos;
    real_type initial_prop_seroneg_at_9_out;
    real_type initial_prop_seroneg_at_vca_out;
    std::vector<real_type> initial_R1;
    std::vector<real_type> initial_R12;
    std::vector<real_type> initial_R123;
    std::vector<real_type> initial_R1234;
    std::vector<real_type> initial_R124;
    std::vector<real_type> initial_R13;
    std::vector<real_type> initial_R134;
    std::vector<real_type> initial_R14;
    std::vector<real_type> initial_R2;
    std::vector<real_type> initial_R23;
    std::vector<real_type> initial_R234;
    std::vector<real_type> initial_R24;
    std::vector<real_type> initial_R3;
    std::vector<real_type> initial_R34;
    std::vector<real_type> initial_R4;
    std::vector<real_type> initial_S;
    real_type initial_tot_inc_dis;
    real_type initial_tot_inc_FOI;
    std::vector<real_type> initial_VE_seroneg1n;
    std::vector<real_type> initial_VE_seroneg1p;
    real_type initial_Y1T_out;
    real_type initial_Y2T_out;
    real_type initial_Y3T_out;
    real_type initial_Y4T_out;
    real_type kappa;
    real_type Kc_mean;
    real_type Kc_season;
    std::vector<real_type> L_dis;
    std::vector<real_type> L_sdis;
    real_type LAST_YEAR;
    std::vector<real_type> life_expec_d;
    real_type max_rel_year;
    real_type max_ve_decay_time;
    std::vector<real_type> mean_age;
    real_type Mwt;
    int N_age;
    int N_age_p1;
    real_type N_eq;
    real_type N_init;
    std::vector<real_type> N_init_age;
    std::vector<real_type> N_init_age0;
    real_type N_sim;
    std::vector<real_type> nc0;
    std::vector<real_type> nc50_age;
    real_type nc50_age_intercept;
    real_type nc50_age_slope;
    std::vector<real_type> nc50_dis;
    std::vector<real_type> nc50_sdis;
    std::vector<real_type> nnveai;
    real_type nu;
    real_type NUM_YEAR_ACCUM;
    std::vector<real_type> nveai;
    int NYO;
    int offset_variable_cum_infection_pri;
    int offset_variable_cum_infection_priV;
    int offset_variable_cum_infection_sec;
    int offset_variable_cum_infection_secV;
    int offset_variable_cum_infection_tq;
    int offset_variable_cum_infection_tqV;
    int offset_variable_I1;
    int offset_variable_I12;
    int offset_variable_I123;
    int offset_variable_I1234;
    int offset_variable_I124;
    int offset_variable_I1243;
    int offset_variable_I13;
    int offset_variable_I132;
    int offset_variable_I134;
    int offset_variable_I1342;
    int offset_variable_I14;
    int offset_variable_I142;
    int offset_variable_I143;
    int offset_variable_I2;
    int offset_variable_I21;
    int offset_variable_I23;
    int offset_variable_I231;
    int offset_variable_I234;
    int offset_variable_I2341;
    int offset_variable_I24;
    int offset_variable_I241;
    int offset_variable_I243;
    int offset_variable_I3;
    int offset_variable_I31;
    int offset_variable_I32;
    int offset_variable_I34;
    int offset_variable_I341;
    int offset_variable_I342;
    int offset_variable_I4;
    int offset_variable_I41;
    int offset_variable_I42;
    int offset_variable_I43;
    int offset_variable_Ntotal_out;
    int offset_variable_out_dis_all_pop;
    int offset_variable_out_dis_all_unvacc;
    int offset_variable_out_dis_all_vacc;
    int offset_variable_out_dis_all_vacc_neg;
    int offset_variable_out_dis_all_vacc_pos;
    int offset_variable_out_dis_sero_pop;
    int offset_variable_out_dis_sero_unvacc;
    int offset_variable_out_dis_sero_vacc;
    int offset_variable_out_dis_sero_vacc_neg;
    int offset_variable_out_dis_sero_vacc_pos;
    int offset_variable_out_disc_dis_all_pop;
    int offset_variable_out_disc_dis_all_vacc;
    int offset_variable_out_disc_nvacc_all_pop;
    int offset_variable_out_disc_sdis_all_pop;
    int offset_variable_out_disc_sdis_all_vacc;
    int offset_variable_out_disc_yll_all_pop;
    int offset_variable_out_disc_yll_all_vacc;
    int offset_variable_out_nc;
    int offset_variable_out_nvacc_all_neg;
    int offset_variable_out_nvacc_all_pop;
    int offset_variable_out_nvacc_all_pos;
    int offset_variable_out_prop_seroneg_at_9;
    int offset_variable_out_prop_seroneg_at_vca;
    int offset_variable_out_RR;
    int offset_variable_out_sdis_all_pop;
    int offset_variable_out_sdis_all_unvacc;
    int offset_variable_out_sdis_all_vacc;
    int offset_variable_out_sdis_all_vacc_neg;
    int offset_variable_out_sdis_all_vacc_pos;
    int offset_variable_out_sdis_sero_pop;
    int offset_variable_out_sdis_sero_unvacc;
    int offset_variable_out_sdis_sero_vacc;
    int offset_variable_out_sdis_sero_vacc_neg;
    int offset_variable_out_sdis_sero_vacc_pos;
    int offset_variable_out_yll_all_pop;
    int offset_variable_out_yll_all_unvacc;
    int offset_variable_out_yll_all_vacc;
    int offset_variable_out_yll_all_vacc_neg;
    int offset_variable_out_yll_all_vacc_pos;
    int offset_variable_out_yll_sero_pop;
    int offset_variable_out_yll_sero_unvacc;
    int offset_variable_out_yll_sero_vacc;
    int offset_variable_out_yll_sero_vacc_neg;
    int offset_variable_out_yll_sero_vacc_pos;
    int offset_variable_R1;
    int offset_variable_R12;
    int offset_variable_R123;
    int offset_variable_R1234;
    int offset_variable_R124;
    int offset_variable_R13;
    int offset_variable_R134;
    int offset_variable_R14;
    int offset_variable_R2;
    int offset_variable_R23;
    int offset_variable_R234;
    int offset_variable_R24;
    int offset_variable_R3;
    int offset_variable_R34;
    int offset_variable_R4;
    int offset_variable_S;
    int offset_variable_VE_seroneg1n;
    int offset_variable_VE_seroneg1p;
    real_type omega;
    real_type phi_dis_enhance;
    real_type phi_ed;
    std::vector<real_type> phi_pri;
    std::vector<real_type> phi_quart;
    std::vector<real_type> phi_scale;
    std::vector<real_type> phi_sec;
    std::vector<real_type> phi_tert;
    real_type PI_C;
    real_type pop_scale;
    std::vector<real_type> pop_size_d;
    real_type R0_1;
    real_type R0_2;
    real_type R0_3;
    real_type R0_4;
    real_type R0_req;
    real_type R0agescale;
    real_type Rel_R01;
    real_type Rel_R02;
    real_type Rel_R03;
    real_type Rel_R04;
    real_type rho_pri;
    real_type rho_quart;
    real_type rho_sec;
    real_type rho_tert;
    real_type Rm;
    std::vector<real_type> sdis_pri;
    std::vector<real_type> sdis_quart;
    std::vector<real_type> sdis_sec;
    std::vector<real_type> sdis_tert;
    real_type sigma;
    std::vector<real_type> suscinitpop;
    std::vector<real_type> ts;
    real_type vacc_by_serostatus;
    real_type vacc_child_age;
    real_type vacc_child_starttime;
    real_type vacc_child_stoptime;
    std::vector<real_type> vacc_cu_age_weight;
    real_type vacc_cu_coverage;
    real_type vacc_cu_coverage_S;
    real_type vacc_cu_maxage;
    real_type vacc_cu_minage;
    real_type vacc_cu_rndtime;
    real_type vacc_cu_time;
    real_type vacc_decay;
    real_type VACC_END_YEAR;
    real_type VACC_YEAR;
    real_type VaccOn;
    real_type VaccRoutineAge;
    real_type vaccS_decay;
    real_type vca;
    real_type vcov_cu_S;
    real_type Wb_cyto;
    real_type Wb_eff;
    real_type Wb_fF;
    real_type Wb_fM;
    real_type Wb_introduration;
    real_type Wb_introlevel;
    real_type Wb_introrate;
    real_type Wb_introtime;
    real_type Wb_mat;
    real_type Wb_relinf1;
    real_type Wb_relinf2;
    real_type Wb_relinf3;
    real_type Wb_relinf4;
    real_type Wb_relsusc1;
    real_type Wb_relsusc2;
    real_type Wb_relsusc3;
    real_type Wb_relsusc4;
    std::vector<real_type> ws;
    real_type year_calib;
    real_type YEAR_STEP;
    real_type YL;
    real_type ZeroVE;
  };
  struct internal_type {
    std::vector<real_type> age_I1;
    std::vector<real_type> age_I12;
    std::vector<real_type> age_I123;
    std::vector<real_type> age_I1234;
    std::vector<real_type> age_I124;
    std::vector<real_type> age_I1243;
    std::vector<real_type> age_I13;
    std::vector<real_type> age_I132;
    std::vector<real_type> age_I134;
    std::vector<real_type> age_I1342;
    std::vector<real_type> age_I14;
    std::vector<real_type> age_I142;
    std::vector<real_type> age_I143;
    std::vector<real_type> age_I2;
    std::vector<real_type> age_I21;
    std::vector<real_type> age_I23;
    std::vector<real_type> age_I231;
    std::vector<real_type> age_I234;
    std::vector<real_type> age_I2341;
    std::vector<real_type> age_I24;
    std::vector<real_type> age_I241;
    std::vector<real_type> age_I243;
    std::vector<real_type> age_I3;
    std::vector<real_type> age_I31;
    std::vector<real_type> age_I32;
    std::vector<real_type> age_I34;
    std::vector<real_type> age_I341;
    std::vector<real_type> age_I342;
    std::vector<real_type> age_I4;
    std::vector<real_type> age_I41;
    std::vector<real_type> age_I42;
    std::vector<real_type> age_I43;
    std::vector<real_type> age_R1;
    std::vector<real_type> age_R12;
    std::vector<real_type> age_R123;
    std::vector<real_type> age_R1234;
    std::vector<real_type> age_R124;
    std::vector<real_type> age_R13;
    std::vector<real_type> age_R134;
    std::vector<real_type> age_R14;
    std::vector<real_type> age_R2;
    std::vector<real_type> age_R23;
    std::vector<real_type> age_R234;
    std::vector<real_type> age_R24;
    std::vector<real_type> age_R3;
    std::vector<real_type> age_R34;
    std::vector<real_type> age_R4;
    std::vector<real_type> age_S;
    std::vector<real_type> agert;
    std::vector<real_type> cur_age_rate;
    std::vector<real_type> death;
    std::vector<real_type> deathrt;
    std::vector<real_type> dis_sero_pop;
    std::vector<real_type> dis_sero_unvacc;
    std::vector<real_type> dis_sero_vacc;
    std::vector<real_type> dis_sero_vacc_neg;
    std::vector<real_type> dis_sero_vacc_pos;
    std::vector<real_type> disc_yll_all;
    std::vector<real_type> disease_sero;
    std::vector<real_type> disease_sero_vacc_pri;
    std::vector<real_type> FOI1a;
    std::vector<real_type> FOI2a;
    std::vector<real_type> FOI3a;
    std::vector<real_type> FOI4a;
    std::vector<real_type> inf_1;
    std::vector<real_type> inf_12;
    std::vector<real_type> inf_123;
    std::vector<real_type> inf_1234;
    std::vector<real_type> inf_124;
    std::vector<real_type> inf_1243;
    std::vector<real_type> inf_13;
    std::vector<real_type> inf_132;
    std::vector<real_type> inf_134;
    std::vector<real_type> inf_1342;
    std::vector<real_type> inf_14;
    std::vector<real_type> inf_142;
    std::vector<real_type> inf_143;
    std::vector<real_type> inf_2;
    std::vector<real_type> inf_21;
    std::vector<real_type> inf_23;
    std::vector<real_type> inf_231;
    std::vector<real_type> inf_234;
    std::vector<real_type> inf_2341;
    std::vector<real_type> inf_24;
    std::vector<real_type> inf_241;
    std::vector<real_type> inf_243;
    std::vector<real_type> inf_3;
    std::vector<real_type> inf_31;
    std::vector<real_type> inf_32;
    std::vector<real_type> inf_34;
    std::vector<real_type> inf_341;
    std::vector<real_type> inf_342;
    std::vector<real_type> inf_4;
    std::vector<real_type> inf_41;
    std::vector<real_type> inf_42;
    std::vector<real_type> inf_43;
    std::vector<real_type> infection_pri;
    std::vector<real_type> infection_sec;
    std::vector<real_type> infection_tq;
    std::vector<real_type> infV_1;
    std::vector<real_type> infV_2;
    std::vector<real_type> infV_3;
    std::vector<real_type> infV_4;
    std::vector<real_type> life_expec;
    std::vector<real_type> n_I1;
    std::vector<real_type> n_I12;
    std::vector<real_type> n_I123;
    std::vector<real_type> n_I1234;
    std::vector<real_type> n_I124;
    std::vector<real_type> n_I1243;
    std::vector<real_type> n_I13;
    std::vector<real_type> n_I132;
    std::vector<real_type> n_I134;
    std::vector<real_type> n_I1342;
    std::vector<real_type> n_I14;
    std::vector<real_type> n_I142;
    std::vector<real_type> n_I143;
    std::vector<real_type> n_I2;
    std::vector<real_type> n_I21;
    std::vector<real_type> n_I23;
    std::vector<real_type> n_I231;
    std::vector<real_type> n_I234;
    std::vector<real_type> n_I2341;
    std::vector<real_type> n_I24;
    std::vector<real_type> n_I241;
    std::vector<real_type> n_I243;
    std::vector<real_type> n_I3;
    std::vector<real_type> n_I31;
    std::vector<real_type> n_I32;
    std::vector<real_type> n_I34;
    std::vector<real_type> n_I341;
    std::vector<real_type> n_I342;
    std::vector<real_type> n_I4;
    std::vector<real_type> n_I41;
    std::vector<real_type> n_I42;
    std::vector<real_type> n_I43;
    std::vector<real_type> n_R1;
    std::vector<real_type> n_R12;
    std::vector<real_type> n_R123;
    std::vector<real_type> n_R1234;
    std::vector<real_type> n_R124;
    std::vector<real_type> n_R13;
    std::vector<real_type> n_R134;
    std::vector<real_type> n_R14;
    std::vector<real_type> n_R2;
    std::vector<real_type> n_R23;
    std::vector<real_type> n_R234;
    std::vector<real_type> n_R24;
    std::vector<real_type> n_R3;
    std::vector<real_type> n_R34;
    std::vector<real_type> n_R4;
    std::vector<real_type> n_S;
    std::vector<real_type> nc;
    std::vector<real_type> nc_cu;
    std::vector<real_type> ncu_I1;
    std::vector<real_type> ncu_I12;
    std::vector<real_type> ncu_I123;
    std::vector<real_type> ncu_I1234;
    std::vector<real_type> ncu_I124;
    std::vector<real_type> ncu_I1243;
    std::vector<real_type> ncu_I13;
    std::vector<real_type> ncu_I132;
    std::vector<real_type> ncu_I134;
    std::vector<real_type> ncu_I1342;
    std::vector<real_type> ncu_I14;
    std::vector<real_type> ncu_I142;
    std::vector<real_type> ncu_I143;
    std::vector<real_type> ncu_I2;
    std::vector<real_type> ncu_I21;
    std::vector<real_type> ncu_I23;
    std::vector<real_type> ncu_I231;
    std::vector<real_type> ncu_I234;
    std::vector<real_type> ncu_I2341;
    std::vector<real_type> ncu_I24;
    std::vector<real_type> ncu_I241;
    std::vector<real_type> ncu_I243;
    std::vector<real_type> ncu_I3;
    std::vector<real_type> ncu_I31;
    std::vector<real_type> ncu_I32;
    std::vector<real_type> ncu_I34;
    std::vector<real_type> ncu_I341;
    std::vector<real_type> ncu_I342;
    std::vector<real_type> ncu_I4;
    std::vector<real_type> ncu_I41;
    std::vector<real_type> ncu_I42;
    std::vector<real_type> ncu_I43;
    std::vector<real_type> ncu_R1;
    std::vector<real_type> ncu_R12;
    std::vector<real_type> ncu_R123;
    std::vector<real_type> ncu_R1234;
    std::vector<real_type> ncu_R124;
    std::vector<real_type> ncu_R13;
    std::vector<real_type> ncu_R134;
    std::vector<real_type> ncu_R14;
    std::vector<real_type> ncu_R2;
    std::vector<real_type> ncu_R23;
    std::vector<real_type> ncu_R234;
    std::vector<real_type> ncu_R24;
    std::vector<real_type> ncu_R3;
    std::vector<real_type> ncu_R34;
    std::vector<real_type> ncu_R4;
    std::vector<real_type> ncu_S;
    std::vector<real_type> Ntotal;
    std::vector<real_type> Ntotal_all;
    std::vector<real_type> Ntotal_nv;
    std::vector<real_type> Ntotal_nvS;
    std::vector<real_type> Ntotal_v;
    std::vector<real_type> Ntotal_vS;
    std::vector<real_type> num_child_vacc_age;
    std::vector<real_type> num_child_vacc_age_neg;
    std::vector<real_type> num_cu_vacc_age;
    std::vector<real_type> num_cu_vacc_age_neg;
    std::vector<real_type> nvacc_I1;
    std::vector<real_type> nvacc_I12;
    std::vector<real_type> nvacc_I123;
    std::vector<real_type> nvacc_I1234;
    std::vector<real_type> nvacc_I124;
    std::vector<real_type> nvacc_I1243;
    std::vector<real_type> nvacc_I13;
    std::vector<real_type> nvacc_I132;
    std::vector<real_type> nvacc_I134;
    std::vector<real_type> nvacc_I1342;
    std::vector<real_type> nvacc_I14;
    std::vector<real_type> nvacc_I142;
    std::vector<real_type> nvacc_I143;
    std::vector<real_type> nvacc_I2;
    std::vector<real_type> nvacc_I21;
    std::vector<real_type> nvacc_I23;
    std::vector<real_type> nvacc_I231;
    std::vector<real_type> nvacc_I234;
    std::vector<real_type> nvacc_I2341;
    std::vector<real_type> nvacc_I24;
    std::vector<real_type> nvacc_I241;
    std::vector<real_type> nvacc_I243;
    std::vector<real_type> nvacc_I3;
    std::vector<real_type> nvacc_I31;
    std::vector<real_type> nvacc_I32;
    std::vector<real_type> nvacc_I34;
    std::vector<real_type> nvacc_I341;
    std::vector<real_type> nvacc_I342;
    std::vector<real_type> nvacc_I4;
    std::vector<real_type> nvacc_I41;
    std::vector<real_type> nvacc_I42;
    std::vector<real_type> nvacc_I43;
    std::vector<real_type> nvacc_R1;
    std::vector<real_type> nvacc_R12;
    std::vector<real_type> nvacc_R123;
    std::vector<real_type> nvacc_R1234;
    std::vector<real_type> nvacc_R124;
    std::vector<real_type> nvacc_R13;
    std::vector<real_type> nvacc_R134;
    std::vector<real_type> nvacc_R14;
    std::vector<real_type> nvacc_R2;
    std::vector<real_type> nvacc_R23;
    std::vector<real_type> nvacc_R234;
    std::vector<real_type> nvacc_R24;
    std::vector<real_type> nvacc_R3;
    std::vector<real_type> nvacc_R34;
    std::vector<real_type> nvacc_R4;
    std::vector<real_type> nvacc_S;
    std::vector<real_type> O_I1;
    std::vector<real_type> O_I12;
    std::vector<real_type> O_I123;
    std::vector<real_type> O_I1234;
    std::vector<real_type> O_I124;
    std::vector<real_type> O_I1243;
    std::vector<real_type> O_I13;
    std::vector<real_type> O_I132;
    std::vector<real_type> O_I134;
    std::vector<real_type> O_I1342;
    std::vector<real_type> O_I14;
    std::vector<real_type> O_I142;
    std::vector<real_type> O_I143;
    std::vector<real_type> O_I2;
    std::vector<real_type> O_I21;
    std::vector<real_type> O_I23;
    std::vector<real_type> O_I231;
    std::vector<real_type> O_I234;
    std::vector<real_type> O_I2341;
    std::vector<real_type> O_I24;
    std::vector<real_type> O_I241;
    std::vector<real_type> O_I243;
    std::vector<real_type> O_I3;
    std::vector<real_type> O_I31;
    std::vector<real_type> O_I32;
    std::vector<real_type> O_I34;
    std::vector<real_type> O_I341;
    std::vector<real_type> O_I342;
    std::vector<real_type> O_I4;
    std::vector<real_type> O_I41;
    std::vector<real_type> O_I42;
    std::vector<real_type> O_I43;
    std::vector<real_type> O_R1;
    std::vector<real_type> O_R12;
    std::vector<real_type> O_R123;
    std::vector<real_type> O_R1234;
    std::vector<real_type> O_R124;
    std::vector<real_type> O_R13;
    std::vector<real_type> O_R134;
    std::vector<real_type> O_R14;
    std::vector<real_type> O_R2;
    std::vector<real_type> O_R23;
    std::vector<real_type> O_R234;
    std::vector<real_type> O_R24;
    std::vector<real_type> O_R3;
    std::vector<real_type> O_R34;
    std::vector<real_type> O_R4;
    std::vector<real_type> O_S;
    std::vector<real_type> out_update_switch;
    std::vector<real_type> recov_1;
    std::vector<real_type> recov_12;
    std::vector<real_type> recov_123;
    std::vector<real_type> recov_1234;
    std::vector<real_type> recov_124;
    std::vector<real_type> recov_1243;
    std::vector<real_type> recov_13;
    std::vector<real_type> recov_132;
    std::vector<real_type> recov_134;
    std::vector<real_type> recov_1342;
    std::vector<real_type> recov_14;
    std::vector<real_type> recov_142;
    std::vector<real_type> recov_143;
    std::vector<real_type> recov_2;
    std::vector<real_type> recov_21;
    std::vector<real_type> recov_23;
    std::vector<real_type> recov_231;
    std::vector<real_type> recov_234;
    std::vector<real_type> recov_2341;
    std::vector<real_type> recov_24;
    std::vector<real_type> recov_241;
    std::vector<real_type> recov_243;
    std::vector<real_type> recov_3;
    std::vector<real_type> recov_31;
    std::vector<real_type> recov_32;
    std::vector<real_type> recov_34;
    std::vector<real_type> recov_341;
    std::vector<real_type> recov_342;
    std::vector<real_type> recov_4;
    std::vector<real_type> recov_41;
    std::vector<real_type> recov_42;
    std::vector<real_type> recov_43;
    std::vector<real_type> rho1;
    std::vector<real_type> rho12;
    std::vector<real_type> rho123;
    std::vector<real_type> rho1234;
    std::vector<real_type> rho124;
    std::vector<real_type> rho1243;
    std::vector<real_type> rho13;
    std::vector<real_type> rho132;
    std::vector<real_type> rho134;
    std::vector<real_type> rho1342;
    std::vector<real_type> rho14;
    std::vector<real_type> rho142;
    std::vector<real_type> rho143;
    std::vector<real_type> rho2;
    std::vector<real_type> rho21;
    std::vector<real_type> rho23;
    std::vector<real_type> rho231;
    std::vector<real_type> rho234;
    std::vector<real_type> rho2341;
    std::vector<real_type> rho24;
    std::vector<real_type> rho241;
    std::vector<real_type> rho243;
    std::vector<real_type> rho3;
    std::vector<real_type> rho31;
    std::vector<real_type> rho32;
    std::vector<real_type> rho34;
    std::vector<real_type> rho341;
    std::vector<real_type> rho342;
    std::vector<real_type> rho4;
    std::vector<real_type> rho41;
    std::vector<real_type> rho42;
    std::vector<real_type> rho43;
    std::vector<real_type> RR_dis;
    std::vector<real_type> RR_dis_cu;
    std::vector<real_type> RR_dis_vc;
    std::vector<real_type> RR_inf;
    std::vector<real_type> RR_sdis;
    std::vector<real_type> RR_sdis_cu;
    std::vector<real_type> RR_sdis_vc;
    std::vector<real_type> sdis_sero_pop;
    std::vector<real_type> sdis_sero_unvacc;
    std::vector<real_type> sdis_sero_vacc;
    std::vector<real_type> sdis_sero_vacc_neg;
    std::vector<real_type> sdis_sero_vacc_pos;
    std::vector<real_type> sdisease_sero;
    std::vector<real_type> sdisease_sero_vacc_pri;
    std::vector<real_type> time_from_last_dose;
    std::vector<real_type> time_from_last_dose_base;
    std::vector<real_type> vacc_ct;
    std::vector<real_type> vacc_noncov;
    std::vector<real_type> vacc_noncov_S;
    std::vector<real_type> vcu_noncov;
    std::vector<real_type> vcu_noncov_S;
    std::vector<real_type> vw_I1;
    std::vector<real_type> vw_I12;
    std::vector<real_type> vw_I123;
    std::vector<real_type> vw_I1234;
    std::vector<real_type> vw_I124;
    std::vector<real_type> vw_I1243;
    std::vector<real_type> vw_I13;
    std::vector<real_type> vw_I132;
    std::vector<real_type> vw_I134;
    std::vector<real_type> vw_I1342;
    std::vector<real_type> vw_I14;
    std::vector<real_type> vw_I142;
    std::vector<real_type> vw_I143;
    std::vector<real_type> vw_I2;
    std::vector<real_type> vw_I21;
    std::vector<real_type> vw_I23;
    std::vector<real_type> vw_I231;
    std::vector<real_type> vw_I234;
    std::vector<real_type> vw_I2341;
    std::vector<real_type> vw_I24;
    std::vector<real_type> vw_I241;
    std::vector<real_type> vw_I243;
    std::vector<real_type> vw_I3;
    std::vector<real_type> vw_I31;
    std::vector<real_type> vw_I32;
    std::vector<real_type> vw_I34;
    std::vector<real_type> vw_I341;
    std::vector<real_type> vw_I342;
    std::vector<real_type> vw_I4;
    std::vector<real_type> vw_I41;
    std::vector<real_type> vw_I42;
    std::vector<real_type> vw_I43;
    std::vector<real_type> vw_R1;
    std::vector<real_type> vw_R12;
    std::vector<real_type> vw_R123;
    std::vector<real_type> vw_R1234;
    std::vector<real_type> vw_R124;
    std::vector<real_type> vw_R13;
    std::vector<real_type> vw_R134;
    std::vector<real_type> vw_R14;
    std::vector<real_type> vw_R2;
    std::vector<real_type> vw_R23;
    std::vector<real_type> vw_R234;
    std::vector<real_type> vw_R24;
    std::vector<real_type> vw_R3;
    std::vector<real_type> vw_R34;
    std::vector<real_type> vw_R4;
    std::vector<real_type> vw_S;
    std::vector<real_type> Y1;
    std::vector<real_type> Y2;
    std::vector<real_type> Y3;
    std::vector<real_type> Y4;
    std::vector<real_type> yll_sero;
    std::vector<real_type> yll_sero_pop;
    std::vector<real_type> yll_sero_unvacc;
    std::vector<real_type> yll_sero_vacc;
    std::vector<real_type> yll_sero_vacc_neg;
    std::vector<real_type> yll_sero_vacc_pos;
    std::vector<real_type> yll_sero_vacc_pri;
  };
  model(const dust::pars_type<model>& pars) :
    shared(pars.shared), internal(pars.internal) {
  }
  size_t size() const {
    return shared->dim_cum_infection_pri + shared->dim_cum_infection_priV + shared->dim_cum_infection_sec + shared->dim_cum_infection_secV + shared->dim_cum_infection_tq + shared->dim_cum_infection_tqV + shared->dim_I1 + shared->dim_I12 + shared->dim_I123 + shared->dim_I1234 + shared->dim_I124 + shared->dim_I1243 + shared->dim_I13 + shared->dim_I132 + shared->dim_I134 + shared->dim_I1342 + shared->dim_I14 + shared->dim_I142 + shared->dim_I143 + shared->dim_I2 + shared->dim_I21 + shared->dim_I23 + shared->dim_I231 + shared->dim_I234 + shared->dim_I2341 + shared->dim_I24 + shared->dim_I241 + shared->dim_I243 + shared->dim_I3 + shared->dim_I31 + shared->dim_I32 + shared->dim_I34 + shared->dim_I341 + shared->dim_I342 + shared->dim_I4 + shared->dim_I41 + shared->dim_I42 + shared->dim_I43 + shared->dim_Ntotal_out + shared->dim_out_dis_all_pop + shared->dim_out_dis_all_unvacc + shared->dim_out_dis_all_vacc + shared->dim_out_dis_all_vacc_neg + shared->dim_out_dis_all_vacc_pos + shared->dim_out_dis_sero_pop + shared->dim_out_dis_sero_unvacc + shared->dim_out_dis_sero_vacc + shared->dim_out_dis_sero_vacc_neg + shared->dim_out_dis_sero_vacc_pos + shared->dim_out_disc_dis_all_pop + shared->dim_out_disc_dis_all_vacc + shared->dim_out_disc_nvacc_all_pop + shared->dim_out_disc_sdis_all_pop + shared->dim_out_disc_sdis_all_vacc + shared->dim_out_disc_yll_all_pop + shared->dim_out_disc_yll_all_vacc + shared->dim_out_nc + shared->dim_out_nvacc_all_neg + shared->dim_out_nvacc_all_pop + shared->dim_out_nvacc_all_pos + shared->dim_out_prop_seroneg_at_9 + shared->dim_out_prop_seroneg_at_vca + shared->dim_out_RR + shared->dim_out_sdis_all_pop + shared->dim_out_sdis_all_unvacc + shared->dim_out_sdis_all_vacc + shared->dim_out_sdis_all_vacc_neg + shared->dim_out_sdis_all_vacc_pos + shared->dim_out_sdis_sero_pop + shared->dim_out_sdis_sero_unvacc + shared->dim_out_sdis_sero_vacc + shared->dim_out_sdis_sero_vacc_neg + shared->dim_out_sdis_sero_vacc_pos + shared->dim_out_time_from_last_dose + shared->dim_out_yll_all_pop + shared->dim_out_yll_all_unvacc + shared->dim_out_yll_all_vacc + shared->dim_out_yll_all_vacc_neg + shared->dim_out_yll_all_vacc_pos + shared->dim_out_yll_sero_pop + shared->dim_out_yll_sero_unvacc + shared->dim_out_yll_sero_vacc + shared->dim_out_yll_sero_vacc_neg + shared->dim_out_yll_sero_vacc_pos + shared->dim_R1 + shared->dim_R12 + shared->dim_R123 + shared->dim_R1234 + shared->dim_R124 + shared->dim_R13 + shared->dim_R134 + shared->dim_R14 + shared->dim_R2 + shared->dim_R23 + shared->dim_R234 + shared->dim_R24 + shared->dim_R3 + shared->dim_R34 + shared->dim_R4 + shared->dim_S + shared->dim_VE_seroneg1n + shared->dim_VE_seroneg1p + 47;
  }
  std::vector<real_type> initial(size_t step, rng_state_type& rng_state) {
    std::vector<real_type> state(shared->dim_cum_infection_pri + shared->dim_cum_infection_priV + shared->dim_cum_infection_sec + shared->dim_cum_infection_secV + shared->dim_cum_infection_tq + shared->dim_cum_infection_tqV + shared->dim_I1 + shared->dim_I12 + shared->dim_I123 + shared->dim_I1234 + shared->dim_I124 + shared->dim_I1243 + shared->dim_I13 + shared->dim_I132 + shared->dim_I134 + shared->dim_I1342 + shared->dim_I14 + shared->dim_I142 + shared->dim_I143 + shared->dim_I2 + shared->dim_I21 + shared->dim_I23 + shared->dim_I231 + shared->dim_I234 + shared->dim_I2341 + shared->dim_I24 + shared->dim_I241 + shared->dim_I243 + shared->dim_I3 + shared->dim_I31 + shared->dim_I32 + shared->dim_I34 + shared->dim_I341 + shared->dim_I342 + shared->dim_I4 + shared->dim_I41 + shared->dim_I42 + shared->dim_I43 + shared->dim_Ntotal_out + shared->dim_out_dis_all_pop + shared->dim_out_dis_all_unvacc + shared->dim_out_dis_all_vacc + shared->dim_out_dis_all_vacc_neg + shared->dim_out_dis_all_vacc_pos + shared->dim_out_dis_sero_pop + shared->dim_out_dis_sero_unvacc + shared->dim_out_dis_sero_vacc + shared->dim_out_dis_sero_vacc_neg + shared->dim_out_dis_sero_vacc_pos + shared->dim_out_disc_dis_all_pop + shared->dim_out_disc_dis_all_vacc + shared->dim_out_disc_nvacc_all_pop + shared->dim_out_disc_sdis_all_pop + shared->dim_out_disc_sdis_all_vacc + shared->dim_out_disc_yll_all_pop + shared->dim_out_disc_yll_all_vacc + shared->dim_out_nc + shared->dim_out_nvacc_all_neg + shared->dim_out_nvacc_all_pop + shared->dim_out_nvacc_all_pos + shared->dim_out_prop_seroneg_at_9 + shared->dim_out_prop_seroneg_at_vca + shared->dim_out_RR + shared->dim_out_sdis_all_pop + shared->dim_out_sdis_all_unvacc + shared->dim_out_sdis_all_vacc + shared->dim_out_sdis_all_vacc_neg + shared->dim_out_sdis_all_vacc_pos + shared->dim_out_sdis_sero_pop + shared->dim_out_sdis_sero_unvacc + shared->dim_out_sdis_sero_vacc + shared->dim_out_sdis_sero_vacc_neg + shared->dim_out_sdis_sero_vacc_pos + shared->dim_out_time_from_last_dose + shared->dim_out_yll_all_pop + shared->dim_out_yll_all_unvacc + shared->dim_out_yll_all_vacc + shared->dim_out_yll_all_vacc_neg + shared->dim_out_yll_all_vacc_pos + shared->dim_out_yll_sero_pop + shared->dim_out_yll_sero_unvacc + shared->dim_out_yll_sero_vacc + shared->dim_out_yll_sero_vacc_neg + shared->dim_out_yll_sero_vacc_pos + shared->dim_R1 + shared->dim_R12 + shared->dim_R123 + shared->dim_R1234 + shared->dim_R124 + shared->dim_R13 + shared->dim_R134 + shared->dim_R14 + shared->dim_R2 + shared->dim_R23 + shared->dim_R234 + shared->dim_R24 + shared->dim_R3 + shared->dim_R34 + shared->dim_R4 + shared->dim_S + shared->dim_VE_seroneg1n + shared->dim_VE_seroneg1p + 47);
    state[0] = shared->initial_Lwt;
    state[1] = shared->initial_Mwt_S;
    state[2] = shared->initial_Mwt_E1;
    state[3] = shared->initial_Mwt_E2;
    state[4] = shared->initial_Mwt_E3;
    state[5] = shared->initial_Mwt_E4;
    state[6] = shared->initial_Mwt_I1;
    state[7] = shared->initial_Mwt_I2;
    state[8] = shared->initial_Mwt_I3;
    state[9] = shared->initial_Mwt_I4;
    state[10] = shared->initial_Lwb;
    state[11] = shared->initial_Mwb_S;
    state[12] = shared->initial_Mwb_E1;
    state[13] = shared->initial_Mwb_E2;
    state[14] = shared->initial_Mwb_E3;
    state[15] = shared->initial_Mwb_E4;
    state[16] = shared->initial_Mwb_I1;
    state[17] = shared->initial_Mwb_I2;
    state[18] = shared->initial_Mwb_I3;
    state[19] = shared->initial_Mwb_I4;
    state[20] = shared->initial_NT_out;
    state[21] = shared->initial_NTv_out;
    state[22] = shared->initial_NTnv_out;
    state[23] = shared->initial_NTvS_out;
    state[24] = shared->initial_NTvE_out;
    state[25] = shared->initial_prop_seroneg_at_9_out;
    state[26] = shared->initial_prop_seroneg_at_vca_out;
    state[27] = shared->initial_Y1T_out;
    state[28] = shared->initial_Y2T_out;
    state[29] = shared->initial_Y3T_out;
    state[30] = shared->initial_Y4T_out;
    state[31] = shared->initial_exposed1;
    state[32] = shared->initial_exposed2;
    state[33] = shared->initial_exposed3;
    state[34] = shared->initial_exposed4;
    state[35] = shared->initial_infectious1;
    state[36] = shared->initial_infectious2;
    state[37] = shared->initial_infectious3;
    state[38] = shared->initial_infectious4;
    state[39] = shared->initial_inc_FOI1;
    state[40] = shared->initial_inc_FOI2;
    state[41] = shared->initial_inc_FOI3;
    state[42] = shared->initial_inc_FOI4;
    state[43] = shared->initial_tot_inc_FOI;
    state[44] = shared->initial_cum_prop_seroneg_at_9;
    state[45] = shared->initial_cum_prop_seroneg_at_vca;
    state[46] = shared->initial_tot_inc_dis;
    std::copy(shared->initial_out_time_from_last_dose.begin(), shared->initial_out_time_from_last_dose.end(), state.begin() + 47);
    std::copy(shared->initial_Ntotal_out.begin(), shared->initial_Ntotal_out.end(), state.begin() + shared->offset_variable_Ntotal_out);
    std::copy(shared->initial_cum_infection_pri.begin(), shared->initial_cum_infection_pri.end(), state.begin() + shared->offset_variable_cum_infection_pri);
    std::copy(shared->initial_cum_infection_priV.begin(), shared->initial_cum_infection_priV.end(), state.begin() + shared->offset_variable_cum_infection_priV);
    std::copy(shared->initial_cum_infection_sec.begin(), shared->initial_cum_infection_sec.end(), state.begin() + shared->offset_variable_cum_infection_sec);
    std::copy(shared->initial_cum_infection_secV.begin(), shared->initial_cum_infection_secV.end(), state.begin() + shared->offset_variable_cum_infection_secV);
    std::copy(shared->initial_cum_infection_tq.begin(), shared->initial_cum_infection_tq.end(), state.begin() + shared->offset_variable_cum_infection_tq);
    std::copy(shared->initial_cum_infection_tqV.begin(), shared->initial_cum_infection_tqV.end(), state.begin() + shared->offset_variable_cum_infection_tqV);
    std::copy(shared->initial_VE_seroneg1n.begin(), shared->initial_VE_seroneg1n.end(), state.begin() + shared->offset_variable_VE_seroneg1n);
    std::copy(shared->initial_VE_seroneg1p.begin(), shared->initial_VE_seroneg1p.end(), state.begin() + shared->offset_variable_VE_seroneg1p);
    std::copy(shared->initial_out_prop_seroneg_at_9.begin(), shared->initial_out_prop_seroneg_at_9.end(), state.begin() + shared->offset_variable_out_prop_seroneg_at_9);
    std::copy(shared->initial_out_prop_seroneg_at_vca.begin(), shared->initial_out_prop_seroneg_at_vca.end(), state.begin() + shared->offset_variable_out_prop_seroneg_at_vca);
    std::copy(shared->initial_out_dis_all_pop.begin(), shared->initial_out_dis_all_pop.end(), state.begin() + shared->offset_variable_out_dis_all_pop);
    std::copy(shared->initial_out_dis_all_unvacc.begin(), shared->initial_out_dis_all_unvacc.end(), state.begin() + shared->offset_variable_out_dis_all_unvacc);
    std::copy(shared->initial_out_dis_all_vacc.begin(), shared->initial_out_dis_all_vacc.end(), state.begin() + shared->offset_variable_out_dis_all_vacc);
    std::copy(shared->initial_out_dis_all_vacc_neg.begin(), shared->initial_out_dis_all_vacc_neg.end(), state.begin() + shared->offset_variable_out_dis_all_vacc_neg);
    std::copy(shared->initial_out_dis_all_vacc_pos.begin(), shared->initial_out_dis_all_vacc_pos.end(), state.begin() + shared->offset_variable_out_dis_all_vacc_pos);
    std::copy(shared->initial_out_disc_dis_all_pop.begin(), shared->initial_out_disc_dis_all_pop.end(), state.begin() + shared->offset_variable_out_disc_dis_all_pop);
    std::copy(shared->initial_out_disc_dis_all_vacc.begin(), shared->initial_out_disc_dis_all_vacc.end(), state.begin() + shared->offset_variable_out_disc_dis_all_vacc);
    std::copy(shared->initial_out_sdis_all_pop.begin(), shared->initial_out_sdis_all_pop.end(), state.begin() + shared->offset_variable_out_sdis_all_pop);
    std::copy(shared->initial_out_sdis_all_unvacc.begin(), shared->initial_out_sdis_all_unvacc.end(), state.begin() + shared->offset_variable_out_sdis_all_unvacc);
    std::copy(shared->initial_out_sdis_all_vacc.begin(), shared->initial_out_sdis_all_vacc.end(), state.begin() + shared->offset_variable_out_sdis_all_vacc);
    std::copy(shared->initial_out_sdis_all_vacc_neg.begin(), shared->initial_out_sdis_all_vacc_neg.end(), state.begin() + shared->offset_variable_out_sdis_all_vacc_neg);
    std::copy(shared->initial_out_sdis_all_vacc_pos.begin(), shared->initial_out_sdis_all_vacc_pos.end(), state.begin() + shared->offset_variable_out_sdis_all_vacc_pos);
    std::copy(shared->initial_out_disc_sdis_all_pop.begin(), shared->initial_out_disc_sdis_all_pop.end(), state.begin() + shared->offset_variable_out_disc_sdis_all_pop);
    std::copy(shared->initial_out_disc_sdis_all_vacc.begin(), shared->initial_out_disc_sdis_all_vacc.end(), state.begin() + shared->offset_variable_out_disc_sdis_all_vacc);
    std::copy(shared->initial_out_yll_all_pop.begin(), shared->initial_out_yll_all_pop.end(), state.begin() + shared->offset_variable_out_yll_all_pop);
    std::copy(shared->initial_out_yll_all_unvacc.begin(), shared->initial_out_yll_all_unvacc.end(), state.begin() + shared->offset_variable_out_yll_all_unvacc);
    std::copy(shared->initial_out_yll_all_vacc.begin(), shared->initial_out_yll_all_vacc.end(), state.begin() + shared->offset_variable_out_yll_all_vacc);
    std::copy(shared->initial_out_yll_all_vacc_neg.begin(), shared->initial_out_yll_all_vacc_neg.end(), state.begin() + shared->offset_variable_out_yll_all_vacc_neg);
    std::copy(shared->initial_out_yll_all_vacc_pos.begin(), shared->initial_out_yll_all_vacc_pos.end(), state.begin() + shared->offset_variable_out_yll_all_vacc_pos);
    std::copy(shared->initial_out_disc_yll_all_pop.begin(), shared->initial_out_disc_yll_all_pop.end(), state.begin() + shared->offset_variable_out_disc_yll_all_pop);
    std::copy(shared->initial_out_disc_yll_all_vacc.begin(), shared->initial_out_disc_yll_all_vacc.end(), state.begin() + shared->offset_variable_out_disc_yll_all_vacc);
    std::copy(shared->initial_out_nvacc_all_pop.begin(), shared->initial_out_nvacc_all_pop.end(), state.begin() + shared->offset_variable_out_nvacc_all_pop);
    std::copy(shared->initial_out_nvacc_all_neg.begin(), shared->initial_out_nvacc_all_neg.end(), state.begin() + shared->offset_variable_out_nvacc_all_neg);
    std::copy(shared->initial_out_nvacc_all_pos.begin(), shared->initial_out_nvacc_all_pos.end(), state.begin() + shared->offset_variable_out_nvacc_all_pos);
    std::copy(shared->initial_out_disc_nvacc_all_pop.begin(), shared->initial_out_disc_nvacc_all_pop.end(), state.begin() + shared->offset_variable_out_disc_nvacc_all_pop);
    std::copy(shared->initial_S.begin(), shared->initial_S.end(), state.begin() + shared->offset_variable_S);
    std::copy(shared->initial_I1.begin(), shared->initial_I1.end(), state.begin() + shared->offset_variable_I1);
    std::copy(shared->initial_I2.begin(), shared->initial_I2.end(), state.begin() + shared->offset_variable_I2);
    std::copy(shared->initial_I3.begin(), shared->initial_I3.end(), state.begin() + shared->offset_variable_I3);
    std::copy(shared->initial_I4.begin(), shared->initial_I4.end(), state.begin() + shared->offset_variable_I4);
    std::copy(shared->initial_R1.begin(), shared->initial_R1.end(), state.begin() + shared->offset_variable_R1);
    std::copy(shared->initial_R2.begin(), shared->initial_R2.end(), state.begin() + shared->offset_variable_R2);
    std::copy(shared->initial_R3.begin(), shared->initial_R3.end(), state.begin() + shared->offset_variable_R3);
    std::copy(shared->initial_R4.begin(), shared->initial_R4.end(), state.begin() + shared->offset_variable_R4);
    std::copy(shared->initial_I21.begin(), shared->initial_I21.end(), state.begin() + shared->offset_variable_I21);
    std::copy(shared->initial_I31.begin(), shared->initial_I31.end(), state.begin() + shared->offset_variable_I31);
    std::copy(shared->initial_I41.begin(), shared->initial_I41.end(), state.begin() + shared->offset_variable_I41);
    std::copy(shared->initial_I12.begin(), shared->initial_I12.end(), state.begin() + shared->offset_variable_I12);
    std::copy(shared->initial_I32.begin(), shared->initial_I32.end(), state.begin() + shared->offset_variable_I32);
    std::copy(shared->initial_I42.begin(), shared->initial_I42.end(), state.begin() + shared->offset_variable_I42);
    std::copy(shared->initial_I13.begin(), shared->initial_I13.end(), state.begin() + shared->offset_variable_I13);
    std::copy(shared->initial_I23.begin(), shared->initial_I23.end(), state.begin() + shared->offset_variable_I23);
    std::copy(shared->initial_I43.begin(), shared->initial_I43.end(), state.begin() + shared->offset_variable_I43);
    std::copy(shared->initial_I14.begin(), shared->initial_I14.end(), state.begin() + shared->offset_variable_I14);
    std::copy(shared->initial_I24.begin(), shared->initial_I24.end(), state.begin() + shared->offset_variable_I24);
    std::copy(shared->initial_I34.begin(), shared->initial_I34.end(), state.begin() + shared->offset_variable_I34);
    std::copy(shared->initial_R12.begin(), shared->initial_R12.end(), state.begin() + shared->offset_variable_R12);
    std::copy(shared->initial_R13.begin(), shared->initial_R13.end(), state.begin() + shared->offset_variable_R13);
    std::copy(shared->initial_R14.begin(), shared->initial_R14.end(), state.begin() + shared->offset_variable_R14);
    std::copy(shared->initial_R23.begin(), shared->initial_R23.end(), state.begin() + shared->offset_variable_R23);
    std::copy(shared->initial_R24.begin(), shared->initial_R24.end(), state.begin() + shared->offset_variable_R24);
    std::copy(shared->initial_R34.begin(), shared->initial_R34.end(), state.begin() + shared->offset_variable_R34);
    std::copy(shared->initial_I231.begin(), shared->initial_I231.end(), state.begin() + shared->offset_variable_I231);
    std::copy(shared->initial_I241.begin(), shared->initial_I241.end(), state.begin() + shared->offset_variable_I241);
    std::copy(shared->initial_I341.begin(), shared->initial_I341.end(), state.begin() + shared->offset_variable_I341);
    std::copy(shared->initial_I132.begin(), shared->initial_I132.end(), state.begin() + shared->offset_variable_I132);
    std::copy(shared->initial_I142.begin(), shared->initial_I142.end(), state.begin() + shared->offset_variable_I142);
    std::copy(shared->initial_I342.begin(), shared->initial_I342.end(), state.begin() + shared->offset_variable_I342);
    std::copy(shared->initial_I123.begin(), shared->initial_I123.end(), state.begin() + shared->offset_variable_I123);
    std::copy(shared->initial_I143.begin(), shared->initial_I143.end(), state.begin() + shared->offset_variable_I143);
    std::copy(shared->initial_I243.begin(), shared->initial_I243.end(), state.begin() + shared->offset_variable_I243);
    std::copy(shared->initial_I124.begin(), shared->initial_I124.end(), state.begin() + shared->offset_variable_I124);
    std::copy(shared->initial_I134.begin(), shared->initial_I134.end(), state.begin() + shared->offset_variable_I134);
    std::copy(shared->initial_I234.begin(), shared->initial_I234.end(), state.begin() + shared->offset_variable_I234);
    std::copy(shared->initial_R123.begin(), shared->initial_R123.end(), state.begin() + shared->offset_variable_R123);
    std::copy(shared->initial_R124.begin(), shared->initial_R124.end(), state.begin() + shared->offset_variable_R124);
    std::copy(shared->initial_R134.begin(), shared->initial_R134.end(), state.begin() + shared->offset_variable_R134);
    std::copy(shared->initial_R234.begin(), shared->initial_R234.end(), state.begin() + shared->offset_variable_R234);
    std::copy(shared->initial_I2341.begin(), shared->initial_I2341.end(), state.begin() + shared->offset_variable_I2341);
    std::copy(shared->initial_I1342.begin(), shared->initial_I1342.end(), state.begin() + shared->offset_variable_I1342);
    std::copy(shared->initial_I1243.begin(), shared->initial_I1243.end(), state.begin() + shared->offset_variable_I1243);
    std::copy(shared->initial_I1234.begin(), shared->initial_I1234.end(), state.begin() + shared->offset_variable_I1234);
    std::copy(shared->initial_R1234.begin(), shared->initial_R1234.end(), state.begin() + shared->offset_variable_R1234);
    std::copy(shared->initial_out_dis_sero_pop.begin(), shared->initial_out_dis_sero_pop.end(), state.begin() + shared->offset_variable_out_dis_sero_pop);
    std::copy(shared->initial_out_dis_sero_unvacc.begin(), shared->initial_out_dis_sero_unvacc.end(), state.begin() + shared->offset_variable_out_dis_sero_unvacc);
    std::copy(shared->initial_out_dis_sero_vacc.begin(), shared->initial_out_dis_sero_vacc.end(), state.begin() + shared->offset_variable_out_dis_sero_vacc);
    std::copy(shared->initial_out_dis_sero_vacc_neg.begin(), shared->initial_out_dis_sero_vacc_neg.end(), state.begin() + shared->offset_variable_out_dis_sero_vacc_neg);
    std::copy(shared->initial_out_dis_sero_vacc_pos.begin(), shared->initial_out_dis_sero_vacc_pos.end(), state.begin() + shared->offset_variable_out_dis_sero_vacc_pos);
    std::copy(shared->initial_out_sdis_sero_pop.begin(), shared->initial_out_sdis_sero_pop.end(), state.begin() + shared->offset_variable_out_sdis_sero_pop);
    std::copy(shared->initial_out_sdis_sero_unvacc.begin(), shared->initial_out_sdis_sero_unvacc.end(), state.begin() + shared->offset_variable_out_sdis_sero_unvacc);
    std::copy(shared->initial_out_sdis_sero_vacc.begin(), shared->initial_out_sdis_sero_vacc.end(), state.begin() + shared->offset_variable_out_sdis_sero_vacc);
    std::copy(shared->initial_out_sdis_sero_vacc_neg.begin(), shared->initial_out_sdis_sero_vacc_neg.end(), state.begin() + shared->offset_variable_out_sdis_sero_vacc_neg);
    std::copy(shared->initial_out_sdis_sero_vacc_pos.begin(), shared->initial_out_sdis_sero_vacc_pos.end(), state.begin() + shared->offset_variable_out_sdis_sero_vacc_pos);
    std::copy(shared->initial_out_yll_sero_pop.begin(), shared->initial_out_yll_sero_pop.end(), state.begin() + shared->offset_variable_out_yll_sero_pop);
    std::copy(shared->initial_out_yll_sero_unvacc.begin(), shared->initial_out_yll_sero_unvacc.end(), state.begin() + shared->offset_variable_out_yll_sero_unvacc);
    std::copy(shared->initial_out_yll_sero_vacc.begin(), shared->initial_out_yll_sero_vacc.end(), state.begin() + shared->offset_variable_out_yll_sero_vacc);
    std::copy(shared->initial_out_yll_sero_vacc_neg.begin(), shared->initial_out_yll_sero_vacc_neg.end(), state.begin() + shared->offset_variable_out_yll_sero_vacc_neg);
    std::copy(shared->initial_out_yll_sero_vacc_pos.begin(), shared->initial_out_yll_sero_vacc_pos.end(), state.begin() + shared->offset_variable_out_yll_sero_vacc_pos);
    std::copy(shared->initial_out_nc.begin(), shared->initial_out_nc.end(), state.begin() + shared->offset_variable_out_nc);
    std::copy(shared->initial_out_RR.begin(), shared->initial_out_RR.end(), state.begin() + shared->offset_variable_out_RR);
    return state;
  }
  void update(size_t step, const real_type * state, rng_state_type& rng_state, real_type * state_next) {
    const real_type Lwt = state[0];
    const real_type Lwb = state[10];
    const real_type Mwt_S = state[1];
    const real_type Mwt_E1 = state[2];
    const real_type Mwt_E2 = state[3];
    const real_type Mwt_E3 = state[4];
    const real_type Mwt_E4 = state[5];
    const real_type Mwt_I1 = state[6];
    const real_type Mwt_I2 = state[7];
    const real_type Mwt_I3 = state[8];
    const real_type Mwt_I4 = state[9];
    const real_type Mwb_S = state[11];
    const real_type Mwb_E1 = state[12];
    const real_type Mwb_E2 = state[13];
    const real_type Mwb_E3 = state[14];
    const real_type Mwb_E4 = state[15];
    const real_type Mwb_I1 = state[16];
    const real_type Mwb_I2 = state[17];
    const real_type Mwb_I3 = state[18];
    const real_type Mwb_I4 = state[19];
    const real_type exposed1 = state[31];
    const real_type exposed2 = state[32];
    const real_type exposed3 = state[33];
    const real_type exposed4 = state[34];
    const real_type infectious1 = state[35];
    const real_type infectious2 = state[36];
    const real_type infectious3 = state[37];
    const real_type infectious4 = state[38];
    const real_type inc_FOI1 = state[39];
    const real_type inc_FOI2 = state[40];
    const real_type inc_FOI3 = state[41];
    const real_type inc_FOI4 = state[42];
    const real_type tot_inc_FOI = state[43];
    const real_type * cum_infection_pri = state + shared->offset_variable_cum_infection_pri;
    const real_type * cum_infection_priV = state + shared->offset_variable_cum_infection_priV;
    const real_type * cum_infection_sec = state + shared->offset_variable_cum_infection_sec;
    const real_type * cum_infection_secV = state + shared->offset_variable_cum_infection_secV;
    const real_type * cum_infection_tq = state + shared->offset_variable_cum_infection_tq;
    const real_type * cum_infection_tqV = state + shared->offset_variable_cum_infection_tqV;
    const real_type * VE_seroneg1n = state + shared->offset_variable_VE_seroneg1n;
    const real_type * VE_seroneg1p = state + shared->offset_variable_VE_seroneg1p;
    const real_type cum_prop_seroneg_at_9 = state[44];
    const real_type * out_prop_seroneg_at_9 = state + shared->offset_variable_out_prop_seroneg_at_9;
    const real_type cum_prop_seroneg_at_vca = state[45];
    const real_type * out_prop_seroneg_at_vca = state + shared->offset_variable_out_prop_seroneg_at_vca;
    const real_type * out_dis_all_pop = state + shared->offset_variable_out_dis_all_pop;
    const real_type * out_dis_sero_pop = state + shared->offset_variable_out_dis_sero_pop;
    const real_type * out_dis_all_unvacc = state + shared->offset_variable_out_dis_all_unvacc;
    const real_type * out_dis_sero_unvacc = state + shared->offset_variable_out_dis_sero_unvacc;
    const real_type * out_dis_all_vacc = state + shared->offset_variable_out_dis_all_vacc;
    const real_type * out_dis_all_vacc_neg = state + shared->offset_variable_out_dis_all_vacc_neg;
    const real_type * out_dis_all_vacc_pos = state + shared->offset_variable_out_dis_all_vacc_pos;
    const real_type * out_dis_sero_vacc = state + shared->offset_variable_out_dis_sero_vacc;
    const real_type * out_dis_sero_vacc_neg = state + shared->offset_variable_out_dis_sero_vacc_neg;
    const real_type * out_dis_sero_vacc_pos = state + shared->offset_variable_out_dis_sero_vacc_pos;
    const real_type * out_disc_dis_all_pop = state + shared->offset_variable_out_disc_dis_all_pop;
    const real_type * out_disc_dis_all_vacc = state + shared->offset_variable_out_disc_dis_all_vacc;
    const real_type tot_inc_dis = state[46];
    const real_type * out_sdis_all_pop = state + shared->offset_variable_out_sdis_all_pop;
    const real_type * out_sdis_sero_pop = state + shared->offset_variable_out_sdis_sero_pop;
    const real_type * out_sdis_all_unvacc = state + shared->offset_variable_out_sdis_all_unvacc;
    const real_type * out_sdis_sero_unvacc = state + shared->offset_variable_out_sdis_sero_unvacc;
    const real_type * out_sdis_all_vacc = state + shared->offset_variable_out_sdis_all_vacc;
    const real_type * out_sdis_all_vacc_neg = state + shared->offset_variable_out_sdis_all_vacc_neg;
    const real_type * out_sdis_all_vacc_pos = state + shared->offset_variable_out_sdis_all_vacc_pos;
    const real_type * out_sdis_sero_vacc = state + shared->offset_variable_out_sdis_sero_vacc;
    const real_type * out_sdis_sero_vacc_neg = state + shared->offset_variable_out_sdis_sero_vacc_neg;
    const real_type * out_sdis_sero_vacc_pos = state + shared->offset_variable_out_sdis_sero_vacc_pos;
    const real_type * out_disc_sdis_all_pop = state + shared->offset_variable_out_disc_sdis_all_pop;
    const real_type * out_disc_sdis_all_vacc = state + shared->offset_variable_out_disc_sdis_all_vacc;
    const real_type * out_yll_all_pop = state + shared->offset_variable_out_yll_all_pop;
    const real_type * out_yll_sero_pop = state + shared->offset_variable_out_yll_sero_pop;
    const real_type * out_yll_all_unvacc = state + shared->offset_variable_out_yll_all_unvacc;
    const real_type * out_yll_sero_unvacc = state + shared->offset_variable_out_yll_sero_unvacc;
    const real_type * out_yll_all_vacc = state + shared->offset_variable_out_yll_all_vacc;
    const real_type * out_yll_all_vacc_neg = state + shared->offset_variable_out_yll_all_vacc_neg;
    const real_type * out_yll_all_vacc_pos = state + shared->offset_variable_out_yll_all_vacc_pos;
    const real_type * out_yll_sero_vacc = state + shared->offset_variable_out_yll_sero_vacc;
    const real_type * out_yll_sero_vacc_neg = state + shared->offset_variable_out_yll_sero_vacc_neg;
    const real_type * out_yll_sero_vacc_pos = state + shared->offset_variable_out_yll_sero_vacc_pos;
    const real_type * out_disc_yll_all_pop = state + shared->offset_variable_out_disc_yll_all_pop;
    const real_type * out_disc_yll_all_vacc = state + shared->offset_variable_out_disc_yll_all_vacc;
    const real_type * out_nvacc_all_pop = state + shared->offset_variable_out_nvacc_all_pop;
    const real_type * out_nvacc_all_neg = state + shared->offset_variable_out_nvacc_all_neg;
    const real_type * out_nvacc_all_pos = state + shared->offset_variable_out_nvacc_all_pos;
    const real_type * out_disc_nvacc_all_pop = state + shared->offset_variable_out_disc_nvacc_all_pop;
    const real_type * S = state + shared->offset_variable_S;
    const real_type * I1 = state + shared->offset_variable_I1;
    const real_type * I2 = state + shared->offset_variable_I2;
    const real_type * I3 = state + shared->offset_variable_I3;
    const real_type * I4 = state + shared->offset_variable_I4;
    const real_type * R1 = state + shared->offset_variable_R1;
    const real_type * R2 = state + shared->offset_variable_R2;
    const real_type * R3 = state + shared->offset_variable_R3;
    const real_type * R4 = state + shared->offset_variable_R4;
    const real_type * I12 = state + shared->offset_variable_I12;
    const real_type * I13 = state + shared->offset_variable_I13;
    const real_type * I14 = state + shared->offset_variable_I14;
    const real_type * I21 = state + shared->offset_variable_I21;
    const real_type * I23 = state + shared->offset_variable_I23;
    const real_type * I24 = state + shared->offset_variable_I24;
    const real_type * I31 = state + shared->offset_variable_I31;
    const real_type * I32 = state + shared->offset_variable_I32;
    const real_type * I34 = state + shared->offset_variable_I34;
    const real_type * I41 = state + shared->offset_variable_I41;
    const real_type * I42 = state + shared->offset_variable_I42;
    const real_type * I43 = state + shared->offset_variable_I43;
    const real_type * R12 = state + shared->offset_variable_R12;
    const real_type * R13 = state + shared->offset_variable_R13;
    const real_type * R14 = state + shared->offset_variable_R14;
    const real_type * R23 = state + shared->offset_variable_R23;
    const real_type * R24 = state + shared->offset_variable_R24;
    const real_type * R34 = state + shared->offset_variable_R34;
    const real_type * I123 = state + shared->offset_variable_I123;
    const real_type * I124 = state + shared->offset_variable_I124;
    const real_type * I132 = state + shared->offset_variable_I132;
    const real_type * I134 = state + shared->offset_variable_I134;
    const real_type * I142 = state + shared->offset_variable_I142;
    const real_type * I143 = state + shared->offset_variable_I143;
    const real_type * I231 = state + shared->offset_variable_I231;
    const real_type * I234 = state + shared->offset_variable_I234;
    const real_type * I241 = state + shared->offset_variable_I241;
    const real_type * I243 = state + shared->offset_variable_I243;
    const real_type * I341 = state + shared->offset_variable_I341;
    const real_type * I342 = state + shared->offset_variable_I342;
    const real_type * R123 = state + shared->offset_variable_R123;
    const real_type * R124 = state + shared->offset_variable_R124;
    const real_type * R134 = state + shared->offset_variable_R134;
    const real_type * R234 = state + shared->offset_variable_R234;
    const real_type * I1234 = state + shared->offset_variable_I1234;
    const real_type * I1243 = state + shared->offset_variable_I1243;
    const real_type * I1342 = state + shared->offset_variable_I1342;
    const real_type * I2341 = state + shared->offset_variable_I2341;
    const real_type * R1234 = state + shared->offset_variable_R1234;
    real_type Mwb_tot = Mwb_S + Mwb_E1 + Mwb_E2 + Mwb_E3 + Mwb_E4 + Mwb_I1 + Mwb_I2 + Mwb_I3 + Mwb_I4;
    real_type Mwt_tot = Mwt_S + Mwt_E1 + Mwt_E2 + Mwt_E3 + Mwt_E4 + Mwt_I1 + Mwt_I2 + Mwt_I3 + Mwt_I4;
    real_type O_Mwt_E1 = (shared->DT * (shared->delta + 1 / (real_type) shared->eip)) * (Mwt_E1);
    real_type O_Mwt_E2 = (shared->DT * (shared->delta + 1 / (real_type) shared->eip)) * (Mwt_E2);
    real_type O_Mwt_E3 = (shared->DT * (shared->delta + 1 / (real_type) shared->eip)) * (Mwt_E3);
    real_type O_Mwt_E4 = (shared->DT * (shared->delta + 1 / (real_type) shared->eip)) * (Mwt_E4);
    real_type TIME = step * shared->DT;
    state_next[35] = infectious1 * (1 - shared->DT / (real_type) shared->inf_per) + exposed1 * shared->DT / (real_type) shared->incub;
    state_next[36] = infectious2 * (1 - shared->DT / (real_type) shared->inf_per) + exposed2 * shared->DT / (real_type) shared->incub;
    state_next[37] = infectious3 * (1 - shared->DT / (real_type) shared->inf_per) + exposed3 * shared->DT / (real_type) shared->incub;
    state_next[38] = infectious4 * (1 - shared->DT / (real_type) shared->inf_per) + exposed4 * shared->DT / (real_type) shared->incub;
    real_type agerts = (dust::math::floor(TIME / (real_type) shared->age_per) == TIME / (real_type) shared->age_per ? shared->age_per / (real_type) shared->YL : 0);
    real_type Beta_mh = shared->Beta_mh_mean * (1 + shared->Beta_mh_season * dust::math::cos(2 * shared->PI_C * TIME / (real_type) shared->YL));
    real_type Lwb_birth = (shared->DT * shared->gamma * shared->Wb_fF * shared->Wb_mat * Mwb_tot);
    real_type Lwt_birth = (shared->DT * shared->gamma * (Mwt_tot * (Mwt_tot + (1 - shared->Wb_cyto) * Mwb_tot) / (real_type) (Mwt_tot + Mwb_tot) + shared->Wb_fF * (1 - shared->Wb_mat) * Mwb_tot));
    real_type Mwt_E1_incub = (1 / (real_type) (shared->delta * shared->eip + 1)) * (O_Mwt_E1);
    real_type Mwt_E2_incub = (1 / (real_type) (shared->delta * shared->eip + 1)) * (O_Mwt_E2);
    real_type Mwt_E3_incub = (1 / (real_type) (shared->delta * shared->eip + 1)) * (O_Mwt_E3);
    real_type Mwt_E4_incub = (1 / (real_type) (shared->delta * shared->eip + 1)) * (O_Mwt_E4);
    real_type O_Mwb_E1 = (shared->DT * (shared->delta_wb + 1 / (real_type) shared->eip)) * (Mwb_E1);
    real_type O_Mwb_E2 = (shared->DT * (shared->delta_wb + 1 / (real_type) shared->eip)) * (Mwb_E2);
    real_type O_Mwb_E3 = (shared->DT * (shared->delta_wb + 1 / (real_type) shared->eip)) * (Mwb_E3);
    real_type O_Mwb_E4 = (shared->DT * (shared->delta_wb + 1 / (real_type) shared->eip)) * (Mwb_E4);
    real_type YEAR = TIME / (real_type) shared->YL;
    real_type Kc = shared->Kc_mean * (1 + shared->Kc_season * dust::math::cos(2 * shared->PI_C * TIME / (real_type) shared->YL));
    real_type Mwb_E1_incub = (1 / (real_type) (shared->delta * shared->eip + 1)) * (O_Mwb_E1);
    real_type Mwb_E2_incub = (1 / (real_type) (shared->delta_wb * shared->eip + 1)) * (O_Mwb_E2);
    real_type Mwb_E3_incub = (1 / (real_type) (shared->delta_wb * shared->eip + 1)) * (O_Mwb_E3);
    real_type Mwb_E4_incub = (1 / (real_type) (shared->delta_wb * shared->eip + 1)) * (O_Mwb_E4);
    for (int i = 1; i <= shared->N_age; ++i) {
      internal.Ntotal_nvS[i - 1] = S[shared->dim_S_1 * 0 + i - 1];
    }
    real_type rel_year = YEAR - shared->EQUILIB_YEARS;
    state_next[6] = Mwt_E1_incub + Mwt_I1 - (shared->DT * shared->delta) * (Mwt_I1);
    state_next[7] = Mwt_E2_incub + Mwt_I2 - (shared->DT * shared->delta) * (Mwt_I2);
    state_next[8] = Mwt_E3_incub + Mwt_I3 - (shared->DT * shared->delta) * (Mwt_I3);
    state_next[9] = Mwt_E4_incub + Mwt_I4 - (shared->DT * shared->delta) * (Mwt_I4);
    real_type YEARS_POST_VACC = YEAR - shared->vacc_child_starttime;
    real_type av_prop_seroneg_at_9 = (YEARS_POST_VACC <= 0 ? 0 : cum_prop_seroneg_at_9 / (real_type) YEARS_POST_VACC / (real_type) shared->YL);
    real_type av_prop_seroneg_at_vca = (YEARS_POST_VACC <= 0 ? 0 : cum_prop_seroneg_at_vca / (real_type) YEARS_POST_VACC / (real_type) shared->YL);
    real_type cov_year = dust::math::floor(YEARS_POST_VACC) + 1;
    real_type cu_time_from_last_dose = (TIME < shared->vacc_cu_rndtime + shared->YL / (real_type) 4 ? (TIME - shared->vacc_cu_rndtime) : (TIME >= shared->vacc_cu_rndtime + shared->YL / (real_type) 4 ? (TIME - shared->vacc_cu_rndtime - shared->YL / (real_type) 4) : 0));
    real_type cum_disc = (YEARS_POST_VACC < 0 ? 0 : 1 / (real_type) (dust::math::pow(shared->disc_fact, YEARS_POST_VACC)));
    real_type cum_disc_vacc = (YEARS_POST_VACC < 0 ? 0 : 1 / (real_type) (dust::math::pow(shared->disc_fact_vacc, YEARS_POST_VACC)));
    for (int i = 1; i <= shared->N_age; ++i) {
      for (int j = 1; j <= 3; ++j) {
        internal.Ntotal[i - 1 + shared->dim_Ntotal_1 * (j - 1)] = S[shared->dim_S_1 * (j - 1) + i - 1] + I1[shared->dim_I1_1 * (j - 1) + i - 1] + I2[shared->dim_I2_1 * (j - 1) + i - 1] + I3[shared->dim_I3_1 * (j - 1) + i - 1] + I4[shared->dim_I4_1 * (j - 1) + i - 1] + R1[shared->dim_R1_1 * (j - 1) + i - 1] + R2[shared->dim_R2_1 * (j - 1) + i - 1] + R3[shared->dim_R3_1 * (j - 1) + i - 1] + R4[shared->dim_R4_1 * (j - 1) + i - 1] + I21[shared->dim_I21_1 * (j - 1) + i - 1] + I31[shared->dim_I31_1 * (j - 1) + i - 1] + I41[shared->dim_I41_1 * (j - 1) + i - 1] + I12[shared->dim_I12_1 * (j - 1) + i - 1] + I32[shared->dim_I32_1 * (j - 1) + i - 1] + I42[shared->dim_I42_1 * (j - 1) + i - 1] + I13[shared->dim_I13_1 * (j - 1) + i - 1] + I23[shared->dim_I23_1 * (j - 1) + i - 1] + I43[shared->dim_I43_1 * (j - 1) + i - 1] + I14[shared->dim_I14_1 * (j - 1) + i - 1] + I24[shared->dim_I24_1 * (j - 1) + i - 1] + I34[shared->dim_I34_1 * (j - 1) + i - 1] + R12[shared->dim_R12_1 * (j - 1) + i - 1] + R13[shared->dim_R13_1 * (j - 1) + i - 1] + R14[shared->dim_R14_1 * (j - 1) + i - 1] + R23[shared->dim_R23_1 * (j - 1) + i - 1] + R24[shared->dim_R24_1 * (j - 1) + i - 1] + R34[shared->dim_R34_1 * (j - 1) + i - 1] + I231[shared->dim_I231_1 * (j - 1) + i - 1] + I241[shared->dim_I241_1 * (j - 1) + i - 1] + I341[shared->dim_I341_1 * (j - 1) + i - 1] + I132[shared->dim_I132_1 * (j - 1) + i - 1] + I142[shared->dim_I142_1 * (j - 1) + i - 1] + I342[shared->dim_I342_1 * (j - 1) + i - 1] + I123[shared->dim_I123_1 * (j - 1) + i - 1] + I143[shared->dim_I143_1 * (j - 1) + i - 1] + I243[shared->dim_I243_1 * (j - 1) + i - 1] + I124[shared->dim_I124_1 * (j - 1) + i - 1] + I134[shared->dim_I134_1 * (j - 1) + i - 1] + I234[shared->dim_I234_1 * (j - 1) + i - 1] + R123[shared->dim_R123_1 * (j - 1) + i - 1] + R124[shared->dim_R124_1 * (j - 1) + i - 1] + R134[shared->dim_R134_1 * (j - 1) + i - 1] + R234[shared->dim_R234_1 * (j - 1) + i - 1] + I2341[shared->dim_I2341_1 * (j - 1) + i - 1] + I1342[shared->dim_I1342_1 * (j - 1) + i - 1] + I1243[shared->dim_I1243_1 * (j - 1) + i - 1] + I1234[shared->dim_I1234_1 * (j - 1) + i - 1] + R1234[shared->dim_R1234_1 * (j - 1) + i - 1];
      }
    }
    for (int i = 1; i <= shared->NYO; ++i) {
      internal.out_update_switch[i - 1] = (YEARS_POST_VACC >= (i - 1) && YEARS_POST_VACC < i ? 1 : 0);
    }
    state_next[16] = Mwb_E1_incub + Mwb_I1 - (shared->DT * shared->delta_wb) * (Mwb_I1);
    state_next[17] = Mwb_E2_incub + Mwb_I2 - (shared->DT * shared->delta_wb) * (Mwb_I2);
    state_next[18] = Mwb_E3_incub + Mwb_I3 - (shared->DT * shared->delta_wb) * (Mwb_I3);
    state_next[19] = Mwb_E4_incub + Mwb_I4 - (shared->DT * shared->delta_wb) * (Mwb_I4);
    real_type year_row = 1 + ((rel_year < 0 ? 0 : (rel_year > shared->max_rel_year ? shared->max_rel_year : dust::math::floor(rel_year))));
    for (int i = 1; i <= shared->N_age; ++i) {
      internal.cur_age_rate[i - 1] = shared->age_rate_d[shared->dim_age_rate_d_1 * (1 + i - 1) + static_cast<int>(year_row) - 1];
    }
    for (int i = 1; i <= 28; ++i) {
      internal.death[i - 1] = shared->age_removal_d[shared->dim_age_removal_d_1 * (1 + i - 1) + static_cast<int>(year_row) - 1];
    }
    {
       int i = 1;
       internal.death[i - 1] = static_cast<real_type>(0.46910000000000002) * internal.death[0] * internal.death[0] + static_cast<real_type>(1.9685999999999999) * internal.death[0];
    }
    real_type gavi_cov = (shared->VaccOn == 0 || YEARS_POST_VACC < 0 || YEARS_POST_VACC > shared->VACC_END_YEAR - shared->VACC_YEAR ? 0 : shared->coverage_d[shared->dim_coverage_d_1 * 1 + static_cast<int>(cov_year) - 1]);
    for (int i = 1; i <= shared->N_age; ++i) {
      internal.life_expec[i - 1] = shared->life_expec_d[shared->dim_life_expec_d_1 * (1 + i - 1) + static_cast<int>(year_row) - 1];
    }
    real_type Nb = shared->births_d[shared->dim_births_d_1 * 1 + static_cast<int>(year_row) - 1];
    for (int i = 1; i <= 4; ++i) {
      for (int j = 1; j <= 2; ++j) {
        internal.nc_cu[i - 1 + shared->dim_nc_cu_1 * (j - 1)] = shared->nc0[shared->dim_nc0_1 * (j - 1) + i - 1] * (1 / (real_type) (dust::math::pow(2, (cu_time_from_last_dose / (real_type) shared->hs[j - 1] + shared->ts[j - 1] / (real_type) shared->hl[j - 1]))) + 1 / (real_type) (dust::math::pow(2, (- cu_time_from_last_dose / (real_type) shared->hl[j - 1] + shared->ts[j - 1] / (real_type) shared->hs[j - 1])))) / (real_type) (1 / (real_type) (dust::math::pow(2, (shared->ts[j - 1] / (real_type) shared->hl[j - 1]))) + 1 / (real_type) (dust::math::pow(2, (- shared->ts[j - 1] / (real_type) shared->hs[j - 1]))));
      }
    }
    real_type NT = odin_sum1<real_type>(internal.Ntotal.data(), 0, shared->dim_Ntotal);
    for (int i = 1; i <= shared->N_age; ++i) {
      internal.Ntotal_all[i - 1] = internal.Ntotal[shared->dim_Ntotal_1 * 0 + i - 1] + internal.Ntotal[shared->dim_Ntotal_1 * 1 + i - 1] + internal.Ntotal[shared->dim_Ntotal_1 * 2 + i - 1];
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      internal.Ntotal_nv[i - 1] = internal.Ntotal[shared->dim_Ntotal_1 * 0 + i - 1];
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      internal.Ntotal_v[i - 1] = internal.Ntotal[shared->dim_Ntotal_1 * 1 + i - 1] + internal.Ntotal[shared->dim_Ntotal_1 * 2 + i - 1];
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      internal.Ntotal_vS[i - 1] = internal.Ntotal[shared->dim_Ntotal_1 * 2 + i - 1];
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      internal.num_cu_vacc_age_neg[i - 1] = (((TIME == shared->vacc_cu_rndtime) && (i >= shared->vacc_cu_minage) && (i <= shared->vacc_cu_maxage) ? (shared->vacc_cu_coverage * shared->vacc_cu_age_weight[i - 1]) : 0)) * internal.Ntotal_nvS[i - 1];
    }
    real_type oldest_cu_age = (shared->vacc_cu_minage <= shared->N_age ? shared->ageb[static_cast<int>(shared->vacc_cu_maxage + 1) - 1] + dust::math::floor(YEAR - shared->vacc_cu_time) : 1000);
    real_type prop_seroneg_at_9 = (S[shared->dim_S_1 * 0 + 9] + S[shared->dim_S_1 * 1 + 9] + S[shared->dim_S_1 * 2 + 9]) / (real_type) (internal.Ntotal[shared->dim_Ntotal_1 * 0 + 9] + internal.Ntotal[shared->dim_Ntotal_1 * 1 + 9] + internal.Ntotal[shared->dim_Ntotal_1 * 2 + 9]);
    real_type prop_seroneg_at_vca = (S[shared->dim_S_1 * 0 + static_cast<int>(shared->vca) + 1 - 1] + S[shared->dim_S_1 * 1 + static_cast<int>(shared->vca) + 1 - 1] + S[shared->dim_S_1 * 2 + static_cast<int>(shared->vca) + 1 - 1]) / (real_type) (internal.Ntotal[shared->dim_Ntotal_1 * 0 + static_cast<int>(shared->vca) + 1 - 1] + internal.Ntotal[shared->dim_Ntotal_1 * 1 + static_cast<int>(shared->vca) + 1 - 1] + internal.Ntotal[shared->dim_Ntotal_1 * 2 + static_cast<int>(shared->vca) + 1 - 1]);
    for (int i = 1; i <= shared->NYO; ++i) {
      state_next[shared->offset_variable_out_prop_seroneg_at_9 + i - 1] = (internal.out_update_switch[i - 1] == 0 ? out_prop_seroneg_at_9[i - 1] : av_prop_seroneg_at_9);
    }
    for (int i = 1; i <= shared->NYO; ++i) {
      state_next[shared->offset_variable_out_prop_seroneg_at_vca + i - 1] = (internal.out_update_switch[i - 1] == 0 ? out_prop_seroneg_at_vca[i - 1] : av_prop_seroneg_at_vca);
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      internal.vacc_ct[i - 1] = (i < static_cast<int>(shared->vca) + 1 ? 100000000 : (i <= 20 ? dust::math::floor(YEAR) - shared->ageb[i - 1] + shared->ageb[static_cast<int>(shared->vca) + 1 - 1] : dust::math::floor(YEAR) - 30 + shared->ageb[static_cast<int>(shared->vca) + 1 - 1]));
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      int j = 1;
      internal.vcu_noncov[i - 1 + shared->dim_vcu_noncov_1 * (j - 1)] = (((TIME == shared->vacc_cu_rndtime) && (i >= shared->vacc_cu_minage) && (i <= shared->vacc_cu_maxage) ? (1 - shared->vacc_cu_coverage * shared->vacc_cu_age_weight[i - 1]) : 1));
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      for (int j = 2; j <= 3; ++j) {
        internal.vcu_noncov[i - 1 + shared->dim_vcu_noncov_1 * (j - 1)] = 1;
      }
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      int j = 1;
      internal.vcu_noncov_S[i - 1 + shared->dim_vcu_noncov_S_1 * (j - 1)] = (((TIME == shared->vacc_cu_rndtime) && (i >= shared->vacc_cu_minage) && (i <= shared->vacc_cu_maxage) ? (1 - shared->vcov_cu_S) * shared->vacc_cu_age_weight[i - 1] : 1));
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      for (int j = 2; j <= 3; ++j) {
        internal.vcu_noncov_S[i - 1 + shared->dim_vcu_noncov_S_1 * (j - 1)] = 1;
      }
    }
    real_type youngest_cu_age = (shared->vacc_cu_minage <= shared->N_age ? shared->ageb[static_cast<int>(shared->vacc_cu_minage + 1) - 1] + dust::math::floor(YEAR - shared->vacc_cu_time) : 1000);
    for (int i = 1; i <= shared->N_age; ++i) {
      internal.agert[i - 1] = internal.cur_age_rate[i - 1] * agerts;
    }
    real_type births = shared->pop_scale * Nb * shared->DT / (real_type) shared->YL;
    for (int i = 1; i <= shared->N_age; ++i) {
      internal.deathrt[i - 1] = internal.death[i - 1] / (real_type) shared->YL * shared->DT;
    }
    real_type FOI1 = shared->DT * Beta_mh * shared->kappa * (Mwt_I1 + Mwb_I1 * shared->Wb_relinf1) / (real_type) NT + shared->extInfRand;
    real_type FOI2 = shared->DT * Beta_mh * shared->kappa * (Mwt_I2 + Mwb_I2 * shared->Wb_relinf2) / (real_type) NT + shared->extInfRand;
    real_type FOI3 = shared->DT * Beta_mh * shared->kappa * (Mwt_I3 + Mwb_I3 * shared->Wb_relinf3) / (real_type) NT + shared->extInfRand;
    real_type FOI4 = shared->DT * Beta_mh * shared->kappa * (Mwt_I4 + Mwb_I4 * shared->Wb_relinf4) / (real_type) NT + shared->extInfRand;
    real_type L_deathrt = shared->DT * shared->sigma * ((1 + dust::math::pow(((Lwt + Lwb) / (real_type) (Kc * NT)), shared->omega)));
    real_type NTnv = odin_sum1<real_type>(internal.Ntotal_nv.data(), 0, shared->dim_Ntotal_nv);
    real_type NTv = odin_sum1<real_type>(internal.Ntotal_v.data(), 0, shared->dim_Ntotal_v);
    real_type NTvS = odin_sum1<real_type>(internal.Ntotal_vS.data(), 0, shared->dim_Ntotal_vS);
    for (int i = 1; i <= shared->N_age; ++i) {
      internal.num_cu_vacc_age[i - 1] = (((TIME == shared->vacc_cu_rndtime) && (i >= shared->vacc_cu_minage) && (i <= shared->vacc_cu_maxage) ? (shared->vacc_cu_coverage * shared->vacc_cu_age_weight[i - 1]) : 0)) * internal.Ntotal_nv[i - 1];
    }
    for (int i = 1; i <= 4; ++i) {
      for (int j = 1; j <= 2; ++j) {
        for (int k = 1; k <= shared->N_age; ++k) {
          internal.RR_dis_cu[i - 1 + shared->dim_RR_dis_cu_1 * (j - 1) + shared->dim_RR_dis_cu_12 * (k - 1)] = ((shared->ageb[k - 1] >= youngest_cu_age) && (shared->ageb[k - 1] <= oldest_cu_age) ? shared->L_dis[shared->dim_L_dis_1 * (j - 1) + i - 1] / (real_type) (1 + dust::math::pow((internal.nc_cu[shared->dim_nc_cu_1 * (j - 1) + i - 1] / (real_type) shared->nc50_dis[shared->dim_nc50_dis_1 * (j - 1) + i - 1] * shared->nc50_age[k - 1]), shared->ws[i - 1])) : 1);
        }
      }
    }
    for (int i = 1; i <= 4; ++i) {
      for (int j = 1; j <= 2; ++j) {
        for (int k = 1; k <= shared->N_age; ++k) {
          internal.RR_sdis_cu[i - 1 + shared->dim_RR_sdis_cu_1 * (j - 1) + shared->dim_RR_sdis_cu_12 * (k - 1)] = ((shared->ageb[k - 1] >= youngest_cu_age) && (shared->ageb[k - 1] <= oldest_cu_age) ? shared->L_sdis[shared->dim_L_sdis_1 * (j - 1) + i - 1] / (real_type) (1 + dust::math::pow((internal.nc_cu[shared->dim_nc_cu_1 * (j - 1) + i - 1] / (real_type) shared->nc50_sdis[shared->dim_nc50_sdis_1 * (j - 1) + i - 1] * shared->nc50_age[k - 1]), shared->ws[i - 1])) : 1);
        }
      }
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      internal.time_from_last_dose_base[i - 1] = ((YEAR >= internal.vacc_ct[i - 1]) && (YEAR < internal.vacc_ct[i - 1] + static_cast<real_type>(0.25)) ? shared->YL * (YEAR - internal.vacc_ct[i - 1]) : (YEAR >= internal.vacc_ct[i - 1] + static_cast<real_type>(0.25) ? shared->YL * (YEAR - internal.vacc_ct[i - 1] - static_cast<real_type>(0.25)) : 0));
    }
    state_next[44] = cum_prop_seroneg_at_9 + ((YEARS_POST_VACC < 0 ? 0 : shared->DT * prop_seroneg_at_9));
    state_next[45] = cum_prop_seroneg_at_vca + ((YEARS_POST_VACC < 0 ? 0 : shared->DT * prop_seroneg_at_vca));
    state_next[20] = NT;
    for (int i = 1; i <= shared->N_age; ++i) {
      state_next[shared->offset_variable_Ntotal_out + i - 1] = internal.Ntotal_all[i - 1];
    }
    state_next[25] = prop_seroneg_at_9;
    state_next[26] = prop_seroneg_at_vca;
    real_type vacc_child_coverage = gavi_cov;
    real_type vacc_child_coverage_S = gavi_cov;
    for (int i = 1; i <= shared->N_age; ++i) {
      internal.FOI1a[i - 1] = shared->FOIas[i - 1] * FOI1;
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      internal.FOI2a[i - 1] = shared->FOIas[i - 1] * FOI2;
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      internal.FOI3a[i - 1] = shared->FOIas[i - 1] * FOI3;
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      internal.FOI4a[i - 1] = shared->FOIas[i - 1] * FOI4;
    }
    real_type NTvE = NTv - NTvS;
    for (int i = 1; i <= shared->N_age; ++i) {
      internal.num_child_vacc_age[i - 1] = (((YEARS_POST_VACC >= 0) && (YEAR < shared->vacc_child_stoptime) && (i == shared->vacc_child_age) ? (vacc_child_coverage) : 0)) * internal.Ntotal_nv[i - 1] * internal.agert[i - 1];
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      internal.num_child_vacc_age_neg[i - 1] = (((YEARS_POST_VACC >= 0) && (YEAR < shared->vacc_child_stoptime) && (i == shared->vacc_child_age) ? (vacc_child_coverage) : 0)) * internal.Ntotal_nvS[i - 1] * internal.agert[i - 1];
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      for (int j = 1; j <= 3; ++j) {
        internal.O_I1[i - 1 + shared->dim_O_I1_1 * (j - 1)] = dust::random::binomial<real_type>(rng_state, (I1[shared->dim_I1_1 * (j - 1) + i - 1]), (shared->nu + internal.deathrt[i - 1]));
      }
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      for (int j = 1; j <= 3; ++j) {
        internal.O_I12[i - 1 + shared->dim_O_I12_1 * (j - 1)] = dust::random::binomial<real_type>(rng_state, (I12[shared->dim_I12_1 * (j - 1) + i - 1]), (shared->nu + internal.deathrt[i - 1]));
      }
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      for (int j = 1; j <= 3; ++j) {
        internal.O_I123[i - 1 + shared->dim_O_I123_1 * (j - 1)] = dust::random::binomial<real_type>(rng_state, (I123[shared->dim_I123_1 * (j - 1) + i - 1]), (shared->nu + internal.deathrt[i - 1]));
      }
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      for (int j = 1; j <= 3; ++j) {
        internal.O_I1234[i - 1 + shared->dim_O_I1234_1 * (j - 1)] = dust::random::binomial<real_type>(rng_state, (I1234[shared->dim_I1234_1 * (j - 1) + i - 1]), (shared->nu + internal.deathrt[i - 1]));
      }
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      for (int j = 1; j <= 3; ++j) {
        internal.O_I124[i - 1 + shared->dim_O_I124_1 * (j - 1)] = dust::random::binomial<real_type>(rng_state, (I124[shared->dim_I124_1 * (j - 1) + i - 1]), (shared->nu + internal.deathrt[i - 1]));
      }
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      for (int j = 1; j <= 3; ++j) {
        internal.O_I1243[i - 1 + shared->dim_O_I1243_1 * (j - 1)] = dust::random::binomial<real_type>(rng_state, (I1243[shared->dim_I1243_1 * (j - 1) + i - 1]), (shared->nu + internal.deathrt[i - 1]));
      }
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      for (int j = 1; j <= 3; ++j) {
        internal.O_I13[i - 1 + shared->dim_O_I13_1 * (j - 1)] = dust::random::binomial<real_type>(rng_state, (I13[shared->dim_I13_1 * (j - 1) + i - 1]), (shared->nu + internal.deathrt[i - 1]));
      }
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      for (int j = 1; j <= 3; ++j) {
        internal.O_I132[i - 1 + shared->dim_O_I132_1 * (j - 1)] = dust::random::binomial<real_type>(rng_state, (I132[shared->dim_I132_1 * (j - 1) + i - 1]), (shared->nu + internal.deathrt[i - 1]));
      }
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      for (int j = 1; j <= 3; ++j) {
        internal.O_I134[i - 1 + shared->dim_O_I134_1 * (j - 1)] = dust::random::binomial<real_type>(rng_state, (I134[shared->dim_I134_1 * (j - 1) + i - 1]), (shared->nu + internal.deathrt[i - 1]));
      }
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      for (int j = 1; j <= 3; ++j) {
        internal.O_I1342[i - 1 + shared->dim_O_I1342_1 * (j - 1)] = dust::random::binomial<real_type>(rng_state, (I1342[shared->dim_I1342_1 * (j - 1) + i - 1]), (shared->nu + internal.deathrt[i - 1]));
      }
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      for (int j = 1; j <= 3; ++j) {
        internal.O_I14[i - 1 + shared->dim_O_I14_1 * (j - 1)] = dust::random::binomial<real_type>(rng_state, (I14[shared->dim_I14_1 * (j - 1) + i - 1]), (shared->nu + internal.deathrt[i - 1]));
      }
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      for (int j = 1; j <= 3; ++j) {
        internal.O_I142[i - 1 + shared->dim_O_I142_1 * (j - 1)] = dust::random::binomial<real_type>(rng_state, (I142[shared->dim_I142_1 * (j - 1) + i - 1]), (shared->nu + internal.deathrt[i - 1]));
      }
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      for (int j = 1; j <= 3; ++j) {
        internal.O_I143[i - 1 + shared->dim_O_I143_1 * (j - 1)] = dust::random::binomial<real_type>(rng_state, (I143[shared->dim_I143_1 * (j - 1) + i - 1]), (shared->nu + internal.deathrt[i - 1]));
      }
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      for (int j = 1; j <= 3; ++j) {
        internal.O_I2[i - 1 + shared->dim_O_I2_1 * (j - 1)] = dust::random::binomial<real_type>(rng_state, (I2[shared->dim_I2_1 * (j - 1) + i - 1]), (shared->nu + internal.deathrt[i - 1]));
      }
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      for (int j = 1; j <= 3; ++j) {
        internal.O_I21[i - 1 + shared->dim_O_I21_1 * (j - 1)] = dust::random::binomial<real_type>(rng_state, (I21[shared->dim_I21_1 * (j - 1) + i - 1]), (shared->nu + internal.deathrt[i - 1]));
      }
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      for (int j = 1; j <= 3; ++j) {
        internal.O_I23[i - 1 + shared->dim_O_I23_1 * (j - 1)] = dust::random::binomial<real_type>(rng_state, (I23[shared->dim_I23_1 * (j - 1) + i - 1]), (shared->nu + internal.deathrt[i - 1]));
      }
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      for (int j = 1; j <= 3; ++j) {
        internal.O_I231[i - 1 + shared->dim_O_I231_1 * (j - 1)] = dust::random::binomial<real_type>(rng_state, (I231[shared->dim_I231_1 * (j - 1) + i - 1]), (shared->nu + internal.deathrt[i - 1]));
      }
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      for (int j = 1; j <= 3; ++j) {
        internal.O_I234[i - 1 + shared->dim_O_I234_1 * (j - 1)] = dust::random::binomial<real_type>(rng_state, (I234[shared->dim_I234_1 * (j - 1) + i - 1]), (shared->nu + internal.deathrt[i - 1]));
      }
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      for (int j = 1; j <= 3; ++j) {
        internal.O_I2341[i - 1 + shared->dim_O_I2341_1 * (j - 1)] = dust::random::binomial<real_type>(rng_state, (I2341[shared->dim_I2341_1 * (j - 1) + i - 1]), (shared->nu + internal.deathrt[i - 1]));
      }
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      for (int j = 1; j <= 3; ++j) {
        internal.O_I24[i - 1 + shared->dim_O_I24_1 * (j - 1)] = dust::random::binomial<real_type>(rng_state, (I24[shared->dim_I24_1 * (j - 1) + i - 1]), (shared->nu + internal.deathrt[i - 1]));
      }
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      for (int j = 1; j <= 3; ++j) {
        internal.O_I241[i - 1 + shared->dim_O_I241_1 * (j - 1)] = dust::random::binomial<real_type>(rng_state, (I241[shared->dim_I241_1 * (j - 1) + i - 1]), (shared->nu + internal.deathrt[i - 1]));
      }
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      for (int j = 1; j <= 3; ++j) {
        internal.O_I243[i - 1 + shared->dim_O_I243_1 * (j - 1)] = dust::random::binomial<real_type>(rng_state, (I243[shared->dim_I243_1 * (j - 1) + i - 1]), (shared->nu + internal.deathrt[i - 1]));
      }
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      for (int j = 1; j <= 3; ++j) {
        internal.O_I3[i - 1 + shared->dim_O_I3_1 * (j - 1)] = dust::random::binomial<real_type>(rng_state, (I3[shared->dim_I3_1 * (j - 1) + i - 1]), (shared->nu + internal.deathrt[i - 1]));
      }
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      for (int j = 1; j <= 3; ++j) {
        internal.O_I31[i - 1 + shared->dim_O_I31_1 * (j - 1)] = dust::random::binomial<real_type>(rng_state, (I31[shared->dim_I31_1 * (j - 1) + i - 1]), (shared->nu + internal.deathrt[i - 1]));
      }
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      for (int j = 1; j <= 3; ++j) {
        internal.O_I32[i - 1 + shared->dim_O_I32_1 * (j - 1)] = dust::random::binomial<real_type>(rng_state, (I32[shared->dim_I32_1 * (j - 1) + i - 1]), (shared->nu + internal.deathrt[i - 1]));
      }
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      for (int j = 1; j <= 3; ++j) {
        internal.O_I34[i - 1 + shared->dim_O_I34_1 * (j - 1)] = dust::random::binomial<real_type>(rng_state, (I34[shared->dim_I34_1 * (j - 1) + i - 1]), (shared->nu + internal.deathrt[i - 1]));
      }
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      for (int j = 1; j <= 3; ++j) {
        internal.O_I341[i - 1 + shared->dim_O_I341_1 * (j - 1)] = dust::random::binomial<real_type>(rng_state, (I341[shared->dim_I341_1 * (j - 1) + i - 1]), (shared->nu + internal.deathrt[i - 1]));
      }
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      for (int j = 1; j <= 3; ++j) {
        internal.O_I342[i - 1 + shared->dim_O_I342_1 * (j - 1)] = dust::random::binomial<real_type>(rng_state, (I342[shared->dim_I342_1 * (j - 1) + i - 1]), (shared->nu + internal.deathrt[i - 1]));
      }
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      for (int j = 1; j <= 3; ++j) {
        internal.O_I4[i - 1 + shared->dim_O_I4_1 * (j - 1)] = dust::random::binomial<real_type>(rng_state, (I4[shared->dim_I4_1 * (j - 1) + i - 1]), (shared->nu + internal.deathrt[i - 1]));
      }
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      for (int j = 1; j <= 3; ++j) {
        internal.O_I41[i - 1 + shared->dim_O_I41_1 * (j - 1)] = dust::random::binomial<real_type>(rng_state, (I41[shared->dim_I41_1 * (j - 1) + i - 1]), (shared->nu + internal.deathrt[i - 1]));
      }
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      for (int j = 1; j <= 3; ++j) {
        internal.O_I42[i - 1 + shared->dim_O_I42_1 * (j - 1)] = dust::random::binomial<real_type>(rng_state, (I42[shared->dim_I42_1 * (j - 1) + i - 1]), (shared->nu + internal.deathrt[i - 1]));
      }
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      for (int j = 1; j <= 3; ++j) {
        internal.O_I43[i - 1 + shared->dim_O_I43_1 * (j - 1)] = dust::random::binomial<real_type>(rng_state, (I43[shared->dim_I43_1 * (j - 1) + i - 1]), (shared->nu + internal.deathrt[i - 1]));
      }
    }
    real_type O_Lwb = (shared->DT * shared->epsilon + L_deathrt) * (Lwb);
    real_type O_Lwt = (shared->DT * shared->epsilon + L_deathrt) * (Lwt);
    for (int i = 1; i <= shared->N_age; ++i) {
      for (int j = 1; j <= 3; ++j) {
        internal.O_R1234[i - 1 + shared->dim_O_R1234_1 * (j - 1)] = dust::random::binomial<real_type>(rng_state, (R1234[shared->dim_R1234_1 * (j - 1) + i - 1]), (internal.deathrt[i - 1]));
      }
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      internal.time_from_last_dose[i - 1] = (internal.time_from_last_dose_base[i - 1] > shared->max_ve_decay_time ? shared->max_ve_decay_time : internal.time_from_last_dose_base[i - 1]);
    }
    state_next[39] = inc_FOI1 + FOI1;
    state_next[40] = inc_FOI2 + FOI2;
    state_next[41] = inc_FOI3 + FOI3;
    state_next[42] = inc_FOI4 + FOI4;
    state_next[22] = NTnv;
    state_next[21] = NTv;
    state_next[23] = NTvS;
    state_next[43] = ((shared->NUM_YEAR_ACCUM * dust::math::floor(YEAR / (real_type) shared->NUM_YEAR_ACCUM) == YEAR ? 0 : tot_inc_FOI)) + FOI1 + FOI2 + FOI3 + FOI4;
    for (int i = 1; i <= shared->N_age_p1; ++i) {
      int j = 1;
      internal.vacc_noncov[i - 1 + shared->dim_vacc_noncov_1 * (j - 1)] = (((YEARS_POST_VACC >= 0) && (YEAR < shared->vacc_child_stoptime) && (i - 1 == shared->vacc_child_age) ? (1 - vacc_child_coverage) : 1));
    }
    for (int i = 1; i <= shared->N_age_p1; ++i) {
      for (int j = 2; j <= 3; ++j) {
        internal.vacc_noncov[i - 1 + shared->dim_vacc_noncov_1 * (j - 1)] = 1;
      }
    }
    real_type vcov_c_S = (shared->vacc_by_serostatus == 0 ? vacc_child_coverage_S : vacc_child_coverage);
    real_type Lwb_mature = (shared->DT * shared->epsilon / (real_type) (shared->DT * shared->epsilon + L_deathrt)) * (O_Lwb);
    real_type Lwt_mature = (shared->DT * shared->epsilon / (real_type) (shared->DT * shared->epsilon + L_deathrt)) * (O_Lwt);
    real_type Mwt_FOI1 = shared->DT * shared->Beta_hm_1 * shared->kappa * infectious1;
    real_type Mwt_FOI2 = shared->DT * shared->Beta_hm_2 * shared->kappa * infectious2;
    real_type Mwt_FOI3 = shared->DT * shared->Beta_hm_3 * shared->kappa * infectious3;
    real_type Mwt_FOI4 = shared->DT * shared->Beta_hm_4 * shared->kappa * infectious4;
    for (int i = 1; i <= 4; ++i) {
      for (int j = 1; j <= 2; ++j) {
        for (int k = 1; k <= shared->N_age; ++k) {
          internal.nc[i - 1 + shared->dim_nc_1 * (j - 1) + shared->dim_nc_12 * (k - 1)] = shared->nc0[shared->dim_nc0_1 * (j - 1) + i - 1] * (1 / (real_type) (dust::math::pow(2, (internal.time_from_last_dose[k - 1] / (real_type) shared->hs[j - 1] + shared->ts[j - 1] / (real_type) shared->hl[j - 1]))) + 1 / (real_type) (dust::math::pow(2, (internal.time_from_last_dose[k - 1] / (real_type) shared->hl[j - 1] + shared->ts[j - 1] / (real_type) shared->hs[j - 1])))) / (real_type) (1 / (real_type) (dust::math::pow(2, (shared->ts[j - 1] / (real_type) shared->hl[j - 1]))) + 1 / (real_type) (dust::math::pow(2, (shared->ts[j - 1] / (real_type) shared->hs[j - 1]))));
        }
      }
    }
    real_type num_child_vacc_sum = (odin_sum1<real_type>(internal.num_child_vacc_age.data(), 0, shared->dim_num_child_vacc_age) + odin_sum1<real_type>(internal.num_cu_vacc_age.data(), 0, shared->dim_num_cu_vacc_age));
    real_type num_child_vacc_sum_neg = (odin_sum1<real_type>(internal.num_child_vacc_age_neg.data(), 0, shared->dim_num_child_vacc_age_neg) + odin_sum1<real_type>(internal.num_cu_vacc_age_neg.data(), 0, shared->dim_num_cu_vacc_age_neg));
    for (int i = 1; i <= shared->N_age; ++i) {
      for (int j = 1; j <= 3; ++j) {
        internal.recov_1[i - 1 + shared->dim_recov_1_1 * (j - 1)] = dust::random::binomial<real_type>(rng_state, (internal.O_I1[shared->dim_O_I1_1 * (j - 1) + i - 1]), (shared->nu / (real_type) (shared->nu + internal.deathrt[i - 1])));
      }
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      for (int j = 1; j <= 3; ++j) {
        internal.recov_12[i - 1 + shared->dim_recov_12_1 * (j - 1)] = dust::random::binomial<real_type>(rng_state, (internal.O_I12[shared->dim_O_I12_1 * (j - 1) + i - 1]), (shared->nu / (real_type) (shared->nu + internal.deathrt[i - 1])));
      }
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      for (int j = 1; j <= 3; ++j) {
        internal.recov_123[i - 1 + shared->dim_recov_123_1 * (j - 1)] = dust::random::binomial<real_type>(rng_state, (internal.O_I123[shared->dim_O_I123_1 * (j - 1) + i - 1]), (shared->nu / (real_type) (shared->nu + internal.deathrt[i - 1])));
      }
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      for (int j = 1; j <= 3; ++j) {
        internal.recov_1234[i - 1 + shared->dim_recov_1234_1 * (j - 1)] = dust::random::binomial<real_type>(rng_state, (internal.O_I1234[shared->dim_O_I1234_1 * (j - 1) + i - 1]), (shared->nu / (real_type) (shared->nu + internal.deathrt[i - 1])));
      }
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      for (int j = 1; j <= 3; ++j) {
        internal.recov_124[i - 1 + shared->dim_recov_124_1 * (j - 1)] = dust::random::binomial<real_type>(rng_state, (internal.O_I124[shared->dim_O_I124_1 * (j - 1) + i - 1]), (shared->nu / (real_type) (shared->nu + internal.deathrt[i - 1])));
      }
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      for (int j = 1; j <= 3; ++j) {
        internal.recov_1243[i - 1 + shared->dim_recov_1243_1 * (j - 1)] = dust::random::binomial<real_type>(rng_state, (internal.O_I1243[shared->dim_O_I1243_1 * (j - 1) + i - 1]), (shared->nu / (real_type) (shared->nu + internal.deathrt[i - 1])));
      }
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      for (int j = 1; j <= 3; ++j) {
        internal.recov_13[i - 1 + shared->dim_recov_13_1 * (j - 1)] = dust::random::binomial<real_type>(rng_state, (internal.O_I13[shared->dim_O_I13_1 * (j - 1) + i - 1]), (shared->nu / (real_type) (shared->nu + internal.deathrt[i - 1])));
      }
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      for (int j = 1; j <= 3; ++j) {
        internal.recov_132[i - 1 + shared->dim_recov_132_1 * (j - 1)] = dust::random::binomial<real_type>(rng_state, (internal.O_I132[shared->dim_O_I132_1 * (j - 1) + i - 1]), (shared->nu / (real_type) (shared->nu + internal.deathrt[i - 1])));
      }
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      for (int j = 1; j <= 3; ++j) {
        internal.recov_134[i - 1 + shared->dim_recov_134_1 * (j - 1)] = dust::random::binomial<real_type>(rng_state, (internal.O_I134[shared->dim_O_I134_1 * (j - 1) + i - 1]), (shared->nu / (real_type) (shared->nu + internal.deathrt[i - 1])));
      }
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      for (int j = 1; j <= 3; ++j) {
        internal.recov_1342[i - 1 + shared->dim_recov_1342_1 * (j - 1)] = dust::random::binomial<real_type>(rng_state, (internal.O_I1342[shared->dim_O_I1342_1 * (j - 1) + i - 1]), (shared->nu / (real_type) (shared->nu + internal.deathrt[i - 1])));
      }
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      for (int j = 1; j <= 3; ++j) {
        internal.recov_14[i - 1 + shared->dim_recov_14_1 * (j - 1)] = dust::random::binomial<real_type>(rng_state, (internal.O_I14[shared->dim_O_I14_1 * (j - 1) + i - 1]), (shared->nu / (real_type) (shared->nu + internal.deathrt[i - 1])));
      }
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      for (int j = 1; j <= 3; ++j) {
        internal.recov_142[i - 1 + shared->dim_recov_142_1 * (j - 1)] = dust::random::binomial<real_type>(rng_state, (internal.O_I142[shared->dim_O_I142_1 * (j - 1) + i - 1]), (shared->nu / (real_type) (shared->nu + internal.deathrt[i - 1])));
      }
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      for (int j = 1; j <= 3; ++j) {
        internal.recov_143[i - 1 + shared->dim_recov_143_1 * (j - 1)] = dust::random::binomial<real_type>(rng_state, (internal.O_I143[shared->dim_O_I143_1 * (j - 1) + i - 1]), (shared->nu / (real_type) (shared->nu + internal.deathrt[i - 1])));
      }
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      for (int j = 1; j <= 3; ++j) {
        internal.recov_2[i - 1 + shared->dim_recov_2_1 * (j - 1)] = dust::random::binomial<real_type>(rng_state, (internal.O_I2[shared->dim_O_I2_1 * (j - 1) + i - 1]), (shared->nu / (real_type) (shared->nu + internal.deathrt[i - 1])));
      }
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      for (int j = 1; j <= 3; ++j) {
        internal.recov_21[i - 1 + shared->dim_recov_21_1 * (j - 1)] = dust::random::binomial<real_type>(rng_state, (internal.O_I21[shared->dim_O_I21_1 * (j - 1) + i - 1]), (shared->nu / (real_type) (shared->nu + internal.deathrt[i - 1])));
      }
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      for (int j = 1; j <= 3; ++j) {
        internal.recov_23[i - 1 + shared->dim_recov_23_1 * (j - 1)] = dust::random::binomial<real_type>(rng_state, (internal.O_I23[shared->dim_O_I23_1 * (j - 1) + i - 1]), (shared->nu / (real_type) (shared->nu + internal.deathrt[i - 1])));
      }
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      for (int j = 1; j <= 3; ++j) {
        internal.recov_231[i - 1 + shared->dim_recov_231_1 * (j - 1)] = dust::random::binomial<real_type>(rng_state, (internal.O_I231[shared->dim_O_I231_1 * (j - 1) + i - 1]), (shared->nu / (real_type) (shared->nu + internal.deathrt[i - 1])));
      }
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      for (int j = 1; j <= 3; ++j) {
        internal.recov_234[i - 1 + shared->dim_recov_234_1 * (j - 1)] = dust::random::binomial<real_type>(rng_state, (internal.O_I234[shared->dim_O_I234_1 * (j - 1) + i - 1]), (shared->nu / (real_type) (shared->nu + internal.deathrt[i - 1])));
      }
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      for (int j = 1; j <= 3; ++j) {
        internal.recov_2341[i - 1 + shared->dim_recov_2341_1 * (j - 1)] = dust::random::binomial<real_type>(rng_state, (internal.O_I2341[shared->dim_O_I2341_1 * (j - 1) + i - 1]), (shared->nu / (real_type) (shared->nu + internal.deathrt[i - 1])));
      }
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      for (int j = 1; j <= 3; ++j) {
        internal.recov_24[i - 1 + shared->dim_recov_24_1 * (j - 1)] = dust::random::binomial<real_type>(rng_state, (internal.O_I24[shared->dim_O_I24_1 * (j - 1) + i - 1]), (shared->nu / (real_type) (shared->nu + internal.deathrt[i - 1])));
      }
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      for (int j = 1; j <= 3; ++j) {
        internal.recov_241[i - 1 + shared->dim_recov_241_1 * (j - 1)] = dust::random::binomial<real_type>(rng_state, (internal.O_I241[shared->dim_O_I241_1 * (j - 1) + i - 1]), (shared->nu / (real_type) (shared->nu + internal.deathrt[i - 1])));
      }
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      for (int j = 1; j <= 3; ++j) {
        internal.recov_243[i - 1 + shared->dim_recov_243_1 * (j - 1)] = dust::random::binomial<real_type>(rng_state, (internal.O_I243[shared->dim_O_I243_1 * (j - 1) + i - 1]), (shared->nu / (real_type) (shared->nu + internal.deathrt[i - 1])));
      }
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      for (int j = 1; j <= 3; ++j) {
        internal.recov_3[i - 1 + shared->dim_recov_3_1 * (j - 1)] = dust::random::binomial<real_type>(rng_state, (internal.O_I3[shared->dim_O_I3_1 * (j - 1) + i - 1]), (shared->nu / (real_type) (shared->nu + internal.deathrt[i - 1])));
      }
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      for (int j = 1; j <= 3; ++j) {
        internal.recov_31[i - 1 + shared->dim_recov_31_1 * (j - 1)] = dust::random::binomial<real_type>(rng_state, (internal.O_I31[shared->dim_O_I31_1 * (j - 1) + i - 1]), (shared->nu / (real_type) (shared->nu + internal.deathrt[i - 1])));
      }
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      for (int j = 1; j <= 3; ++j) {
        internal.recov_32[i - 1 + shared->dim_recov_32_1 * (j - 1)] = dust::random::binomial<real_type>(rng_state, (internal.O_I32[shared->dim_O_I32_1 * (j - 1) + i - 1]), (shared->nu / (real_type) (shared->nu + internal.deathrt[i - 1])));
      }
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      for (int j = 1; j <= 3; ++j) {
        internal.recov_34[i - 1 + shared->dim_recov_34_1 * (j - 1)] = dust::random::binomial<real_type>(rng_state, (internal.O_I34[shared->dim_O_I34_1 * (j - 1) + i - 1]), (shared->nu / (real_type) (shared->nu + internal.deathrt[i - 1])));
      }
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      for (int j = 1; j <= 3; ++j) {
        internal.recov_341[i - 1 + shared->dim_recov_341_1 * (j - 1)] = dust::random::binomial<real_type>(rng_state, (internal.O_I341[shared->dim_O_I341_1 * (j - 1) + i - 1]), (shared->nu / (real_type) (shared->nu + internal.deathrt[i - 1])));
      }
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      for (int j = 1; j <= 3; ++j) {
        internal.recov_342[i - 1 + shared->dim_recov_342_1 * (j - 1)] = dust::random::binomial<real_type>(rng_state, (internal.O_I342[shared->dim_O_I342_1 * (j - 1) + i - 1]), (shared->nu / (real_type) (shared->nu + internal.deathrt[i - 1])));
      }
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      for (int j = 1; j <= 3; ++j) {
        internal.recov_4[i - 1 + shared->dim_recov_4_1 * (j - 1)] = dust::random::binomial<real_type>(rng_state, (internal.O_I4[shared->dim_O_I4_1 * (j - 1) + i - 1]), (shared->nu / (real_type) (shared->nu + internal.deathrt[i - 1])));
      }
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      for (int j = 1; j <= 3; ++j) {
        internal.recov_41[i - 1 + shared->dim_recov_41_1 * (j - 1)] = dust::random::binomial<real_type>(rng_state, (internal.O_I41[shared->dim_O_I41_1 * (j - 1) + i - 1]), (shared->nu / (real_type) (shared->nu + internal.deathrt[i - 1])));
      }
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      for (int j = 1; j <= 3; ++j) {
        internal.recov_42[i - 1 + shared->dim_recov_42_1 * (j - 1)] = dust::random::binomial<real_type>(rng_state, (internal.O_I42[shared->dim_O_I42_1 * (j - 1) + i - 1]), (shared->nu / (real_type) (shared->nu + internal.deathrt[i - 1])));
      }
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      for (int j = 1; j <= 3; ++j) {
        internal.recov_43[i - 1 + shared->dim_recov_43_1 * (j - 1)] = dust::random::binomial<real_type>(rng_state, (internal.O_I43[shared->dim_O_I43_1 * (j - 1) + i - 1]), (shared->nu / (real_type) (shared->nu + internal.deathrt[i - 1])));
      }
    }
    state_next[10] = Lwb_birth + Lwb - O_Lwb;
    state_next[0] = Lwt_birth + Lwt - O_Lwt;
    state_next[24] = NTvE;
    for (int i = 1; i <= shared->N_age; ++i) {
      state_next[47 + i - 1] = internal.time_from_last_dose[i - 1];
    }
    for (int i = 1; i <= shared->N_age_p1; ++i) {
      int j = 1;
      internal.vacc_noncov_S[i - 1 + shared->dim_vacc_noncov_S_1 * (j - 1)] = (((YEARS_POST_VACC >= 0) && (YEAR < shared->vacc_child_stoptime) && (i - 1 == shared->vacc_child_age) ? (1 - vcov_c_S) : 1));
    }
    for (int i = 1; i <= shared->N_age_p1; ++i) {
      for (int j = 2; j <= 3; ++j) {
        internal.vacc_noncov_S[i - 1 + shared->dim_vacc_noncov_S_1 * (j - 1)] = 1;
      }
    }
    for (int i = 2; i <= shared->N_age_p1; ++i) {
      for (int j = 1; j <= 3; ++j) {
        internal.age_R1234[i - 1 + shared->dim_age_R1234_1 * (j - 1)] = dust::random::binomial<real_type>(rng_state, (R1234[shared->dim_R1234_1 * (j - 1) + i - 1 - 1] - internal.O_R1234[shared->dim_O_R1234_1 * (j - 1) + i - 1 - 1] + internal.recov_1234[shared->dim_recov_1234_1 * (j - 1) + i - 1 - 1] + internal.recov_1243[shared->dim_recov_1243_1 * (j - 1) + i - 1 - 1] + internal.recov_1342[shared->dim_recov_1342_1 * (j - 1) + i - 1 - 1] + internal.recov_2341[shared->dim_recov_2341_1 * (j - 1) + i - 1 - 1]), internal.agert[i - 1 - 1]);
      }
    }
    {
       int i = 1;
       for (int j = 1; j <= 3; ++j) {
         internal.age_R1234[i - 1 + shared->dim_age_R1234_1 * (j - 1)] = 0;
       }
    }
    real_type Mwb_FOI1 = shared->Wb_relsusc1 * Mwt_FOI1;
    real_type Mwb_FOI2 = shared->Wb_relsusc2 * Mwt_FOI2;
    real_type Mwb_FOI3 = shared->Wb_relsusc3 * Mwt_FOI3;
    real_type Mwb_FOI4 = shared->Wb_relsusc4 * Mwt_FOI4;
    real_type Mwb_intro = ((TIME >= shared->Wb_introtime * shared->YL) && (TIME < shared->Wb_introtime * shared->YL + shared->Wb_introduration) ? (shared->Wb_introrate) : 0);
    real_type num_child_vacc_sum_pos = num_child_vacc_sum - num_child_vacc_sum_neg;
    real_type O_Mwt_S = (shared->DT * shared->delta + Mwt_FOI1 + Mwt_FOI2 + Mwt_FOI3 + Mwt_FOI4) * (Mwt_S);
    for (int i = 1; i <= 4; ++i) {
      for (int j = 1; j <= 2; ++j) {
        for (int k = 1; k <= shared->N_age; ++k) {
          internal.RR_dis_vc[i - 1 + shared->dim_RR_dis_vc_1 * (j - 1) + shared->dim_RR_dis_vc_12 * (k - 1)] = shared->L_dis[shared->dim_L_dis_1 * (j - 1) + i - 1] / (real_type) (1 + dust::math::pow((internal.nc[shared->dim_nc_12 * (k - 1) + shared->dim_nc_1 * (j - 1) + i - 1] / (real_type) (shared->nc50_dis[shared->dim_nc50_dis_1 * (j - 1) + i - 1] * shared->nc50_age[k - 1])), shared->ws[i - 1]));
        }
      }
    }
    for (int i = 1; i <= 4; ++i) {
      for (int j = 1; j <= 2; ++j) {
        for (int k = 1; k <= shared->N_age; ++k) {
          internal.RR_sdis_vc[i - 1 + shared->dim_RR_sdis_vc_1 * (j - 1) + shared->dim_RR_sdis_vc_12 * (k - 1)] = shared->L_sdis[shared->dim_L_sdis_1 * (j - 1) + i - 1] / (real_type) (1 + dust::math::pow((internal.nc[shared->dim_nc_12 * (k - 1) + shared->dim_nc_1 * (j - 1) + i - 1] / (real_type) (shared->nc50_sdis[shared->dim_nc50_sdis_1 * (j - 1) + i - 1] * shared->nc50_age[k - 1])), shared->ws[i - 1]));
        }
      }
    }
    for (int i = 1; i <= shared->NYO; ++i) {
      state_next[shared->offset_variable_out_disc_nvacc_all_pop + i - 1] = out_disc_nvacc_all_pop[i - 1] + ((internal.out_update_switch[i - 1] == 0 ? 0 : num_child_vacc_sum * cum_disc_vacc));
    }
    for (int i = 1; i <= 4; ++i) {
      for (int j = 1; j <= 2; ++j) {
        for (int k = 1; k <= shared->N_age; ++k) {
          state_next[shared->offset_variable_out_nc + i - 1 + shared->dim_out_nc_1 * (j - 1) + shared->dim_out_nc_12 * (k - 1)] = internal.nc[shared->dim_nc_12 * (k - 1) + shared->dim_nc_1 * (j - 1) + i - 1];
        }
      }
    }
    for (int i = 1; i <= shared->NYO; ++i) {
      state_next[shared->offset_variable_out_nvacc_all_neg + i - 1] = out_nvacc_all_neg[i - 1] + ((internal.out_update_switch[i - 1] == 0 ? 0 : num_child_vacc_sum_neg));
    }
    for (int i = 1; i <= shared->NYO; ++i) {
      state_next[shared->offset_variable_out_nvacc_all_pop + i - 1] = out_nvacc_all_pop[i - 1] + ((internal.out_update_switch[i - 1] == 0 ? 0 : num_child_vacc_sum));
    }
    real_type Mwt_inf1 = (Mwt_FOI1 / (real_type) (shared->DT * shared->delta + Mwt_FOI1 + Mwt_FOI2 + Mwt_FOI3 + Mwt_FOI4)) * (O_Mwt_S);
    for (int i = 2; i <= shared->N_age; ++i) {
      int j = 1;
      internal.nvacc_R1234[i - 1 + shared->dim_nvacc_R1234_1 * (j - 1)] = dust::random::binomial<real_type>(rng_state, internal.age_R1234[shared->dim_age_R1234_1 * (j - 1) + i - 1], internal.vacc_noncov[shared->dim_vacc_noncov_1 * (j - 1) + i - 1]);
    }
    {
       int i = 1;
       int j = 1;
       internal.nvacc_R1234[i - 1 + shared->dim_nvacc_R1234_1 * (j - 1)] = 0;
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      int j = 2;
      internal.nvacc_R1234[i - 1 + shared->dim_nvacc_R1234_1 * (j - 1)] = internal.age_R1234[shared->dim_age_R1234_1 * (j - 1) + i - 1] + internal.age_R1234[shared->dim_age_R1234_1 * 0 + i - 1] - internal.nvacc_R1234[shared->dim_nvacc_R1234_1 * 0 + i - 1];
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      int j = 3;
      internal.nvacc_R1234[i - 1 + shared->dim_nvacc_R1234_1 * (j - 1)] = internal.age_R1234[shared->dim_age_R1234_1 * (j - 1) + i - 1];
    }
    real_type O_Mwb_S = (shared->DT * shared->delta_wb + Mwb_FOI1 + Mwb_FOI2 + Mwb_FOI3 + Mwb_FOI4) * (Mwb_S);
    for (int i = 1; i <= 4; ++i) {
      for (int j = 1; j <= 2; ++j) {
        for (int k = 1; k <= shared->N_age; ++k) {
          internal.RR_dis[i - 1 + shared->dim_RR_dis_1 * (j - 1) + shared->dim_RR_dis_12 * (k - 1)] = (shared->ZeroVE == 1 ? 1 : (shared->DoVEInf ? 1 : internal.RR_dis_vc[shared->dim_RR_dis_vc_12 * (k - 1) + shared->dim_RR_dis_vc_1 * (j - 1) + i - 1] * internal.RR_dis_cu[shared->dim_RR_dis_cu_12 * (k - 1) + shared->dim_RR_dis_cu_1 * (j - 1) + i - 1]));
        }
      }
    }
    for (int i = 1; i <= 4; ++i) {
      for (int j = 1; j <= 2; ++j) {
        for (int k = 1; k <= shared->N_age; ++k) {
          internal.RR_inf[i - 1 + shared->dim_RR_inf_1 * (j - 1) + shared->dim_RR_inf_12 * (k - 1)] = (shared->ZeroVE == 1 ? 1 : (shared->DoVEInf ? internal.RR_dis_vc[shared->dim_RR_dis_vc_12 * (k - 1) + shared->dim_RR_dis_vc_1 * (j - 1) + i - 1] * internal.RR_dis_cu[shared->dim_RR_dis_cu_12 * (k - 1) + shared->dim_RR_dis_cu_1 * (j - 1) + i - 1] : 1));
        }
      }
    }
    state_next[1] = Lwt_mature + Mwt_S - O_Mwt_S;
    for (int i = 1; i <= shared->NYO; ++i) {
      state_next[shared->offset_variable_out_nvacc_all_pos + i - 1] = out_nvacc_all_pos[i - 1] + ((internal.out_update_switch[i - 1] == 0 ? 0 : num_child_vacc_sum_pos));
    }
    real_type Mwb_inf1 = (Mwb_FOI1 / (real_type) (shared->DT * shared->delta_wb + Mwb_FOI1 + Mwb_FOI2 + Mwb_FOI3 + Mwb_FOI4)) * (O_Mwb_S);
    real_type Mwt_inf2 = (Mwt_FOI2 / (real_type) (shared->DT * shared->delta + Mwt_FOI2 + Mwt_FOI3 + Mwt_FOI4)) * (O_Mwt_S - Mwt_inf1);
    for (int i = 1; i <= shared->N_age; ++i) {
      for (int j = 1; j <= 3; ++j) {
        internal.n_R1234[i - 1 + shared->dim_n_R1234_1 * (j - 1)] = internal.nvacc_R1234[shared->dim_nvacc_R1234_1 * (j - 1) + i - 1] + R1234[shared->dim_R1234_1 * (j - 1) + i - 1] - internal.O_R1234[shared->dim_O_R1234_1 * (j - 1) + i - 1] + internal.recov_1234[shared->dim_recov_1234_1 * (j - 1) + i - 1] + internal.recov_1243[shared->dim_recov_1243_1 * (j - 1) + i - 1] + internal.recov_1342[shared->dim_recov_1342_1 * (j - 1) + i - 1] + internal.recov_2341[shared->dim_recov_2341_1 * (j - 1) + i - 1] - internal.age_R1234[shared->dim_age_R1234_1 * (j - 1) + i + 1 - 1];
      }
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      int j = 1;
      internal.rho1[i - 1 + shared->dim_rho1_1 * (j - 1)] = shared->rho_pri;
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      for (int j = 2; j <= 3; ++j) {
        internal.rho1[i - 1 + shared->dim_rho1_1 * (j - 1)] = shared->rho_pri * internal.RR_inf[shared->dim_RR_inf_12 * (i - 1) + shared->dim_RR_inf_1 * 0 + 0];
      }
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      int j = 1;
      internal.rho12[i - 1 + shared->dim_rho12_1 * (j - 1)] = shared->rho_sec;
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      for (int j = 2; j <= 3; ++j) {
        internal.rho12[i - 1 + shared->dim_rho12_1 * (j - 1)] = shared->rho_sec * internal.RR_inf[shared->dim_RR_inf_12 * (i - 1) + shared->dim_RR_inf_1 * 1 + 1];
      }
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      int j = 1;
      internal.rho123[i - 1 + shared->dim_rho123_1 * (j - 1)] = shared->rho_tert;
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      for (int j = 2; j <= 3; ++j) {
        internal.rho123[i - 1 + shared->dim_rho123_1 * (j - 1)] = shared->rho_tert * internal.RR_inf[shared->dim_RR_inf_12 * (i - 1) + shared->dim_RR_inf_1 * 1 + 2];
      }
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      int j = 1;
      internal.rho1234[i - 1 + shared->dim_rho1234_1 * (j - 1)] = shared->rho_quart;
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      for (int j = 2; j <= 3; ++j) {
        internal.rho1234[i - 1 + shared->dim_rho1234_1 * (j - 1)] = shared->rho_quart * internal.RR_inf[shared->dim_RR_inf_12 * (i - 1) + shared->dim_RR_inf_1 * 1 + 3];
      }
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      int j = 1;
      internal.rho124[i - 1 + shared->dim_rho124_1 * (j - 1)] = shared->rho_tert;
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      for (int j = 2; j <= 3; ++j) {
        internal.rho124[i - 1 + shared->dim_rho124_1 * (j - 1)] = shared->rho_tert * internal.RR_inf[shared->dim_RR_inf_12 * (i - 1) + shared->dim_RR_inf_1 * 1 + 3];
      }
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      int j = 1;
      internal.rho1243[i - 1 + shared->dim_rho1243_1 * (j - 1)] = shared->rho_quart;
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      for (int j = 2; j <= 3; ++j) {
        internal.rho1243[i - 1 + shared->dim_rho1243_1 * (j - 1)] = shared->rho_quart * internal.RR_inf[shared->dim_RR_inf_12 * (i - 1) + shared->dim_RR_inf_1 * 1 + 2];
      }
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      int j = 1;
      internal.rho13[i - 1 + shared->dim_rho13_1 * (j - 1)] = shared->rho_sec;
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      for (int j = 2; j <= 3; ++j) {
        internal.rho13[i - 1 + shared->dim_rho13_1 * (j - 1)] = shared->rho_sec * internal.RR_inf[shared->dim_RR_inf_12 * (i - 1) + shared->dim_RR_inf_1 * 1 + 2];
      }
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      int j = 1;
      internal.rho132[i - 1 + shared->dim_rho132_1 * (j - 1)] = shared->rho_tert;
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      for (int j = 2; j <= 3; ++j) {
        internal.rho132[i - 1 + shared->dim_rho132_1 * (j - 1)] = shared->rho_tert * internal.RR_inf[shared->dim_RR_inf_12 * (i - 1) + shared->dim_RR_inf_1 * 1 + 1];
      }
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      int j = 1;
      internal.rho134[i - 1 + shared->dim_rho134_1 * (j - 1)] = shared->rho_tert;
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      for (int j = 2; j <= 3; ++j) {
        internal.rho134[i - 1 + shared->dim_rho134_1 * (j - 1)] = shared->rho_tert * internal.RR_inf[shared->dim_RR_inf_12 * (i - 1) + shared->dim_RR_inf_1 * 1 + 3];
      }
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      int j = 1;
      internal.rho1342[i - 1 + shared->dim_rho1342_1 * (j - 1)] = shared->rho_quart;
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      for (int j = 2; j <= 3; ++j) {
        internal.rho1342[i - 1 + shared->dim_rho1342_1 * (j - 1)] = shared->rho_quart * internal.RR_inf[shared->dim_RR_inf_12 * (i - 1) + shared->dim_RR_inf_1 * 1 + 1];
      }
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      int j = 1;
      internal.rho14[i - 1 + shared->dim_rho14_1 * (j - 1)] = shared->rho_sec;
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      for (int j = 2; j <= 3; ++j) {
        internal.rho14[i - 1 + shared->dim_rho14_1 * (j - 1)] = shared->rho_sec * internal.RR_inf[shared->dim_RR_inf_12 * (i - 1) + shared->dim_RR_inf_1 * 1 + 3];
      }
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      int j = 1;
      internal.rho142[i - 1 + shared->dim_rho142_1 * (j - 1)] = shared->rho_tert;
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      for (int j = 2; j <= 3; ++j) {
        internal.rho142[i - 1 + shared->dim_rho142_1 * (j - 1)] = shared->rho_tert * internal.RR_inf[shared->dim_RR_inf_12 * (i - 1) + shared->dim_RR_inf_1 * 1 + 1];
      }
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      int j = 1;
      internal.rho143[i - 1 + shared->dim_rho143_1 * (j - 1)] = shared->rho_tert;
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      for (int j = 2; j <= 3; ++j) {
        internal.rho143[i - 1 + shared->dim_rho143_1 * (j - 1)] = shared->rho_tert * internal.RR_inf[shared->dim_RR_inf_12 * (i - 1) + shared->dim_RR_inf_1 * 1 + 2];
      }
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      int j = 1;
      internal.rho2[i - 1 + shared->dim_rho2_1 * (j - 1)] = shared->rho_pri;
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      for (int j = 2; j <= 3; ++j) {
        internal.rho2[i - 1 + shared->dim_rho2_1 * (j - 1)] = shared->rho_pri * internal.RR_inf[shared->dim_RR_inf_12 * (i - 1) + shared->dim_RR_inf_1 * 0 + 1];
      }
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      int j = 1;
      internal.rho21[i - 1 + shared->dim_rho21_1 * (j - 1)] = shared->rho_sec;
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      for (int j = 2; j <= 3; ++j) {
        internal.rho21[i - 1 + shared->dim_rho21_1 * (j - 1)] = shared->rho_sec * internal.RR_inf[shared->dim_RR_inf_12 * (i - 1) + shared->dim_RR_inf_1 * 1 + 0];
      }
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      int j = 1;
      internal.rho23[i - 1 + shared->dim_rho23_1 * (j - 1)] = shared->rho_sec;
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      for (int j = 2; j <= 3; ++j) {
        internal.rho23[i - 1 + shared->dim_rho23_1 * (j - 1)] = shared->rho_sec * internal.RR_inf[shared->dim_RR_inf_12 * (i - 1) + shared->dim_RR_inf_1 * 1 + 2];
      }
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      int j = 1;
      internal.rho231[i - 1 + shared->dim_rho231_1 * (j - 1)] = shared->rho_tert;
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      for (int j = 2; j <= 3; ++j) {
        internal.rho231[i - 1 + shared->dim_rho231_1 * (j - 1)] = shared->rho_tert * internal.RR_inf[shared->dim_RR_inf_12 * (i - 1) + shared->dim_RR_inf_1 * 1 + 0];
      }
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      int j = 1;
      internal.rho234[i - 1 + shared->dim_rho234_1 * (j - 1)] = shared->rho_tert;
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      for (int j = 2; j <= 3; ++j) {
        internal.rho234[i - 1 + shared->dim_rho234_1 * (j - 1)] = shared->rho_tert * internal.RR_inf[shared->dim_RR_inf_12 * (i - 1) + shared->dim_RR_inf_1 * 1 + 3];
      }
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      int j = 1;
      internal.rho2341[i - 1 + shared->dim_rho2341_1 * (j - 1)] = shared->rho_quart;
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      for (int j = 2; j <= 3; ++j) {
        internal.rho2341[i - 1 + shared->dim_rho2341_1 * (j - 1)] = shared->rho_quart * internal.RR_inf[shared->dim_RR_inf_12 * (i - 1) + shared->dim_RR_inf_1 * 1 + 0];
      }
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      int j = 1;
      internal.rho24[i - 1 + shared->dim_rho24_1 * (j - 1)] = shared->rho_sec;
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      for (int j = 2; j <= 3; ++j) {
        internal.rho24[i - 1 + shared->dim_rho24_1 * (j - 1)] = shared->rho_sec * internal.RR_inf[shared->dim_RR_inf_12 * (i - 1) + shared->dim_RR_inf_1 * 1 + 3];
      }
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      int j = 1;
      internal.rho241[i - 1 + shared->dim_rho241_1 * (j - 1)] = shared->rho_tert;
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      for (int j = 2; j <= 3; ++j) {
        internal.rho241[i - 1 + shared->dim_rho241_1 * (j - 1)] = shared->rho_tert * internal.RR_inf[shared->dim_RR_inf_12 * (i - 1) + shared->dim_RR_inf_1 * 1 + 0];
      }
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      int j = 1;
      internal.rho243[i - 1 + shared->dim_rho243_1 * (j - 1)] = shared->rho_tert;
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      for (int j = 2; j <= 3; ++j) {
        internal.rho243[i - 1 + shared->dim_rho243_1 * (j - 1)] = shared->rho_tert * internal.RR_inf[shared->dim_RR_inf_12 * (i - 1) + shared->dim_RR_inf_1 * 1 + 2];
      }
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      int j = 1;
      internal.rho3[i - 1 + shared->dim_rho3_1 * (j - 1)] = shared->rho_pri;
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      for (int j = 2; j <= 3; ++j) {
        internal.rho3[i - 1 + shared->dim_rho3_1 * (j - 1)] = shared->rho_pri * internal.RR_inf[shared->dim_RR_inf_12 * (i - 1) + shared->dim_RR_inf_1 * 0 + 2];
      }
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      int j = 1;
      internal.rho31[i - 1 + shared->dim_rho31_1 * (j - 1)] = shared->rho_sec;
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      for (int j = 2; j <= 3; ++j) {
        internal.rho31[i - 1 + shared->dim_rho31_1 * (j - 1)] = shared->rho_sec * internal.RR_inf[shared->dim_RR_inf_12 * (i - 1) + shared->dim_RR_inf_1 * 1 + 0];
      }
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      int j = 1;
      internal.rho32[i - 1 + shared->dim_rho32_1 * (j - 1)] = shared->rho_sec;
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      for (int j = 2; j <= 3; ++j) {
        internal.rho32[i - 1 + shared->dim_rho32_1 * (j - 1)] = shared->rho_sec * internal.RR_inf[shared->dim_RR_inf_12 * (i - 1) + shared->dim_RR_inf_1 * 1 + 1];
      }
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      int j = 1;
      internal.rho34[i - 1 + shared->dim_rho34_1 * (j - 1)] = shared->rho_sec;
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      for (int j = 2; j <= 3; ++j) {
        internal.rho34[i - 1 + shared->dim_rho34_1 * (j - 1)] = shared->rho_sec * internal.RR_inf[shared->dim_RR_inf_12 * (i - 1) + shared->dim_RR_inf_1 * 1 + 3];
      }
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      int j = 1;
      internal.rho341[i - 1 + shared->dim_rho341_1 * (j - 1)] = shared->rho_tert;
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      for (int j = 2; j <= 3; ++j) {
        internal.rho341[i - 1 + shared->dim_rho341_1 * (j - 1)] = shared->rho_tert * internal.RR_inf[shared->dim_RR_inf_12 * (i - 1) + shared->dim_RR_inf_1 * 1 + 0];
      }
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      int j = 1;
      internal.rho342[i - 1 + shared->dim_rho342_1 * (j - 1)] = shared->rho_tert;
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      for (int j = 2; j <= 3; ++j) {
        internal.rho342[i - 1 + shared->dim_rho342_1 * (j - 1)] = shared->rho_tert * internal.RR_inf[shared->dim_RR_inf_12 * (i - 1) + shared->dim_RR_inf_1 * 1 + 1];
      }
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      int j = 1;
      internal.rho4[i - 1 + shared->dim_rho4_1 * (j - 1)] = shared->rho_pri;
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      for (int j = 2; j <= 3; ++j) {
        internal.rho4[i - 1 + shared->dim_rho4_1 * (j - 1)] = shared->rho_pri * internal.RR_inf[shared->dim_RR_inf_12 * (i - 1) + shared->dim_RR_inf_1 * 0 + 3];
      }
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      int j = 1;
      internal.rho41[i - 1 + shared->dim_rho41_1 * (j - 1)] = shared->rho_sec;
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      for (int j = 2; j <= 3; ++j) {
        internal.rho41[i - 1 + shared->dim_rho41_1 * (j - 1)] = shared->rho_sec * internal.RR_inf[shared->dim_RR_inf_12 * (i - 1) + shared->dim_RR_inf_1 * 1 + 0];
      }
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      int j = 1;
      internal.rho42[i - 1 + shared->dim_rho42_1 * (j - 1)] = shared->rho_sec;
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      for (int j = 2; j <= 3; ++j) {
        internal.rho42[i - 1 + shared->dim_rho42_1 * (j - 1)] = shared->rho_sec * internal.RR_inf[shared->dim_RR_inf_12 * (i - 1) + shared->dim_RR_inf_1 * 1 + 1];
      }
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      int j = 1;
      internal.rho43[i - 1 + shared->dim_rho43_1 * (j - 1)] = shared->rho_sec;
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      for (int j = 2; j <= 3; ++j) {
        internal.rho43[i - 1 + shared->dim_rho43_1 * (j - 1)] = shared->rho_sec * internal.RR_inf[shared->dim_RR_inf_12 * (i - 1) + shared->dim_RR_inf_1 * 1 + 2];
      }
    }
    for (int i = 1; i <= 4; ++i) {
      for (int j = 1; j <= 2; ++j) {
        for (int k = 1; k <= shared->N_age; ++k) {
          internal.RR_sdis[i - 1 + shared->dim_RR_sdis_1 * (j - 1) + shared->dim_RR_sdis_12 * (k - 1)] = (shared->ZeroVE == 1 ? 1 : (shared->DoVEInf ? internal.RR_sdis_vc[shared->dim_RR_sdis_vc_12 * (k - 1) + shared->dim_RR_sdis_vc_1 * (j - 1) + i - 1] * internal.RR_sdis_cu[shared->dim_RR_sdis_cu_12 * (k - 1) + shared->dim_RR_sdis_cu_1 * (j - 1) + i - 1] : internal.RR_dis[shared->dim_RR_dis_12 * (k - 1) + shared->dim_RR_dis_1 * (j - 1) + i - 1] * internal.RR_sdis_vc[shared->dim_RR_sdis_vc_12 * (k - 1) + shared->dim_RR_sdis_vc_1 * (j - 1) + i - 1] * internal.RR_sdis_cu[shared->dim_RR_sdis_cu_12 * (k - 1) + shared->dim_RR_sdis_cu_1 * (j - 1) + i - 1]));
        }
      }
    }
    state_next[11] = Lwb_mature + Mwb_intro + Mwb_S - O_Mwb_S;
    state_next[2] = Mwt_inf1 + Mwt_E1 - O_Mwt_E1;
    for (int i = 1; i <= 4; ++i) {
      for (int j = 1; j <= 2; ++j) {
        for (int k = 1; k <= shared->N_age; ++k) {
          state_next[shared->offset_variable_out_RR + i - 1 + shared->dim_out_RR_1 * (j - 1) + shared->dim_out_RR_12 * (k - 1)] = internal.RR_dis[shared->dim_RR_dis_12 * (k - 1) + shared->dim_RR_dis_1 * (j - 1) + i - 1];
        }
      }
    }
    for (int i = 1; i <= shared->NYO; ++i) {
      state_next[shared->offset_variable_VE_seroneg1n + i - 1] = (internal.out_update_switch[i - 1] == 0 || (shared->vca + i - 1) > shared->N_age ? VE_seroneg1n[i - 1] : internal.RR_dis[shared->dim_RR_dis_12 * (static_cast<int>(shared->vca) + i - 1 - 1) + shared->dim_RR_dis_1 * 0 + 0]);
    }
    for (int i = 1; i <= shared->NYO; ++i) {
      state_next[shared->offset_variable_VE_seroneg1p + i - 1] = (internal.out_update_switch[i - 1] == 0 || (shared->vca + i - 1) > shared->N_age ? VE_seroneg1p[i - 1] : internal.RR_dis[shared->dim_RR_dis_12 * (static_cast<int>(shared->vca) + i - 1 - 1) + shared->dim_RR_dis_1 * 1 + 0]);
    }
    real_type Mwb_inf2 = (Mwb_FOI2 / (real_type) (shared->DT * shared->delta_wb + Mwb_FOI2 + Mwb_FOI3 + Mwb_FOI4)) * (O_Mwb_S - Mwb_inf1);
    real_type Mwt_inf3 = (Mwt_FOI3 / (real_type) (shared->DT * shared->delta + Mwt_FOI3 + Mwt_FOI4)) * (O_Mwt_S - Mwt_inf1 - Mwt_inf2);
    for (int i = 1; i <= shared->N_age; ++i) {
      internal.ncu_R1234[i - 1] = dust::random::binomial<real_type>(rng_state, internal.n_R1234[shared->dim_n_R1234_1 * 0 + i - 1], internal.vcu_noncov[shared->dim_vcu_noncov_1 * 0 + i - 1]);
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      for (int j = 1; j <= 3; ++j) {
        internal.O_R1[i - 1 + shared->dim_O_R1_1 * (j - 1)] = dust::random::binomial<real_type>(rng_state, (R1[shared->dim_R1_1 * (j - 1) + i - 1]), (internal.rho12[shared->dim_rho12_1 * (j - 1) + i - 1] * internal.FOI2a[i - 1] + internal.rho13[shared->dim_rho13_1 * (j - 1) + i - 1] * internal.FOI3a[i - 1] + internal.rho14[shared->dim_rho14_1 * (j - 1) + i - 1] * internal.FOI4a[i - 1] + internal.deathrt[i - 1]));
      }
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      for (int j = 1; j <= 3; ++j) {
        internal.O_R12[i - 1 + shared->dim_O_R12_1 * (j - 1)] = dust::random::binomial<real_type>(rng_state, (R12[shared->dim_R12_1 * (j - 1) + i - 1]), (internal.rho123[shared->dim_rho123_1 * (j - 1) + i - 1] * internal.FOI3a[i - 1] + internal.rho124[shared->dim_rho124_1 * (j - 1) + i - 1] * internal.FOI4a[i - 1] + internal.deathrt[i - 1]));
      }
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      for (int j = 1; j <= 3; ++j) {
        internal.O_R123[i - 1 + shared->dim_O_R123_1 * (j - 1)] = dust::random::binomial<real_type>(rng_state, (R123[shared->dim_R123_1 * (j - 1) + i - 1]), (internal.rho1234[shared->dim_rho1234_1 * (j - 1) + i - 1] * internal.FOI4a[i - 1] + internal.deathrt[i - 1]));
      }
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      for (int j = 1; j <= 3; ++j) {
        internal.O_R124[i - 1 + shared->dim_O_R124_1 * (j - 1)] = dust::random::binomial<real_type>(rng_state, (R124[shared->dim_R124_1 * (j - 1) + i - 1]), (internal.rho1243[shared->dim_rho1243_1 * (j - 1) + i - 1] * internal.FOI3a[i - 1] + internal.deathrt[i - 1]));
      }
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      for (int j = 1; j <= 3; ++j) {
        internal.O_R13[i - 1 + shared->dim_O_R13_1 * (j - 1)] = dust::random::binomial<real_type>(rng_state, (R13[shared->dim_R13_1 * (j - 1) + i - 1]), (internal.rho132[shared->dim_rho132_1 * (j - 1) + i - 1] * internal.FOI2a[i - 1] + internal.rho134[shared->dim_rho134_1 * (j - 1) + i - 1] * internal.FOI4a[i - 1] + internal.deathrt[i - 1]));
      }
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      for (int j = 1; j <= 3; ++j) {
        internal.O_R134[i - 1 + shared->dim_O_R134_1 * (j - 1)] = dust::random::binomial<real_type>(rng_state, (R134[shared->dim_R134_1 * (j - 1) + i - 1]), (internal.rho1342[shared->dim_rho1342_1 * (j - 1) + i - 1] * internal.FOI2a[i - 1] + internal.deathrt[i - 1]));
      }
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      for (int j = 1; j <= 3; ++j) {
        internal.O_R14[i - 1 + shared->dim_O_R14_1 * (j - 1)] = dust::random::binomial<real_type>(rng_state, (R14[shared->dim_R14_1 * (j - 1) + i - 1]), (internal.rho142[shared->dim_rho142_1 * (j - 1) + i - 1] * internal.FOI2a[i - 1] + internal.rho143[shared->dim_rho143_1 * (j - 1) + i - 1] * internal.FOI3a[i - 1] + internal.deathrt[i - 1]));
      }
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      for (int j = 1; j <= 3; ++j) {
        internal.O_R2[i - 1 + shared->dim_O_R2_1 * (j - 1)] = dust::random::binomial<real_type>(rng_state, (R2[shared->dim_R2_1 * (j - 1) + i - 1]), (internal.rho21[shared->dim_rho21_1 * (j - 1) + i - 1] * internal.FOI1a[i - 1] + internal.rho23[shared->dim_rho23_1 * (j - 1) + i - 1] * internal.FOI3a[i - 1] + internal.rho24[shared->dim_rho24_1 * (j - 1) + i - 1] * internal.FOI4a[i - 1] + internal.deathrt[i - 1]));
      }
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      for (int j = 1; j <= 3; ++j) {
        internal.O_R23[i - 1 + shared->dim_O_R23_1 * (j - 1)] = dust::random::binomial<real_type>(rng_state, (R23[shared->dim_R23_1 * (j - 1) + i - 1]), (internal.rho231[shared->dim_rho231_1 * (j - 1) + i - 1] * internal.FOI1a[i - 1] + internal.rho234[shared->dim_rho234_1 * (j - 1) + i - 1] * internal.FOI4a[i - 1] + internal.deathrt[i - 1]));
      }
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      for (int j = 1; j <= 3; ++j) {
        internal.O_R234[i - 1 + shared->dim_O_R234_1 * (j - 1)] = dust::random::binomial<real_type>(rng_state, (R234[shared->dim_R234_1 * (j - 1) + i - 1]), (internal.rho2341[shared->dim_rho2341_1 * (j - 1) + i - 1] * internal.FOI1a[i - 1] + internal.deathrt[i - 1]));
      }
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      for (int j = 1; j <= 3; ++j) {
        internal.O_R24[i - 1 + shared->dim_O_R24_1 * (j - 1)] = dust::random::binomial<real_type>(rng_state, (R24[shared->dim_R24_1 * (j - 1) + i - 1]), (internal.rho241[shared->dim_rho241_1 * (j - 1) + i - 1] * internal.FOI1a[i - 1] + internal.rho243[shared->dim_rho243_1 * (j - 1) + i - 1] * internal.FOI3a[i - 1] + internal.deathrt[i - 1]));
      }
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      for (int j = 1; j <= 3; ++j) {
        internal.O_R3[i - 1 + shared->dim_O_R3_1 * (j - 1)] = dust::random::binomial<real_type>(rng_state, (R3[shared->dim_R3_1 * (j - 1) + i - 1]), (internal.rho31[shared->dim_rho31_1 * (j - 1) + i - 1] * internal.FOI1a[i - 1] + internal.rho32[shared->dim_rho32_1 * (j - 1) + i - 1] * internal.FOI2a[i - 1] + internal.rho34[shared->dim_rho34_1 * (j - 1) + i - 1] * internal.FOI4a[i - 1] + internal.deathrt[i - 1]));
      }
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      for (int j = 1; j <= 3; ++j) {
        internal.O_R34[i - 1 + shared->dim_O_R34_1 * (j - 1)] = dust::random::binomial<real_type>(rng_state, (R34[shared->dim_R34_1 * (j - 1) + i - 1]), (internal.rho341[shared->dim_rho341_1 * (j - 1) + i - 1] * internal.FOI1a[i - 1] + internal.rho342[shared->dim_rho342_1 * (j - 1) + i - 1] * internal.FOI2a[i - 1] + internal.deathrt[i - 1]));
      }
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      for (int j = 1; j <= 3; ++j) {
        internal.O_R4[i - 1 + shared->dim_O_R4_1 * (j - 1)] = dust::random::binomial<real_type>(rng_state, (R4[shared->dim_R4_1 * (j - 1) + i - 1]), (internal.rho41[shared->dim_rho41_1 * (j - 1) + i - 1] * internal.FOI1a[i - 1] + internal.rho42[shared->dim_rho42_1 * (j - 1) + i - 1] * internal.FOI2a[i - 1] + internal.rho43[shared->dim_rho43_1 * (j - 1) + i - 1] * internal.FOI3a[i - 1] + internal.deathrt[i - 1]));
      }
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      for (int j = 1; j <= 3; ++j) {
        internal.O_S[i - 1 + shared->dim_O_S_1 * (j - 1)] = dust::random::binomial<real_type>(rng_state, (S[shared->dim_S_1 * (j - 1) + i - 1]), (internal.rho1[shared->dim_rho1_1 * (j - 1) + i - 1] * internal.FOI1a[i - 1] + internal.rho2[shared->dim_rho2_1 * (j - 1) + i - 1] * internal.FOI2a[i - 1] + internal.rho3[shared->dim_rho3_1 * (j - 1) + i - 1] * internal.FOI3a[i - 1] + internal.rho4[shared->dim_rho4_1 * (j - 1) + i - 1] * internal.FOI4a[i - 1] + internal.deathrt[i - 1]));
      }
    }
    state_next[12] = Mwb_inf1 + Mwb_E1 - O_Mwb_E1;
    state_next[3] = Mwt_inf2 + Mwt_E2 - O_Mwt_E2;
    for (int i = 1; i <= shared->N_age; ++i) {
      internal.vw_R1234[i - 1] = dust::random::binomial<real_type>(rng_state, internal.n_R1234[shared->dim_n_R1234_1 * 1 + i - 1], shared->vacc_decay);
    }
    for (int i = 2; i <= shared->N_age_p1; ++i) {
      for (int j = 1; j <= 3; ++j) {
        internal.age_R1[i - 1 + shared->dim_age_R1_1 * (j - 1)] = dust::random::binomial<real_type>(rng_state, (R1[shared->dim_R1_1 * (j - 1) + i - 1 - 1] - internal.O_R1[shared->dim_O_R1_1 * (j - 1) + i - 1 - 1] + internal.recov_1[shared->dim_recov_1_1 * (j - 1) + i - 1 - 1]), internal.agert[i - 1 - 1]);
      }
    }
    {
       int i = 1;
       for (int j = 1; j <= 3; ++j) {
         internal.age_R1[i - 1 + shared->dim_age_R1_1 * (j - 1)] = 0;
       }
    }
    for (int i = 2; i <= shared->N_age_p1; ++i) {
      for (int j = 1; j <= 3; ++j) {
        internal.age_R12[i - 1 + shared->dim_age_R12_1 * (j - 1)] = dust::random::binomial<real_type>(rng_state, (R12[shared->dim_R12_1 * (j - 1) + i - 1 - 1] - internal.O_R12[shared->dim_O_R12_1 * (j - 1) + i - 1 - 1] + internal.recov_12[shared->dim_recov_12_1 * (j - 1) + i - 1 - 1] + internal.recov_21[shared->dim_recov_21_1 * (j - 1) + i - 1 - 1]), internal.agert[i - 1 - 1]);
      }
    }
    {
       int i = 1;
       for (int j = 1; j <= 3; ++j) {
         internal.age_R12[i - 1 + shared->dim_age_R12_1 * (j - 1)] = 0;
       }
    }
    for (int i = 2; i <= shared->N_age_p1; ++i) {
      for (int j = 1; j <= 3; ++j) {
        internal.age_R123[i - 1 + shared->dim_age_R123_1 * (j - 1)] = dust::random::binomial<real_type>(rng_state, (R123[shared->dim_R123_1 * (j - 1) + i - 1 - 1] - internal.O_R123[shared->dim_O_R123_1 * (j - 1) + i - 1 - 1] + internal.recov_123[shared->dim_recov_123_1 * (j - 1) + i - 1 - 1] + internal.recov_132[shared->dim_recov_132_1 * (j - 1) + i - 1 - 1] + internal.recov_231[shared->dim_recov_231_1 * (j - 1) + i - 1 - 1]), internal.agert[i - 1 - 1]);
      }
    }
    {
       int i = 1;
       for (int j = 1; j <= 3; ++j) {
         internal.age_R123[i - 1 + shared->dim_age_R123_1 * (j - 1)] = 0;
       }
    }
    for (int i = 2; i <= shared->N_age_p1; ++i) {
      for (int j = 1; j <= 3; ++j) {
        internal.age_R124[i - 1 + shared->dim_age_R124_1 * (j - 1)] = dust::random::binomial<real_type>(rng_state, (R124[shared->dim_R124_1 * (j - 1) + i - 1 - 1] - internal.O_R124[shared->dim_O_R124_1 * (j - 1) + i - 1 - 1] + internal.recov_124[shared->dim_recov_124_1 * (j - 1) + i - 1 - 1] + internal.recov_142[shared->dim_recov_142_1 * (j - 1) + i - 1 - 1] + internal.recov_241[shared->dim_recov_241_1 * (j - 1) + i - 1 - 1]), internal.agert[i - 1 - 1]);
      }
    }
    {
       int i = 1;
       for (int j = 1; j <= 3; ++j) {
         internal.age_R124[i - 1 + shared->dim_age_R124_1 * (j - 1)] = 0;
       }
    }
    for (int i = 2; i <= shared->N_age_p1; ++i) {
      for (int j = 1; j <= 3; ++j) {
        internal.age_R13[i - 1 + shared->dim_age_R13_1 * (j - 1)] = dust::random::binomial<real_type>(rng_state, (R13[shared->dim_R13_1 * (j - 1) + i - 1 - 1] - internal.O_R13[shared->dim_O_R13_1 * (j - 1) + i - 1 - 1] + internal.recov_13[shared->dim_recov_13_1 * (j - 1) + i - 1 - 1] + internal.recov_31[shared->dim_recov_31_1 * (j - 1) + i - 1 - 1]), internal.agert[i - 1 - 1]);
      }
    }
    {
       int i = 1;
       for (int j = 1; j <= 3; ++j) {
         internal.age_R13[i - 1 + shared->dim_age_R13_1 * (j - 1)] = 0;
       }
    }
    for (int i = 2; i <= shared->N_age_p1; ++i) {
      for (int j = 1; j <= 3; ++j) {
        internal.age_R134[i - 1 + shared->dim_age_R134_1 * (j - 1)] = dust::random::binomial<real_type>(rng_state, (R134[shared->dim_R134_1 * (j - 1) + i - 1 - 1] - internal.O_R134[shared->dim_O_R134_1 * (j - 1) + i - 1 - 1] + internal.recov_134[shared->dim_recov_134_1 * (j - 1) + i - 1 - 1] + internal.recov_143[shared->dim_recov_143_1 * (j - 1) + i - 1 - 1] + internal.recov_341[shared->dim_recov_341_1 * (j - 1) + i - 1 - 1]), internal.agert[i - 1 - 1]);
      }
    }
    {
       int i = 1;
       for (int j = 1; j <= 3; ++j) {
         internal.age_R134[i - 1 + shared->dim_age_R134_1 * (j - 1)] = 0;
       }
    }
    for (int i = 2; i <= shared->N_age_p1; ++i) {
      for (int j = 1; j <= 3; ++j) {
        internal.age_R14[i - 1 + shared->dim_age_R14_1 * (j - 1)] = dust::random::binomial<real_type>(rng_state, (R14[shared->dim_R14_1 * (j - 1) + i - 1 - 1] - internal.O_R14[shared->dim_O_R14_1 * (j - 1) + i - 1 - 1] + internal.recov_14[shared->dim_recov_14_1 * (j - 1) + i - 1 - 1] + internal.recov_41[shared->dim_recov_41_1 * (j - 1) + i - 1 - 1]), internal.agert[i - 1 - 1]);
      }
    }
    {
       int i = 1;
       for (int j = 1; j <= 3; ++j) {
         internal.age_R14[i - 1 + shared->dim_age_R14_1 * (j - 1)] = 0;
       }
    }
    for (int i = 2; i <= shared->N_age_p1; ++i) {
      for (int j = 1; j <= 3; ++j) {
        internal.age_R2[i - 1 + shared->dim_age_R2_1 * (j - 1)] = dust::random::binomial<real_type>(rng_state, (R2[shared->dim_R2_1 * (j - 1) + i - 1 - 1] - internal.O_R2[shared->dim_O_R2_1 * (j - 1) + i - 1 - 1] + internal.recov_2[shared->dim_recov_2_1 * (j - 1) + i - 1 - 1]), internal.agert[i - 1 - 1]);
      }
    }
    {
       int i = 1;
       for (int j = 1; j <= 3; ++j) {
         internal.age_R2[i - 1 + shared->dim_age_R2_1 * (j - 1)] = 0;
       }
    }
    for (int i = 2; i <= shared->N_age_p1; ++i) {
      for (int j = 1; j <= 3; ++j) {
        internal.age_R23[i - 1 + shared->dim_age_R23_1 * (j - 1)] = dust::random::binomial<real_type>(rng_state, (R23[shared->dim_R23_1 * (j - 1) + i - 1 - 1] - internal.O_R23[shared->dim_O_R23_1 * (j - 1) + i - 1 - 1] + internal.recov_23[shared->dim_recov_23_1 * (j - 1) + i - 1 - 1] + internal.recov_32[shared->dim_recov_32_1 * (j - 1) + i - 1 - 1]), internal.agert[i - 1 - 1]);
      }
    }
    {
       int i = 1;
       for (int j = 1; j <= 3; ++j) {
         internal.age_R23[i - 1 + shared->dim_age_R23_1 * (j - 1)] = 0;
       }
    }
    for (int i = 2; i <= shared->N_age_p1; ++i) {
      for (int j = 1; j <= 3; ++j) {
        internal.age_R234[i - 1 + shared->dim_age_R234_1 * (j - 1)] = dust::random::binomial<real_type>(rng_state, (R234[shared->dim_R234_1 * (j - 1) + i - 1 - 1] - internal.O_R234[shared->dim_O_R234_1 * (j - 1) + i - 1 - 1] + internal.recov_234[shared->dim_recov_234_1 * (j - 1) + i - 1 - 1] + internal.recov_243[shared->dim_recov_243_1 * (j - 1) + i - 1 - 1] + internal.recov_342[shared->dim_recov_342_1 * (j - 1) + i - 1 - 1]), internal.agert[i - 1 - 1]);
      }
    }
    {
       int i = 1;
       for (int j = 1; j <= 3; ++j) {
         internal.age_R234[i - 1 + shared->dim_age_R234_1 * (j - 1)] = 0;
       }
    }
    for (int i = 2; i <= shared->N_age_p1; ++i) {
      for (int j = 1; j <= 3; ++j) {
        internal.age_R24[i - 1 + shared->dim_age_R24_1 * (j - 1)] = dust::random::binomial<real_type>(rng_state, (R24[shared->dim_R24_1 * (j - 1) + i - 1 - 1] - internal.O_R24[shared->dim_O_R24_1 * (j - 1) + i - 1 - 1] + internal.recov_24[shared->dim_recov_24_1 * (j - 1) + i - 1 - 1] + internal.recov_42[shared->dim_recov_42_1 * (j - 1) + i - 1 - 1]), internal.agert[i - 1 - 1]);
      }
    }
    {
       int i = 1;
       for (int j = 1; j <= 3; ++j) {
         internal.age_R24[i - 1 + shared->dim_age_R24_1 * (j - 1)] = 0;
       }
    }
    for (int i = 2; i <= shared->N_age_p1; ++i) {
      for (int j = 1; j <= 3; ++j) {
        internal.age_R3[i - 1 + shared->dim_age_R3_1 * (j - 1)] = dust::random::binomial<real_type>(rng_state, (R3[shared->dim_R3_1 * (j - 1) + i - 1 - 1] - internal.O_R3[shared->dim_O_R3_1 * (j - 1) + i - 1 - 1] + internal.recov_3[shared->dim_recov_3_1 * (j - 1) + i - 1 - 1]), internal.agert[i - 1 - 1]);
      }
    }
    {
       int i = 1;
       for (int j = 1; j <= 3; ++j) {
         internal.age_R3[i - 1 + shared->dim_age_R3_1 * (j - 1)] = 0;
       }
    }
    for (int i = 2; i <= shared->N_age_p1; ++i) {
      for (int j = 1; j <= 3; ++j) {
        internal.age_R34[i - 1 + shared->dim_age_R34_1 * (j - 1)] = dust::random::binomial<real_type>(rng_state, (R34[shared->dim_R34_1 * (j - 1) + i - 1 - 1] - internal.O_R34[shared->dim_O_R34_1 * (j - 1) + i - 1 - 1] + internal.recov_34[shared->dim_recov_34_1 * (j - 1) + i - 1 - 1] + internal.recov_43[shared->dim_recov_43_1 * (j - 1) + i - 1 - 1]), internal.agert[i - 1 - 1]);
      }
    }
    {
       int i = 1;
       for (int j = 1; j <= 3; ++j) {
         internal.age_R34[i - 1 + shared->dim_age_R34_1 * (j - 1)] = 0;
       }
    }
    for (int i = 2; i <= shared->N_age_p1; ++i) {
      for (int j = 1; j <= 3; ++j) {
        internal.age_R4[i - 1 + shared->dim_age_R4_1 * (j - 1)] = dust::random::binomial<real_type>(rng_state, (R4[shared->dim_R4_1 * (j - 1) + i - 1 - 1] - internal.O_R4[shared->dim_O_R4_1 * (j - 1) + i - 1 - 1] + internal.recov_4[shared->dim_recov_4_1 * (j - 1) + i - 1 - 1]), internal.agert[i - 1 - 1]);
      }
    }
    {
       int i = 1;
       for (int j = 1; j <= 3; ++j) {
         internal.age_R4[i - 1 + shared->dim_age_R4_1 * (j - 1)] = 0;
       }
    }
    for (int i = 2; i <= shared->N_age_p1; ++i) {
      for (int j = 1; j <= 3; ++j) {
        internal.age_S[i - 1 + shared->dim_age_S_1 * (j - 1)] = dust::random::binomial<real_type>(rng_state, S[shared->dim_S_1 * (j - 1) + i - 1 - 1] - internal.O_S[shared->dim_O_S_1 * (j - 1) + i - 1 - 1], internal.agert[i - 1 - 1]);
      }
    }
    {
       int i = 1;
       int j = 1;
       internal.age_S[i - 1 + shared->dim_age_S_1 * (j - 1)] = dust::random::binomial<real_type>(rng_state, 10000000, births / (real_type) 10000000);
    }
    {
       int i = 1;
       for (int j = 2; j <= 3; ++j) {
         internal.age_S[i - 1 + shared->dim_age_S_1 * (j - 1)] = 0;
       }
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      for (int j = 1; j <= 3; ++j) {
        internal.inf_1[i - 1 + shared->dim_inf_1_1 * (j - 1)] = dust::random::binomial<real_type>(rng_state, (internal.O_S[shared->dim_O_S_1 * (j - 1) + i - 1]), (internal.rho1[shared->dim_rho1_1 * (j - 1) + i - 1] * internal.FOI1a[i - 1] / (real_type) (internal.rho1[shared->dim_rho1_1 * (j - 1) + i - 1] * internal.FOI1a[i - 1] + internal.rho2[shared->dim_rho2_1 * (j - 1) + i - 1] * internal.FOI2a[i - 1] + internal.rho3[shared->dim_rho3_1 * (j - 1) + i - 1] * internal.FOI3a[i - 1] + internal.rho4[shared->dim_rho4_1 * (j - 1) + i - 1] * internal.FOI4a[i - 1] + internal.deathrt[i - 1])));
      }
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      for (int j = 1; j <= 3; ++j) {
        internal.inf_12[i - 1 + shared->dim_inf_12_1 * (j - 1)] = dust::random::binomial<real_type>(rng_state, (internal.O_R1[shared->dim_O_R1_1 * (j - 1) + i - 1]), (internal.rho12[shared->dim_rho12_1 * (j - 1) + i - 1] * internal.FOI2a[i - 1] / (real_type) (internal.rho12[shared->dim_rho12_1 * (j - 1) + i - 1] * internal.FOI2a[i - 1] + internal.rho13[shared->dim_rho13_1 * (j - 1) + i - 1] * internal.FOI3a[i - 1] + internal.rho14[shared->dim_rho14_1 * (j - 1) + i - 1] * internal.FOI4a[i - 1] + internal.deathrt[i - 1])));
      }
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      for (int j = 1; j <= 3; ++j) {
        internal.inf_123[i - 1 + shared->dim_inf_123_1 * (j - 1)] = dust::random::binomial<real_type>(rng_state, (internal.O_R12[shared->dim_O_R12_1 * (j - 1) + i - 1]), (internal.rho123[shared->dim_rho123_1 * (j - 1) + i - 1] * internal.FOI3a[i - 1] / (real_type) (internal.rho123[shared->dim_rho123_1 * (j - 1) + i - 1] * internal.FOI3a[i - 1] + internal.rho124[shared->dim_rho124_1 * (j - 1) + i - 1] * internal.FOI4a[i - 1] + internal.deathrt[i - 1])));
      }
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      for (int j = 1; j <= 3; ++j) {
        internal.inf_1234[i - 1 + shared->dim_inf_1234_1 * (j - 1)] = dust::random::binomial<real_type>(rng_state, (internal.O_R123[shared->dim_O_R123_1 * (j - 1) + i - 1]), (internal.rho1234[shared->dim_rho1234_1 * (j - 1) + i - 1] * internal.FOI4a[i - 1] / (real_type) (internal.rho1234[shared->dim_rho1234_1 * (j - 1) + i - 1] * internal.FOI4a[i - 1] + internal.deathrt[i - 1])));
      }
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      for (int j = 1; j <= 3; ++j) {
        internal.inf_1243[i - 1 + shared->dim_inf_1243_1 * (j - 1)] = dust::random::binomial<real_type>(rng_state, (internal.O_R124[shared->dim_O_R124_1 * (j - 1) + i - 1]), (internal.rho1243[shared->dim_rho1243_1 * (j - 1) + i - 1] * internal.FOI3a[i - 1] / (real_type) (internal.rho1243[shared->dim_rho1243_1 * (j - 1) + i - 1] * internal.FOI3a[i - 1] + internal.deathrt[i - 1])));
      }
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      for (int j = 1; j <= 3; ++j) {
        internal.inf_132[i - 1 + shared->dim_inf_132_1 * (j - 1)] = dust::random::binomial<real_type>(rng_state, (internal.O_R13[shared->dim_O_R13_1 * (j - 1) + i - 1]), (internal.rho132[shared->dim_rho132_1 * (j - 1) + i - 1] * internal.FOI2a[i - 1] / (real_type) (internal.rho132[shared->dim_rho132_1 * (j - 1) + i - 1] * internal.FOI2a[i - 1] + internal.rho134[shared->dim_rho134_1 * (j - 1) + i - 1] * internal.FOI4a[i - 1] + internal.deathrt[i - 1])));
      }
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      for (int j = 1; j <= 3; ++j) {
        internal.inf_1342[i - 1 + shared->dim_inf_1342_1 * (j - 1)] = dust::random::binomial<real_type>(rng_state, (internal.O_R134[shared->dim_O_R134_1 * (j - 1) + i - 1]), (internal.rho1342[shared->dim_rho1342_1 * (j - 1) + i - 1] * internal.FOI2a[i - 1] / (real_type) (internal.rho1342[shared->dim_rho1342_1 * (j - 1) + i - 1] * internal.FOI2a[i - 1] + internal.deathrt[i - 1])));
      }
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      for (int j = 1; j <= 3; ++j) {
        internal.inf_142[i - 1 + shared->dim_inf_142_1 * (j - 1)] = dust::random::binomial<real_type>(rng_state, (internal.O_R14[shared->dim_O_R14_1 * (j - 1) + i - 1]), (internal.rho142[shared->dim_rho142_1 * (j - 1) + i - 1] * internal.FOI2a[i - 1] / (real_type) (internal.rho142[shared->dim_rho142_1 * (j - 1) + i - 1] * internal.FOI2a[i - 1] + internal.rho143[shared->dim_rho143_1 * (j - 1) + i - 1] * internal.FOI3a[i - 1] + internal.deathrt[i - 1])));
      }
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      for (int j = 1; j <= 3; ++j) {
        internal.inf_21[i - 1 + shared->dim_inf_21_1 * (j - 1)] = dust::random::binomial<real_type>(rng_state, (internal.O_R2[shared->dim_O_R2_1 * (j - 1) + i - 1]), (internal.rho21[shared->dim_rho21_1 * (j - 1) + i - 1] * internal.FOI1a[i - 1] / (real_type) (internal.rho21[shared->dim_rho21_1 * (j - 1) + i - 1] * internal.FOI1a[i - 1] + internal.rho23[shared->dim_rho23_1 * (j - 1) + i - 1] * internal.FOI3a[i - 1] + internal.rho24[shared->dim_rho24_1 * (j - 1) + i - 1] * internal.FOI4a[i - 1] + internal.deathrt[i - 1])));
      }
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      for (int j = 1; j <= 3; ++j) {
        internal.inf_231[i - 1 + shared->dim_inf_231_1 * (j - 1)] = dust::random::binomial<real_type>(rng_state, (internal.O_R23[shared->dim_O_R23_1 * (j - 1) + i - 1]), (internal.rho231[shared->dim_rho231_1 * (j - 1) + i - 1] * internal.FOI1a[i - 1] / (real_type) (internal.rho231[shared->dim_rho231_1 * (j - 1) + i - 1] * internal.FOI1a[i - 1] + internal.rho234[shared->dim_rho234_1 * (j - 1) + i - 1] * internal.FOI4a[i - 1] + internal.deathrt[i - 1])));
      }
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      for (int j = 1; j <= 3; ++j) {
        internal.inf_2341[i - 1 + shared->dim_inf_2341_1 * (j - 1)] = dust::random::binomial<real_type>(rng_state, (internal.O_R234[shared->dim_O_R234_1 * (j - 1) + i - 1]), (internal.rho2341[shared->dim_rho2341_1 * (j - 1) + i - 1] * internal.FOI1a[i - 1] / (real_type) (internal.rho2341[shared->dim_rho2341_1 * (j - 1) + i - 1] * internal.FOI1a[i - 1] + internal.deathrt[i - 1])));
      }
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      for (int j = 1; j <= 3; ++j) {
        internal.inf_241[i - 1 + shared->dim_inf_241_1 * (j - 1)] = dust::random::binomial<real_type>(rng_state, (internal.O_R24[shared->dim_O_R24_1 * (j - 1) + i - 1]), (internal.rho241[shared->dim_rho241_1 * (j - 1) + i - 1] * internal.FOI1a[i - 1] / (real_type) (internal.rho241[shared->dim_rho241_1 * (j - 1) + i - 1] * internal.FOI1a[i - 1] + internal.rho243[shared->dim_rho243_1 * (j - 1) + i - 1] * internal.FOI3a[i - 1] + internal.deathrt[i - 1])));
      }
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      for (int j = 1; j <= 3; ++j) {
        internal.inf_31[i - 1 + shared->dim_inf_31_1 * (j - 1)] = dust::random::binomial<real_type>(rng_state, (internal.O_R3[shared->dim_O_R3_1 * (j - 1) + i - 1]), (internal.rho31[shared->dim_rho31_1 * (j - 1) + i - 1] * internal.FOI1a[i - 1] / (real_type) (internal.rho31[shared->dim_rho31_1 * (j - 1) + i - 1] * internal.FOI1a[i - 1] + internal.rho32[shared->dim_rho32_1 * (j - 1) + i - 1] * internal.FOI2a[i - 1] + internal.rho34[shared->dim_rho34_1 * (j - 1) + i - 1] * internal.FOI4a[i - 1] + internal.deathrt[i - 1])));
      }
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      for (int j = 1; j <= 3; ++j) {
        internal.inf_341[i - 1 + shared->dim_inf_341_1 * (j - 1)] = dust::random::binomial<real_type>(rng_state, (internal.O_R34[shared->dim_O_R34_1 * (j - 1) + i - 1]), (internal.rho341[shared->dim_rho341_1 * (j - 1) + i - 1] * internal.FOI1a[i - 1] / (real_type) (internal.rho341[shared->dim_rho341_1 * (j - 1) + i - 1] * internal.FOI1a[i - 1] + internal.rho342[shared->dim_rho342_1 * (j - 1) + i - 1] * internal.FOI2a[i - 1] + internal.deathrt[i - 1])));
      }
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      for (int j = 1; j <= 3; ++j) {
        internal.inf_41[i - 1 + shared->dim_inf_41_1 * (j - 1)] = dust::random::binomial<real_type>(rng_state, (internal.O_R4[shared->dim_O_R4_1 * (j - 1) + i - 1]), (internal.rho41[shared->dim_rho41_1 * (j - 1) + i - 1] * internal.FOI1a[i - 1] / (real_type) (internal.rho41[shared->dim_rho41_1 * (j - 1) + i - 1] * internal.FOI1a[i - 1] + internal.rho42[shared->dim_rho42_1 * (j - 1) + i - 1] * internal.FOI2a[i - 1] + internal.rho43[shared->dim_rho43_1 * (j - 1) + i - 1] * internal.FOI3a[i - 1] + internal.deathrt[i - 1])));
      }
    }
    real_type Mwb_inf3 = (Mwb_FOI3 / (real_type) (shared->DT * shared->delta_wb + Mwb_FOI3 + Mwb_FOI4)) * (O_Mwb_S - Mwb_inf1 - Mwb_inf2);
    real_type Mwt_inf4 = (Mwt_FOI4 / (real_type) (shared->DT * shared->delta + Mwt_FOI4)) * (O_Mwt_S - Mwt_inf1 - Mwt_inf2 - Mwt_inf3);
    state_next[13] = Mwb_inf2 + Mwb_E2 - O_Mwb_E2;
    state_next[4] = Mwt_inf3 + Mwt_E3 - O_Mwt_E3;
    for (int i = 1; i <= shared->N_age; ++i) {
      int j = 1;
      state_next[shared->offset_variable_R1234 + i - 1 + shared->dim_R1234_1 * (j - 1)] = internal.ncu_R1234[i - 1];
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      int j = 2;
      state_next[shared->offset_variable_R1234 + i - 1 + shared->dim_R1234_1 * (j - 1)] = internal.n_R1234[shared->dim_n_R1234_1 * (j - 1) + i - 1] + internal.n_R1234[shared->dim_n_R1234_1 * 0 + i - 1] - internal.ncu_R1234[i - 1] - internal.vw_R1234[i - 1];
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      int j = 3;
      state_next[shared->offset_variable_R1234 + i - 1 + shared->dim_R1234_1 * (j - 1)] = internal.n_R1234[shared->dim_n_R1234_1 * (j - 1) + i - 1] + internal.vw_R1234[i - 1];
    }
    for (int i = 2; i <= shared->N_age_p1; ++i) {
      for (int j = 1; j <= 3; ++j) {
        internal.age_I12[i - 1 + shared->dim_age_I12_1 * (j - 1)] = dust::random::binomial<real_type>(rng_state, (I12[shared->dim_I12_1 * (j - 1) + i - 1 - 1] - internal.O_I12[shared->dim_O_I12_1 * (j - 1) + i - 1 - 1] + internal.inf_12[shared->dim_inf_12_1 * (j - 1) + i - 1 - 1]), internal.agert[i - 1 - 1]);
      }
    }
    {
       int i = 1;
       for (int j = 1; j <= 3; ++j) {
         internal.age_I12[i - 1 + shared->dim_age_I12_1 * (j - 1)] = 0;
       }
    }
    for (int i = 2; i <= shared->N_age_p1; ++i) {
      for (int j = 1; j <= 3; ++j) {
        internal.age_I123[i - 1 + shared->dim_age_I123_1 * (j - 1)] = dust::random::binomial<real_type>(rng_state, (I123[shared->dim_I123_1 * (j - 1) + i - 1 - 1] - internal.O_I123[shared->dim_O_I123_1 * (j - 1) + i - 1 - 1] + internal.inf_123[shared->dim_inf_123_1 * (j - 1) + i - 1 - 1]), internal.agert[i - 1 - 1]);
      }
    }
    {
       int i = 1;
       for (int j = 1; j <= 3; ++j) {
         internal.age_I123[i - 1 + shared->dim_age_I123_1 * (j - 1)] = 0;
       }
    }
    for (int i = 2; i <= shared->N_age_p1; ++i) {
      for (int j = 1; j <= 3; ++j) {
        internal.age_I1234[i - 1 + shared->dim_age_I1234_1 * (j - 1)] = dust::random::binomial<real_type>(rng_state, (I1234[shared->dim_I1234_1 * (j - 1) + i - 1 - 1] - internal.O_I1234[shared->dim_O_I1234_1 * (j - 1) + i - 1 - 1] + internal.inf_1234[shared->dim_inf_1234_1 * (j - 1) + i - 1 - 1]), internal.agert[i - 1 - 1]);
      }
    }
    {
       int i = 1;
       for (int j = 1; j <= 3; ++j) {
         internal.age_I1234[i - 1 + shared->dim_age_I1234_1 * (j - 1)] = 0;
       }
    }
    for (int i = 2; i <= shared->N_age_p1; ++i) {
      for (int j = 1; j <= 3; ++j) {
        internal.age_I1243[i - 1 + shared->dim_age_I1243_1 * (j - 1)] = dust::random::binomial<real_type>(rng_state, (I1243[shared->dim_I1243_1 * (j - 1) + i - 1 - 1] - internal.O_I1243[shared->dim_O_I1243_1 * (j - 1) + i - 1 - 1] + internal.inf_1243[shared->dim_inf_1243_1 * (j - 1) + i - 1 - 1]), internal.agert[i - 1 - 1]);
      }
    }
    {
       int i = 1;
       for (int j = 1; j <= 3; ++j) {
         internal.age_I1243[i - 1 + shared->dim_age_I1243_1 * (j - 1)] = 0;
       }
    }
    for (int i = 2; i <= shared->N_age_p1; ++i) {
      for (int j = 1; j <= 3; ++j) {
        internal.age_I132[i - 1 + shared->dim_age_I132_1 * (j - 1)] = dust::random::binomial<real_type>(rng_state, (I132[shared->dim_I132_1 * (j - 1) + i - 1 - 1] - internal.O_I132[shared->dim_O_I132_1 * (j - 1) + i - 1 - 1] + internal.inf_132[shared->dim_inf_132_1 * (j - 1) + i - 1 - 1]), internal.agert[i - 1 - 1]);
      }
    }
    {
       int i = 1;
       for (int j = 1; j <= 3; ++j) {
         internal.age_I132[i - 1 + shared->dim_age_I132_1 * (j - 1)] = 0;
       }
    }
    for (int i = 2; i <= shared->N_age_p1; ++i) {
      for (int j = 1; j <= 3; ++j) {
        internal.age_I1342[i - 1 + shared->dim_age_I1342_1 * (j - 1)] = dust::random::binomial<real_type>(rng_state, (I1342[shared->dim_I1342_1 * (j - 1) + i - 1 - 1] - internal.O_I1342[shared->dim_O_I1342_1 * (j - 1) + i - 1 - 1] + internal.inf_1342[shared->dim_inf_1342_1 * (j - 1) + i - 1 - 1]), internal.agert[i - 1 - 1]);
      }
    }
    {
       int i = 1;
       for (int j = 1; j <= 3; ++j) {
         internal.age_I1342[i - 1 + shared->dim_age_I1342_1 * (j - 1)] = 0;
       }
    }
    for (int i = 2; i <= shared->N_age_p1; ++i) {
      for (int j = 1; j <= 3; ++j) {
        internal.age_I142[i - 1 + shared->dim_age_I142_1 * (j - 1)] = dust::random::binomial<real_type>(rng_state, (I142[shared->dim_I142_1 * (j - 1) + i - 1 - 1] - internal.O_I142[shared->dim_O_I142_1 * (j - 1) + i - 1 - 1] + internal.inf_142[shared->dim_inf_142_1 * (j - 1) + i - 1 - 1]), internal.agert[i - 1 - 1]);
      }
    }
    {
       int i = 1;
       for (int j = 1; j <= 3; ++j) {
         internal.age_I142[i - 1 + shared->dim_age_I142_1 * (j - 1)] = 0;
       }
    }
    for (int i = 2; i <= shared->N_age_p1; ++i) {
      for (int j = 1; j <= 3; ++j) {
        internal.age_I21[i - 1 + shared->dim_age_I21_1 * (j - 1)] = dust::random::binomial<real_type>(rng_state, (I21[shared->dim_I21_1 * (j - 1) + i - 1 - 1] - internal.O_I21[shared->dim_O_I21_1 * (j - 1) + i - 1 - 1] + internal.inf_21[shared->dim_inf_21_1 * (j - 1) + i - 1 - 1]), internal.agert[i - 1 - 1]);
      }
    }
    {
       int i = 1;
       for (int j = 1; j <= 3; ++j) {
         internal.age_I21[i - 1 + shared->dim_age_I21_1 * (j - 1)] = 0;
       }
    }
    for (int i = 2; i <= shared->N_age_p1; ++i) {
      for (int j = 1; j <= 3; ++j) {
        internal.age_I231[i - 1 + shared->dim_age_I231_1 * (j - 1)] = dust::random::binomial<real_type>(rng_state, (I231[shared->dim_I231_1 * (j - 1) + i - 1 - 1] - internal.O_I231[shared->dim_O_I231_1 * (j - 1) + i - 1 - 1] + internal.inf_231[shared->dim_inf_231_1 * (j - 1) + i - 1 - 1]), internal.agert[i - 1 - 1]);
      }
    }
    {
       int i = 1;
       for (int j = 1; j <= 3; ++j) {
         internal.age_I231[i - 1 + shared->dim_age_I231_1 * (j - 1)] = 0;
       }
    }
    for (int i = 2; i <= shared->N_age_p1; ++i) {
      for (int j = 1; j <= 3; ++j) {
        internal.age_I2341[i - 1 + shared->dim_age_I2341_1 * (j - 1)] = dust::random::binomial<real_type>(rng_state, (I2341[shared->dim_I2341_1 * (j - 1) + i - 1 - 1] - internal.O_I2341[shared->dim_O_I2341_1 * (j - 1) + i - 1 - 1] + internal.inf_2341[shared->dim_inf_2341_1 * (j - 1) + i - 1 - 1]), internal.agert[i - 1 - 1]);
      }
    }
    {
       int i = 1;
       for (int j = 1; j <= 3; ++j) {
         internal.age_I2341[i - 1 + shared->dim_age_I2341_1 * (j - 1)] = 0;
       }
    }
    for (int i = 2; i <= shared->N_age_p1; ++i) {
      for (int j = 1; j <= 3; ++j) {
        internal.age_I241[i - 1 + shared->dim_age_I241_1 * (j - 1)] = dust::random::binomial<real_type>(rng_state, (I241[shared->dim_I241_1 * (j - 1) + i - 1 - 1] - internal.O_I241[shared->dim_O_I241_1 * (j - 1) + i - 1 - 1] + internal.inf_241[shared->dim_inf_241_1 * (j - 1) + i - 1 - 1]), internal.agert[i - 1 - 1]);
      }
    }
    {
       int i = 1;
       for (int j = 1; j <= 3; ++j) {
         internal.age_I241[i - 1 + shared->dim_age_I241_1 * (j - 1)] = 0;
       }
    }
    for (int i = 2; i <= shared->N_age_p1; ++i) {
      for (int j = 1; j <= 3; ++j) {
        internal.age_I31[i - 1 + shared->dim_age_I31_1 * (j - 1)] = dust::random::binomial<real_type>(rng_state, (I31[shared->dim_I31_1 * (j - 1) + i - 1 - 1] - internal.O_I31[shared->dim_O_I31_1 * (j - 1) + i - 1 - 1] + internal.inf_31[shared->dim_inf_31_1 * (j - 1) + i - 1 - 1]), internal.agert[i - 1 - 1]);
      }
    }
    {
       int i = 1;
       for (int j = 1; j <= 3; ++j) {
         internal.age_I31[i - 1 + shared->dim_age_I31_1 * (j - 1)] = 0;
       }
    }
    for (int i = 2; i <= shared->N_age_p1; ++i) {
      for (int j = 1; j <= 3; ++j) {
        internal.age_I341[i - 1 + shared->dim_age_I341_1 * (j - 1)] = dust::random::binomial<real_type>(rng_state, (I341[shared->dim_I341_1 * (j - 1) + i - 1 - 1] - internal.O_I341[shared->dim_O_I341_1 * (j - 1) + i - 1 - 1] + internal.inf_341[shared->dim_inf_341_1 * (j - 1) + i - 1 - 1]), internal.agert[i - 1 - 1]);
      }
    }
    {
       int i = 1;
       for (int j = 1; j <= 3; ++j) {
         internal.age_I341[i - 1 + shared->dim_age_I341_1 * (j - 1)] = 0;
       }
    }
    for (int i = 2; i <= shared->N_age_p1; ++i) {
      for (int j = 1; j <= 3; ++j) {
        internal.age_I41[i - 1 + shared->dim_age_I41_1 * (j - 1)] = dust::random::binomial<real_type>(rng_state, (I41[shared->dim_I41_1 * (j - 1) + i - 1 - 1] - internal.O_I41[shared->dim_O_I41_1 * (j - 1) + i - 1 - 1] + internal.inf_41[shared->dim_inf_41_1 * (j - 1) + i - 1 - 1]), internal.agert[i - 1 - 1]);
      }
    }
    {
       int i = 1;
       for (int j = 1; j <= 3; ++j) {
         internal.age_I41[i - 1 + shared->dim_age_I41_1 * (j - 1)] = 0;
       }
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      for (int j = 1; j <= 3; ++j) {
        internal.inf_124[i - 1 + shared->dim_inf_124_1 * (j - 1)] = dust::random::binomial<real_type>(rng_state, (internal.O_R12[shared->dim_O_R12_1 * (j - 1) + i - 1] - internal.inf_123[shared->dim_inf_123_1 * (j - 1) + i - 1]), (internal.rho124[shared->dim_rho124_1 * (j - 1) + i - 1] * internal.FOI4a[i - 1] / (real_type) (internal.rho124[shared->dim_rho124_1 * (j - 1) + i - 1] * internal.FOI4a[i - 1] + internal.deathrt[i - 1])));
      }
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      for (int j = 1; j <= 3; ++j) {
        internal.inf_13[i - 1 + shared->dim_inf_13_1 * (j - 1)] = dust::random::binomial<real_type>(rng_state, (internal.O_R1[shared->dim_O_R1_1 * (j - 1) + i - 1] - internal.inf_12[shared->dim_inf_12_1 * (j - 1) + i - 1]), (internal.rho13[shared->dim_rho13_1 * (j - 1) + i - 1] * internal.FOI3a[i - 1] / (real_type) (internal.rho13[shared->dim_rho13_1 * (j - 1) + i - 1] * internal.FOI3a[i - 1] + internal.rho14[shared->dim_rho14_1 * (j - 1) + i - 1] * internal.FOI4a[i - 1] + internal.deathrt[i - 1])));
      }
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      for (int j = 1; j <= 3; ++j) {
        internal.inf_134[i - 1 + shared->dim_inf_134_1 * (j - 1)] = dust::random::binomial<real_type>(rng_state, (internal.O_R13[shared->dim_O_R13_1 * (j - 1) + i - 1] - internal.inf_132[shared->dim_inf_132_1 * (j - 1) + i - 1]), (internal.rho134[shared->dim_rho134_1 * (j - 1) + i - 1] * internal.FOI4a[i - 1] / (real_type) (internal.rho134[shared->dim_rho134_1 * (j - 1) + i - 1] * internal.FOI4a[i - 1] + internal.deathrt[i - 1])));
      }
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      for (int j = 1; j <= 3; ++j) {
        internal.inf_143[i - 1 + shared->dim_inf_143_1 * (j - 1)] = dust::random::binomial<real_type>(rng_state, (internal.O_R14[shared->dim_O_R14_1 * (j - 1) + i - 1] - internal.inf_142[shared->dim_inf_142_1 * (j - 1) + i - 1]), (internal.rho143[shared->dim_rho143_1 * (j - 1) + i - 1] * internal.FOI3a[i - 1] / (real_type) (internal.rho143[shared->dim_rho143_1 * (j - 1) + i - 1] * internal.FOI3a[i - 1] + internal.deathrt[i - 1])));
      }
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      for (int j = 1; j <= 3; ++j) {
        internal.inf_2[i - 1 + shared->dim_inf_2_1 * (j - 1)] = dust::random::binomial<real_type>(rng_state, (internal.O_S[shared->dim_O_S_1 * (j - 1) + i - 1] - internal.inf_1[shared->dim_inf_1_1 * (j - 1) + i - 1]), (internal.rho2[shared->dim_rho2_1 * (j - 1) + i - 1] * internal.FOI2a[i - 1] / (real_type) (internal.rho2[shared->dim_rho2_1 * (j - 1) + i - 1] * internal.FOI2a[i - 1] + internal.rho3[shared->dim_rho3_1 * (j - 1) + i - 1] * internal.FOI3a[i - 1] + internal.rho4[shared->dim_rho4_1 * (j - 1) + i - 1] * internal.FOI4a[i - 1] + internal.deathrt[i - 1])));
      }
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      for (int j = 1; j <= 3; ++j) {
        internal.inf_23[i - 1 + shared->dim_inf_23_1 * (j - 1)] = dust::random::binomial<real_type>(rng_state, (internal.O_R2[shared->dim_O_R2_1 * (j - 1) + i - 1] - internal.inf_21[shared->dim_inf_21_1 * (j - 1) + i - 1]), (internal.rho23[shared->dim_rho23_1 * (j - 1) + i - 1] * internal.FOI3a[i - 1] / (real_type) (internal.rho23[shared->dim_rho23_1 * (j - 1) + i - 1] * internal.FOI3a[i - 1] + internal.rho24[shared->dim_rho24_1 * (j - 1) + i - 1] * internal.FOI4a[i - 1] + internal.deathrt[i - 1])));
      }
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      for (int j = 1; j <= 3; ++j) {
        internal.inf_234[i - 1 + shared->dim_inf_234_1 * (j - 1)] = dust::random::binomial<real_type>(rng_state, (internal.O_R23[shared->dim_O_R23_1 * (j - 1) + i - 1] - internal.inf_231[shared->dim_inf_231_1 * (j - 1) + i - 1]), (internal.rho234[shared->dim_rho234_1 * (j - 1) + i - 1] * internal.FOI4a[i - 1] / (real_type) (internal.rho234[shared->dim_rho234_1 * (j - 1) + i - 1] * internal.FOI4a[i - 1] + internal.deathrt[i - 1])));
      }
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      for (int j = 1; j <= 3; ++j) {
        internal.inf_243[i - 1 + shared->dim_inf_243_1 * (j - 1)] = dust::random::binomial<real_type>(rng_state, (internal.O_R24[shared->dim_O_R24_1 * (j - 1) + i - 1] - internal.inf_241[shared->dim_inf_241_1 * (j - 1) + i - 1]), (internal.rho243[shared->dim_rho243_1 * (j - 1) + i - 1] * internal.FOI3a[i - 1] / (real_type) (internal.rho243[shared->dim_rho243_1 * (j - 1) + i - 1] * internal.FOI3a[i - 1] + internal.deathrt[i - 1])));
      }
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      for (int j = 1; j <= 3; ++j) {
        internal.inf_32[i - 1 + shared->dim_inf_32_1 * (j - 1)] = dust::random::binomial<real_type>(rng_state, (internal.O_R3[shared->dim_O_R3_1 * (j - 1) + i - 1] - internal.inf_31[shared->dim_inf_31_1 * (j - 1) + i - 1]), (internal.rho32[shared->dim_rho32_1 * (j - 1) + i - 1] * internal.FOI2a[i - 1] / (real_type) (internal.rho32[shared->dim_rho32_1 * (j - 1) + i - 1] * internal.FOI2a[i - 1] + internal.rho34[shared->dim_rho34_1 * (j - 1) + i - 1] * internal.FOI4a[i - 1] + internal.deathrt[i - 1])));
      }
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      for (int j = 1; j <= 3; ++j) {
        internal.inf_342[i - 1 + shared->dim_inf_342_1 * (j - 1)] = dust::random::binomial<real_type>(rng_state, (internal.O_R34[shared->dim_O_R34_1 * (j - 1) + i - 1] - internal.inf_341[shared->dim_inf_341_1 * (j - 1) + i - 1]), (internal.rho342[shared->dim_rho342_1 * (j - 1) + i - 1] * internal.FOI2a[i - 1] / (real_type) (internal.rho342[shared->dim_rho342_1 * (j - 1) + i - 1] * internal.FOI2a[i - 1] + internal.deathrt[i - 1])));
      }
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      for (int j = 1; j <= 3; ++j) {
        internal.inf_42[i - 1 + shared->dim_inf_42_1 * (j - 1)] = dust::random::binomial<real_type>(rng_state, (internal.O_R4[shared->dim_O_R4_1 * (j - 1) + i - 1] - internal.inf_41[shared->dim_inf_41_1 * (j - 1) + i - 1]), (internal.rho42[shared->dim_rho42_1 * (j - 1) + i - 1] * internal.FOI2a[i - 1] / (real_type) (internal.rho42[shared->dim_rho42_1 * (j - 1) + i - 1] * internal.FOI2a[i - 1] + internal.rho43[shared->dim_rho43_1 * (j - 1) + i - 1] * internal.FOI3a[i - 1] + internal.deathrt[i - 1])));
      }
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      int j = 1;
      internal.infV_1[i - 1 + shared->dim_infV_1_1 * (j - 1)] = internal.inf_1[shared->dim_inf_1_1 * (j - 1) + i - 1] + shared->nnveai[j - 1] * internal.inf_1[shared->dim_inf_1_1 * 1 + i - 1];
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      int j = 2;
      internal.infV_1[i - 1 + shared->dim_infV_1_1 * (j - 1)] = shared->nveai[j - 1] * internal.inf_1[shared->dim_inf_1_1 * (j - 1) + i - 1];
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      int j = 3;
      internal.infV_1[i - 1 + shared->dim_infV_1_1 * (j - 1)] = internal.inf_1[shared->dim_inf_1_1 * (j - 1) + i - 1];
    }
    real_type Mwb_inf4 = (Mwb_FOI4 / (real_type) (shared->DT * shared->delta_wb + Mwb_FOI4)) * (O_Mwb_S - Mwb_inf1 - Mwb_inf2 - Mwb_inf3);
    for (int i = 2; i <= shared->N_age; ++i) {
      int j = 1;
      internal.nvacc_R1[i - 1 + shared->dim_nvacc_R1_1 * (j - 1)] = dust::random::binomial<real_type>(rng_state, internal.age_R1[shared->dim_age_R1_1 * (j - 1) + i - 1], internal.vacc_noncov[shared->dim_vacc_noncov_1 * (j - 1) + i - 1]);
    }
    {
       int i = 1;
       int j = 1;
       internal.nvacc_R1[i - 1 + shared->dim_nvacc_R1_1 * (j - 1)] = 0;
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      int j = 2;
      internal.nvacc_R1[i - 1 + shared->dim_nvacc_R1_1 * (j - 1)] = internal.age_R1[shared->dim_age_R1_1 * (j - 1) + i - 1] + internal.age_R1[shared->dim_age_R1_1 * 0 + i - 1] - internal.nvacc_R1[shared->dim_nvacc_R1_1 * 0 + i - 1];
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      int j = 3;
      internal.nvacc_R1[i - 1 + shared->dim_nvacc_R1_1 * (j - 1)] = internal.age_R1[shared->dim_age_R1_1 * (j - 1) + i - 1];
    }
    for (int i = 2; i <= shared->N_age; ++i) {
      int j = 1;
      internal.nvacc_R12[i - 1 + shared->dim_nvacc_R12_1 * (j - 1)] = dust::random::binomial<real_type>(rng_state, internal.age_R12[shared->dim_age_R12_1 * (j - 1) + i - 1], internal.vacc_noncov[shared->dim_vacc_noncov_1 * (j - 1) + i - 1]);
    }
    {
       int i = 1;
       int j = 1;
       internal.nvacc_R12[i - 1 + shared->dim_nvacc_R12_1 * (j - 1)] = 0;
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      int j = 2;
      internal.nvacc_R12[i - 1 + shared->dim_nvacc_R12_1 * (j - 1)] = internal.age_R12[shared->dim_age_R12_1 * (j - 1) + i - 1] + internal.age_R12[shared->dim_age_R12_1 * 0 + i - 1] - internal.nvacc_R12[shared->dim_nvacc_R12_1 * 0 + i - 1];
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      int j = 3;
      internal.nvacc_R12[i - 1 + shared->dim_nvacc_R12_1 * (j - 1)] = internal.age_R12[shared->dim_age_R12_1 * (j - 1) + i - 1];
    }
    for (int i = 2; i <= shared->N_age; ++i) {
      int j = 1;
      internal.nvacc_R123[i - 1 + shared->dim_nvacc_R123_1 * (j - 1)] = dust::random::binomial<real_type>(rng_state, internal.age_R123[shared->dim_age_R123_1 * (j - 1) + i - 1], internal.vacc_noncov[shared->dim_vacc_noncov_1 * (j - 1) + i - 1]);
    }
    {
       int i = 1;
       int j = 1;
       internal.nvacc_R123[i - 1 + shared->dim_nvacc_R123_1 * (j - 1)] = 0;
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      int j = 2;
      internal.nvacc_R123[i - 1 + shared->dim_nvacc_R123_1 * (j - 1)] = internal.age_R123[shared->dim_age_R123_1 * (j - 1) + i - 1] + internal.age_R123[shared->dim_age_R123_1 * 0 + i - 1] - internal.nvacc_R123[shared->dim_nvacc_R123_1 * 0 + i - 1];
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      int j = 3;
      internal.nvacc_R123[i - 1 + shared->dim_nvacc_R123_1 * (j - 1)] = internal.age_R123[shared->dim_age_R123_1 * (j - 1) + i - 1];
    }
    for (int i = 2; i <= shared->N_age; ++i) {
      int j = 1;
      internal.nvacc_R124[i - 1 + shared->dim_nvacc_R124_1 * (j - 1)] = dust::random::binomial<real_type>(rng_state, internal.age_R124[shared->dim_age_R124_1 * (j - 1) + i - 1], internal.vacc_noncov[shared->dim_vacc_noncov_1 * (j - 1) + i - 1]);
    }
    {
       int i = 1;
       int j = 1;
       internal.nvacc_R124[i - 1 + shared->dim_nvacc_R124_1 * (j - 1)] = 0;
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      int j = 2;
      internal.nvacc_R124[i - 1 + shared->dim_nvacc_R124_1 * (j - 1)] = internal.age_R124[shared->dim_age_R124_1 * (j - 1) + i - 1] + internal.age_R124[shared->dim_age_R124_1 * 0 + i - 1] - internal.nvacc_R124[shared->dim_nvacc_R124_1 * 0 + i - 1];
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      int j = 3;
      internal.nvacc_R124[i - 1 + shared->dim_nvacc_R124_1 * (j - 1)] = internal.age_R124[shared->dim_age_R124_1 * (j - 1) + i - 1];
    }
    for (int i = 2; i <= shared->N_age; ++i) {
      int j = 1;
      internal.nvacc_R13[i - 1 + shared->dim_nvacc_R13_1 * (j - 1)] = dust::random::binomial<real_type>(rng_state, internal.age_R13[shared->dim_age_R13_1 * (j - 1) + i - 1], internal.vacc_noncov[shared->dim_vacc_noncov_1 * (j - 1) + i - 1]);
    }
    {
       int i = 1;
       int j = 1;
       internal.nvacc_R13[i - 1 + shared->dim_nvacc_R13_1 * (j - 1)] = 0;
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      int j = 2;
      internal.nvacc_R13[i - 1 + shared->dim_nvacc_R13_1 * (j - 1)] = internal.age_R13[shared->dim_age_R13_1 * (j - 1) + i - 1] + internal.age_R13[shared->dim_age_R13_1 * 0 + i - 1] - internal.nvacc_R13[shared->dim_nvacc_R13_1 * 0 + i - 1];
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      int j = 3;
      internal.nvacc_R13[i - 1 + shared->dim_nvacc_R13_1 * (j - 1)] = internal.age_R13[shared->dim_age_R13_1 * (j - 1) + i - 1];
    }
    for (int i = 2; i <= shared->N_age; ++i) {
      int j = 1;
      internal.nvacc_R134[i - 1 + shared->dim_nvacc_R134_1 * (j - 1)] = dust::random::binomial<real_type>(rng_state, internal.age_R134[shared->dim_age_R134_1 * (j - 1) + i - 1], internal.vacc_noncov[shared->dim_vacc_noncov_1 * (j - 1) + i - 1]);
    }
    {
       int i = 1;
       int j = 1;
       internal.nvacc_R134[i - 1 + shared->dim_nvacc_R134_1 * (j - 1)] = 0;
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      int j = 2;
      internal.nvacc_R134[i - 1 + shared->dim_nvacc_R134_1 * (j - 1)] = internal.age_R134[shared->dim_age_R134_1 * (j - 1) + i - 1] + internal.age_R134[shared->dim_age_R134_1 * 0 + i - 1] - internal.nvacc_R134[shared->dim_nvacc_R134_1 * 0 + i - 1];
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      int j = 3;
      internal.nvacc_R134[i - 1 + shared->dim_nvacc_R134_1 * (j - 1)] = internal.age_R134[shared->dim_age_R134_1 * (j - 1) + i - 1];
    }
    for (int i = 2; i <= shared->N_age; ++i) {
      int j = 1;
      internal.nvacc_R14[i - 1 + shared->dim_nvacc_R14_1 * (j - 1)] = dust::random::binomial<real_type>(rng_state, internal.age_R14[shared->dim_age_R14_1 * (j - 1) + i - 1], internal.vacc_noncov[shared->dim_vacc_noncov_1 * (j - 1) + i - 1]);
    }
    {
       int i = 1;
       int j = 1;
       internal.nvacc_R14[i - 1 + shared->dim_nvacc_R14_1 * (j - 1)] = 0;
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      int j = 2;
      internal.nvacc_R14[i - 1 + shared->dim_nvacc_R14_1 * (j - 1)] = internal.age_R14[shared->dim_age_R14_1 * (j - 1) + i - 1] + internal.age_R14[shared->dim_age_R14_1 * 0 + i - 1] - internal.nvacc_R14[shared->dim_nvacc_R14_1 * 0 + i - 1];
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      int j = 3;
      internal.nvacc_R14[i - 1 + shared->dim_nvacc_R14_1 * (j - 1)] = internal.age_R14[shared->dim_age_R14_1 * (j - 1) + i - 1];
    }
    for (int i = 2; i <= shared->N_age; ++i) {
      int j = 1;
      internal.nvacc_R2[i - 1 + shared->dim_nvacc_R2_1 * (j - 1)] = dust::random::binomial<real_type>(rng_state, internal.age_R2[shared->dim_age_R2_1 * (j - 1) + i - 1], internal.vacc_noncov[shared->dim_vacc_noncov_1 * (j - 1) + i - 1]);
    }
    {
       int i = 1;
       int j = 1;
       internal.nvacc_R2[i - 1 + shared->dim_nvacc_R2_1 * (j - 1)] = 0;
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      int j = 2;
      internal.nvacc_R2[i - 1 + shared->dim_nvacc_R2_1 * (j - 1)] = internal.age_R2[shared->dim_age_R2_1 * (j - 1) + i - 1] + internal.age_R2[shared->dim_age_R2_1 * 0 + i - 1] - internal.nvacc_R2[shared->dim_nvacc_R2_1 * 0 + i - 1];
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      int j = 3;
      internal.nvacc_R2[i - 1 + shared->dim_nvacc_R2_1 * (j - 1)] = internal.age_R2[shared->dim_age_R2_1 * (j - 1) + i - 1];
    }
    for (int i = 2; i <= shared->N_age; ++i) {
      int j = 1;
      internal.nvacc_R23[i - 1 + shared->dim_nvacc_R23_1 * (j - 1)] = dust::random::binomial<real_type>(rng_state, internal.age_R23[shared->dim_age_R23_1 * (j - 1) + i - 1], internal.vacc_noncov[shared->dim_vacc_noncov_1 * (j - 1) + i - 1]);
    }
    {
       int i = 1;
       int j = 1;
       internal.nvacc_R23[i - 1 + shared->dim_nvacc_R23_1 * (j - 1)] = 0;
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      int j = 2;
      internal.nvacc_R23[i - 1 + shared->dim_nvacc_R23_1 * (j - 1)] = internal.age_R23[shared->dim_age_R23_1 * (j - 1) + i - 1] + internal.age_R23[shared->dim_age_R23_1 * 0 + i - 1] - internal.nvacc_R23[shared->dim_nvacc_R23_1 * 0 + i - 1];
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      int j = 3;
      internal.nvacc_R23[i - 1 + shared->dim_nvacc_R23_1 * (j - 1)] = internal.age_R23[shared->dim_age_R23_1 * (j - 1) + i - 1];
    }
    for (int i = 2; i <= shared->N_age; ++i) {
      int j = 1;
      internal.nvacc_R234[i - 1 + shared->dim_nvacc_R234_1 * (j - 1)] = dust::random::binomial<real_type>(rng_state, internal.age_R234[shared->dim_age_R234_1 * (j - 1) + i - 1], internal.vacc_noncov[shared->dim_vacc_noncov_1 * (j - 1) + i - 1]);
    }
    {
       int i = 1;
       int j = 1;
       internal.nvacc_R234[i - 1 + shared->dim_nvacc_R234_1 * (j - 1)] = 0;
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      int j = 2;
      internal.nvacc_R234[i - 1 + shared->dim_nvacc_R234_1 * (j - 1)] = internal.age_R234[shared->dim_age_R234_1 * (j - 1) + i - 1] + internal.age_R234[shared->dim_age_R234_1 * 0 + i - 1] - internal.nvacc_R234[shared->dim_nvacc_R234_1 * 0 + i - 1];
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      int j = 3;
      internal.nvacc_R234[i - 1 + shared->dim_nvacc_R234_1 * (j - 1)] = internal.age_R234[shared->dim_age_R234_1 * (j - 1) + i - 1];
    }
    for (int i = 2; i <= shared->N_age; ++i) {
      int j = 1;
      internal.nvacc_R24[i - 1 + shared->dim_nvacc_R24_1 * (j - 1)] = dust::random::binomial<real_type>(rng_state, internal.age_R24[shared->dim_age_R24_1 * (j - 1) + i - 1], internal.vacc_noncov[shared->dim_vacc_noncov_1 * (j - 1) + i - 1]);
    }
    {
       int i = 1;
       int j = 1;
       internal.nvacc_R24[i - 1 + shared->dim_nvacc_R24_1 * (j - 1)] = 0;
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      int j = 2;
      internal.nvacc_R24[i - 1 + shared->dim_nvacc_R24_1 * (j - 1)] = internal.age_R24[shared->dim_age_R24_1 * (j - 1) + i - 1] + internal.age_R24[shared->dim_age_R24_1 * 0 + i - 1] - internal.nvacc_R24[shared->dim_nvacc_R24_1 * 0 + i - 1];
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      int j = 3;
      internal.nvacc_R24[i - 1 + shared->dim_nvacc_R24_1 * (j - 1)] = internal.age_R24[shared->dim_age_R24_1 * (j - 1) + i - 1];
    }
    for (int i = 2; i <= shared->N_age; ++i) {
      int j = 1;
      internal.nvacc_R3[i - 1 + shared->dim_nvacc_R3_1 * (j - 1)] = dust::random::binomial<real_type>(rng_state, internal.age_R3[shared->dim_age_R3_1 * (j - 1) + i - 1], internal.vacc_noncov[shared->dim_vacc_noncov_1 * (j - 1) + i - 1]);
    }
    {
       int i = 1;
       int j = 1;
       internal.nvacc_R3[i - 1 + shared->dim_nvacc_R3_1 * (j - 1)] = 0;
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      int j = 2;
      internal.nvacc_R3[i - 1 + shared->dim_nvacc_R3_1 * (j - 1)] = internal.age_R3[shared->dim_age_R3_1 * (j - 1) + i - 1] + internal.age_R3[shared->dim_age_R3_1 * 0 + i - 1] - internal.nvacc_R3[shared->dim_nvacc_R3_1 * 0 + i - 1];
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      int j = 3;
      internal.nvacc_R3[i - 1 + shared->dim_nvacc_R3_1 * (j - 1)] = internal.age_R3[shared->dim_age_R3_1 * (j - 1) + i - 1];
    }
    for (int i = 2; i <= shared->N_age; ++i) {
      int j = 1;
      internal.nvacc_R34[i - 1 + shared->dim_nvacc_R34_1 * (j - 1)] = dust::random::binomial<real_type>(rng_state, internal.age_R34[shared->dim_age_R34_1 * (j - 1) + i - 1], internal.vacc_noncov[shared->dim_vacc_noncov_1 * (j - 1) + i - 1]);
    }
    {
       int i = 1;
       int j = 1;
       internal.nvacc_R34[i - 1 + shared->dim_nvacc_R34_1 * (j - 1)] = 0;
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      int j = 2;
      internal.nvacc_R34[i - 1 + shared->dim_nvacc_R34_1 * (j - 1)] = internal.age_R34[shared->dim_age_R34_1 * (j - 1) + i - 1] + internal.age_R34[shared->dim_age_R34_1 * 0 + i - 1] - internal.nvacc_R34[shared->dim_nvacc_R34_1 * 0 + i - 1];
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      int j = 3;
      internal.nvacc_R34[i - 1 + shared->dim_nvacc_R34_1 * (j - 1)] = internal.age_R34[shared->dim_age_R34_1 * (j - 1) + i - 1];
    }
    for (int i = 2; i <= shared->N_age; ++i) {
      int j = 1;
      internal.nvacc_R4[i - 1 + shared->dim_nvacc_R4_1 * (j - 1)] = dust::random::binomial<real_type>(rng_state, internal.age_R4[shared->dim_age_R4_1 * (j - 1) + i - 1], internal.vacc_noncov[shared->dim_vacc_noncov_1 * (j - 1) + i - 1]);
    }
    {
       int i = 1;
       int j = 1;
       internal.nvacc_R4[i - 1 + shared->dim_nvacc_R4_1 * (j - 1)] = 0;
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      int j = 2;
      internal.nvacc_R4[i - 1 + shared->dim_nvacc_R4_1 * (j - 1)] = internal.age_R4[shared->dim_age_R4_1 * (j - 1) + i - 1] + internal.age_R4[shared->dim_age_R4_1 * 0 + i - 1] - internal.nvacc_R4[shared->dim_nvacc_R4_1 * 0 + i - 1];
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      int j = 3;
      internal.nvacc_R4[i - 1 + shared->dim_nvacc_R4_1 * (j - 1)] = internal.age_R4[shared->dim_age_R4_1 * (j - 1) + i - 1];
    }
    for (int i = 2; i <= shared->N_age; ++i) {
      int j = 1;
      internal.nvacc_S[i - 1 + shared->dim_nvacc_S_1 * (j - 1)] = dust::random::binomial<real_type>(rng_state, internal.age_S[shared->dim_age_S_1 * (j - 1) + i - 1], internal.vacc_noncov_S[shared->dim_vacc_noncov_S_1 * (j - 1) + i - 1]);
    }
    {
       int i = 1;
       int j = 1;
       internal.nvacc_S[i - 1 + shared->dim_nvacc_S_1 * (j - 1)] = internal.age_S[shared->dim_age_S_1 * 0 + 0];
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      int j = 2;
      internal.nvacc_S[i - 1 + shared->dim_nvacc_S_1 * (j - 1)] = internal.age_S[shared->dim_age_S_1 * (j - 1) + i - 1];
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      int j = 3;
      internal.nvacc_S[i - 1 + shared->dim_nvacc_S_1 * (j - 1)] = internal.age_S[shared->dim_age_S_1 * (j - 1) + i - 1] + internal.age_S[shared->dim_age_S_1 * 0 + i - 1] - internal.nvacc_S[shared->dim_nvacc_S_1 * 0 + i - 1];
    }
    state_next[14] = Mwb_inf3 + Mwb_E3 - O_Mwb_E3;
    state_next[5] = Mwt_inf4 + Mwt_E4 - O_Mwt_E4;
    for (int i = 1; i <= shared->N_age; ++i) {
      int j = 1;
      internal.Y1[i - 1 + shared->dim_Y1_1 * (j - 1)] = shared->phi_pri[0] * (1 + shared->dis_pri[0] * shared->phi_ed) * internal.inf_1[shared->dim_inf_1_1 * (j - 1) + i - 1] + shared->phi_sec[0] * (1 + shared->dis_sec[0] * shared->phi_ed) * (internal.inf_21[shared->dim_inf_21_1 * (j - 1) + i - 1] + internal.inf_31[shared->dim_inf_31_1 * (j - 1) + i - 1] + internal.inf_41[shared->dim_inf_41_1 * (j - 1) + i - 1]) + shared->phi_tert[0] * (1 + shared->dis_tert[0] * shared->phi_ed) * (internal.inf_231[shared->dim_inf_231_1 * (j - 1) + i - 1] + internal.inf_241[shared->dim_inf_241_1 * (j - 1) + i - 1] + internal.inf_341[shared->dim_inf_341_1 * (j - 1) + i - 1]) + shared->phi_quart[0] * (1 + shared->dis_quart[0] * shared->phi_ed) * internal.inf_2341[shared->dim_inf_2341_1 * (j - 1) + i - 1];
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      for (int j = 2; j <= 3; ++j) {
        internal.Y1[i - 1 + shared->dim_Y1_1 * (j - 1)] = shared->phi_pri[0] * (1 + shared->dis_pri[0] * internal.RR_dis[shared->dim_RR_dis_12 * (i - 1) + shared->dim_RR_dis_1 * 0 + 0] * shared->phi_ed) * internal.inf_1[shared->dim_inf_1_1 * (j - 1) + i - 1] + shared->phi_sec[0] * (1 + shared->dis_sec[0] * internal.RR_dis[shared->dim_RR_dis_12 * (i - 1) + shared->dim_RR_dis_1 * 1 + 0] * shared->phi_ed) * (internal.inf_21[shared->dim_inf_21_1 * (j - 1) + i - 1] + internal.inf_31[shared->dim_inf_31_1 * (j - 1) + i - 1] + internal.inf_41[shared->dim_inf_41_1 * (j - 1) + i - 1]) + shared->phi_tert[0] * (1 + shared->dis_tert[0] * internal.RR_dis[shared->dim_RR_dis_12 * (i - 1) + shared->dim_RR_dis_1 * 1 + 0] * shared->phi_ed) * (internal.inf_231[shared->dim_inf_231_1 * (j - 1) + i - 1] + internal.inf_241[shared->dim_inf_241_1 * (j - 1) + i - 1] + internal.inf_341[shared->dim_inf_341_1 * (j - 1) + i - 1]) + shared->phi_quart[0] * (1 + shared->dis_quart[0] * internal.RR_dis[shared->dim_RR_dis_12 * (i - 1) + shared->dim_RR_dis_1 * 1 + 0] * shared->phi_ed) * internal.inf_2341[shared->dim_inf_2341_1 * (j - 1) + i - 1];
      }
    }
    for (int i = 2; i <= shared->N_age_p1; ++i) {
      for (int j = 1; j <= 3; ++j) {
        internal.age_I1[i - 1 + shared->dim_age_I1_1 * (j - 1)] = dust::random::binomial<real_type>(rng_state, (I1[shared->dim_I1_1 * (j - 1) + i - 1 - 1] - internal.O_I1[shared->dim_O_I1_1 * (j - 1) + i - 1 - 1] + internal.infV_1[shared->dim_infV_1_1 * (j - 1) + i - 1 - 1]), internal.agert[i - 1 - 1]);
      }
    }
    {
       int i = 1;
       for (int j = 1; j <= 3; ++j) {
         internal.age_I1[i - 1 + shared->dim_age_I1_1 * (j - 1)] = 0;
       }
    }
    for (int i = 2; i <= shared->N_age_p1; ++i) {
      for (int j = 1; j <= 3; ++j) {
        internal.age_I124[i - 1 + shared->dim_age_I124_1 * (j - 1)] = dust::random::binomial<real_type>(rng_state, (I124[shared->dim_I124_1 * (j - 1) + i - 1 - 1] - internal.O_I124[shared->dim_O_I124_1 * (j - 1) + i - 1 - 1] + internal.inf_124[shared->dim_inf_124_1 * (j - 1) + i - 1 - 1]), internal.agert[i - 1 - 1]);
      }
    }
    {
       int i = 1;
       for (int j = 1; j <= 3; ++j) {
         internal.age_I124[i - 1 + shared->dim_age_I124_1 * (j - 1)] = 0;
       }
    }
    for (int i = 2; i <= shared->N_age_p1; ++i) {
      for (int j = 1; j <= 3; ++j) {
        internal.age_I13[i - 1 + shared->dim_age_I13_1 * (j - 1)] = dust::random::binomial<real_type>(rng_state, (I13[shared->dim_I13_1 * (j - 1) + i - 1 - 1] - internal.O_I13[shared->dim_O_I13_1 * (j - 1) + i - 1 - 1] + internal.inf_13[shared->dim_inf_13_1 * (j - 1) + i - 1 - 1]), internal.agert[i - 1 - 1]);
      }
    }
    {
       int i = 1;
       for (int j = 1; j <= 3; ++j) {
         internal.age_I13[i - 1 + shared->dim_age_I13_1 * (j - 1)] = 0;
       }
    }
    for (int i = 2; i <= shared->N_age_p1; ++i) {
      for (int j = 1; j <= 3; ++j) {
        internal.age_I134[i - 1 + shared->dim_age_I134_1 * (j - 1)] = dust::random::binomial<real_type>(rng_state, (I134[shared->dim_I134_1 * (j - 1) + i - 1 - 1] - internal.O_I134[shared->dim_O_I134_1 * (j - 1) + i - 1 - 1] + internal.inf_134[shared->dim_inf_134_1 * (j - 1) + i - 1 - 1]), internal.agert[i - 1 - 1]);
      }
    }
    {
       int i = 1;
       for (int j = 1; j <= 3; ++j) {
         internal.age_I134[i - 1 + shared->dim_age_I134_1 * (j - 1)] = 0;
       }
    }
    for (int i = 2; i <= shared->N_age_p1; ++i) {
      for (int j = 1; j <= 3; ++j) {
        internal.age_I143[i - 1 + shared->dim_age_I143_1 * (j - 1)] = dust::random::binomial<real_type>(rng_state, (I143[shared->dim_I143_1 * (j - 1) + i - 1 - 1] - internal.O_I143[shared->dim_O_I143_1 * (j - 1) + i - 1 - 1] + internal.inf_143[shared->dim_inf_143_1 * (j - 1) + i - 1 - 1]), internal.agert[i - 1 - 1]);
      }
    }
    {
       int i = 1;
       for (int j = 1; j <= 3; ++j) {
         internal.age_I143[i - 1 + shared->dim_age_I143_1 * (j - 1)] = 0;
       }
    }
    for (int i = 2; i <= shared->N_age_p1; ++i) {
      for (int j = 1; j <= 3; ++j) {
        internal.age_I23[i - 1 + shared->dim_age_I23_1 * (j - 1)] = dust::random::binomial<real_type>(rng_state, (I23[shared->dim_I23_1 * (j - 1) + i - 1 - 1] - internal.O_I23[shared->dim_O_I23_1 * (j - 1) + i - 1 - 1] + internal.inf_23[shared->dim_inf_23_1 * (j - 1) + i - 1 - 1]), internal.agert[i - 1 - 1]);
      }
    }
    {
       int i = 1;
       for (int j = 1; j <= 3; ++j) {
         internal.age_I23[i - 1 + shared->dim_age_I23_1 * (j - 1)] = 0;
       }
    }
    for (int i = 2; i <= shared->N_age_p1; ++i) {
      for (int j = 1; j <= 3; ++j) {
        internal.age_I234[i - 1 + shared->dim_age_I234_1 * (j - 1)] = dust::random::binomial<real_type>(rng_state, (I234[shared->dim_I234_1 * (j - 1) + i - 1 - 1] - internal.O_I234[shared->dim_O_I234_1 * (j - 1) + i - 1 - 1] + internal.inf_234[shared->dim_inf_234_1 * (j - 1) + i - 1 - 1]), internal.agert[i - 1 - 1]);
      }
    }
    {
       int i = 1;
       for (int j = 1; j <= 3; ++j) {
         internal.age_I234[i - 1 + shared->dim_age_I234_1 * (j - 1)] = 0;
       }
    }
    for (int i = 2; i <= shared->N_age_p1; ++i) {
      for (int j = 1; j <= 3; ++j) {
        internal.age_I243[i - 1 + shared->dim_age_I243_1 * (j - 1)] = dust::random::binomial<real_type>(rng_state, (I243[shared->dim_I243_1 * (j - 1) + i - 1 - 1] - internal.O_I243[shared->dim_O_I243_1 * (j - 1) + i - 1 - 1] + internal.inf_243[shared->dim_inf_243_1 * (j - 1) + i - 1 - 1]), internal.agert[i - 1 - 1]);
      }
    }
    {
       int i = 1;
       for (int j = 1; j <= 3; ++j) {
         internal.age_I243[i - 1 + shared->dim_age_I243_1 * (j - 1)] = 0;
       }
    }
    for (int i = 2; i <= shared->N_age_p1; ++i) {
      for (int j = 1; j <= 3; ++j) {
        internal.age_I32[i - 1 + shared->dim_age_I32_1 * (j - 1)] = dust::random::binomial<real_type>(rng_state, (I32[shared->dim_I32_1 * (j - 1) + i - 1 - 1] - internal.O_I32[shared->dim_O_I32_1 * (j - 1) + i - 1 - 1] + internal.inf_32[shared->dim_inf_32_1 * (j - 1) + i - 1 - 1]), internal.agert[i - 1 - 1]);
      }
    }
    {
       int i = 1;
       for (int j = 1; j <= 3; ++j) {
         internal.age_I32[i - 1 + shared->dim_age_I32_1 * (j - 1)] = 0;
       }
    }
    for (int i = 2; i <= shared->N_age_p1; ++i) {
      for (int j = 1; j <= 3; ++j) {
        internal.age_I342[i - 1 + shared->dim_age_I342_1 * (j - 1)] = dust::random::binomial<real_type>(rng_state, (I342[shared->dim_I342_1 * (j - 1) + i - 1 - 1] - internal.O_I342[shared->dim_O_I342_1 * (j - 1) + i - 1 - 1] + internal.inf_342[shared->dim_inf_342_1 * (j - 1) + i - 1 - 1]), internal.agert[i - 1 - 1]);
      }
    }
    {
       int i = 1;
       for (int j = 1; j <= 3; ++j) {
         internal.age_I342[i - 1 + shared->dim_age_I342_1 * (j - 1)] = 0;
       }
    }
    for (int i = 2; i <= shared->N_age_p1; ++i) {
      for (int j = 1; j <= 3; ++j) {
        internal.age_I42[i - 1 + shared->dim_age_I42_1 * (j - 1)] = dust::random::binomial<real_type>(rng_state, (I42[shared->dim_I42_1 * (j - 1) + i - 1 - 1] - internal.O_I42[shared->dim_O_I42_1 * (j - 1) + i - 1 - 1] + internal.inf_42[shared->dim_inf_42_1 * (j - 1) + i - 1 - 1]), internal.agert[i - 1 - 1]);
      }
    }
    {
       int i = 1;
       for (int j = 1; j <= 3; ++j) {
         internal.age_I42[i - 1 + shared->dim_age_I42_1 * (j - 1)] = 0;
       }
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      for (int j = 1; j <= 3; ++j) {
        internal.inf_14[i - 1 + shared->dim_inf_14_1 * (j - 1)] = dust::random::binomial<real_type>(rng_state, (internal.O_R1[shared->dim_O_R1_1 * (j - 1) + i - 1] - internal.inf_12[shared->dim_inf_12_1 * (j - 1) + i - 1] - internal.inf_13[shared->dim_inf_13_1 * (j - 1) + i - 1]), (internal.rho14[shared->dim_rho14_1 * (j - 1) + i - 1] * internal.FOI4a[i - 1] / (real_type) (internal.rho14[shared->dim_rho14_1 * (j - 1) + i - 1] * internal.FOI4a[i - 1] + internal.deathrt[i - 1])));
      }
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      for (int j = 1; j <= 3; ++j) {
        internal.inf_24[i - 1 + shared->dim_inf_24_1 * (j - 1)] = dust::random::binomial<real_type>(rng_state, (internal.O_R2[shared->dim_O_R2_1 * (j - 1) + i - 1] - internal.inf_21[shared->dim_inf_21_1 * (j - 1) + i - 1] - internal.inf_23[shared->dim_inf_23_1 * (j - 1) + i - 1]), (internal.rho24[shared->dim_rho24_1 * (j - 1) + i - 1] * internal.FOI4a[i - 1] / (real_type) (internal.rho24[shared->dim_rho24_1 * (j - 1) + i - 1] * internal.FOI4a[i - 1] + internal.deathrt[i - 1])));
      }
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      for (int j = 1; j <= 3; ++j) {
        internal.inf_3[i - 1 + shared->dim_inf_3_1 * (j - 1)] = dust::random::binomial<real_type>(rng_state, (internal.O_S[shared->dim_O_S_1 * (j - 1) + i - 1] - internal.inf_1[shared->dim_inf_1_1 * (j - 1) + i - 1] - internal.inf_2[shared->dim_inf_2_1 * (j - 1) + i - 1]), (internal.rho3[shared->dim_rho3_1 * (j - 1) + i - 1] * internal.FOI3a[i - 1] / (real_type) (internal.rho3[shared->dim_rho3_1 * (j - 1) + i - 1] * internal.FOI3a[i - 1] + internal.rho4[shared->dim_rho4_1 * (j - 1) + i - 1] * internal.FOI4a[i - 1] + internal.deathrt[i - 1])));
      }
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      for (int j = 1; j <= 3; ++j) {
        internal.inf_34[i - 1 + shared->dim_inf_34_1 * (j - 1)] = dust::random::binomial<real_type>(rng_state, (internal.O_R3[shared->dim_O_R3_1 * (j - 1) + i - 1] - internal.inf_31[shared->dim_inf_31_1 * (j - 1) + i - 1] - internal.inf_32[shared->dim_inf_32_1 * (j - 1) + i - 1]), (internal.rho34[shared->dim_rho34_1 * (j - 1) + i - 1] * internal.FOI4a[i - 1] / (real_type) (internal.rho34[shared->dim_rho34_1 * (j - 1) + i - 1] * internal.FOI4a[i - 1] + internal.deathrt[i - 1])));
      }
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      for (int j = 1; j <= 3; ++j) {
        internal.inf_43[i - 1 + shared->dim_inf_43_1 * (j - 1)] = dust::random::binomial<real_type>(rng_state, (internal.O_R4[shared->dim_O_R4_1 * (j - 1) + i - 1] - internal.inf_41[shared->dim_inf_41_1 * (j - 1) + i - 1] - internal.inf_42[shared->dim_inf_42_1 * (j - 1) + i - 1]), (internal.rho43[shared->dim_rho43_1 * (j - 1) + i - 1] * internal.FOI3a[i - 1] / (real_type) (internal.rho43[shared->dim_rho43_1 * (j - 1) + i - 1] * internal.FOI3a[i - 1] + internal.deathrt[i - 1])));
      }
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      for (int j = 1; j <= 3; ++j) {
        internal.infection_tq[i - 1 + shared->dim_infection_tq_1 * (j - 1)] = internal.inf_231[shared->dim_inf_231_1 * (j - 1) + i - 1] + internal.inf_241[shared->dim_inf_241_1 * (j - 1) + i - 1] + internal.inf_341[shared->dim_inf_341_1 * (j - 1) + i - 1] + internal.inf_132[shared->dim_inf_132_1 * (j - 1) + i - 1] + internal.inf_142[shared->dim_inf_142_1 * (j - 1) + i - 1] + internal.inf_342[shared->dim_inf_342_1 * (j - 1) + i - 1] + internal.inf_123[shared->dim_inf_123_1 * (j - 1) + i - 1] + internal.inf_143[shared->dim_inf_143_1 * (j - 1) + i - 1] + internal.inf_243[shared->dim_inf_243_1 * (j - 1) + i - 1] + internal.inf_124[shared->dim_inf_124_1 * (j - 1) + i - 1] + internal.inf_134[shared->dim_inf_134_1 * (j - 1) + i - 1] + internal.inf_234[shared->dim_inf_234_1 * (j - 1) + i - 1] + internal.inf_2341[shared->dim_inf_2341_1 * (j - 1) + i - 1] + internal.inf_1342[shared->dim_inf_1342_1 * (j - 1) + i - 1] + internal.inf_1243[shared->dim_inf_1243_1 * (j - 1) + i - 1] + internal.inf_1234[shared->dim_inf_1234_1 * (j - 1) + i - 1];
      }
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      int j = 1;
      internal.infV_2[i - 1 + shared->dim_infV_2_1 * (j - 1)] = internal.inf_2[shared->dim_inf_2_1 * (j - 1) + i - 1] + shared->nnveai[j - 1] * internal.inf_2[shared->dim_inf_2_1 * 1 + i - 1];
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      int j = 2;
      internal.infV_2[i - 1 + shared->dim_infV_2_1 * (j - 1)] = shared->nveai[j - 1] * internal.inf_2[shared->dim_inf_2_1 * (j - 1) + i - 1];
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      int j = 3;
      internal.infV_2[i - 1 + shared->dim_infV_2_1 * (j - 1)] = internal.inf_2[shared->dim_inf_2_1 * (j - 1) + i - 1];
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      for (int j = 1; j <= 3; ++j) {
        internal.n_R1[i - 1 + shared->dim_n_R1_1 * (j - 1)] = internal.nvacc_R1[shared->dim_nvacc_R1_1 * (j - 1) + i - 1] + R1[shared->dim_R1_1 * (j - 1) + i - 1] - internal.O_R1[shared->dim_O_R1_1 * (j - 1) + i - 1] + internal.recov_1[shared->dim_recov_1_1 * (j - 1) + i - 1] - internal.age_R1[shared->dim_age_R1_1 * (j - 1) + i + 1 - 1];
      }
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      for (int j = 1; j <= 3; ++j) {
        internal.n_R12[i - 1 + shared->dim_n_R12_1 * (j - 1)] = internal.nvacc_R12[shared->dim_nvacc_R12_1 * (j - 1) + i - 1] + R12[shared->dim_R12_1 * (j - 1) + i - 1] - internal.O_R12[shared->dim_O_R12_1 * (j - 1) + i - 1] + internal.recov_12[shared->dim_recov_12_1 * (j - 1) + i - 1] + internal.recov_21[shared->dim_recov_21_1 * (j - 1) + i - 1] - internal.age_R12[shared->dim_age_R12_1 * (j - 1) + i + 1 - 1];
      }
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      for (int j = 1; j <= 3; ++j) {
        internal.n_R123[i - 1 + shared->dim_n_R123_1 * (j - 1)] = internal.nvacc_R123[shared->dim_nvacc_R123_1 * (j - 1) + i - 1] + R123[shared->dim_R123_1 * (j - 1) + i - 1] - internal.O_R123[shared->dim_O_R123_1 * (j - 1) + i - 1] + internal.recov_123[shared->dim_recov_123_1 * (j - 1) + i - 1] + internal.recov_132[shared->dim_recov_132_1 * (j - 1) + i - 1] + internal.recov_231[shared->dim_recov_231_1 * (j - 1) + i - 1] - internal.age_R123[shared->dim_age_R123_1 * (j - 1) + i + 1 - 1];
      }
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      for (int j = 1; j <= 3; ++j) {
        internal.n_R124[i - 1 + shared->dim_n_R124_1 * (j - 1)] = internal.nvacc_R124[shared->dim_nvacc_R124_1 * (j - 1) + i - 1] + R124[shared->dim_R124_1 * (j - 1) + i - 1] - internal.O_R124[shared->dim_O_R124_1 * (j - 1) + i - 1] + internal.recov_124[shared->dim_recov_124_1 * (j - 1) + i - 1] + internal.recov_142[shared->dim_recov_142_1 * (j - 1) + i - 1] + internal.recov_241[shared->dim_recov_241_1 * (j - 1) + i - 1] - internal.age_R124[shared->dim_age_R124_1 * (j - 1) + i + 1 - 1];
      }
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      for (int j = 1; j <= 3; ++j) {
        internal.n_R13[i - 1 + shared->dim_n_R13_1 * (j - 1)] = internal.nvacc_R13[shared->dim_nvacc_R13_1 * (j - 1) + i - 1] + R13[shared->dim_R13_1 * (j - 1) + i - 1] - internal.O_R13[shared->dim_O_R13_1 * (j - 1) + i - 1] + internal.recov_13[shared->dim_recov_13_1 * (j - 1) + i - 1] + internal.recov_31[shared->dim_recov_31_1 * (j - 1) + i - 1] - internal.age_R13[shared->dim_age_R13_1 * (j - 1) + i + 1 - 1];
      }
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      for (int j = 1; j <= 3; ++j) {
        internal.n_R134[i - 1 + shared->dim_n_R134_1 * (j - 1)] = internal.nvacc_R134[shared->dim_nvacc_R134_1 * (j - 1) + i - 1] + R134[shared->dim_R134_1 * (j - 1) + i - 1] - internal.O_R134[shared->dim_O_R134_1 * (j - 1) + i - 1] + internal.recov_134[shared->dim_recov_134_1 * (j - 1) + i - 1] + internal.recov_143[shared->dim_recov_143_1 * (j - 1) + i - 1] + internal.recov_341[shared->dim_recov_341_1 * (j - 1) + i - 1] - internal.age_R134[shared->dim_age_R134_1 * (j - 1) + i + 1 - 1];
      }
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      for (int j = 1; j <= 3; ++j) {
        internal.n_R14[i - 1 + shared->dim_n_R14_1 * (j - 1)] = internal.nvacc_R14[shared->dim_nvacc_R14_1 * (j - 1) + i - 1] + R14[shared->dim_R14_1 * (j - 1) + i - 1] - internal.O_R14[shared->dim_O_R14_1 * (j - 1) + i - 1] + internal.recov_14[shared->dim_recov_14_1 * (j - 1) + i - 1] + internal.recov_41[shared->dim_recov_41_1 * (j - 1) + i - 1] - internal.age_R14[shared->dim_age_R14_1 * (j - 1) + i + 1 - 1];
      }
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      for (int j = 1; j <= 3; ++j) {
        internal.n_R2[i - 1 + shared->dim_n_R2_1 * (j - 1)] = internal.nvacc_R2[shared->dim_nvacc_R2_1 * (j - 1) + i - 1] + R2[shared->dim_R2_1 * (j - 1) + i - 1] - internal.O_R2[shared->dim_O_R2_1 * (j - 1) + i - 1] + internal.recov_2[shared->dim_recov_2_1 * (j - 1) + i - 1] - internal.age_R2[shared->dim_age_R2_1 * (j - 1) + i + 1 - 1];
      }
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      for (int j = 1; j <= 3; ++j) {
        internal.n_R23[i - 1 + shared->dim_n_R23_1 * (j - 1)] = internal.nvacc_R23[shared->dim_nvacc_R23_1 * (j - 1) + i - 1] + R23[shared->dim_R23_1 * (j - 1) + i - 1] - internal.O_R23[shared->dim_O_R23_1 * (j - 1) + i - 1] + internal.recov_23[shared->dim_recov_23_1 * (j - 1) + i - 1] + internal.recov_32[shared->dim_recov_32_1 * (j - 1) + i - 1] - internal.age_R23[shared->dim_age_R23_1 * (j - 1) + i + 1 - 1];
      }
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      for (int j = 1; j <= 3; ++j) {
        internal.n_R234[i - 1 + shared->dim_n_R234_1 * (j - 1)] = internal.nvacc_R234[shared->dim_nvacc_R234_1 * (j - 1) + i - 1] + R234[shared->dim_R234_1 * (j - 1) + i - 1] - internal.O_R234[shared->dim_O_R234_1 * (j - 1) + i - 1] + internal.recov_234[shared->dim_recov_234_1 * (j - 1) + i - 1] + internal.recov_243[shared->dim_recov_243_1 * (j - 1) + i - 1] + internal.recov_342[shared->dim_recov_342_1 * (j - 1) + i - 1] - internal.age_R234[shared->dim_age_R234_1 * (j - 1) + i + 1 - 1];
      }
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      for (int j = 1; j <= 3; ++j) {
        internal.n_R24[i - 1 + shared->dim_n_R24_1 * (j - 1)] = internal.nvacc_R24[shared->dim_nvacc_R24_1 * (j - 1) + i - 1] + R24[shared->dim_R24_1 * (j - 1) + i - 1] - internal.O_R24[shared->dim_O_R24_1 * (j - 1) + i - 1] + internal.recov_24[shared->dim_recov_24_1 * (j - 1) + i - 1] + internal.recov_42[shared->dim_recov_42_1 * (j - 1) + i - 1] - internal.age_R24[shared->dim_age_R24_1 * (j - 1) + i + 1 - 1];
      }
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      for (int j = 1; j <= 3; ++j) {
        internal.n_R3[i - 1 + shared->dim_n_R3_1 * (j - 1)] = internal.nvacc_R3[shared->dim_nvacc_R3_1 * (j - 1) + i - 1] + R3[shared->dim_R3_1 * (j - 1) + i - 1] - internal.O_R3[shared->dim_O_R3_1 * (j - 1) + i - 1] + internal.recov_3[shared->dim_recov_3_1 * (j - 1) + i - 1] - internal.age_R3[shared->dim_age_R3_1 * (j - 1) + i + 1 - 1];
      }
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      for (int j = 1; j <= 3; ++j) {
        internal.n_R34[i - 1 + shared->dim_n_R34_1 * (j - 1)] = internal.nvacc_R34[shared->dim_nvacc_R34_1 * (j - 1) + i - 1] + R34[shared->dim_R34_1 * (j - 1) + i - 1] - internal.O_R34[shared->dim_O_R34_1 * (j - 1) + i - 1] + internal.recov_34[shared->dim_recov_34_1 * (j - 1) + i - 1] + internal.recov_43[shared->dim_recov_43_1 * (j - 1) + i - 1] - internal.age_R34[shared->dim_age_R34_1 * (j - 1) + i + 1 - 1];
      }
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      for (int j = 1; j <= 3; ++j) {
        internal.n_R4[i - 1 + shared->dim_n_R4_1 * (j - 1)] = internal.nvacc_R4[shared->dim_nvacc_R4_1 * (j - 1) + i - 1] + R4[shared->dim_R4_1 * (j - 1) + i - 1] - internal.O_R4[shared->dim_O_R4_1 * (j - 1) + i - 1] + internal.recov_4[shared->dim_recov_4_1 * (j - 1) + i - 1] - internal.age_R4[shared->dim_age_R4_1 * (j - 1) + i + 1 - 1];
      }
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      for (int j = 1; j <= 3; ++j) {
        internal.n_S[i - 1 + shared->dim_n_S_1 * (j - 1)] = internal.nvacc_S[shared->dim_nvacc_S_1 * (j - 1) + i - 1] + S[shared->dim_S_1 * (j - 1) + i - 1] - internal.O_S[shared->dim_O_S_1 * (j - 1) + i - 1] - internal.age_S[shared->dim_age_S_1 * (j - 1) + i + 1 - 1];
      }
    }
    for (int i = 2; i <= shared->N_age; ++i) {
      int j = 1;
      internal.nvacc_I12[i - 1 + shared->dim_nvacc_I12_1 * (j - 1)] = dust::random::binomial<real_type>(rng_state, internal.age_I12[shared->dim_age_I12_1 * (j - 1) + i - 1], internal.vacc_noncov[shared->dim_vacc_noncov_1 * (j - 1) + i - 1]);
    }
    {
       int i = 1;
       int j = 1;
       internal.nvacc_I12[i - 1 + shared->dim_nvacc_I12_1 * (j - 1)] = 0;
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      int j = 2;
      internal.nvacc_I12[i - 1 + shared->dim_nvacc_I12_1 * (j - 1)] = internal.age_I12[shared->dim_age_I12_1 * (j - 1) + i - 1] + internal.age_I12[shared->dim_age_I12_1 * 0 + i - 1] - internal.nvacc_I12[shared->dim_nvacc_I12_1 * 0 + i - 1];
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      int j = 3;
      internal.nvacc_I12[i - 1 + shared->dim_nvacc_I12_1 * (j - 1)] = internal.age_I12[shared->dim_age_I12_1 * (j - 1) + i - 1];
    }
    for (int i = 2; i <= shared->N_age; ++i) {
      int j = 1;
      internal.nvacc_I123[i - 1 + shared->dim_nvacc_I123_1 * (j - 1)] = dust::random::binomial<real_type>(rng_state, internal.age_I123[shared->dim_age_I123_1 * (j - 1) + i - 1], internal.vacc_noncov[shared->dim_vacc_noncov_1 * (j - 1) + i - 1]);
    }
    {
       int i = 1;
       int j = 1;
       internal.nvacc_I123[i - 1 + shared->dim_nvacc_I123_1 * (j - 1)] = 0;
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      int j = 2;
      internal.nvacc_I123[i - 1 + shared->dim_nvacc_I123_1 * (j - 1)] = internal.age_I123[shared->dim_age_I123_1 * (j - 1) + i - 1] + internal.age_I123[shared->dim_age_I123_1 * 0 + i - 1] - internal.nvacc_I123[shared->dim_nvacc_I123_1 * 0 + i - 1];
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      int j = 3;
      internal.nvacc_I123[i - 1 + shared->dim_nvacc_I123_1 * (j - 1)] = internal.age_I123[shared->dim_age_I123_1 * (j - 1) + i - 1];
    }
    for (int i = 2; i <= shared->N_age; ++i) {
      int j = 1;
      internal.nvacc_I1234[i - 1 + shared->dim_nvacc_I1234_1 * (j - 1)] = dust::random::binomial<real_type>(rng_state, internal.age_I1234[shared->dim_age_I1234_1 * (j - 1) + i - 1], internal.vacc_noncov[shared->dim_vacc_noncov_1 * (j - 1) + i - 1]);
    }
    {
       int i = 1;
       int j = 1;
       internal.nvacc_I1234[i - 1 + shared->dim_nvacc_I1234_1 * (j - 1)] = 0;
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      int j = 2;
      internal.nvacc_I1234[i - 1 + shared->dim_nvacc_I1234_1 * (j - 1)] = internal.age_I1234[shared->dim_age_I1234_1 * (j - 1) + i - 1] + internal.age_I1234[shared->dim_age_I1234_1 * 0 + i - 1] - internal.nvacc_I1234[shared->dim_nvacc_I1234_1 * 0 + i - 1];
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      int j = 3;
      internal.nvacc_I1234[i - 1 + shared->dim_nvacc_I1234_1 * (j - 1)] = internal.age_I1234[shared->dim_age_I1234_1 * (j - 1) + i - 1];
    }
    for (int i = 2; i <= shared->N_age; ++i) {
      int j = 1;
      internal.nvacc_I1243[i - 1 + shared->dim_nvacc_I1243_1 * (j - 1)] = dust::random::binomial<real_type>(rng_state, internal.age_I1243[shared->dim_age_I1243_1 * (j - 1) + i - 1], internal.vacc_noncov[shared->dim_vacc_noncov_1 * (j - 1) + i - 1]);
    }
    {
       int i = 1;
       int j = 1;
       internal.nvacc_I1243[i - 1 + shared->dim_nvacc_I1243_1 * (j - 1)] = 0;
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      int j = 2;
      internal.nvacc_I1243[i - 1 + shared->dim_nvacc_I1243_1 * (j - 1)] = internal.age_I1243[shared->dim_age_I1243_1 * (j - 1) + i - 1] + internal.age_I1243[shared->dim_age_I1243_1 * 0 + i - 1] - internal.nvacc_I1243[shared->dim_nvacc_I1243_1 * 0 + i - 1];
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      int j = 3;
      internal.nvacc_I1243[i - 1 + shared->dim_nvacc_I1243_1 * (j - 1)] = internal.age_I1243[shared->dim_age_I1243_1 * (j - 1) + i - 1];
    }
    for (int i = 2; i <= shared->N_age; ++i) {
      int j = 1;
      internal.nvacc_I132[i - 1 + shared->dim_nvacc_I132_1 * (j - 1)] = dust::random::binomial<real_type>(rng_state, internal.age_I132[shared->dim_age_I132_1 * (j - 1) + i - 1], internal.vacc_noncov[shared->dim_vacc_noncov_1 * (j - 1) + i - 1]);
    }
    {
       int i = 1;
       int j = 1;
       internal.nvacc_I132[i - 1 + shared->dim_nvacc_I132_1 * (j - 1)] = 0;
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      int j = 2;
      internal.nvacc_I132[i - 1 + shared->dim_nvacc_I132_1 * (j - 1)] = internal.age_I132[shared->dim_age_I132_1 * (j - 1) + i - 1] + internal.age_I132[shared->dim_age_I132_1 * 0 + i - 1] - internal.nvacc_I132[shared->dim_nvacc_I132_1 * 0 + i - 1];
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      int j = 3;
      internal.nvacc_I132[i - 1 + shared->dim_nvacc_I132_1 * (j - 1)] = internal.age_I132[shared->dim_age_I132_1 * (j - 1) + i - 1];
    }
    for (int i = 2; i <= shared->N_age; ++i) {
      int j = 1;
      internal.nvacc_I1342[i - 1 + shared->dim_nvacc_I1342_1 * (j - 1)] = dust::random::binomial<real_type>(rng_state, internal.age_I1342[shared->dim_age_I1342_1 * (j - 1) + i - 1], internal.vacc_noncov[shared->dim_vacc_noncov_1 * (j - 1) + i - 1]);
    }
    {
       int i = 1;
       int j = 1;
       internal.nvacc_I1342[i - 1 + shared->dim_nvacc_I1342_1 * (j - 1)] = 0;
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      int j = 2;
      internal.nvacc_I1342[i - 1 + shared->dim_nvacc_I1342_1 * (j - 1)] = internal.age_I1342[shared->dim_age_I1342_1 * (j - 1) + i - 1] + internal.age_I1342[shared->dim_age_I1342_1 * 0 + i - 1] - internal.nvacc_I1342[shared->dim_nvacc_I1342_1 * 0 + i - 1];
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      int j = 3;
      internal.nvacc_I1342[i - 1 + shared->dim_nvacc_I1342_1 * (j - 1)] = internal.age_I1342[shared->dim_age_I1342_1 * (j - 1) + i - 1];
    }
    for (int i = 2; i <= shared->N_age; ++i) {
      int j = 1;
      internal.nvacc_I142[i - 1 + shared->dim_nvacc_I142_1 * (j - 1)] = dust::random::binomial<real_type>(rng_state, internal.age_I142[shared->dim_age_I142_1 * (j - 1) + i - 1], internal.vacc_noncov[shared->dim_vacc_noncov_1 * (j - 1) + i - 1]);
    }
    {
       int i = 1;
       int j = 1;
       internal.nvacc_I142[i - 1 + shared->dim_nvacc_I142_1 * (j - 1)] = 0;
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      int j = 2;
      internal.nvacc_I142[i - 1 + shared->dim_nvacc_I142_1 * (j - 1)] = internal.age_I142[shared->dim_age_I142_1 * (j - 1) + i - 1] + internal.age_I142[shared->dim_age_I142_1 * 0 + i - 1] - internal.nvacc_I142[shared->dim_nvacc_I142_1 * 0 + i - 1];
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      int j = 3;
      internal.nvacc_I142[i - 1 + shared->dim_nvacc_I142_1 * (j - 1)] = internal.age_I142[shared->dim_age_I142_1 * (j - 1) + i - 1];
    }
    for (int i = 2; i <= shared->N_age; ++i) {
      int j = 1;
      internal.nvacc_I21[i - 1 + shared->dim_nvacc_I21_1 * (j - 1)] = dust::random::binomial<real_type>(rng_state, internal.age_I21[shared->dim_age_I21_1 * (j - 1) + i - 1], internal.vacc_noncov[shared->dim_vacc_noncov_1 * (j - 1) + i - 1]);
    }
    {
       int i = 1;
       int j = 1;
       internal.nvacc_I21[i - 1 + shared->dim_nvacc_I21_1 * (j - 1)] = 0;
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      int j = 2;
      internal.nvacc_I21[i - 1 + shared->dim_nvacc_I21_1 * (j - 1)] = internal.age_I21[shared->dim_age_I21_1 * (j - 1) + i - 1] + internal.age_I21[shared->dim_age_I21_1 * 0 + i - 1] - internal.nvacc_I21[shared->dim_nvacc_I21_1 * 0 + i - 1];
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      int j = 3;
      internal.nvacc_I21[i - 1 + shared->dim_nvacc_I21_1 * (j - 1)] = internal.age_I21[shared->dim_age_I21_1 * (j - 1) + i - 1];
    }
    for (int i = 2; i <= shared->N_age; ++i) {
      int j = 1;
      internal.nvacc_I231[i - 1 + shared->dim_nvacc_I231_1 * (j - 1)] = dust::random::binomial<real_type>(rng_state, internal.age_I231[shared->dim_age_I231_1 * (j - 1) + i - 1], internal.vacc_noncov[shared->dim_vacc_noncov_1 * (j - 1) + i - 1]);
    }
    {
       int i = 1;
       int j = 1;
       internal.nvacc_I231[i - 1 + shared->dim_nvacc_I231_1 * (j - 1)] = 0;
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      int j = 2;
      internal.nvacc_I231[i - 1 + shared->dim_nvacc_I231_1 * (j - 1)] = internal.age_I231[shared->dim_age_I231_1 * (j - 1) + i - 1] + internal.age_I231[shared->dim_age_I231_1 * 0 + i - 1] - internal.nvacc_I231[shared->dim_nvacc_I231_1 * 0 + i - 1];
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      int j = 3;
      internal.nvacc_I231[i - 1 + shared->dim_nvacc_I231_1 * (j - 1)] = internal.age_I231[shared->dim_age_I231_1 * (j - 1) + i - 1];
    }
    for (int i = 2; i <= shared->N_age; ++i) {
      int j = 1;
      internal.nvacc_I2341[i - 1 + shared->dim_nvacc_I2341_1 * (j - 1)] = dust::random::binomial<real_type>(rng_state, internal.age_I2341[shared->dim_age_I2341_1 * (j - 1) + i - 1], internal.vacc_noncov[shared->dim_vacc_noncov_1 * (j - 1) + i - 1]);
    }
    {
       int i = 1;
       int j = 1;
       internal.nvacc_I2341[i - 1 + shared->dim_nvacc_I2341_1 * (j - 1)] = 0;
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      int j = 2;
      internal.nvacc_I2341[i - 1 + shared->dim_nvacc_I2341_1 * (j - 1)] = internal.age_I2341[shared->dim_age_I2341_1 * (j - 1) + i - 1] + internal.age_I2341[shared->dim_age_I2341_1 * 0 + i - 1] - internal.nvacc_I2341[shared->dim_nvacc_I2341_1 * 0 + i - 1];
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      int j = 3;
      internal.nvacc_I2341[i - 1 + shared->dim_nvacc_I2341_1 * (j - 1)] = internal.age_I2341[shared->dim_age_I2341_1 * (j - 1) + i - 1];
    }
    for (int i = 2; i <= shared->N_age; ++i) {
      int j = 1;
      internal.nvacc_I241[i - 1 + shared->dim_nvacc_I241_1 * (j - 1)] = dust::random::binomial<real_type>(rng_state, internal.age_I241[shared->dim_age_I241_1 * (j - 1) + i - 1], internal.vacc_noncov[shared->dim_vacc_noncov_1 * (j - 1) + i - 1]);
    }
    {
       int i = 1;
       int j = 1;
       internal.nvacc_I241[i - 1 + shared->dim_nvacc_I241_1 * (j - 1)] = 0;
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      int j = 2;
      internal.nvacc_I241[i - 1 + shared->dim_nvacc_I241_1 * (j - 1)] = internal.age_I241[shared->dim_age_I241_1 * (j - 1) + i - 1] + internal.age_I241[shared->dim_age_I241_1 * 0 + i - 1] - internal.nvacc_I241[shared->dim_nvacc_I241_1 * 0 + i - 1];
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      int j = 3;
      internal.nvacc_I241[i - 1 + shared->dim_nvacc_I241_1 * (j - 1)] = internal.age_I241[shared->dim_age_I241_1 * (j - 1) + i - 1];
    }
    for (int i = 2; i <= shared->N_age; ++i) {
      int j = 1;
      internal.nvacc_I31[i - 1 + shared->dim_nvacc_I31_1 * (j - 1)] = dust::random::binomial<real_type>(rng_state, internal.age_I31[shared->dim_age_I31_1 * (j - 1) + i - 1], internal.vacc_noncov[shared->dim_vacc_noncov_1 * (j - 1) + i - 1]);
    }
    {
       int i = 1;
       int j = 1;
       internal.nvacc_I31[i - 1 + shared->dim_nvacc_I31_1 * (j - 1)] = 0;
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      int j = 2;
      internal.nvacc_I31[i - 1 + shared->dim_nvacc_I31_1 * (j - 1)] = internal.age_I31[shared->dim_age_I31_1 * (j - 1) + i - 1] + internal.age_I31[shared->dim_age_I31_1 * 0 + i - 1] - internal.nvacc_I31[shared->dim_nvacc_I31_1 * 0 + i - 1];
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      int j = 3;
      internal.nvacc_I31[i - 1 + shared->dim_nvacc_I31_1 * (j - 1)] = internal.age_I31[shared->dim_age_I31_1 * (j - 1) + i - 1];
    }
    for (int i = 2; i <= shared->N_age; ++i) {
      int j = 1;
      internal.nvacc_I341[i - 1 + shared->dim_nvacc_I341_1 * (j - 1)] = dust::random::binomial<real_type>(rng_state, internal.age_I341[shared->dim_age_I341_1 * (j - 1) + i - 1], internal.vacc_noncov[shared->dim_vacc_noncov_1 * (j - 1) + i - 1]);
    }
    {
       int i = 1;
       int j = 1;
       internal.nvacc_I341[i - 1 + shared->dim_nvacc_I341_1 * (j - 1)] = 0;
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      int j = 2;
      internal.nvacc_I341[i - 1 + shared->dim_nvacc_I341_1 * (j - 1)] = internal.age_I341[shared->dim_age_I341_1 * (j - 1) + i - 1] + internal.age_I341[shared->dim_age_I341_1 * 0 + i - 1] - internal.nvacc_I341[shared->dim_nvacc_I341_1 * 0 + i - 1];
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      int j = 3;
      internal.nvacc_I341[i - 1 + shared->dim_nvacc_I341_1 * (j - 1)] = internal.age_I341[shared->dim_age_I341_1 * (j - 1) + i - 1];
    }
    for (int i = 2; i <= shared->N_age; ++i) {
      int j = 1;
      internal.nvacc_I41[i - 1 + shared->dim_nvacc_I41_1 * (j - 1)] = dust::random::binomial<real_type>(rng_state, internal.age_I41[shared->dim_age_I41_1 * (j - 1) + i - 1], internal.vacc_noncov[shared->dim_vacc_noncov_1 * (j - 1) + i - 1]);
    }
    {
       int i = 1;
       int j = 1;
       internal.nvacc_I41[i - 1 + shared->dim_nvacc_I41_1 * (j - 1)] = 0;
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      int j = 2;
      internal.nvacc_I41[i - 1 + shared->dim_nvacc_I41_1 * (j - 1)] = internal.age_I41[shared->dim_age_I41_1 * (j - 1) + i - 1] + internal.age_I41[shared->dim_age_I41_1 * 0 + i - 1] - internal.nvacc_I41[shared->dim_nvacc_I41_1 * 0 + i - 1];
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      int j = 3;
      internal.nvacc_I41[i - 1 + shared->dim_nvacc_I41_1 * (j - 1)] = internal.age_I41[shared->dim_age_I41_1 * (j - 1) + i - 1];
    }
    state_next[15] = Mwb_inf4 + Mwb_E4 - O_Mwb_E4;
    real_type Y1T = odin_sum1<real_type>(internal.Y1.data(), 0, shared->dim_Y1) / (real_type) NT;
    for (int i = 1; i <= shared->N_age; ++i) {
      int j = 1;
      internal.Y2[i - 1 + shared->dim_Y2_1 * (j - 1)] = shared->phi_pri[1] * (1 + shared->dis_pri[1] * shared->phi_ed) * internal.inf_2[shared->dim_inf_2_1 * (j - 1) + i - 1] + shared->phi_sec[1] * (1 + shared->dis_sec[1] * shared->phi_ed) * (internal.inf_12[shared->dim_inf_12_1 * (j - 1) + i - 1] + internal.inf_32[shared->dim_inf_32_1 * (j - 1) + i - 1] + internal.inf_42[shared->dim_inf_42_1 * (j - 1) + i - 1]) + shared->phi_tert[1] * (1 + shared->dis_tert[1] * shared->phi_ed) * (internal.inf_132[shared->dim_inf_132_1 * (j - 1) + i - 1] + internal.inf_142[shared->dim_inf_142_1 * (j - 1) + i - 1] + internal.inf_342[shared->dim_inf_342_1 * (j - 1) + i - 1]) + shared->phi_quart[1] * (1 + shared->dis_quart[1] * shared->phi_ed) * internal.inf_1342[shared->dim_inf_1342_1 * (j - 1) + i - 1];
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      for (int j = 2; j <= 3; ++j) {
        internal.Y2[i - 1 + shared->dim_Y2_1 * (j - 1)] = shared->phi_pri[1] * (1 + shared->dis_pri[1] * internal.RR_dis[shared->dim_RR_dis_12 * (i - 1) + shared->dim_RR_dis_1 * 0 + 1] * shared->phi_ed) * internal.inf_2[shared->dim_inf_2_1 * (j - 1) + i - 1] + shared->phi_sec[1] * (1 + shared->dis_sec[1] * internal.RR_dis[shared->dim_RR_dis_12 * (i - 1) + shared->dim_RR_dis_1 * 1 + 1] * shared->phi_ed) * (internal.inf_12[shared->dim_inf_12_1 * (j - 1) + i - 1] + internal.inf_32[shared->dim_inf_32_1 * (j - 1) + i - 1] + internal.inf_42[shared->dim_inf_42_1 * (j - 1) + i - 1]) + shared->phi_tert[1] * (1 + shared->dis_tert[1] * internal.RR_dis[shared->dim_RR_dis_12 * (i - 1) + shared->dim_RR_dis_1 * 1 + 1] * shared->phi_ed) * (internal.inf_132[shared->dim_inf_132_1 * (j - 1) + i - 1] + internal.inf_142[shared->dim_inf_142_1 * (j - 1) + i - 1] + internal.inf_342[shared->dim_inf_342_1 * (j - 1) + i - 1]) + shared->phi_quart[1] * (1 + shared->dis_quart[1] * internal.RR_dis[shared->dim_RR_dis_12 * (i - 1) + shared->dim_RR_dis_1 * 1 + 1] * shared->phi_ed) * internal.inf_1342[shared->dim_inf_1342_1 * (j - 1) + i - 1];
      }
    }
    for (int i = 2; i <= shared->N_age_p1; ++i) {
      for (int j = 1; j <= 3; ++j) {
        internal.age_I14[i - 1 + shared->dim_age_I14_1 * (j - 1)] = dust::random::binomial<real_type>(rng_state, (I14[shared->dim_I14_1 * (j - 1) + i - 1 - 1] - internal.O_I14[shared->dim_O_I14_1 * (j - 1) + i - 1 - 1] + internal.inf_14[shared->dim_inf_14_1 * (j - 1) + i - 1 - 1]), internal.agert[i - 1 - 1]);
      }
    }
    {
       int i = 1;
       for (int j = 1; j <= 3; ++j) {
         internal.age_I14[i - 1 + shared->dim_age_I14_1 * (j - 1)] = 0;
       }
    }
    for (int i = 2; i <= shared->N_age_p1; ++i) {
      for (int j = 1; j <= 3; ++j) {
        internal.age_I2[i - 1 + shared->dim_age_I2_1 * (j - 1)] = dust::random::binomial<real_type>(rng_state, (I2[shared->dim_I2_1 * (j - 1) + i - 1 - 1] - internal.O_I2[shared->dim_O_I2_1 * (j - 1) + i - 1 - 1] + internal.infV_2[shared->dim_infV_2_1 * (j - 1) + i - 1 - 1]), internal.agert[i - 1 - 1]);
      }
    }
    {
       int i = 1;
       for (int j = 1; j <= 3; ++j) {
         internal.age_I2[i - 1 + shared->dim_age_I2_1 * (j - 1)] = 0;
       }
    }
    for (int i = 2; i <= shared->N_age_p1; ++i) {
      for (int j = 1; j <= 3; ++j) {
        internal.age_I24[i - 1 + shared->dim_age_I24_1 * (j - 1)] = dust::random::binomial<real_type>(rng_state, (I24[shared->dim_I24_1 * (j - 1) + i - 1 - 1] - internal.O_I24[shared->dim_O_I24_1 * (j - 1) + i - 1 - 1] + internal.inf_24[shared->dim_inf_24_1 * (j - 1) + i - 1 - 1]), internal.agert[i - 1 - 1]);
      }
    }
    {
       int i = 1;
       for (int j = 1; j <= 3; ++j) {
         internal.age_I24[i - 1 + shared->dim_age_I24_1 * (j - 1)] = 0;
       }
    }
    for (int i = 2; i <= shared->N_age_p1; ++i) {
      for (int j = 1; j <= 3; ++j) {
        internal.age_I34[i - 1 + shared->dim_age_I34_1 * (j - 1)] = dust::random::binomial<real_type>(rng_state, (I34[shared->dim_I34_1 * (j - 1) + i - 1 - 1] - internal.O_I34[shared->dim_O_I34_1 * (j - 1) + i - 1 - 1] + internal.inf_34[shared->dim_inf_34_1 * (j - 1) + i - 1 - 1]), internal.agert[i - 1 - 1]);
      }
    }
    {
       int i = 1;
       for (int j = 1; j <= 3; ++j) {
         internal.age_I34[i - 1 + shared->dim_age_I34_1 * (j - 1)] = 0;
       }
    }
    for (int i = 2; i <= shared->N_age_p1; ++i) {
      for (int j = 1; j <= 3; ++j) {
        internal.age_I43[i - 1 + shared->dim_age_I43_1 * (j - 1)] = dust::random::binomial<real_type>(rng_state, (I43[shared->dim_I43_1 * (j - 1) + i - 1 - 1] - internal.O_I43[shared->dim_O_I43_1 * (j - 1) + i - 1 - 1] + internal.inf_43[shared->dim_inf_43_1 * (j - 1) + i - 1 - 1]), internal.agert[i - 1 - 1]);
      }
    }
    {
       int i = 1;
       for (int j = 1; j <= 3; ++j) {
         internal.age_I43[i - 1 + shared->dim_age_I43_1 * (j - 1)] = 0;
       }
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      for (int j = 1; j <= 3; ++j) {
        internal.inf_4[i - 1 + shared->dim_inf_4_1 * (j - 1)] = dust::random::binomial<real_type>(rng_state, (internal.O_S[shared->dim_O_S_1 * (j - 1) + i - 1] - internal.inf_1[shared->dim_inf_1_1 * (j - 1) + i - 1] - internal.inf_2[shared->dim_inf_2_1 * (j - 1) + i - 1] - internal.inf_3[shared->dim_inf_3_1 * (j - 1) + i - 1]), (internal.rho4[shared->dim_rho4_1 * (j - 1) + i - 1] * internal.FOI4a[i - 1] / (real_type) (internal.rho4[shared->dim_rho4_1 * (j - 1) + i - 1] * internal.FOI4a[i - 1] + internal.deathrt[i - 1])));
      }
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      for (int j = 1; j <= 3; ++j) {
        internal.infection_sec[i - 1 + shared->dim_infection_sec_1 * (j - 1)] = internal.inf_21[shared->dim_inf_21_1 * (j - 1) + i - 1] + internal.inf_31[shared->dim_inf_31_1 * (j - 1) + i - 1] + internal.inf_41[shared->dim_inf_41_1 * (j - 1) + i - 1] + internal.inf_12[shared->dim_inf_12_1 * (j - 1) + i - 1] + internal.inf_32[shared->dim_inf_32_1 * (j - 1) + i - 1] + internal.inf_42[shared->dim_inf_42_1 * (j - 1) + i - 1] + internal.inf_13[shared->dim_inf_13_1 * (j - 1) + i - 1] + internal.inf_23[shared->dim_inf_23_1 * (j - 1) + i - 1] + internal.inf_43[shared->dim_inf_43_1 * (j - 1) + i - 1] + internal.inf_14[shared->dim_inf_14_1 * (j - 1) + i - 1] + internal.inf_24[shared->dim_inf_24_1 * (j - 1) + i - 1] + internal.inf_34[shared->dim_inf_34_1 * (j - 1) + i - 1];
      }
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      int j = 1;
      internal.infV_3[i - 1 + shared->dim_infV_3_1 * (j - 1)] = internal.inf_3[shared->dim_inf_3_1 * (j - 1) + i - 1] + shared->nnveai[j - 1] * internal.inf_3[shared->dim_inf_3_1 * 1 + i - 1];
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      int j = 2;
      internal.infV_3[i - 1 + shared->dim_infV_3_1 * (j - 1)] = shared->nveai[j - 1] * internal.inf_3[shared->dim_inf_3_1 * (j - 1) + i - 1];
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      int j = 3;
      internal.infV_3[i - 1 + shared->dim_infV_3_1 * (j - 1)] = internal.inf_3[shared->dim_inf_3_1 * (j - 1) + i - 1];
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      for (int j = 1; j <= 3; ++j) {
        internal.n_I12[i - 1 + shared->dim_n_I12_1 * (j - 1)] = internal.nvacc_I12[shared->dim_nvacc_I12_1 * (j - 1) + i - 1] + I12[shared->dim_I12_1 * (j - 1) + i - 1] - internal.O_I12[shared->dim_O_I12_1 * (j - 1) + i - 1] + internal.inf_12[shared->dim_inf_12_1 * (j - 1) + i - 1] - internal.age_I12[shared->dim_age_I12_1 * (j - 1) + i + 1 - 1];
      }
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      for (int j = 1; j <= 3; ++j) {
        internal.n_I123[i - 1 + shared->dim_n_I123_1 * (j - 1)] = internal.nvacc_I123[shared->dim_nvacc_I123_1 * (j - 1) + i - 1] + I123[shared->dim_I123_1 * (j - 1) + i - 1] - internal.O_I123[shared->dim_O_I123_1 * (j - 1) + i - 1] + internal.inf_123[shared->dim_inf_123_1 * (j - 1) + i - 1] - internal.age_I123[shared->dim_age_I123_1 * (j - 1) + i + 1 - 1];
      }
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      for (int j = 1; j <= 3; ++j) {
        internal.n_I1234[i - 1 + shared->dim_n_I1234_1 * (j - 1)] = internal.nvacc_I1234[shared->dim_nvacc_I1234_1 * (j - 1) + i - 1] + I1234[shared->dim_I1234_1 * (j - 1) + i - 1] - internal.O_I1234[shared->dim_O_I1234_1 * (j - 1) + i - 1] + internal.inf_1234[shared->dim_inf_1234_1 * (j - 1) + i - 1] - internal.age_I1234[shared->dim_age_I1234_1 * (j - 1) + i + 1 - 1];
      }
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      for (int j = 1; j <= 3; ++j) {
        internal.n_I1243[i - 1 + shared->dim_n_I1243_1 * (j - 1)] = internal.nvacc_I1243[shared->dim_nvacc_I1243_1 * (j - 1) + i - 1] + I1243[shared->dim_I1243_1 * (j - 1) + i - 1] - internal.O_I1243[shared->dim_O_I1243_1 * (j - 1) + i - 1] + internal.inf_1243[shared->dim_inf_1243_1 * (j - 1) + i - 1] - internal.age_I1243[shared->dim_age_I1243_1 * (j - 1) + i + 1 - 1];
      }
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      for (int j = 1; j <= 3; ++j) {
        internal.n_I132[i - 1 + shared->dim_n_I132_1 * (j - 1)] = internal.nvacc_I132[shared->dim_nvacc_I132_1 * (j - 1) + i - 1] + I132[shared->dim_I132_1 * (j - 1) + i - 1] - internal.O_I132[shared->dim_O_I132_1 * (j - 1) + i - 1] + internal.inf_132[shared->dim_inf_132_1 * (j - 1) + i - 1] - internal.age_I132[shared->dim_age_I132_1 * (j - 1) + i + 1 - 1];
      }
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      for (int j = 1; j <= 3; ++j) {
        internal.n_I1342[i - 1 + shared->dim_n_I1342_1 * (j - 1)] = internal.nvacc_I1342[shared->dim_nvacc_I1342_1 * (j - 1) + i - 1] + I1342[shared->dim_I1342_1 * (j - 1) + i - 1] - internal.O_I1342[shared->dim_O_I1342_1 * (j - 1) + i - 1] + internal.inf_1342[shared->dim_inf_1342_1 * (j - 1) + i - 1] - internal.age_I1342[shared->dim_age_I1342_1 * (j - 1) + i + 1 - 1];
      }
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      for (int j = 1; j <= 3; ++j) {
        internal.n_I142[i - 1 + shared->dim_n_I142_1 * (j - 1)] = internal.nvacc_I142[shared->dim_nvacc_I142_1 * (j - 1) + i - 1] + I142[shared->dim_I142_1 * (j - 1) + i - 1] - internal.O_I142[shared->dim_O_I142_1 * (j - 1) + i - 1] + internal.inf_142[shared->dim_inf_142_1 * (j - 1) + i - 1] - internal.age_I142[shared->dim_age_I142_1 * (j - 1) + i + 1 - 1];
      }
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      for (int j = 1; j <= 3; ++j) {
        internal.n_I21[i - 1 + shared->dim_n_I21_1 * (j - 1)] = internal.nvacc_I21[shared->dim_nvacc_I21_1 * (j - 1) + i - 1] + I21[shared->dim_I21_1 * (j - 1) + i - 1] - internal.O_I21[shared->dim_O_I21_1 * (j - 1) + i - 1] + internal.inf_21[shared->dim_inf_21_1 * (j - 1) + i - 1] - internal.age_I21[shared->dim_age_I21_1 * (j - 1) + i + 1 - 1];
      }
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      for (int j = 1; j <= 3; ++j) {
        internal.n_I231[i - 1 + shared->dim_n_I231_1 * (j - 1)] = internal.nvacc_I231[shared->dim_nvacc_I231_1 * (j - 1) + i - 1] + I231[shared->dim_I231_1 * (j - 1) + i - 1] - internal.O_I231[shared->dim_O_I231_1 * (j - 1) + i - 1] + internal.inf_231[shared->dim_inf_231_1 * (j - 1) + i - 1] - internal.age_I231[shared->dim_age_I231_1 * (j - 1) + i + 1 - 1];
      }
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      for (int j = 1; j <= 3; ++j) {
        internal.n_I2341[i - 1 + shared->dim_n_I2341_1 * (j - 1)] = internal.nvacc_I2341[shared->dim_nvacc_I2341_1 * (j - 1) + i - 1] + I2341[shared->dim_I2341_1 * (j - 1) + i - 1] - internal.O_I2341[shared->dim_O_I2341_1 * (j - 1) + i - 1] + internal.inf_2341[shared->dim_inf_2341_1 * (j - 1) + i - 1] - internal.age_I2341[shared->dim_age_I2341_1 * (j - 1) + i + 1 - 1];
      }
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      for (int j = 1; j <= 3; ++j) {
        internal.n_I241[i - 1 + shared->dim_n_I241_1 * (j - 1)] = internal.nvacc_I241[shared->dim_nvacc_I241_1 * (j - 1) + i - 1] + I241[shared->dim_I241_1 * (j - 1) + i - 1] - internal.O_I241[shared->dim_O_I241_1 * (j - 1) + i - 1] + internal.inf_241[shared->dim_inf_241_1 * (j - 1) + i - 1] - internal.age_I241[shared->dim_age_I241_1 * (j - 1) + i + 1 - 1];
      }
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      for (int j = 1; j <= 3; ++j) {
        internal.n_I31[i - 1 + shared->dim_n_I31_1 * (j - 1)] = internal.nvacc_I31[shared->dim_nvacc_I31_1 * (j - 1) + i - 1] + I31[shared->dim_I31_1 * (j - 1) + i - 1] - internal.O_I31[shared->dim_O_I31_1 * (j - 1) + i - 1] + internal.inf_31[shared->dim_inf_31_1 * (j - 1) + i - 1] - internal.age_I31[shared->dim_age_I31_1 * (j - 1) + i + 1 - 1];
      }
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      for (int j = 1; j <= 3; ++j) {
        internal.n_I341[i - 1 + shared->dim_n_I341_1 * (j - 1)] = internal.nvacc_I341[shared->dim_nvacc_I341_1 * (j - 1) + i - 1] + I341[shared->dim_I341_1 * (j - 1) + i - 1] - internal.O_I341[shared->dim_O_I341_1 * (j - 1) + i - 1] + internal.inf_341[shared->dim_inf_341_1 * (j - 1) + i - 1] - internal.age_I341[shared->dim_age_I341_1 * (j - 1) + i + 1 - 1];
      }
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      for (int j = 1; j <= 3; ++j) {
        internal.n_I41[i - 1 + shared->dim_n_I41_1 * (j - 1)] = internal.nvacc_I41[shared->dim_nvacc_I41_1 * (j - 1) + i - 1] + I41[shared->dim_I41_1 * (j - 1) + i - 1] - internal.O_I41[shared->dim_O_I41_1 * (j - 1) + i - 1] + internal.inf_41[shared->dim_inf_41_1 * (j - 1) + i - 1] - internal.age_I41[shared->dim_age_I41_1 * (j - 1) + i + 1 - 1];
      }
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      internal.ncu_R1[i - 1] = dust::random::binomial<real_type>(rng_state, internal.n_R1[shared->dim_n_R1_1 * 0 + i - 1], internal.vcu_noncov[shared->dim_vcu_noncov_1 * 0 + i - 1]);
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      internal.ncu_R12[i - 1] = dust::random::binomial<real_type>(rng_state, internal.n_R12[shared->dim_n_R12_1 * 0 + i - 1], internal.vcu_noncov[shared->dim_vcu_noncov_1 * 0 + i - 1]);
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      internal.ncu_R123[i - 1] = dust::random::binomial<real_type>(rng_state, internal.n_R123[shared->dim_n_R123_1 * 0 + i - 1], internal.vcu_noncov[shared->dim_vcu_noncov_1 * 0 + i - 1]);
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      internal.ncu_R124[i - 1] = dust::random::binomial<real_type>(rng_state, internal.n_R124[shared->dim_n_R124_1 * 0 + i - 1], internal.vcu_noncov[shared->dim_vcu_noncov_1 * 0 + i - 1]);
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      internal.ncu_R13[i - 1] = dust::random::binomial<real_type>(rng_state, internal.n_R13[shared->dim_n_R13_1 * 0 + i - 1], internal.vcu_noncov[shared->dim_vcu_noncov_1 * 0 + i - 1]);
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      internal.ncu_R134[i - 1] = dust::random::binomial<real_type>(rng_state, internal.n_R134[shared->dim_n_R134_1 * 0 + i - 1], internal.vcu_noncov[shared->dim_vcu_noncov_1 * 0 + i - 1]);
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      internal.ncu_R14[i - 1] = dust::random::binomial<real_type>(rng_state, internal.n_R14[shared->dim_n_R14_1 * 0 + i - 1], internal.vcu_noncov[shared->dim_vcu_noncov_1 * 0 + i - 1]);
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      internal.ncu_R2[i - 1] = dust::random::binomial<real_type>(rng_state, internal.n_R2[shared->dim_n_R2_1 * 0 + i - 1], internal.vcu_noncov[shared->dim_vcu_noncov_1 * 0 + i - 1]);
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      internal.ncu_R23[i - 1] = dust::random::binomial<real_type>(rng_state, internal.n_R23[shared->dim_n_R23_1 * 0 + i - 1], internal.vcu_noncov[shared->dim_vcu_noncov_1 * 0 + i - 1]);
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      internal.ncu_R234[i - 1] = dust::random::binomial<real_type>(rng_state, internal.n_R234[shared->dim_n_R234_1 * 0 + i - 1], internal.vcu_noncov[shared->dim_vcu_noncov_1 * 0 + i - 1]);
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      internal.ncu_R24[i - 1] = dust::random::binomial<real_type>(rng_state, internal.n_R24[shared->dim_n_R24_1 * 0 + i - 1], internal.vcu_noncov[shared->dim_vcu_noncov_1 * 0 + i - 1]);
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      internal.ncu_R3[i - 1] = dust::random::binomial<real_type>(rng_state, internal.n_R3[shared->dim_n_R3_1 * 0 + i - 1], internal.vcu_noncov[shared->dim_vcu_noncov_1 * 0 + i - 1]);
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      internal.ncu_R34[i - 1] = dust::random::binomial<real_type>(rng_state, internal.n_R34[shared->dim_n_R34_1 * 0 + i - 1], internal.vcu_noncov[shared->dim_vcu_noncov_1 * 0 + i - 1]);
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      internal.ncu_R4[i - 1] = dust::random::binomial<real_type>(rng_state, internal.n_R4[shared->dim_n_R4_1 * 0 + i - 1], internal.vcu_noncov[shared->dim_vcu_noncov_1 * 0 + i - 1]);
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      internal.ncu_S[i - 1] = dust::random::binomial<real_type>(rng_state, internal.n_S[shared->dim_n_S_1 * 0 + i - 1], internal.vcu_noncov_S[shared->dim_vcu_noncov_S_1 * 0 + i - 1]);
    }
    for (int i = 2; i <= shared->N_age; ++i) {
      int j = 1;
      internal.nvacc_I1[i - 1 + shared->dim_nvacc_I1_1 * (j - 1)] = dust::random::binomial<real_type>(rng_state, internal.age_I1[shared->dim_age_I1_1 * (j - 1) + i - 1], internal.vacc_noncov[shared->dim_vacc_noncov_1 * (j - 1) + i - 1]);
    }
    {
       int i = 1;
       int j = 1;
       internal.nvacc_I1[i - 1 + shared->dim_nvacc_I1_1 * (j - 1)] = 0;
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      int j = 2;
      internal.nvacc_I1[i - 1 + shared->dim_nvacc_I1_1 * (j - 1)] = internal.age_I1[shared->dim_age_I1_1 * (j - 1) + i - 1] + internal.age_I1[shared->dim_age_I1_1 * 0 + i - 1] - internal.nvacc_I1[shared->dim_nvacc_I1_1 * 0 + i - 1];
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      int j = 3;
      internal.nvacc_I1[i - 1 + shared->dim_nvacc_I1_1 * (j - 1)] = internal.age_I1[shared->dim_age_I1_1 * (j - 1) + i - 1];
    }
    for (int i = 2; i <= shared->N_age; ++i) {
      int j = 1;
      internal.nvacc_I124[i - 1 + shared->dim_nvacc_I124_1 * (j - 1)] = dust::random::binomial<real_type>(rng_state, internal.age_I124[shared->dim_age_I124_1 * (j - 1) + i - 1], internal.vacc_noncov[shared->dim_vacc_noncov_1 * (j - 1) + i - 1]);
    }
    {
       int i = 1;
       int j = 1;
       internal.nvacc_I124[i - 1 + shared->dim_nvacc_I124_1 * (j - 1)] = 0;
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      int j = 2;
      internal.nvacc_I124[i - 1 + shared->dim_nvacc_I124_1 * (j - 1)] = internal.age_I124[shared->dim_age_I124_1 * (j - 1) + i - 1] + internal.age_I124[shared->dim_age_I124_1 * 0 + i - 1] - internal.nvacc_I124[shared->dim_nvacc_I124_1 * 0 + i - 1];
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      int j = 3;
      internal.nvacc_I124[i - 1 + shared->dim_nvacc_I124_1 * (j - 1)] = internal.age_I124[shared->dim_age_I124_1 * (j - 1) + i - 1];
    }
    for (int i = 2; i <= shared->N_age; ++i) {
      int j = 1;
      internal.nvacc_I13[i - 1 + shared->dim_nvacc_I13_1 * (j - 1)] = dust::random::binomial<real_type>(rng_state, internal.age_I13[shared->dim_age_I13_1 * (j - 1) + i - 1], internal.vacc_noncov[shared->dim_vacc_noncov_1 * (j - 1) + i - 1]);
    }
    {
       int i = 1;
       int j = 1;
       internal.nvacc_I13[i - 1 + shared->dim_nvacc_I13_1 * (j - 1)] = 0;
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      int j = 2;
      internal.nvacc_I13[i - 1 + shared->dim_nvacc_I13_1 * (j - 1)] = internal.age_I13[shared->dim_age_I13_1 * (j - 1) + i - 1] + internal.age_I13[shared->dim_age_I13_1 * 0 + i - 1] - internal.nvacc_I13[shared->dim_nvacc_I13_1 * 0 + i - 1];
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      int j = 3;
      internal.nvacc_I13[i - 1 + shared->dim_nvacc_I13_1 * (j - 1)] = internal.age_I13[shared->dim_age_I13_1 * (j - 1) + i - 1];
    }
    for (int i = 2; i <= shared->N_age; ++i) {
      int j = 1;
      internal.nvacc_I134[i - 1 + shared->dim_nvacc_I134_1 * (j - 1)] = dust::random::binomial<real_type>(rng_state, internal.age_I134[shared->dim_age_I134_1 * (j - 1) + i - 1], internal.vacc_noncov[shared->dim_vacc_noncov_1 * (j - 1) + i - 1]);
    }
    {
       int i = 1;
       int j = 1;
       internal.nvacc_I134[i - 1 + shared->dim_nvacc_I134_1 * (j - 1)] = 0;
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      int j = 2;
      internal.nvacc_I134[i - 1 + shared->dim_nvacc_I134_1 * (j - 1)] = internal.age_I134[shared->dim_age_I134_1 * (j - 1) + i - 1] + internal.age_I134[shared->dim_age_I134_1 * 0 + i - 1] - internal.nvacc_I134[shared->dim_nvacc_I134_1 * 0 + i - 1];
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      int j = 3;
      internal.nvacc_I134[i - 1 + shared->dim_nvacc_I134_1 * (j - 1)] = internal.age_I134[shared->dim_age_I134_1 * (j - 1) + i - 1];
    }
    for (int i = 2; i <= shared->N_age; ++i) {
      int j = 1;
      internal.nvacc_I143[i - 1 + shared->dim_nvacc_I143_1 * (j - 1)] = dust::random::binomial<real_type>(rng_state, internal.age_I143[shared->dim_age_I143_1 * (j - 1) + i - 1], internal.vacc_noncov[shared->dim_vacc_noncov_1 * (j - 1) + i - 1]);
    }
    {
       int i = 1;
       int j = 1;
       internal.nvacc_I143[i - 1 + shared->dim_nvacc_I143_1 * (j - 1)] = 0;
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      int j = 2;
      internal.nvacc_I143[i - 1 + shared->dim_nvacc_I143_1 * (j - 1)] = internal.age_I143[shared->dim_age_I143_1 * (j - 1) + i - 1] + internal.age_I143[shared->dim_age_I143_1 * 0 + i - 1] - internal.nvacc_I143[shared->dim_nvacc_I143_1 * 0 + i - 1];
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      int j = 3;
      internal.nvacc_I143[i - 1 + shared->dim_nvacc_I143_1 * (j - 1)] = internal.age_I143[shared->dim_age_I143_1 * (j - 1) + i - 1];
    }
    for (int i = 2; i <= shared->N_age; ++i) {
      int j = 1;
      internal.nvacc_I23[i - 1 + shared->dim_nvacc_I23_1 * (j - 1)] = dust::random::binomial<real_type>(rng_state, internal.age_I23[shared->dim_age_I23_1 * (j - 1) + i - 1], internal.vacc_noncov[shared->dim_vacc_noncov_1 * (j - 1) + i - 1]);
    }
    {
       int i = 1;
       int j = 1;
       internal.nvacc_I23[i - 1 + shared->dim_nvacc_I23_1 * (j - 1)] = 0;
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      int j = 2;
      internal.nvacc_I23[i - 1 + shared->dim_nvacc_I23_1 * (j - 1)] = internal.age_I23[shared->dim_age_I23_1 * (j - 1) + i - 1] + internal.age_I23[shared->dim_age_I23_1 * 0 + i - 1] - internal.nvacc_I23[shared->dim_nvacc_I23_1 * 0 + i - 1];
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      int j = 3;
      internal.nvacc_I23[i - 1 + shared->dim_nvacc_I23_1 * (j - 1)] = internal.age_I23[shared->dim_age_I23_1 * (j - 1) + i - 1];
    }
    for (int i = 2; i <= shared->N_age; ++i) {
      int j = 1;
      internal.nvacc_I234[i - 1 + shared->dim_nvacc_I234_1 * (j - 1)] = dust::random::binomial<real_type>(rng_state, internal.age_I234[shared->dim_age_I234_1 * (j - 1) + i - 1], internal.vacc_noncov[shared->dim_vacc_noncov_1 * (j - 1) + i - 1]);
    }
    {
       int i = 1;
       int j = 1;
       internal.nvacc_I234[i - 1 + shared->dim_nvacc_I234_1 * (j - 1)] = 0;
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      int j = 2;
      internal.nvacc_I234[i - 1 + shared->dim_nvacc_I234_1 * (j - 1)] = internal.age_I234[shared->dim_age_I234_1 * (j - 1) + i - 1] + internal.age_I234[shared->dim_age_I234_1 * 0 + i - 1] - internal.nvacc_I234[shared->dim_nvacc_I234_1 * 0 + i - 1];
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      int j = 3;
      internal.nvacc_I234[i - 1 + shared->dim_nvacc_I234_1 * (j - 1)] = internal.age_I234[shared->dim_age_I234_1 * (j - 1) + i - 1];
    }
    for (int i = 2; i <= shared->N_age; ++i) {
      int j = 1;
      internal.nvacc_I243[i - 1 + shared->dim_nvacc_I243_1 * (j - 1)] = dust::random::binomial<real_type>(rng_state, internal.age_I243[shared->dim_age_I243_1 * (j - 1) + i - 1], internal.vacc_noncov[shared->dim_vacc_noncov_1 * (j - 1) + i - 1]);
    }
    {
       int i = 1;
       int j = 1;
       internal.nvacc_I243[i - 1 + shared->dim_nvacc_I243_1 * (j - 1)] = 0;
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      int j = 2;
      internal.nvacc_I243[i - 1 + shared->dim_nvacc_I243_1 * (j - 1)] = internal.age_I243[shared->dim_age_I243_1 * (j - 1) + i - 1] + internal.age_I243[shared->dim_age_I243_1 * 0 + i - 1] - internal.nvacc_I243[shared->dim_nvacc_I243_1 * 0 + i - 1];
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      int j = 3;
      internal.nvacc_I243[i - 1 + shared->dim_nvacc_I243_1 * (j - 1)] = internal.age_I243[shared->dim_age_I243_1 * (j - 1) + i - 1];
    }
    for (int i = 2; i <= shared->N_age; ++i) {
      int j = 1;
      internal.nvacc_I32[i - 1 + shared->dim_nvacc_I32_1 * (j - 1)] = dust::random::binomial<real_type>(rng_state, internal.age_I32[shared->dim_age_I32_1 * (j - 1) + i - 1], internal.vacc_noncov[shared->dim_vacc_noncov_1 * (j - 1) + i - 1]);
    }
    {
       int i = 1;
       int j = 1;
       internal.nvacc_I32[i - 1 + shared->dim_nvacc_I32_1 * (j - 1)] = 0;
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      int j = 2;
      internal.nvacc_I32[i - 1 + shared->dim_nvacc_I32_1 * (j - 1)] = internal.age_I32[shared->dim_age_I32_1 * (j - 1) + i - 1] + internal.age_I32[shared->dim_age_I32_1 * 0 + i - 1] - internal.nvacc_I32[shared->dim_nvacc_I32_1 * 0 + i - 1];
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      int j = 3;
      internal.nvacc_I32[i - 1 + shared->dim_nvacc_I32_1 * (j - 1)] = internal.age_I32[shared->dim_age_I32_1 * (j - 1) + i - 1];
    }
    for (int i = 2; i <= shared->N_age; ++i) {
      int j = 1;
      internal.nvacc_I342[i - 1 + shared->dim_nvacc_I342_1 * (j - 1)] = dust::random::binomial<real_type>(rng_state, internal.age_I342[shared->dim_age_I342_1 * (j - 1) + i - 1], internal.vacc_noncov[shared->dim_vacc_noncov_1 * (j - 1) + i - 1]);
    }
    {
       int i = 1;
       int j = 1;
       internal.nvacc_I342[i - 1 + shared->dim_nvacc_I342_1 * (j - 1)] = 0;
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      int j = 2;
      internal.nvacc_I342[i - 1 + shared->dim_nvacc_I342_1 * (j - 1)] = internal.age_I342[shared->dim_age_I342_1 * (j - 1) + i - 1] + internal.age_I342[shared->dim_age_I342_1 * 0 + i - 1] - internal.nvacc_I342[shared->dim_nvacc_I342_1 * 0 + i - 1];
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      int j = 3;
      internal.nvacc_I342[i - 1 + shared->dim_nvacc_I342_1 * (j - 1)] = internal.age_I342[shared->dim_age_I342_1 * (j - 1) + i - 1];
    }
    for (int i = 2; i <= shared->N_age; ++i) {
      int j = 1;
      internal.nvacc_I42[i - 1 + shared->dim_nvacc_I42_1 * (j - 1)] = dust::random::binomial<real_type>(rng_state, internal.age_I42[shared->dim_age_I42_1 * (j - 1) + i - 1], internal.vacc_noncov[shared->dim_vacc_noncov_1 * (j - 1) + i - 1]);
    }
    {
       int i = 1;
       int j = 1;
       internal.nvacc_I42[i - 1 + shared->dim_nvacc_I42_1 * (j - 1)] = 0;
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      int j = 2;
      internal.nvacc_I42[i - 1 + shared->dim_nvacc_I42_1 * (j - 1)] = internal.age_I42[shared->dim_age_I42_1 * (j - 1) + i - 1] + internal.age_I42[shared->dim_age_I42_1 * 0 + i - 1] - internal.nvacc_I42[shared->dim_nvacc_I42_1 * 0 + i - 1];
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      int j = 3;
      internal.nvacc_I42[i - 1 + shared->dim_nvacc_I42_1 * (j - 1)] = internal.age_I42[shared->dim_age_I42_1 * (j - 1) + i - 1];
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      state_next[shared->offset_variable_cum_infection_tq + i - 1] = cum_infection_tq[i - 1] + internal.infection_tq[shared->dim_infection_tq_1 * 0 + i - 1] + internal.infection_tq[shared->dim_infection_tq_1 * 1 + i - 1] + internal.infection_tq[shared->dim_infection_tq_1 * 2 + i - 1];
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      state_next[shared->offset_variable_cum_infection_tqV + i - 1] = cum_infection_tqV[i - 1] + internal.infection_tq[shared->dim_infection_tq_1 * 1 + i - 1] + internal.infection_tq[shared->dim_infection_tq_1 * 2 + i - 1];
    }
    state_next[31] = exposed1 + Y1T - exposed1 * shared->DT / (real_type) shared->incub;
    state_next[27] = Y1T;
    for (int i = 1; i <= shared->N_age; ++i) {
      internal.vw_R1[i - 1] = dust::random::binomial<real_type>(rng_state, internal.n_R1[shared->dim_n_R1_1 * 1 + i - 1], shared->vacc_decay);
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      internal.vw_R12[i - 1] = dust::random::binomial<real_type>(rng_state, internal.n_R12[shared->dim_n_R12_1 * 1 + i - 1], shared->vacc_decay);
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      internal.vw_R123[i - 1] = dust::random::binomial<real_type>(rng_state, internal.n_R123[shared->dim_n_R123_1 * 1 + i - 1], shared->vacc_decay);
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      internal.vw_R124[i - 1] = dust::random::binomial<real_type>(rng_state, internal.n_R124[shared->dim_n_R124_1 * 1 + i - 1], shared->vacc_decay);
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      internal.vw_R13[i - 1] = dust::random::binomial<real_type>(rng_state, internal.n_R13[shared->dim_n_R13_1 * 1 + i - 1], shared->vacc_decay);
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      internal.vw_R134[i - 1] = dust::random::binomial<real_type>(rng_state, internal.n_R134[shared->dim_n_R134_1 * 1 + i - 1], shared->vacc_decay);
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      internal.vw_R14[i - 1] = dust::random::binomial<real_type>(rng_state, internal.n_R14[shared->dim_n_R14_1 * 1 + i - 1], shared->vacc_decay);
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      internal.vw_R2[i - 1] = dust::random::binomial<real_type>(rng_state, internal.n_R2[shared->dim_n_R2_1 * 1 + i - 1], shared->vacc_decay);
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      internal.vw_R23[i - 1] = dust::random::binomial<real_type>(rng_state, internal.n_R23[shared->dim_n_R23_1 * 1 + i - 1], shared->vacc_decay);
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      internal.vw_R234[i - 1] = dust::random::binomial<real_type>(rng_state, internal.n_R234[shared->dim_n_R234_1 * 1 + i - 1], shared->vacc_decay);
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      internal.vw_R24[i - 1] = dust::random::binomial<real_type>(rng_state, internal.n_R24[shared->dim_n_R24_1 * 1 + i - 1], shared->vacc_decay);
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      internal.vw_R3[i - 1] = dust::random::binomial<real_type>(rng_state, internal.n_R3[shared->dim_n_R3_1 * 1 + i - 1], shared->vacc_decay);
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      internal.vw_R34[i - 1] = dust::random::binomial<real_type>(rng_state, internal.n_R34[shared->dim_n_R34_1 * 1 + i - 1], shared->vacc_decay);
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      internal.vw_R4[i - 1] = dust::random::binomial<real_type>(rng_state, internal.n_R4[shared->dim_n_R4_1 * 1 + i - 1], shared->vacc_decay);
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      internal.vw_S[i - 1] = dust::random::binomial<real_type>(rng_state, internal.n_S[shared->dim_n_S_1 * 1 + i - 1], shared->vaccS_decay);
    }
    real_type Y2T = odin_sum1<real_type>(internal.Y2.data(), 0, shared->dim_Y2) / (real_type) NT;
    for (int i = 1; i <= shared->N_age; ++i) {
      int j = 1;
      internal.Y3[i - 1 + shared->dim_Y3_1 * (j - 1)] = shared->phi_pri[2] * (1 + shared->dis_pri[2] * shared->phi_ed) * internal.inf_3[shared->dim_inf_3_1 * (j - 1) + i - 1] + shared->phi_sec[2] * (1 + shared->dis_sec[2] * shared->phi_ed) * (internal.inf_13[shared->dim_inf_13_1 * (j - 1) + i - 1] + internal.inf_23[shared->dim_inf_23_1 * (j - 1) + i - 1] + internal.inf_43[shared->dim_inf_43_1 * (j - 1) + i - 1]) + shared->phi_tert[2] * (1 + shared->dis_tert[2] * shared->phi_ed) * (internal.inf_123[shared->dim_inf_123_1 * (j - 1) + i - 1] + internal.inf_143[shared->dim_inf_143_1 * (j - 1) + i - 1] + internal.inf_243[shared->dim_inf_243_1 * (j - 1) + i - 1]) + shared->phi_quart[2] * (1 + shared->dis_quart[2] * shared->phi_ed) * internal.inf_1243[shared->dim_inf_1243_1 * (j - 1) + i - 1];
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      for (int j = 2; j <= 3; ++j) {
        internal.Y3[i - 1 + shared->dim_Y3_1 * (j - 1)] = shared->phi_pri[2] * (1 + shared->dis_pri[2] * internal.RR_dis[shared->dim_RR_dis_12 * (i - 1) + shared->dim_RR_dis_1 * 0 + 2] * shared->phi_ed) * internal.inf_3[shared->dim_inf_3_1 * (j - 1) + i - 1] + shared->phi_sec[2] * (1 + shared->dis_sec[2] * internal.RR_dis[shared->dim_RR_dis_12 * (i - 1) + shared->dim_RR_dis_1 * 1 + 2] * shared->phi_ed) * (internal.inf_13[shared->dim_inf_13_1 * (j - 1) + i - 1] + internal.inf_23[shared->dim_inf_23_1 * (j - 1) + i - 1] + internal.inf_43[shared->dim_inf_43_1 * (j - 1) + i - 1]) + shared->phi_tert[2] * (1 + shared->dis_tert[2] * internal.RR_dis[shared->dim_RR_dis_12 * (i - 1) + shared->dim_RR_dis_1 * 1 + 2] * shared->phi_ed) * (internal.inf_123[shared->dim_inf_123_1 * (j - 1) + i - 1] + internal.inf_143[shared->dim_inf_143_1 * (j - 1) + i - 1] + internal.inf_243[shared->dim_inf_243_1 * (j - 1) + i - 1]) + shared->phi_quart[2] * (1 + shared->dis_quart[2] * internal.RR_dis[shared->dim_RR_dis_12 * (i - 1) + shared->dim_RR_dis_1 * 1 + 2] * shared->phi_ed) * internal.inf_1243[shared->dim_inf_1243_1 * (j - 1) + i - 1];
      }
    }
    for (int i = 2; i <= shared->N_age_p1; ++i) {
      for (int j = 1; j <= 3; ++j) {
        internal.age_I3[i - 1 + shared->dim_age_I3_1 * (j - 1)] = dust::random::binomial<real_type>(rng_state, (I3[shared->dim_I3_1 * (j - 1) + i - 1 - 1] - internal.O_I3[shared->dim_O_I3_1 * (j - 1) + i - 1 - 1] + internal.infV_3[shared->dim_infV_3_1 * (j - 1) + i - 1 - 1]), internal.agert[i - 1 - 1]);
      }
    }
    {
       int i = 1;
       for (int j = 1; j <= 3; ++j) {
         internal.age_I3[i - 1 + shared->dim_age_I3_1 * (j - 1)] = 0;
       }
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      int j = 1;
      int k = 1;
      internal.disease_sero[i - 1 + shared->dim_disease_sero_1 * (j - 1) + shared->dim_disease_sero_12 * (k - 1)] = shared->dis_pri[0] * internal.inf_1[shared->dim_inf_1_1 * (j - 1) + i - 1] + shared->dis_sec[0] * (internal.inf_21[shared->dim_inf_21_1 * (j - 1) + i - 1] + internal.inf_31[shared->dim_inf_31_1 * (j - 1) + i - 1] + internal.inf_41[shared->dim_inf_41_1 * (j - 1) + i - 1]) + shared->dis_tert[0] * (internal.inf_231[shared->dim_inf_231_1 * (j - 1) + i - 1] + internal.inf_241[shared->dim_inf_241_1 * (j - 1) + i - 1] + internal.inf_341[shared->dim_inf_341_1 * (j - 1) + i - 1]) + shared->dis_quart[0] * internal.inf_2341[shared->dim_inf_2341_1 * (j - 1) + i - 1];
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      for (int j = 2; j <= 3; ++j) {
        int k = 1;
        internal.disease_sero[i - 1 + shared->dim_disease_sero_1 * (j - 1) + shared->dim_disease_sero_12 * (k - 1)] = internal.RR_dis[shared->dim_RR_dis_12 * (i - 1) + shared->dim_RR_dis_1 * 0 + 0] * shared->dis_pri[0] * internal.inf_1[shared->dim_inf_1_1 * (j - 1) + i - 1] + internal.RR_dis[shared->dim_RR_dis_12 * (i - 1) + shared->dim_RR_dis_1 * 1 + 0] * (shared->dis_sec[0] * (internal.inf_21[shared->dim_inf_21_1 * (j - 1) + i - 1] + internal.inf_31[shared->dim_inf_31_1 * (j - 1) + i - 1] + internal.inf_41[shared->dim_inf_41_1 * (j - 1) + i - 1]) + shared->dis_tert[0] * (internal.inf_231[shared->dim_inf_231_1 * (j - 1) + i - 1] + internal.inf_241[shared->dim_inf_241_1 * (j - 1) + i - 1] + internal.inf_341[shared->dim_inf_341_1 * (j - 1) + i - 1]) + shared->dis_quart[0] * internal.inf_2341[shared->dim_inf_2341_1 * (j - 1) + i - 1]);
      }
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      int j = 1;
      int k = 2;
      internal.disease_sero[i - 1 + shared->dim_disease_sero_1 * (j - 1) + shared->dim_disease_sero_12 * (k - 1)] = shared->dis_pri[1] * internal.inf_2[shared->dim_inf_2_1 * (j - 1) + i - 1] + shared->dis_sec[1] * (internal.inf_12[shared->dim_inf_12_1 * (j - 1) + i - 1] + internal.inf_32[shared->dim_inf_32_1 * (j - 1) + i - 1] + internal.inf_42[shared->dim_inf_42_1 * (j - 1) + i - 1]) + shared->dis_tert[1] * (internal.inf_132[shared->dim_inf_132_1 * (j - 1) + i - 1] + internal.inf_142[shared->dim_inf_142_1 * (j - 1) + i - 1] + internal.inf_342[shared->dim_inf_342_1 * (j - 1) + i - 1]) + shared->dis_quart[1] * internal.inf_1342[shared->dim_inf_1342_1 * (j - 1) + i - 1];
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      for (int j = 2; j <= 3; ++j) {
        int k = 2;
        internal.disease_sero[i - 1 + shared->dim_disease_sero_1 * (j - 1) + shared->dim_disease_sero_12 * (k - 1)] = internal.RR_dis[shared->dim_RR_dis_12 * (i - 1) + shared->dim_RR_dis_1 * 0 + 1] * shared->dis_pri[1] * internal.inf_2[shared->dim_inf_2_1 * (j - 1) + i - 1] + internal.RR_dis[shared->dim_RR_dis_12 * (i - 1) + shared->dim_RR_dis_1 * 1 + 1] * (shared->dis_sec[1] * (internal.inf_12[shared->dim_inf_12_1 * (j - 1) + i - 1] + internal.inf_32[shared->dim_inf_32_1 * (j - 1) + i - 1] + internal.inf_42[shared->dim_inf_42_1 * (j - 1) + i - 1]) + shared->dis_tert[1] * (internal.inf_132[shared->dim_inf_132_1 * (j - 1) + i - 1] + internal.inf_142[shared->dim_inf_142_1 * (j - 1) + i - 1] + internal.inf_342[shared->dim_inf_342_1 * (j - 1) + i - 1]) + shared->dis_quart[1] * internal.inf_1342[shared->dim_inf_1342_1 * (j - 1) + i - 1]);
      }
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      int j = 1;
      int k = 3;
      internal.disease_sero[i - 1 + shared->dim_disease_sero_1 * (j - 1) + shared->dim_disease_sero_12 * (k - 1)] = shared->dis_pri[2] * internal.inf_3[shared->dim_inf_3_1 * (j - 1) + i - 1] + shared->dis_sec[2] * (internal.inf_13[shared->dim_inf_13_1 * (j - 1) + i - 1] + internal.inf_23[shared->dim_inf_23_1 * (j - 1) + i - 1] + internal.inf_43[shared->dim_inf_43_1 * (j - 1) + i - 1]) + shared->dis_tert[2] * (internal.inf_123[shared->dim_inf_123_1 * (j - 1) + i - 1] + internal.inf_143[shared->dim_inf_143_1 * (j - 1) + i - 1] + internal.inf_243[shared->dim_inf_243_1 * (j - 1) + i - 1]) + shared->dis_quart[2] * internal.inf_1243[shared->dim_inf_1243_1 * (j - 1) + i - 1];
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      for (int j = 2; j <= 3; ++j) {
        int k = 3;
        internal.disease_sero[i - 1 + shared->dim_disease_sero_1 * (j - 1) + shared->dim_disease_sero_12 * (k - 1)] = internal.RR_dis[shared->dim_RR_dis_12 * (i - 1) + shared->dim_RR_dis_1 * 0 + 2] * shared->dis_pri[2] * internal.inf_3[shared->dim_inf_3_1 * (j - 1) + i - 1] + internal.RR_dis[shared->dim_RR_dis_12 * (i - 1) + shared->dim_RR_dis_1 * 1 + 2] * (shared->dis_sec[2] * (internal.inf_13[shared->dim_inf_13_1 * (j - 1) + i - 1] + internal.inf_23[shared->dim_inf_23_1 * (j - 1) + i - 1] + internal.inf_43[shared->dim_inf_43_1 * (j - 1) + i - 1]) + shared->dis_tert[2] * (internal.inf_123[shared->dim_inf_123_1 * (j - 1) + i - 1] + internal.inf_143[shared->dim_inf_143_1 * (j - 1) + i - 1] + internal.inf_243[shared->dim_inf_243_1 * (j - 1) + i - 1]) + shared->dis_quart[2] * internal.inf_1243[shared->dim_inf_1243_1 * (j - 1) + i - 1]);
      }
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      int j = 1;
      int k = 4;
      internal.disease_sero[i - 1 + shared->dim_disease_sero_1 * (j - 1) + shared->dim_disease_sero_12 * (k - 1)] = shared->dis_pri[3] * internal.inf_4[shared->dim_inf_4_1 * (j - 1) + i - 1] + shared->dis_sec[3] * (internal.inf_14[shared->dim_inf_14_1 * (j - 1) + i - 1] + internal.inf_24[shared->dim_inf_24_1 * (j - 1) + i - 1] + internal.inf_34[shared->dim_inf_34_1 * (j - 1) + i - 1]) + shared->dis_tert[3] * (internal.inf_124[shared->dim_inf_124_1 * (j - 1) + i - 1] + internal.inf_134[shared->dim_inf_134_1 * (j - 1) + i - 1] + internal.inf_234[shared->dim_inf_234_1 * (j - 1) + i - 1]) + shared->dis_quart[3] * internal.inf_1234[shared->dim_inf_1234_1 * (j - 1) + i - 1];
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      for (int j = 2; j <= 3; ++j) {
        int k = 4;
        internal.disease_sero[i - 1 + shared->dim_disease_sero_1 * (j - 1) + shared->dim_disease_sero_12 * (k - 1)] = internal.RR_dis[shared->dim_RR_dis_12 * (i - 1) + shared->dim_RR_dis_1 * 0 + 3] * shared->dis_pri[3] * internal.inf_4[shared->dim_inf_4_1 * (j - 1) + i - 1] + internal.RR_dis[shared->dim_RR_dis_12 * (i - 1) + shared->dim_RR_dis_1 * 1 + 3] * (shared->dis_sec[3] * (internal.inf_14[shared->dim_inf_14_1 * (j - 1) + i - 1] + internal.inf_24[shared->dim_inf_24_1 * (j - 1) + i - 1] + internal.inf_34[shared->dim_inf_34_1 * (j - 1) + i - 1]) + shared->dis_tert[3] * (internal.inf_124[shared->dim_inf_124_1 * (j - 1) + i - 1] + internal.inf_134[shared->dim_inf_134_1 * (j - 1) + i - 1] + internal.inf_234[shared->dim_inf_234_1 * (j - 1) + i - 1]) + shared->dis_quart[3] * internal.inf_1234[shared->dim_inf_1234_1 * (j - 1) + i - 1]);
      }
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      int j = 1;
      internal.disease_sero_vacc_pri[i - 1 + shared->dim_disease_sero_vacc_pri_1 * (j - 1)] = shared->dis_pri[0] * internal.RR_dis[shared->dim_RR_dis_12 * (i - 1) + shared->dim_RR_dis_1 * 0 + 0] * (internal.inf_1[shared->dim_inf_1_1 * 1 + i - 1] + internal.inf_1[shared->dim_inf_1_1 * 2 + i - 1]);
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      int j = 2;
      internal.disease_sero_vacc_pri[i - 1 + shared->dim_disease_sero_vacc_pri_1 * (j - 1)] = shared->dis_pri[1] * internal.RR_dis[shared->dim_RR_dis_12 * (i - 1) + shared->dim_RR_dis_1 * 0 + 1] * (internal.inf_2[shared->dim_inf_2_1 * 1 + i - 1] + internal.inf_2[shared->dim_inf_2_1 * 2 + i - 1]);
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      int j = 3;
      internal.disease_sero_vacc_pri[i - 1 + shared->dim_disease_sero_vacc_pri_1 * (j - 1)] = shared->dis_pri[2] * internal.RR_dis[shared->dim_RR_dis_12 * (i - 1) + shared->dim_RR_dis_1 * 0 + 2] * (internal.inf_3[shared->dim_inf_3_1 * 1 + i - 1] + internal.inf_3[shared->dim_inf_3_1 * 2 + i - 1]);
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      int j = 4;
      internal.disease_sero_vacc_pri[i - 1 + shared->dim_disease_sero_vacc_pri_1 * (j - 1)] = shared->dis_pri[3] * internal.RR_dis[shared->dim_RR_dis_12 * (i - 1) + shared->dim_RR_dis_1 * 0 + 3] * (internal.inf_4[shared->dim_inf_4_1 * 1 + i - 1] + internal.inf_4[shared->dim_inf_4_1 * 2 + i - 1]);
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      for (int j = 1; j <= 3; ++j) {
        internal.infection_pri[i - 1 + shared->dim_infection_pri_1 * (j - 1)] = internal.inf_1[shared->dim_inf_1_1 * (j - 1) + i - 1] + internal.inf_2[shared->dim_inf_2_1 * (j - 1) + i - 1] + internal.inf_3[shared->dim_inf_3_1 * (j - 1) + i - 1] + internal.inf_4[shared->dim_inf_4_1 * (j - 1) + i - 1];
      }
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      int j = 1;
      internal.infV_4[i - 1 + shared->dim_infV_4_1 * (j - 1)] = internal.inf_4[shared->dim_inf_4_1 * (j - 1) + i - 1] + shared->nnveai[j - 1] * internal.inf_4[shared->dim_inf_4_1 * 1 + i - 1];
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      int j = 2;
      internal.infV_4[i - 1 + shared->dim_infV_4_1 * (j - 1)] = shared->nveai[j - 1] * internal.inf_4[shared->dim_inf_4_1 * (j - 1) + i - 1];
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      int j = 3;
      internal.infV_4[i - 1 + shared->dim_infV_4_1 * (j - 1)] = internal.inf_4[shared->dim_inf_4_1 * (j - 1) + i - 1];
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      for (int j = 1; j <= 3; ++j) {
        internal.n_I1[i - 1 + shared->dim_n_I1_1 * (j - 1)] = internal.nvacc_I1[shared->dim_nvacc_I1_1 * (j - 1) + i - 1] + I1[shared->dim_I1_1 * (j - 1) + i - 1] - internal.O_I1[shared->dim_O_I1_1 * (j - 1) + i - 1] + internal.infV_1[shared->dim_infV_1_1 * (j - 1) + i - 1] - internal.age_I1[shared->dim_age_I1_1 * (j - 1) + i + 1 - 1];
      }
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      for (int j = 1; j <= 3; ++j) {
        internal.n_I124[i - 1 + shared->dim_n_I124_1 * (j - 1)] = internal.nvacc_I124[shared->dim_nvacc_I124_1 * (j - 1) + i - 1] + I124[shared->dim_I124_1 * (j - 1) + i - 1] - internal.O_I124[shared->dim_O_I124_1 * (j - 1) + i - 1] + internal.inf_124[shared->dim_inf_124_1 * (j - 1) + i - 1] - internal.age_I124[shared->dim_age_I124_1 * (j - 1) + i + 1 - 1];
      }
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      for (int j = 1; j <= 3; ++j) {
        internal.n_I13[i - 1 + shared->dim_n_I13_1 * (j - 1)] = internal.nvacc_I13[shared->dim_nvacc_I13_1 * (j - 1) + i - 1] + I13[shared->dim_I13_1 * (j - 1) + i - 1] - internal.O_I13[shared->dim_O_I13_1 * (j - 1) + i - 1] + internal.inf_13[shared->dim_inf_13_1 * (j - 1) + i - 1] - internal.age_I13[shared->dim_age_I13_1 * (j - 1) + i + 1 - 1];
      }
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      for (int j = 1; j <= 3; ++j) {
        internal.n_I134[i - 1 + shared->dim_n_I134_1 * (j - 1)] = internal.nvacc_I134[shared->dim_nvacc_I134_1 * (j - 1) + i - 1] + I134[shared->dim_I134_1 * (j - 1) + i - 1] - internal.O_I134[shared->dim_O_I134_1 * (j - 1) + i - 1] + internal.inf_134[shared->dim_inf_134_1 * (j - 1) + i - 1] - internal.age_I134[shared->dim_age_I134_1 * (j - 1) + i + 1 - 1];
      }
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      for (int j = 1; j <= 3; ++j) {
        internal.n_I143[i - 1 + shared->dim_n_I143_1 * (j - 1)] = internal.nvacc_I143[shared->dim_nvacc_I143_1 * (j - 1) + i - 1] + I143[shared->dim_I143_1 * (j - 1) + i - 1] - internal.O_I143[shared->dim_O_I143_1 * (j - 1) + i - 1] + internal.inf_143[shared->dim_inf_143_1 * (j - 1) + i - 1] - internal.age_I143[shared->dim_age_I143_1 * (j - 1) + i + 1 - 1];
      }
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      for (int j = 1; j <= 3; ++j) {
        internal.n_I23[i - 1 + shared->dim_n_I23_1 * (j - 1)] = internal.nvacc_I23[shared->dim_nvacc_I23_1 * (j - 1) + i - 1] + I23[shared->dim_I23_1 * (j - 1) + i - 1] - internal.O_I23[shared->dim_O_I23_1 * (j - 1) + i - 1] + internal.inf_23[shared->dim_inf_23_1 * (j - 1) + i - 1] - internal.age_I23[shared->dim_age_I23_1 * (j - 1) + i + 1 - 1];
      }
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      for (int j = 1; j <= 3; ++j) {
        internal.n_I234[i - 1 + shared->dim_n_I234_1 * (j - 1)] = internal.nvacc_I234[shared->dim_nvacc_I234_1 * (j - 1) + i - 1] + I234[shared->dim_I234_1 * (j - 1) + i - 1] - internal.O_I234[shared->dim_O_I234_1 * (j - 1) + i - 1] + internal.inf_234[shared->dim_inf_234_1 * (j - 1) + i - 1] - internal.age_I234[shared->dim_age_I234_1 * (j - 1) + i + 1 - 1];
      }
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      for (int j = 1; j <= 3; ++j) {
        internal.n_I243[i - 1 + shared->dim_n_I243_1 * (j - 1)] = internal.nvacc_I243[shared->dim_nvacc_I243_1 * (j - 1) + i - 1] + I243[shared->dim_I243_1 * (j - 1) + i - 1] - internal.O_I243[shared->dim_O_I243_1 * (j - 1) + i - 1] + internal.inf_243[shared->dim_inf_243_1 * (j - 1) + i - 1] - internal.age_I243[shared->dim_age_I243_1 * (j - 1) + i + 1 - 1];
      }
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      for (int j = 1; j <= 3; ++j) {
        internal.n_I32[i - 1 + shared->dim_n_I32_1 * (j - 1)] = internal.nvacc_I32[shared->dim_nvacc_I32_1 * (j - 1) + i - 1] + I32[shared->dim_I32_1 * (j - 1) + i - 1] - internal.O_I32[shared->dim_O_I32_1 * (j - 1) + i - 1] + internal.inf_32[shared->dim_inf_32_1 * (j - 1) + i - 1] - internal.age_I32[shared->dim_age_I32_1 * (j - 1) + i + 1 - 1];
      }
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      for (int j = 1; j <= 3; ++j) {
        internal.n_I342[i - 1 + shared->dim_n_I342_1 * (j - 1)] = internal.nvacc_I342[shared->dim_nvacc_I342_1 * (j - 1) + i - 1] + I342[shared->dim_I342_1 * (j - 1) + i - 1] - internal.O_I342[shared->dim_O_I342_1 * (j - 1) + i - 1] + internal.inf_342[shared->dim_inf_342_1 * (j - 1) + i - 1] - internal.age_I342[shared->dim_age_I342_1 * (j - 1) + i + 1 - 1];
      }
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      for (int j = 1; j <= 3; ++j) {
        internal.n_I42[i - 1 + shared->dim_n_I42_1 * (j - 1)] = internal.nvacc_I42[shared->dim_nvacc_I42_1 * (j - 1) + i - 1] + I42[shared->dim_I42_1 * (j - 1) + i - 1] - internal.O_I42[shared->dim_O_I42_1 * (j - 1) + i - 1] + internal.inf_42[shared->dim_inf_42_1 * (j - 1) + i - 1] - internal.age_I42[shared->dim_age_I42_1 * (j - 1) + i + 1 - 1];
      }
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      internal.ncu_I12[i - 1] = dust::random::binomial<real_type>(rng_state, internal.n_I12[shared->dim_n_I12_1 * 0 + i - 1], internal.vcu_noncov[shared->dim_vcu_noncov_1 * 0 + i - 1]);
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      internal.ncu_I123[i - 1] = dust::random::binomial<real_type>(rng_state, internal.n_I123[shared->dim_n_I123_1 * 0 + i - 1], internal.vcu_noncov[shared->dim_vcu_noncov_1 * 0 + i - 1]);
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      internal.ncu_I1234[i - 1] = dust::random::binomial<real_type>(rng_state, internal.n_I1234[shared->dim_n_I1234_1 * 0 + i - 1], internal.vcu_noncov[shared->dim_vcu_noncov_1 * 0 + i - 1]);
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      internal.ncu_I1243[i - 1] = dust::random::binomial<real_type>(rng_state, internal.n_I1243[shared->dim_n_I1243_1 * 0 + i - 1], internal.vcu_noncov[shared->dim_vcu_noncov_1 * 0 + i - 1]);
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      internal.ncu_I132[i - 1] = dust::random::binomial<real_type>(rng_state, internal.n_I132[shared->dim_n_I132_1 * 0 + i - 1], internal.vcu_noncov[shared->dim_vcu_noncov_1 * 0 + i - 1]);
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      internal.ncu_I1342[i - 1] = dust::random::binomial<real_type>(rng_state, internal.n_I1342[shared->dim_n_I1342_1 * 0 + i - 1], internal.vcu_noncov[shared->dim_vcu_noncov_1 * 0 + i - 1]);
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      internal.ncu_I142[i - 1] = dust::random::binomial<real_type>(rng_state, internal.n_I142[shared->dim_n_I142_1 * 0 + i - 1], internal.vcu_noncov[shared->dim_vcu_noncov_1 * 0 + i - 1]);
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      internal.ncu_I21[i - 1] = dust::random::binomial<real_type>(rng_state, internal.n_I21[shared->dim_n_I21_1 * 0 + i - 1], internal.vcu_noncov[shared->dim_vcu_noncov_1 * 0 + i - 1]);
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      internal.ncu_I231[i - 1] = dust::random::binomial<real_type>(rng_state, internal.n_I231[shared->dim_n_I231_1 * 0 + i - 1], internal.vcu_noncov[shared->dim_vcu_noncov_1 * 0 + i - 1]);
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      internal.ncu_I2341[i - 1] = dust::random::binomial<real_type>(rng_state, internal.n_I2341[shared->dim_n_I2341_1 * 0 + i - 1], internal.vcu_noncov[shared->dim_vcu_noncov_1 * 0 + i - 1]);
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      internal.ncu_I241[i - 1] = dust::random::binomial<real_type>(rng_state, internal.n_I241[shared->dim_n_I241_1 * 0 + i - 1], internal.vcu_noncov[shared->dim_vcu_noncov_1 * 0 + i - 1]);
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      internal.ncu_I31[i - 1] = dust::random::binomial<real_type>(rng_state, internal.n_I31[shared->dim_n_I31_1 * 0 + i - 1], internal.vcu_noncov[shared->dim_vcu_noncov_1 * 0 + i - 1]);
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      internal.ncu_I341[i - 1] = dust::random::binomial<real_type>(rng_state, internal.n_I341[shared->dim_n_I341_1 * 0 + i - 1], internal.vcu_noncov[shared->dim_vcu_noncov_1 * 0 + i - 1]);
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      internal.ncu_I41[i - 1] = dust::random::binomial<real_type>(rng_state, internal.n_I41[shared->dim_n_I41_1 * 0 + i - 1], internal.vcu_noncov[shared->dim_vcu_noncov_1 * 0 + i - 1]);
    }
    for (int i = 2; i <= shared->N_age; ++i) {
      int j = 1;
      internal.nvacc_I14[i - 1 + shared->dim_nvacc_I14_1 * (j - 1)] = dust::random::binomial<real_type>(rng_state, internal.age_I14[shared->dim_age_I14_1 * (j - 1) + i - 1], internal.vacc_noncov[shared->dim_vacc_noncov_1 * (j - 1) + i - 1]);
    }
    {
       int i = 1;
       int j = 1;
       internal.nvacc_I14[i - 1 + shared->dim_nvacc_I14_1 * (j - 1)] = 0;
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      int j = 2;
      internal.nvacc_I14[i - 1 + shared->dim_nvacc_I14_1 * (j - 1)] = internal.age_I14[shared->dim_age_I14_1 * (j - 1) + i - 1] + internal.age_I14[shared->dim_age_I14_1 * 0 + i - 1] - internal.nvacc_I14[shared->dim_nvacc_I14_1 * 0 + i - 1];
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      int j = 3;
      internal.nvacc_I14[i - 1 + shared->dim_nvacc_I14_1 * (j - 1)] = internal.age_I14[shared->dim_age_I14_1 * (j - 1) + i - 1];
    }
    for (int i = 2; i <= shared->N_age; ++i) {
      int j = 1;
      internal.nvacc_I2[i - 1 + shared->dim_nvacc_I2_1 * (j - 1)] = dust::random::binomial<real_type>(rng_state, internal.age_I2[shared->dim_age_I2_1 * (j - 1) + i - 1], internal.vacc_noncov[shared->dim_vacc_noncov_1 * (j - 1) + i - 1]);
    }
    {
       int i = 1;
       int j = 1;
       internal.nvacc_I2[i - 1 + shared->dim_nvacc_I2_1 * (j - 1)] = 0;
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      int j = 2;
      internal.nvacc_I2[i - 1 + shared->dim_nvacc_I2_1 * (j - 1)] = internal.age_I2[shared->dim_age_I2_1 * (j - 1) + i - 1] + internal.age_I2[shared->dim_age_I2_1 * 0 + i - 1] - internal.nvacc_I2[shared->dim_nvacc_I2_1 * 0 + i - 1];
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      int j = 3;
      internal.nvacc_I2[i - 1 + shared->dim_nvacc_I2_1 * (j - 1)] = internal.age_I2[shared->dim_age_I2_1 * (j - 1) + i - 1];
    }
    for (int i = 2; i <= shared->N_age; ++i) {
      int j = 1;
      internal.nvacc_I24[i - 1 + shared->dim_nvacc_I24_1 * (j - 1)] = dust::random::binomial<real_type>(rng_state, internal.age_I24[shared->dim_age_I24_1 * (j - 1) + i - 1], internal.vacc_noncov[shared->dim_vacc_noncov_1 * (j - 1) + i - 1]);
    }
    {
       int i = 1;
       int j = 1;
       internal.nvacc_I24[i - 1 + shared->dim_nvacc_I24_1 * (j - 1)] = 0;
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      int j = 2;
      internal.nvacc_I24[i - 1 + shared->dim_nvacc_I24_1 * (j - 1)] = internal.age_I24[shared->dim_age_I24_1 * (j - 1) + i - 1] + internal.age_I24[shared->dim_age_I24_1 * 0 + i - 1] - internal.nvacc_I24[shared->dim_nvacc_I24_1 * 0 + i - 1];
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      int j = 3;
      internal.nvacc_I24[i - 1 + shared->dim_nvacc_I24_1 * (j - 1)] = internal.age_I24[shared->dim_age_I24_1 * (j - 1) + i - 1];
    }
    for (int i = 2; i <= shared->N_age; ++i) {
      int j = 1;
      internal.nvacc_I34[i - 1 + shared->dim_nvacc_I34_1 * (j - 1)] = dust::random::binomial<real_type>(rng_state, internal.age_I34[shared->dim_age_I34_1 * (j - 1) + i - 1], internal.vacc_noncov[shared->dim_vacc_noncov_1 * (j - 1) + i - 1]);
    }
    {
       int i = 1;
       int j = 1;
       internal.nvacc_I34[i - 1 + shared->dim_nvacc_I34_1 * (j - 1)] = 0;
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      int j = 2;
      internal.nvacc_I34[i - 1 + shared->dim_nvacc_I34_1 * (j - 1)] = internal.age_I34[shared->dim_age_I34_1 * (j - 1) + i - 1] + internal.age_I34[shared->dim_age_I34_1 * 0 + i - 1] - internal.nvacc_I34[shared->dim_nvacc_I34_1 * 0 + i - 1];
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      int j = 3;
      internal.nvacc_I34[i - 1 + shared->dim_nvacc_I34_1 * (j - 1)] = internal.age_I34[shared->dim_age_I34_1 * (j - 1) + i - 1];
    }
    for (int i = 2; i <= shared->N_age; ++i) {
      int j = 1;
      internal.nvacc_I43[i - 1 + shared->dim_nvacc_I43_1 * (j - 1)] = dust::random::binomial<real_type>(rng_state, internal.age_I43[shared->dim_age_I43_1 * (j - 1) + i - 1], internal.vacc_noncov[shared->dim_vacc_noncov_1 * (j - 1) + i - 1]);
    }
    {
       int i = 1;
       int j = 1;
       internal.nvacc_I43[i - 1 + shared->dim_nvacc_I43_1 * (j - 1)] = 0;
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      int j = 2;
      internal.nvacc_I43[i - 1 + shared->dim_nvacc_I43_1 * (j - 1)] = internal.age_I43[shared->dim_age_I43_1 * (j - 1) + i - 1] + internal.age_I43[shared->dim_age_I43_1 * 0 + i - 1] - internal.nvacc_I43[shared->dim_nvacc_I43_1 * 0 + i - 1];
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      int j = 3;
      internal.nvacc_I43[i - 1 + shared->dim_nvacc_I43_1 * (j - 1)] = internal.age_I43[shared->dim_age_I43_1 * (j - 1) + i - 1];
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      int j = 1;
      int k = 1;
      internal.sdisease_sero[i - 1 + shared->dim_sdisease_sero_1 * (j - 1) + shared->dim_sdisease_sero_12 * (k - 1)] = shared->sdis_pri[0] * internal.inf_1[shared->dim_inf_1_1 * (j - 1) + i - 1] + shared->sdis_sec[0] * (internal.inf_21[shared->dim_inf_21_1 * (j - 1) + i - 1] + internal.inf_31[shared->dim_inf_31_1 * (j - 1) + i - 1] + internal.inf_41[shared->dim_inf_41_1 * (j - 1) + i - 1]) + shared->sdis_tert[0] * (internal.inf_231[shared->dim_inf_231_1 * (j - 1) + i - 1] + internal.inf_241[shared->dim_inf_241_1 * (j - 1) + i - 1] + internal.inf_341[shared->dim_inf_341_1 * (j - 1) + i - 1]) + shared->sdis_quart[0] * internal.inf_2341[shared->dim_inf_2341_1 * (j - 1) + i - 1];
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      for (int j = 2; j <= 3; ++j) {
        int k = 1;
        internal.sdisease_sero[i - 1 + shared->dim_sdisease_sero_1 * (j - 1) + shared->dim_sdisease_sero_12 * (k - 1)] = internal.RR_sdis[shared->dim_RR_sdis_12 * (i - 1) + shared->dim_RR_sdis_1 * 0 + 0] * shared->sdis_pri[0] * internal.inf_1[shared->dim_inf_1_1 * (j - 1) + i - 1] + internal.RR_sdis[shared->dim_RR_sdis_12 * (i - 1) + shared->dim_RR_sdis_1 * 1 + 0] * (shared->sdis_sec[0] * (internal.inf_21[shared->dim_inf_21_1 * (j - 1) + i - 1] + internal.inf_31[shared->dim_inf_31_1 * (j - 1) + i - 1] + internal.inf_41[shared->dim_inf_41_1 * (j - 1) + i - 1]) + shared->sdis_tert[0] * (internal.inf_231[shared->dim_inf_231_1 * (j - 1) + i - 1] + internal.inf_241[shared->dim_inf_241_1 * (j - 1) + i - 1] + internal.inf_341[shared->dim_inf_341_1 * (j - 1) + i - 1]) + shared->sdis_quart[0] * internal.inf_2341[shared->dim_inf_2341_1 * (j - 1) + i - 1]);
      }
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      int j = 1;
      int k = 2;
      internal.sdisease_sero[i - 1 + shared->dim_sdisease_sero_1 * (j - 1) + shared->dim_sdisease_sero_12 * (k - 1)] = shared->sdis_pri[1] * internal.inf_2[shared->dim_inf_2_1 * (j - 1) + i - 1] + shared->sdis_sec[1] * (internal.inf_12[shared->dim_inf_12_1 * (j - 1) + i - 1] + internal.inf_32[shared->dim_inf_32_1 * (j - 1) + i - 1] + internal.inf_42[shared->dim_inf_42_1 * (j - 1) + i - 1]) + shared->sdis_tert[1] * (internal.inf_132[shared->dim_inf_132_1 * (j - 1) + i - 1] + internal.inf_142[shared->dim_inf_142_1 * (j - 1) + i - 1] + internal.inf_342[shared->dim_inf_342_1 * (j - 1) + i - 1]) + shared->sdis_quart[1] * internal.inf_1342[shared->dim_inf_1342_1 * (j - 1) + i - 1];
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      for (int j = 2; j <= 3; ++j) {
        int k = 2;
        internal.sdisease_sero[i - 1 + shared->dim_sdisease_sero_1 * (j - 1) + shared->dim_sdisease_sero_12 * (k - 1)] = internal.RR_sdis[shared->dim_RR_sdis_12 * (i - 1) + shared->dim_RR_sdis_1 * 0 + 1] * shared->sdis_pri[1] * internal.inf_2[shared->dim_inf_2_1 * (j - 1) + i - 1] + internal.RR_sdis[shared->dim_RR_sdis_12 * (i - 1) + shared->dim_RR_sdis_1 * 1 + 1] * (shared->sdis_sec[1] * (internal.inf_12[shared->dim_inf_12_1 * (j - 1) + i - 1] + internal.inf_32[shared->dim_inf_32_1 * (j - 1) + i - 1] + internal.inf_42[shared->dim_inf_42_1 * (j - 1) + i - 1]) + shared->sdis_tert[1] * (internal.inf_132[shared->dim_inf_132_1 * (j - 1) + i - 1] + internal.inf_142[shared->dim_inf_142_1 * (j - 1) + i - 1] + internal.inf_342[shared->dim_inf_342_1 * (j - 1) + i - 1]) + shared->sdis_quart[1] * internal.inf_1342[shared->dim_inf_1342_1 * (j - 1) + i - 1]);
      }
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      int j = 1;
      int k = 3;
      internal.sdisease_sero[i - 1 + shared->dim_sdisease_sero_1 * (j - 1) + shared->dim_sdisease_sero_12 * (k - 1)] = shared->sdis_pri[2] * internal.inf_3[shared->dim_inf_3_1 * (j - 1) + i - 1] + shared->sdis_sec[2] * (internal.inf_13[shared->dim_inf_13_1 * (j - 1) + i - 1] + internal.inf_23[shared->dim_inf_23_1 * (j - 1) + i - 1] + internal.inf_43[shared->dim_inf_43_1 * (j - 1) + i - 1]) + shared->sdis_tert[2] * (internal.inf_123[shared->dim_inf_123_1 * (j - 1) + i - 1] + internal.inf_143[shared->dim_inf_143_1 * (j - 1) + i - 1] + internal.inf_243[shared->dim_inf_243_1 * (j - 1) + i - 1]) + shared->sdis_quart[2] * internal.inf_1243[shared->dim_inf_1243_1 * (j - 1) + i - 1];
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      for (int j = 2; j <= 3; ++j) {
        int k = 3;
        internal.sdisease_sero[i - 1 + shared->dim_sdisease_sero_1 * (j - 1) + shared->dim_sdisease_sero_12 * (k - 1)] = internal.RR_sdis[shared->dim_RR_sdis_12 * (i - 1) + shared->dim_RR_sdis_1 * 0 + 2] * shared->sdis_pri[2] * internal.inf_3[shared->dim_inf_3_1 * (j - 1) + i - 1] + internal.RR_sdis[shared->dim_RR_sdis_12 * (i - 1) + shared->dim_RR_sdis_1 * 1 + 2] * (shared->sdis_sec[2] * (internal.inf_13[shared->dim_inf_13_1 * (j - 1) + i - 1] + internal.inf_23[shared->dim_inf_23_1 * (j - 1) + i - 1] + internal.inf_43[shared->dim_inf_43_1 * (j - 1) + i - 1]) + shared->sdis_tert[2] * (internal.inf_123[shared->dim_inf_123_1 * (j - 1) + i - 1] + internal.inf_143[shared->dim_inf_143_1 * (j - 1) + i - 1] + internal.inf_243[shared->dim_inf_243_1 * (j - 1) + i - 1]) + shared->sdis_quart[2] * internal.inf_1243[shared->dim_inf_1243_1 * (j - 1) + i - 1]);
      }
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      int j = 1;
      int k = 4;
      internal.sdisease_sero[i - 1 + shared->dim_sdisease_sero_1 * (j - 1) + shared->dim_sdisease_sero_12 * (k - 1)] = shared->sdis_pri[3] * internal.inf_4[shared->dim_inf_4_1 * (j - 1) + i - 1] + shared->sdis_sec[3] * (internal.inf_14[shared->dim_inf_14_1 * (j - 1) + i - 1] + internal.inf_24[shared->dim_inf_24_1 * (j - 1) + i - 1] + internal.inf_34[shared->dim_inf_34_1 * (j - 1) + i - 1]) + shared->sdis_tert[3] * (internal.inf_124[shared->dim_inf_124_1 * (j - 1) + i - 1] + internal.inf_134[shared->dim_inf_134_1 * (j - 1) + i - 1] + internal.inf_234[shared->dim_inf_234_1 * (j - 1) + i - 1]) + shared->sdis_quart[3] * internal.inf_1234[shared->dim_inf_1234_1 * (j - 1) + i - 1];
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      for (int j = 2; j <= 3; ++j) {
        int k = 4;
        internal.sdisease_sero[i - 1 + shared->dim_sdisease_sero_1 * (j - 1) + shared->dim_sdisease_sero_12 * (k - 1)] = internal.RR_sdis[shared->dim_RR_sdis_12 * (i - 1) + shared->dim_RR_sdis_1 * 0 + 3] * shared->sdis_pri[3] * internal.inf_4[shared->dim_inf_4_1 * (j - 1) + i - 1] + internal.RR_sdis[shared->dim_RR_sdis_12 * (i - 1) + shared->dim_RR_sdis_1 * 1 + 3] * (shared->sdis_sec[3] * (internal.inf_14[shared->dim_inf_14_1 * (j - 1) + i - 1] + internal.inf_24[shared->dim_inf_24_1 * (j - 1) + i - 1] + internal.inf_34[shared->dim_inf_34_1 * (j - 1) + i - 1]) + shared->sdis_tert[3] * (internal.inf_124[shared->dim_inf_124_1 * (j - 1) + i - 1] + internal.inf_134[shared->dim_inf_134_1 * (j - 1) + i - 1] + internal.inf_234[shared->dim_inf_234_1 * (j - 1) + i - 1]) + shared->sdis_quart[3] * internal.inf_1234[shared->dim_inf_1234_1 * (j - 1) + i - 1]);
      }
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      int j = 1;
      internal.sdisease_sero_vacc_pri[i - 1 + shared->dim_sdisease_sero_vacc_pri_1 * (j - 1)] = shared->sdis_pri[0] * internal.RR_sdis[shared->dim_RR_sdis_12 * (i - 1) + shared->dim_RR_sdis_1 * 0 + 0] * (internal.inf_1[shared->dim_inf_1_1 * 1 + i - 1] + internal.inf_1[shared->dim_inf_1_1 * 2 + i - 1]);
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      int j = 2;
      internal.sdisease_sero_vacc_pri[i - 1 + shared->dim_sdisease_sero_vacc_pri_1 * (j - 1)] = shared->sdis_pri[1] * internal.RR_sdis[shared->dim_RR_sdis_12 * (i - 1) + shared->dim_RR_sdis_1 * 0 + 1] * (internal.inf_2[shared->dim_inf_2_1 * 1 + i - 1] + internal.inf_2[shared->dim_inf_2_1 * 2 + i - 1]);
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      int j = 3;
      internal.sdisease_sero_vacc_pri[i - 1 + shared->dim_sdisease_sero_vacc_pri_1 * (j - 1)] = shared->sdis_pri[2] * internal.RR_sdis[shared->dim_RR_sdis_12 * (i - 1) + shared->dim_RR_sdis_1 * 0 + 2] * (internal.inf_3[shared->dim_inf_3_1 * 1 + i - 1] + internal.inf_3[shared->dim_inf_3_1 * 2 + i - 1]);
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      int j = 4;
      internal.sdisease_sero_vacc_pri[i - 1 + shared->dim_sdisease_sero_vacc_pri_1 * (j - 1)] = shared->sdis_pri[3] * internal.RR_sdis[shared->dim_RR_sdis_12 * (i - 1) + shared->dim_RR_sdis_1 * 0 + 3] * (internal.inf_4[shared->dim_inf_4_1 * 1 + i - 1] + internal.inf_4[shared->dim_inf_4_1 * 2 + i - 1]);
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      state_next[shared->offset_variable_cum_infection_sec + i - 1] = cum_infection_sec[i - 1] + internal.infection_sec[shared->dim_infection_sec_1 * 0 + i - 1] + internal.infection_sec[shared->dim_infection_sec_1 * 1 + i - 1] + internal.infection_sec[shared->dim_infection_sec_1 * 2 + i - 1];
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      state_next[shared->offset_variable_cum_infection_secV + i - 1] = cum_infection_secV[i - 1] + internal.infection_sec[shared->dim_infection_sec_1 * 1 + i - 1] + internal.infection_sec[shared->dim_infection_sec_1 * 2 + i - 1];
    }
    state_next[32] = exposed2 + Y2T - exposed2 * shared->DT / (real_type) shared->incub;
    for (int i = 1; i <= shared->N_age; ++i) {
      int j = 1;
      state_next[shared->offset_variable_R1 + i - 1 + shared->dim_R1_1 * (j - 1)] = internal.ncu_R1[i - 1];
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      int j = 2;
      state_next[shared->offset_variable_R1 + i - 1 + shared->dim_R1_1 * (j - 1)] = internal.n_R1[shared->dim_n_R1_1 * (j - 1) + i - 1] + internal.n_R1[shared->dim_n_R1_1 * 0 + i - 1] - internal.ncu_R1[i - 1] - internal.vw_R1[i - 1];
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      int j = 3;
      state_next[shared->offset_variable_R1 + i - 1 + shared->dim_R1_1 * (j - 1)] = internal.n_R1[shared->dim_n_R1_1 * (j - 1) + i - 1] + internal.vw_R1[i - 1];
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      int j = 1;
      state_next[shared->offset_variable_R12 + i - 1 + shared->dim_R12_1 * (j - 1)] = internal.ncu_R12[i - 1];
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      int j = 2;
      state_next[shared->offset_variable_R12 + i - 1 + shared->dim_R12_1 * (j - 1)] = internal.n_R12[shared->dim_n_R12_1 * (j - 1) + i - 1] + internal.n_R12[shared->dim_n_R12_1 * 0 + i - 1] - internal.ncu_R12[i - 1] - internal.vw_R12[i - 1];
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      int j = 3;
      state_next[shared->offset_variable_R12 + i - 1 + shared->dim_R12_1 * (j - 1)] = internal.n_R12[shared->dim_n_R12_1 * (j - 1) + i - 1] + internal.vw_R12[i - 1];
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      int j = 1;
      state_next[shared->offset_variable_R123 + i - 1 + shared->dim_R123_1 * (j - 1)] = internal.ncu_R123[i - 1];
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      int j = 2;
      state_next[shared->offset_variable_R123 + i - 1 + shared->dim_R123_1 * (j - 1)] = internal.n_R123[shared->dim_n_R123_1 * (j - 1) + i - 1] + internal.n_R123[shared->dim_n_R123_1 * 0 + i - 1] - internal.ncu_R123[i - 1] - internal.vw_R123[i - 1];
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      int j = 3;
      state_next[shared->offset_variable_R123 + i - 1 + shared->dim_R123_1 * (j - 1)] = internal.n_R123[shared->dim_n_R123_1 * (j - 1) + i - 1] + internal.vw_R123[i - 1];
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      int j = 1;
      state_next[shared->offset_variable_R124 + i - 1 + shared->dim_R124_1 * (j - 1)] = internal.ncu_R124[i - 1];
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      int j = 2;
      state_next[shared->offset_variable_R124 + i - 1 + shared->dim_R124_1 * (j - 1)] = internal.n_R124[shared->dim_n_R124_1 * (j - 1) + i - 1] + internal.n_R124[shared->dim_n_R124_1 * 0 + i - 1] - internal.ncu_R124[i - 1] - internal.vw_R124[i - 1];
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      int j = 3;
      state_next[shared->offset_variable_R124 + i - 1 + shared->dim_R124_1 * (j - 1)] = internal.n_R124[shared->dim_n_R124_1 * (j - 1) + i - 1] + internal.vw_R124[i - 1];
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      int j = 1;
      state_next[shared->offset_variable_R13 + i - 1 + shared->dim_R13_1 * (j - 1)] = internal.ncu_R13[i - 1];
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      int j = 2;
      state_next[shared->offset_variable_R13 + i - 1 + shared->dim_R13_1 * (j - 1)] = internal.n_R13[shared->dim_n_R13_1 * (j - 1) + i - 1] + internal.n_R13[shared->dim_n_R13_1 * 0 + i - 1] - internal.ncu_R13[i - 1] - internal.vw_R13[i - 1];
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      int j = 3;
      state_next[shared->offset_variable_R13 + i - 1 + shared->dim_R13_1 * (j - 1)] = internal.n_R13[shared->dim_n_R13_1 * (j - 1) + i - 1] + internal.vw_R13[i - 1];
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      int j = 1;
      state_next[shared->offset_variable_R134 + i - 1 + shared->dim_R134_1 * (j - 1)] = internal.ncu_R134[i - 1];
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      int j = 2;
      state_next[shared->offset_variable_R134 + i - 1 + shared->dim_R134_1 * (j - 1)] = internal.n_R134[shared->dim_n_R134_1 * (j - 1) + i - 1] + internal.n_R134[shared->dim_n_R134_1 * 0 + i - 1] - internal.ncu_R134[i - 1] - internal.vw_R134[i - 1];
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      int j = 3;
      state_next[shared->offset_variable_R134 + i - 1 + shared->dim_R134_1 * (j - 1)] = internal.n_R134[shared->dim_n_R134_1 * (j - 1) + i - 1] + internal.vw_R134[i - 1];
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      int j = 1;
      state_next[shared->offset_variable_R14 + i - 1 + shared->dim_R14_1 * (j - 1)] = internal.ncu_R14[i - 1];
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      int j = 2;
      state_next[shared->offset_variable_R14 + i - 1 + shared->dim_R14_1 * (j - 1)] = internal.n_R14[shared->dim_n_R14_1 * (j - 1) + i - 1] + internal.n_R14[shared->dim_n_R14_1 * 0 + i - 1] - internal.ncu_R14[i - 1] - internal.vw_R14[i - 1];
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      int j = 3;
      state_next[shared->offset_variable_R14 + i - 1 + shared->dim_R14_1 * (j - 1)] = internal.n_R14[shared->dim_n_R14_1 * (j - 1) + i - 1] + internal.vw_R14[i - 1];
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      int j = 1;
      state_next[shared->offset_variable_R2 + i - 1 + shared->dim_R2_1 * (j - 1)] = internal.ncu_R2[i - 1];
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      int j = 2;
      state_next[shared->offset_variable_R2 + i - 1 + shared->dim_R2_1 * (j - 1)] = internal.n_R2[shared->dim_n_R2_1 * (j - 1) + i - 1] + internal.n_R2[shared->dim_n_R2_1 * 0 + i - 1] - internal.ncu_R2[i - 1] - internal.vw_R2[i - 1];
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      int j = 3;
      state_next[shared->offset_variable_R2 + i - 1 + shared->dim_R2_1 * (j - 1)] = internal.n_R2[shared->dim_n_R2_1 * (j - 1) + i - 1] + internal.vw_R2[i - 1];
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      int j = 1;
      state_next[shared->offset_variable_R23 + i - 1 + shared->dim_R23_1 * (j - 1)] = internal.ncu_R23[i - 1];
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      int j = 2;
      state_next[shared->offset_variable_R23 + i - 1 + shared->dim_R23_1 * (j - 1)] = internal.n_R23[shared->dim_n_R23_1 * (j - 1) + i - 1] + internal.n_R23[shared->dim_n_R23_1 * 0 + i - 1] - internal.ncu_R23[i - 1] - internal.vw_R23[i - 1];
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      int j = 3;
      state_next[shared->offset_variable_R23 + i - 1 + shared->dim_R23_1 * (j - 1)] = internal.n_R23[shared->dim_n_R23_1 * (j - 1) + i - 1] + internal.vw_R23[i - 1];
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      int j = 1;
      state_next[shared->offset_variable_R234 + i - 1 + shared->dim_R234_1 * (j - 1)] = internal.ncu_R234[i - 1];
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      int j = 2;
      state_next[shared->offset_variable_R234 + i - 1 + shared->dim_R234_1 * (j - 1)] = internal.n_R234[shared->dim_n_R234_1 * (j - 1) + i - 1] + internal.n_R234[shared->dim_n_R234_1 * 0 + i - 1] - internal.ncu_R234[i - 1] - internal.vw_R234[i - 1];
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      int j = 3;
      state_next[shared->offset_variable_R234 + i - 1 + shared->dim_R234_1 * (j - 1)] = internal.n_R234[shared->dim_n_R234_1 * (j - 1) + i - 1] + internal.vw_R234[i - 1];
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      int j = 1;
      state_next[shared->offset_variable_R24 + i - 1 + shared->dim_R24_1 * (j - 1)] = internal.ncu_R24[i - 1];
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      int j = 2;
      state_next[shared->offset_variable_R24 + i - 1 + shared->dim_R24_1 * (j - 1)] = internal.n_R24[shared->dim_n_R24_1 * (j - 1) + i - 1] + internal.n_R24[shared->dim_n_R24_1 * 0 + i - 1] - internal.ncu_R24[i - 1] - internal.vw_R24[i - 1];
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      int j = 3;
      state_next[shared->offset_variable_R24 + i - 1 + shared->dim_R24_1 * (j - 1)] = internal.n_R24[shared->dim_n_R24_1 * (j - 1) + i - 1] + internal.vw_R24[i - 1];
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      int j = 1;
      state_next[shared->offset_variable_R3 + i - 1 + shared->dim_R3_1 * (j - 1)] = internal.ncu_R3[i - 1];
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      int j = 2;
      state_next[shared->offset_variable_R3 + i - 1 + shared->dim_R3_1 * (j - 1)] = internal.n_R3[shared->dim_n_R3_1 * (j - 1) + i - 1] + internal.n_R3[shared->dim_n_R3_1 * 0 + i - 1] - internal.ncu_R3[i - 1] - internal.vw_R3[i - 1];
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      int j = 3;
      state_next[shared->offset_variable_R3 + i - 1 + shared->dim_R3_1 * (j - 1)] = internal.n_R3[shared->dim_n_R3_1 * (j - 1) + i - 1] + internal.vw_R3[i - 1];
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      int j = 1;
      state_next[shared->offset_variable_R34 + i - 1 + shared->dim_R34_1 * (j - 1)] = internal.ncu_R34[i - 1];
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      int j = 2;
      state_next[shared->offset_variable_R34 + i - 1 + shared->dim_R34_1 * (j - 1)] = internal.n_R34[shared->dim_n_R34_1 * (j - 1) + i - 1] + internal.n_R34[shared->dim_n_R34_1 * 0 + i - 1] - internal.ncu_R34[i - 1] - internal.vw_R34[i - 1];
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      int j = 3;
      state_next[shared->offset_variable_R34 + i - 1 + shared->dim_R34_1 * (j - 1)] = internal.n_R34[shared->dim_n_R34_1 * (j - 1) + i - 1] + internal.vw_R34[i - 1];
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      int j = 1;
      state_next[shared->offset_variable_R4 + i - 1 + shared->dim_R4_1 * (j - 1)] = internal.ncu_R4[i - 1];
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      int j = 2;
      state_next[shared->offset_variable_R4 + i - 1 + shared->dim_R4_1 * (j - 1)] = internal.n_R4[shared->dim_n_R4_1 * (j - 1) + i - 1] + internal.n_R4[shared->dim_n_R4_1 * 0 + i - 1] - internal.ncu_R4[i - 1] - internal.vw_R4[i - 1];
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      int j = 3;
      state_next[shared->offset_variable_R4 + i - 1 + shared->dim_R4_1 * (j - 1)] = internal.n_R4[shared->dim_n_R4_1 * (j - 1) + i - 1] + internal.vw_R4[i - 1];
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      int j = 1;
      state_next[shared->offset_variable_S + i - 1 + shared->dim_S_1 * (j - 1)] = internal.ncu_S[i - 1];
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      int j = 2;
      state_next[shared->offset_variable_S + i - 1 + shared->dim_S_1 * (j - 1)] = internal.n_S[shared->dim_n_S_1 * 1 + i - 1] - internal.vw_S[i - 1];
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      int j = 3;
      state_next[shared->offset_variable_S + i - 1 + shared->dim_S_1 * (j - 1)] = internal.n_S[shared->dim_n_S_1 * 0 + i - 1] - internal.ncu_S[i - 1] + internal.n_S[shared->dim_n_S_1 * 2 + i - 1] + internal.vw_S[i - 1];
    }
    state_next[28] = Y2T;
    for (int i = 1; i <= shared->N_age; ++i) {
      internal.vw_I12[i - 1] = dust::random::binomial<real_type>(rng_state, internal.n_I12[shared->dim_n_I12_1 * 1 + i - 1], shared->vacc_decay);
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      internal.vw_I123[i - 1] = dust::random::binomial<real_type>(rng_state, internal.n_I123[shared->dim_n_I123_1 * 1 + i - 1], shared->vacc_decay);
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      internal.vw_I1234[i - 1] = dust::random::binomial<real_type>(rng_state, internal.n_I1234[shared->dim_n_I1234_1 * 1 + i - 1], shared->vacc_decay);
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      internal.vw_I1243[i - 1] = dust::random::binomial<real_type>(rng_state, internal.n_I1243[shared->dim_n_I1243_1 * 1 + i - 1], shared->vacc_decay);
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      internal.vw_I132[i - 1] = dust::random::binomial<real_type>(rng_state, internal.n_I132[shared->dim_n_I132_1 * 1 + i - 1], shared->vacc_decay);
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      internal.vw_I1342[i - 1] = dust::random::binomial<real_type>(rng_state, internal.n_I1342[shared->dim_n_I1342_1 * 1 + i - 1], shared->vacc_decay);
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      internal.vw_I142[i - 1] = dust::random::binomial<real_type>(rng_state, internal.n_I142[shared->dim_n_I142_1 * 1 + i - 1], shared->vacc_decay);
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      internal.vw_I21[i - 1] = dust::random::binomial<real_type>(rng_state, internal.n_I21[shared->dim_n_I21_1 * 1 + i - 1], shared->vacc_decay);
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      internal.vw_I231[i - 1] = dust::random::binomial<real_type>(rng_state, internal.n_I231[shared->dim_n_I231_1 * 1 + i - 1], shared->vacc_decay);
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      internal.vw_I2341[i - 1] = dust::random::binomial<real_type>(rng_state, internal.n_I2341[shared->dim_n_I2341_1 * 1 + i - 1], shared->vacc_decay);
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      internal.vw_I241[i - 1] = dust::random::binomial<real_type>(rng_state, internal.n_I241[shared->dim_n_I241_1 * 1 + i - 1], shared->vacc_decay);
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      internal.vw_I31[i - 1] = dust::random::binomial<real_type>(rng_state, internal.n_I31[shared->dim_n_I31_1 * 1 + i - 1], shared->vacc_decay);
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      internal.vw_I341[i - 1] = dust::random::binomial<real_type>(rng_state, internal.n_I341[shared->dim_n_I341_1 * 1 + i - 1], shared->vacc_decay);
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      internal.vw_I41[i - 1] = dust::random::binomial<real_type>(rng_state, internal.n_I41[shared->dim_n_I41_1 * 1 + i - 1], shared->vacc_decay);
    }
    real_type Y3T = odin_sum1<real_type>(internal.Y3.data(), 0, shared->dim_Y3) / (real_type) NT;
    for (int i = 1; i <= shared->N_age; ++i) {
      int j = 1;
      internal.Y4[i - 1 + shared->dim_Y4_1 * (j - 1)] = shared->phi_pri[3] * (1 + shared->dis_pri[3] * shared->phi_ed) * internal.inf_4[shared->dim_inf_4_1 * (j - 1) + i - 1] + shared->phi_sec[3] * (1 + shared->dis_sec[3] * shared->phi_ed) * (internal.inf_14[shared->dim_inf_14_1 * (j - 1) + i - 1] + internal.inf_24[shared->dim_inf_24_1 * (j - 1) + i - 1] + internal.inf_34[shared->dim_inf_34_1 * (j - 1) + i - 1]) + shared->phi_tert[3] * (1 + shared->dis_tert[3] * shared->phi_ed) * (internal.inf_124[shared->dim_inf_124_1 * (j - 1) + i - 1] + internal.inf_134[shared->dim_inf_134_1 * (j - 1) + i - 1] + internal.inf_234[shared->dim_inf_234_1 * (j - 1) + i - 1]) + shared->phi_quart[3] * (1 + shared->dis_quart[3] * shared->phi_ed) * internal.inf_1234[shared->dim_inf_1234_1 * (j - 1) + i - 1];
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      for (int j = 2; j <= 3; ++j) {
        internal.Y4[i - 1 + shared->dim_Y4_1 * (j - 1)] = shared->phi_pri[3] * (1 + shared->dis_pri[3] * internal.RR_dis[shared->dim_RR_dis_12 * (i - 1) + shared->dim_RR_dis_1 * 0 + 3] * shared->phi_ed) * internal.inf_4[shared->dim_inf_4_1 * (j - 1) + i - 1] + shared->phi_sec[3] * (1 + shared->dis_sec[3] * internal.RR_dis[shared->dim_RR_dis_12 * (i - 1) + shared->dim_RR_dis_1 * 1 + 3] * shared->phi_ed) * (internal.inf_14[shared->dim_inf_14_1 * (j - 1) + i - 1] + internal.inf_24[shared->dim_inf_24_1 * (j - 1) + i - 1] + internal.inf_34[shared->dim_inf_34_1 * (j - 1) + i - 1]) + shared->phi_tert[3] * (1 + shared->dis_tert[3] * internal.RR_dis[shared->dim_RR_dis_12 * (i - 1) + shared->dim_RR_dis_1 * 1 + 3] * shared->phi_ed) * (internal.inf_124[shared->dim_inf_124_1 * (j - 1) + i - 1] + internal.inf_134[shared->dim_inf_134_1 * (j - 1) + i - 1] + internal.inf_234[shared->dim_inf_234_1 * (j - 1) + i - 1]) + shared->phi_quart[3] * (1 + shared->dis_quart[3] * internal.RR_dis[shared->dim_RR_dis_12 * (i - 1) + shared->dim_RR_dis_1 * 1 + 3] * shared->phi_ed) * internal.inf_1234[shared->dim_inf_1234_1 * (j - 1) + i - 1];
      }
    }
    for (int i = 2; i <= shared->N_age_p1; ++i) {
      for (int j = 1; j <= 3; ++j) {
        internal.age_I4[i - 1 + shared->dim_age_I4_1 * (j - 1)] = dust::random::binomial<real_type>(rng_state, (I4[shared->dim_I4_1 * (j - 1) + i - 1 - 1] - internal.O_I4[shared->dim_O_I4_1 * (j - 1) + i - 1 - 1] + internal.infV_4[shared->dim_infV_4_1 * (j - 1) + i - 1 - 1]), internal.agert[i - 1 - 1]);
      }
    }
    {
       int i = 1;
       for (int j = 1; j <= 3; ++j) {
         internal.age_I4[i - 1 + shared->dim_age_I4_1 * (j - 1)] = 0;
       }
    }
    for (int i = 1; i <= 4; ++i) {
      internal.dis_sero_unvacc[i - 1] = odin_sum3<real_type>(internal.disease_sero.data(), 0, shared->dim_disease_sero_1, 0, 1, i - 1, i, shared->dim_disease_sero_1, shared->dim_disease_sero_12);
    }
    for (int i = 1; i <= 4; ++i) {
      internal.dis_sero_vacc[i - 1] = odin_sum3<real_type>(internal.disease_sero.data(), 0, shared->dim_disease_sero_1, 1, 2, i - 1, i, shared->dim_disease_sero_1, shared->dim_disease_sero_12) + odin_sum3<real_type>(internal.disease_sero.data(), 0, shared->dim_disease_sero_1, 2, 3, i - 1, i, shared->dim_disease_sero_1, shared->dim_disease_sero_12);
    }
    for (int i = 1; i <= 4; ++i) {
      internal.dis_sero_vacc_neg[i - 1] = odin_sum2<real_type>(internal.disease_sero_vacc_pri.data(), 0, shared->dim_disease_sero_vacc_pri_1, i - 1, i, shared->dim_disease_sero_vacc_pri_1);
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      for (int j = 1; j <= 3; ++j) {
        internal.disc_yll_all[i - 1 + shared->dim_disc_yll_all_1 * (j - 1)] = odin_sum3<real_type>(internal.sdisease_sero.data(), i - 1, i, j - 1, j, 0, shared->dim_sdisease_sero_3, shared->dim_sdisease_sero_1, shared->dim_sdisease_sero_12) * shared->cfr * (1 - 1 / (real_type) (dust::math::pow(shared->disc_fact, internal.life_expec[i - 1]))) / (real_type) dust::math::log(shared->disc_fact);
      }
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      for (int j = 1; j <= 3; ++j) {
        internal.n_I14[i - 1 + shared->dim_n_I14_1 * (j - 1)] = internal.nvacc_I14[shared->dim_nvacc_I14_1 * (j - 1) + i - 1] + I14[shared->dim_I14_1 * (j - 1) + i - 1] - internal.O_I14[shared->dim_O_I14_1 * (j - 1) + i - 1] + internal.inf_14[shared->dim_inf_14_1 * (j - 1) + i - 1] - internal.age_I14[shared->dim_age_I14_1 * (j - 1) + i + 1 - 1];
      }
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      for (int j = 1; j <= 3; ++j) {
        internal.n_I2[i - 1 + shared->dim_n_I2_1 * (j - 1)] = internal.nvacc_I2[shared->dim_nvacc_I2_1 * (j - 1) + i - 1] + I2[shared->dim_I2_1 * (j - 1) + i - 1] - internal.O_I2[shared->dim_O_I2_1 * (j - 1) + i - 1] + internal.infV_2[shared->dim_infV_2_1 * (j - 1) + i - 1] - internal.age_I2[shared->dim_age_I2_1 * (j - 1) + i + 1 - 1];
      }
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      for (int j = 1; j <= 3; ++j) {
        internal.n_I24[i - 1 + shared->dim_n_I24_1 * (j - 1)] = internal.nvacc_I24[shared->dim_nvacc_I24_1 * (j - 1) + i - 1] + I24[shared->dim_I24_1 * (j - 1) + i - 1] - internal.O_I24[shared->dim_O_I24_1 * (j - 1) + i - 1] + internal.inf_24[shared->dim_inf_24_1 * (j - 1) + i - 1] - internal.age_I24[shared->dim_age_I24_1 * (j - 1) + i + 1 - 1];
      }
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      for (int j = 1; j <= 3; ++j) {
        internal.n_I34[i - 1 + shared->dim_n_I34_1 * (j - 1)] = internal.nvacc_I34[shared->dim_nvacc_I34_1 * (j - 1) + i - 1] + I34[shared->dim_I34_1 * (j - 1) + i - 1] - internal.O_I34[shared->dim_O_I34_1 * (j - 1) + i - 1] + internal.inf_34[shared->dim_inf_34_1 * (j - 1) + i - 1] - internal.age_I34[shared->dim_age_I34_1 * (j - 1) + i + 1 - 1];
      }
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      for (int j = 1; j <= 3; ++j) {
        internal.n_I43[i - 1 + shared->dim_n_I43_1 * (j - 1)] = internal.nvacc_I43[shared->dim_nvacc_I43_1 * (j - 1) + i - 1] + I43[shared->dim_I43_1 * (j - 1) + i - 1] - internal.O_I43[shared->dim_O_I43_1 * (j - 1) + i - 1] + internal.inf_43[shared->dim_inf_43_1 * (j - 1) + i - 1] - internal.age_I43[shared->dim_age_I43_1 * (j - 1) + i + 1 - 1];
      }
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      internal.ncu_I1[i - 1] = dust::random::binomial<real_type>(rng_state, internal.n_I1[shared->dim_n_I1_1 * 0 + i - 1], internal.vcu_noncov[shared->dim_vcu_noncov_1 * 0 + i - 1]);
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      internal.ncu_I124[i - 1] = dust::random::binomial<real_type>(rng_state, internal.n_I124[shared->dim_n_I124_1 * 0 + i - 1], internal.vcu_noncov[shared->dim_vcu_noncov_1 * 0 + i - 1]);
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      internal.ncu_I13[i - 1] = dust::random::binomial<real_type>(rng_state, internal.n_I13[shared->dim_n_I13_1 * 0 + i - 1], internal.vcu_noncov[shared->dim_vcu_noncov_1 * 0 + i - 1]);
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      internal.ncu_I134[i - 1] = dust::random::binomial<real_type>(rng_state, internal.n_I134[shared->dim_n_I134_1 * 0 + i - 1], internal.vcu_noncov[shared->dim_vcu_noncov_1 * 0 + i - 1]);
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      internal.ncu_I143[i - 1] = dust::random::binomial<real_type>(rng_state, internal.n_I143[shared->dim_n_I143_1 * 0 + i - 1], internal.vcu_noncov[shared->dim_vcu_noncov_1 * 0 + i - 1]);
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      internal.ncu_I23[i - 1] = dust::random::binomial<real_type>(rng_state, internal.n_I23[shared->dim_n_I23_1 * 0 + i - 1], internal.vcu_noncov[shared->dim_vcu_noncov_1 * 0 + i - 1]);
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      internal.ncu_I234[i - 1] = dust::random::binomial<real_type>(rng_state, internal.n_I234[shared->dim_n_I234_1 * 0 + i - 1], internal.vcu_noncov[shared->dim_vcu_noncov_1 * 0 + i - 1]);
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      internal.ncu_I243[i - 1] = dust::random::binomial<real_type>(rng_state, internal.n_I243[shared->dim_n_I243_1 * 0 + i - 1], internal.vcu_noncov[shared->dim_vcu_noncov_1 * 0 + i - 1]);
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      internal.ncu_I32[i - 1] = dust::random::binomial<real_type>(rng_state, internal.n_I32[shared->dim_n_I32_1 * 0 + i - 1], internal.vcu_noncov[shared->dim_vcu_noncov_1 * 0 + i - 1]);
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      internal.ncu_I342[i - 1] = dust::random::binomial<real_type>(rng_state, internal.n_I342[shared->dim_n_I342_1 * 0 + i - 1], internal.vcu_noncov[shared->dim_vcu_noncov_1 * 0 + i - 1]);
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      internal.ncu_I42[i - 1] = dust::random::binomial<real_type>(rng_state, internal.n_I42[shared->dim_n_I42_1 * 0 + i - 1], internal.vcu_noncov[shared->dim_vcu_noncov_1 * 0 + i - 1]);
    }
    for (int i = 2; i <= shared->N_age; ++i) {
      int j = 1;
      internal.nvacc_I3[i - 1 + shared->dim_nvacc_I3_1 * (j - 1)] = dust::random::binomial<real_type>(rng_state, internal.age_I3[shared->dim_age_I3_1 * (j - 1) + i - 1], internal.vacc_noncov[shared->dim_vacc_noncov_1 * (j - 1) + i - 1]);
    }
    {
       int i = 1;
       int j = 1;
       internal.nvacc_I3[i - 1 + shared->dim_nvacc_I3_1 * (j - 1)] = 0;
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      int j = 2;
      internal.nvacc_I3[i - 1 + shared->dim_nvacc_I3_1 * (j - 1)] = internal.age_I3[shared->dim_age_I3_1 * (j - 1) + i - 1] + internal.age_I3[shared->dim_age_I3_1 * 0 + i - 1] - internal.nvacc_I3[shared->dim_nvacc_I3_1 * 0 + i - 1];
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      int j = 3;
      internal.nvacc_I3[i - 1 + shared->dim_nvacc_I3_1 * (j - 1)] = internal.age_I3[shared->dim_age_I3_1 * (j - 1) + i - 1];
    }
    for (int i = 1; i <= 4; ++i) {
      internal.sdis_sero_unvacc[i - 1] = odin_sum3<real_type>(internal.sdisease_sero.data(), 0, shared->dim_sdisease_sero_1, 0, 1, i - 1, i, shared->dim_sdisease_sero_1, shared->dim_sdisease_sero_12);
    }
    for (int i = 1; i <= 4; ++i) {
      internal.sdis_sero_vacc[i - 1] = odin_sum3<real_type>(internal.sdisease_sero.data(), 0, shared->dim_sdisease_sero_1, 1, 2, i - 1, i, shared->dim_sdisease_sero_1, shared->dim_sdisease_sero_12) + odin_sum3<real_type>(internal.sdisease_sero.data(), 0, shared->dim_sdisease_sero_1, 2, 3, i - 1, i, shared->dim_sdisease_sero_1, shared->dim_sdisease_sero_12);
    }
    for (int i = 1; i <= 4; ++i) {
      internal.sdis_sero_vacc_neg[i - 1] = odin_sum2<real_type>(internal.sdisease_sero_vacc_pri.data(), 0, shared->dim_sdisease_sero_vacc_pri_1, i - 1, i, shared->dim_sdisease_sero_vacc_pri_1);
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      state_next[shared->offset_variable_cum_infection_pri + i - 1] = cum_infection_pri[i - 1] + internal.infection_pri[shared->dim_infection_pri_1 * 0 + i - 1] + internal.infection_pri[shared->dim_infection_pri_1 * 1 + i - 1] + internal.infection_pri[shared->dim_infection_pri_1 * 2 + i - 1];
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      state_next[shared->offset_variable_cum_infection_priV + i - 1] = cum_infection_priV[i - 1] + internal.infection_pri[shared->dim_infection_pri_1 * 1 + i - 1] + internal.infection_pri[shared->dim_infection_pri_1 * 2 + i - 1];
    }
    state_next[33] = exposed3 + Y3T - exposed3 * shared->DT / (real_type) shared->incub;
    for (int i = 1; i <= shared->N_age; ++i) {
      int j = 1;
      state_next[shared->offset_variable_I12 + i - 1 + shared->dim_I12_1 * (j - 1)] = internal.ncu_I12[i - 1];
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      int j = 2;
      state_next[shared->offset_variable_I12 + i - 1 + shared->dim_I12_1 * (j - 1)] = internal.n_I12[shared->dim_n_I12_1 * (j - 1) + i - 1] + internal.n_I12[shared->dim_n_I12_1 * 0 + i - 1] - internal.ncu_I12[i - 1] - internal.vw_I12[i - 1];
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      int j = 3;
      state_next[shared->offset_variable_I12 + i - 1 + shared->dim_I12_1 * (j - 1)] = internal.n_I12[shared->dim_n_I12_1 * (j - 1) + i - 1] + internal.vw_I12[i - 1];
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      int j = 1;
      state_next[shared->offset_variable_I123 + i - 1 + shared->dim_I123_1 * (j - 1)] = internal.ncu_I123[i - 1];
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      int j = 2;
      state_next[shared->offset_variable_I123 + i - 1 + shared->dim_I123_1 * (j - 1)] = internal.n_I123[shared->dim_n_I123_1 * (j - 1) + i - 1] + internal.n_I123[shared->dim_n_I123_1 * 0 + i - 1] - internal.ncu_I123[i - 1] - internal.vw_I123[i - 1];
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      int j = 3;
      state_next[shared->offset_variable_I123 + i - 1 + shared->dim_I123_1 * (j - 1)] = internal.n_I123[shared->dim_n_I123_1 * (j - 1) + i - 1] + internal.vw_I123[i - 1];
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      int j = 1;
      state_next[shared->offset_variable_I1234 + i - 1 + shared->dim_I1234_1 * (j - 1)] = internal.ncu_I1234[i - 1];
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      int j = 2;
      state_next[shared->offset_variable_I1234 + i - 1 + shared->dim_I1234_1 * (j - 1)] = internal.n_I1234[shared->dim_n_I1234_1 * (j - 1) + i - 1] + internal.n_I1234[shared->dim_n_I1234_1 * 0 + i - 1] - internal.ncu_I1234[i - 1] - internal.vw_I1234[i - 1];
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      int j = 3;
      state_next[shared->offset_variable_I1234 + i - 1 + shared->dim_I1234_1 * (j - 1)] = internal.n_I1234[shared->dim_n_I1234_1 * (j - 1) + i - 1] + internal.vw_I1234[i - 1];
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      int j = 1;
      state_next[shared->offset_variable_I1243 + i - 1 + shared->dim_I1243_1 * (j - 1)] = internal.ncu_I1243[i - 1];
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      int j = 2;
      state_next[shared->offset_variable_I1243 + i - 1 + shared->dim_I1243_1 * (j - 1)] = internal.n_I1243[shared->dim_n_I1243_1 * (j - 1) + i - 1] + internal.n_I1243[shared->dim_n_I1243_1 * 0 + i - 1] - internal.ncu_I1243[i - 1] - internal.vw_I1243[i - 1];
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      int j = 3;
      state_next[shared->offset_variable_I1243 + i - 1 + shared->dim_I1243_1 * (j - 1)] = internal.n_I1243[shared->dim_n_I1243_1 * (j - 1) + i - 1] + internal.vw_I1243[i - 1];
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      int j = 1;
      state_next[shared->offset_variable_I132 + i - 1 + shared->dim_I132_1 * (j - 1)] = internal.ncu_I132[i - 1];
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      int j = 2;
      state_next[shared->offset_variable_I132 + i - 1 + shared->dim_I132_1 * (j - 1)] = internal.n_I132[shared->dim_n_I132_1 * (j - 1) + i - 1] + internal.n_I132[shared->dim_n_I132_1 * 0 + i - 1] - internal.ncu_I132[i - 1] - internal.vw_I132[i - 1];
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      int j = 3;
      state_next[shared->offset_variable_I132 + i - 1 + shared->dim_I132_1 * (j - 1)] = internal.n_I132[shared->dim_n_I132_1 * (j - 1) + i - 1] + internal.vw_I132[i - 1];
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      int j = 1;
      state_next[shared->offset_variable_I1342 + i - 1 + shared->dim_I1342_1 * (j - 1)] = internal.ncu_I1342[i - 1];
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      int j = 2;
      state_next[shared->offset_variable_I1342 + i - 1 + shared->dim_I1342_1 * (j - 1)] = internal.n_I1342[shared->dim_n_I1342_1 * (j - 1) + i - 1] + internal.n_I1342[shared->dim_n_I1342_1 * 0 + i - 1] - internal.ncu_I1342[i - 1] - internal.vw_I1342[i - 1];
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      int j = 3;
      state_next[shared->offset_variable_I1342 + i - 1 + shared->dim_I1342_1 * (j - 1)] = internal.n_I1342[shared->dim_n_I1342_1 * (j - 1) + i - 1] + internal.vw_I1342[i - 1];
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      int j = 1;
      state_next[shared->offset_variable_I142 + i - 1 + shared->dim_I142_1 * (j - 1)] = internal.ncu_I142[i - 1];
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      int j = 2;
      state_next[shared->offset_variable_I142 + i - 1 + shared->dim_I142_1 * (j - 1)] = internal.n_I142[shared->dim_n_I142_1 * (j - 1) + i - 1] + internal.n_I142[shared->dim_n_I142_1 * 0 + i - 1] - internal.ncu_I142[i - 1] - internal.vw_I142[i - 1];
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      int j = 3;
      state_next[shared->offset_variable_I142 + i - 1 + shared->dim_I142_1 * (j - 1)] = internal.n_I142[shared->dim_n_I142_1 * (j - 1) + i - 1] + internal.vw_I142[i - 1];
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      int j = 1;
      state_next[shared->offset_variable_I21 + i - 1 + shared->dim_I21_1 * (j - 1)] = internal.ncu_I21[i - 1];
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      int j = 2;
      state_next[shared->offset_variable_I21 + i - 1 + shared->dim_I21_1 * (j - 1)] = internal.n_I21[shared->dim_n_I21_1 * (j - 1) + i - 1] + internal.n_I21[shared->dim_n_I21_1 * 0 + i - 1] - internal.ncu_I21[i - 1] - internal.vw_I21[i - 1];
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      int j = 3;
      state_next[shared->offset_variable_I21 + i - 1 + shared->dim_I21_1 * (j - 1)] = internal.n_I21[shared->dim_n_I21_1 * (j - 1) + i - 1] + internal.vw_I21[i - 1];
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      int j = 1;
      state_next[shared->offset_variable_I231 + i - 1 + shared->dim_I231_1 * (j - 1)] = internal.ncu_I231[i - 1];
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      int j = 2;
      state_next[shared->offset_variable_I231 + i - 1 + shared->dim_I231_1 * (j - 1)] = internal.n_I231[shared->dim_n_I231_1 * (j - 1) + i - 1] + internal.n_I231[shared->dim_n_I231_1 * 0 + i - 1] - internal.ncu_I231[i - 1] - internal.vw_I231[i - 1];
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      int j = 3;
      state_next[shared->offset_variable_I231 + i - 1 + shared->dim_I231_1 * (j - 1)] = internal.n_I231[shared->dim_n_I231_1 * (j - 1) + i - 1] + internal.vw_I231[i - 1];
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      int j = 1;
      state_next[shared->offset_variable_I2341 + i - 1 + shared->dim_I2341_1 * (j - 1)] = internal.ncu_I2341[i - 1];
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      int j = 2;
      state_next[shared->offset_variable_I2341 + i - 1 + shared->dim_I2341_1 * (j - 1)] = internal.n_I2341[shared->dim_n_I2341_1 * (j - 1) + i - 1] + internal.n_I2341[shared->dim_n_I2341_1 * 0 + i - 1] - internal.ncu_I2341[i - 1] - internal.vw_I2341[i - 1];
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      int j = 3;
      state_next[shared->offset_variable_I2341 + i - 1 + shared->dim_I2341_1 * (j - 1)] = internal.n_I2341[shared->dim_n_I2341_1 * (j - 1) + i - 1] + internal.vw_I2341[i - 1];
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      int j = 1;
      state_next[shared->offset_variable_I241 + i - 1 + shared->dim_I241_1 * (j - 1)] = internal.ncu_I241[i - 1];
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      int j = 2;
      state_next[shared->offset_variable_I241 + i - 1 + shared->dim_I241_1 * (j - 1)] = internal.n_I241[shared->dim_n_I241_1 * (j - 1) + i - 1] + internal.n_I241[shared->dim_n_I241_1 * 0 + i - 1] - internal.ncu_I241[i - 1] - internal.vw_I241[i - 1];
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      int j = 3;
      state_next[shared->offset_variable_I241 + i - 1 + shared->dim_I241_1 * (j - 1)] = internal.n_I241[shared->dim_n_I241_1 * (j - 1) + i - 1] + internal.vw_I241[i - 1];
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      int j = 1;
      state_next[shared->offset_variable_I31 + i - 1 + shared->dim_I31_1 * (j - 1)] = internal.ncu_I31[i - 1];
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      int j = 2;
      state_next[shared->offset_variable_I31 + i - 1 + shared->dim_I31_1 * (j - 1)] = internal.n_I31[shared->dim_n_I31_1 * (j - 1) + i - 1] + internal.n_I31[shared->dim_n_I31_1 * 0 + i - 1] - internal.ncu_I31[i - 1] - internal.vw_I31[i - 1];
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      int j = 3;
      state_next[shared->offset_variable_I31 + i - 1 + shared->dim_I31_1 * (j - 1)] = internal.n_I31[shared->dim_n_I31_1 * (j - 1) + i - 1] + internal.vw_I31[i - 1];
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      int j = 1;
      state_next[shared->offset_variable_I341 + i - 1 + shared->dim_I341_1 * (j - 1)] = internal.ncu_I341[i - 1];
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      int j = 2;
      state_next[shared->offset_variable_I341 + i - 1 + shared->dim_I341_1 * (j - 1)] = internal.n_I341[shared->dim_n_I341_1 * (j - 1) + i - 1] + internal.n_I341[shared->dim_n_I341_1 * 0 + i - 1] - internal.ncu_I341[i - 1] - internal.vw_I341[i - 1];
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      int j = 3;
      state_next[shared->offset_variable_I341 + i - 1 + shared->dim_I341_1 * (j - 1)] = internal.n_I341[shared->dim_n_I341_1 * (j - 1) + i - 1] + internal.vw_I341[i - 1];
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      int j = 1;
      state_next[shared->offset_variable_I41 + i - 1 + shared->dim_I41_1 * (j - 1)] = internal.ncu_I41[i - 1];
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      int j = 2;
      state_next[shared->offset_variable_I41 + i - 1 + shared->dim_I41_1 * (j - 1)] = internal.n_I41[shared->dim_n_I41_1 * (j - 1) + i - 1] + internal.n_I41[shared->dim_n_I41_1 * 0 + i - 1] - internal.ncu_I41[i - 1] - internal.vw_I41[i - 1];
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      int j = 3;
      state_next[shared->offset_variable_I41 + i - 1 + shared->dim_I41_1 * (j - 1)] = internal.n_I41[shared->dim_n_I41_1 * (j - 1) + i - 1] + internal.vw_I41[i - 1];
    }
    state_next[29] = Y3T;
    for (int i = 1; i <= shared->N_age; ++i) {
      internal.vw_I1[i - 1] = dust::random::binomial<real_type>(rng_state, internal.n_I1[shared->dim_n_I1_1 * 1 + i - 1], shared->vacc_decay);
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      internal.vw_I124[i - 1] = dust::random::binomial<real_type>(rng_state, internal.n_I124[shared->dim_n_I124_1 * 1 + i - 1], shared->vacc_decay);
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      internal.vw_I13[i - 1] = dust::random::binomial<real_type>(rng_state, internal.n_I13[shared->dim_n_I13_1 * 1 + i - 1], shared->vacc_decay);
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      internal.vw_I134[i - 1] = dust::random::binomial<real_type>(rng_state, internal.n_I134[shared->dim_n_I134_1 * 1 + i - 1], shared->vacc_decay);
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      internal.vw_I143[i - 1] = dust::random::binomial<real_type>(rng_state, internal.n_I143[shared->dim_n_I143_1 * 1 + i - 1], shared->vacc_decay);
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      internal.vw_I23[i - 1] = dust::random::binomial<real_type>(rng_state, internal.n_I23[shared->dim_n_I23_1 * 1 + i - 1], shared->vacc_decay);
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      internal.vw_I234[i - 1] = dust::random::binomial<real_type>(rng_state, internal.n_I234[shared->dim_n_I234_1 * 1 + i - 1], shared->vacc_decay);
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      internal.vw_I243[i - 1] = dust::random::binomial<real_type>(rng_state, internal.n_I243[shared->dim_n_I243_1 * 1 + i - 1], shared->vacc_decay);
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      internal.vw_I32[i - 1] = dust::random::binomial<real_type>(rng_state, internal.n_I32[shared->dim_n_I32_1 * 1 + i - 1], shared->vacc_decay);
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      internal.vw_I342[i - 1] = dust::random::binomial<real_type>(rng_state, internal.n_I342[shared->dim_n_I342_1 * 1 + i - 1], shared->vacc_decay);
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      internal.vw_I42[i - 1] = dust::random::binomial<real_type>(rng_state, internal.n_I42[shared->dim_n_I42_1 * 1 + i - 1], shared->vacc_decay);
    }
    real_type Y4T = odin_sum1<real_type>(internal.Y4.data(), 0, shared->dim_Y4) / (real_type) NT;
    for (int i = 1; i <= shared->N_age; ++i) {
      for (int j = 1; j <= 3; ++j) {
        for (int k = 1; k <= 4; ++k) {
          internal.yll_sero[i - 1 + shared->dim_yll_sero_1 * (j - 1) + shared->dim_yll_sero_12 * (k - 1)] = internal.sdisease_sero[shared->dim_sdisease_sero_12 * (k - 1) + shared->dim_sdisease_sero_1 * (j - 1) + i - 1] * shared->cfr * internal.life_expec[i - 1];
        }
      }
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      for (int j = 1; j <= 4; ++j) {
        internal.yll_sero_vacc_pri[i - 1 + shared->dim_yll_sero_vacc_pri_1 * (j - 1)] = internal.sdisease_sero_vacc_pri[shared->dim_sdisease_sero_vacc_pri_1 * (j - 1) + i - 1] * shared->cfr * internal.life_expec[i - 1];
      }
    }
    real_type dis_all_unvacc = odin_sum1<real_type>(internal.dis_sero_unvacc.data(), 0, shared->dim_dis_sero_unvacc);
    real_type dis_all_vacc = odin_sum1<real_type>(internal.dis_sero_vacc.data(), 0, shared->dim_dis_sero_vacc);
    real_type dis_all_vacc_neg = odin_sum1<real_type>(internal.dis_sero_vacc_neg.data(), 0, shared->dim_dis_sero_vacc_neg);
    for (int i = 1; i <= 4; ++i) {
      internal.dis_sero_pop[i - 1] = internal.dis_sero_unvacc[i - 1] + internal.dis_sero_vacc[i - 1];
    }
    for (int i = 1; i <= 4; ++i) {
      internal.dis_sero_vacc_pos[i - 1] = internal.dis_sero_vacc[i - 1] - internal.dis_sero_vacc_neg[i - 1];
    }
    real_type disc_yll_all_unvacc = odin_sum2<real_type>(internal.disc_yll_all.data(), 0, shared->dim_disc_yll_all_1, 0, 1, shared->dim_disc_yll_all_1) * cum_disc;
    real_type disc_yll_all_vacc = (odin_sum2<real_type>(internal.disc_yll_all.data(), 0, shared->dim_disc_yll_all_1, 1, 2, shared->dim_disc_yll_all_1) + odin_sum2<real_type>(internal.disc_yll_all.data(), 0, shared->dim_disc_yll_all_1, 2, 3, shared->dim_disc_yll_all_1)) * cum_disc;
    for (int i = 1; i <= shared->N_age; ++i) {
      for (int j = 1; j <= 3; ++j) {
        internal.n_I3[i - 1 + shared->dim_n_I3_1 * (j - 1)] = internal.nvacc_I3[shared->dim_nvacc_I3_1 * (j - 1) + i - 1] + I3[shared->dim_I3_1 * (j - 1) + i - 1] - internal.O_I3[shared->dim_O_I3_1 * (j - 1) + i - 1] + internal.infV_3[shared->dim_infV_3_1 * (j - 1) + i - 1] - internal.age_I3[shared->dim_age_I3_1 * (j - 1) + i + 1 - 1];
      }
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      internal.ncu_I14[i - 1] = dust::random::binomial<real_type>(rng_state, internal.n_I14[shared->dim_n_I14_1 * 0 + i - 1], internal.vcu_noncov[shared->dim_vcu_noncov_1 * 0 + i - 1]);
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      internal.ncu_I2[i - 1] = dust::random::binomial<real_type>(rng_state, internal.n_I2[shared->dim_n_I2_1 * 0 + i - 1], internal.vcu_noncov[shared->dim_vcu_noncov_1 * 0 + i - 1]);
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      internal.ncu_I24[i - 1] = dust::random::binomial<real_type>(rng_state, internal.n_I24[shared->dim_n_I24_1 * 0 + i - 1], internal.vcu_noncov[shared->dim_vcu_noncov_1 * 0 + i - 1]);
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      internal.ncu_I34[i - 1] = dust::random::binomial<real_type>(rng_state, internal.n_I34[shared->dim_n_I34_1 * 0 + i - 1], internal.vcu_noncov[shared->dim_vcu_noncov_1 * 0 + i - 1]);
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      internal.ncu_I43[i - 1] = dust::random::binomial<real_type>(rng_state, internal.n_I43[shared->dim_n_I43_1 * 0 + i - 1], internal.vcu_noncov[shared->dim_vcu_noncov_1 * 0 + i - 1]);
    }
    for (int i = 2; i <= shared->N_age; ++i) {
      int j = 1;
      internal.nvacc_I4[i - 1 + shared->dim_nvacc_I4_1 * (j - 1)] = dust::random::binomial<real_type>(rng_state, internal.age_I4[shared->dim_age_I4_1 * (j - 1) + i - 1], internal.vacc_noncov[shared->dim_vacc_noncov_1 * (j - 1) + i - 1]);
    }
    {
       int i = 1;
       int j = 1;
       internal.nvacc_I4[i - 1 + shared->dim_nvacc_I4_1 * (j - 1)] = 0;
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      int j = 2;
      internal.nvacc_I4[i - 1 + shared->dim_nvacc_I4_1 * (j - 1)] = internal.age_I4[shared->dim_age_I4_1 * (j - 1) + i - 1] + internal.age_I4[shared->dim_age_I4_1 * 0 + i - 1] - internal.nvacc_I4[shared->dim_nvacc_I4_1 * 0 + i - 1];
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      int j = 3;
      internal.nvacc_I4[i - 1 + shared->dim_nvacc_I4_1 * (j - 1)] = internal.age_I4[shared->dim_age_I4_1 * (j - 1) + i - 1];
    }
    real_type sdis_all_unvacc = odin_sum1<real_type>(internal.sdis_sero_unvacc.data(), 0, shared->dim_sdis_sero_unvacc);
    real_type sdis_all_vacc = odin_sum1<real_type>(internal.sdis_sero_vacc.data(), 0, shared->dim_sdis_sero_vacc);
    real_type sdis_all_vacc_neg = odin_sum1<real_type>(internal.sdis_sero_vacc_neg.data(), 0, shared->dim_sdis_sero_vacc_neg);
    for (int i = 1; i <= 4; ++i) {
      internal.sdis_sero_pop[i - 1] = internal.sdis_sero_unvacc[i - 1] + internal.sdis_sero_vacc[i - 1];
    }
    for (int i = 1; i <= 4; ++i) {
      internal.sdis_sero_vacc_pos[i - 1] = internal.sdis_sero_vacc[i - 1] - internal.sdis_sero_vacc_neg[i - 1];
    }
    state_next[34] = exposed4 + Y4T - exposed4 * shared->DT / (real_type) shared->incub;
    for (int i = 1; i <= shared->N_age; ++i) {
      int j = 1;
      state_next[shared->offset_variable_I1 + i - 1 + shared->dim_I1_1 * (j - 1)] = internal.ncu_I1[i - 1];
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      int j = 2;
      state_next[shared->offset_variable_I1 + i - 1 + shared->dim_I1_1 * (j - 1)] = internal.n_I1[shared->dim_n_I1_1 * (j - 1) + i - 1] + internal.n_I1[shared->dim_n_I1_1 * 0 + i - 1] - internal.ncu_I1[i - 1] - internal.vw_I1[i - 1];
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      int j = 3;
      state_next[shared->offset_variable_I1 + i - 1 + shared->dim_I1_1 * (j - 1)] = internal.n_I1[shared->dim_n_I1_1 * (j - 1) + i - 1] + internal.vw_I1[i - 1];
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      int j = 1;
      state_next[shared->offset_variable_I124 + i - 1 + shared->dim_I124_1 * (j - 1)] = internal.ncu_I124[i - 1];
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      int j = 2;
      state_next[shared->offset_variable_I124 + i - 1 + shared->dim_I124_1 * (j - 1)] = internal.n_I124[shared->dim_n_I124_1 * (j - 1) + i - 1] + internal.n_I124[shared->dim_n_I124_1 * 0 + i - 1] - internal.ncu_I124[i - 1] - internal.vw_I124[i - 1];
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      int j = 3;
      state_next[shared->offset_variable_I124 + i - 1 + shared->dim_I124_1 * (j - 1)] = internal.n_I124[shared->dim_n_I124_1 * (j - 1) + i - 1] + internal.vw_I124[i - 1];
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      int j = 1;
      state_next[shared->offset_variable_I13 + i - 1 + shared->dim_I13_1 * (j - 1)] = internal.ncu_I13[i - 1];
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      int j = 2;
      state_next[shared->offset_variable_I13 + i - 1 + shared->dim_I13_1 * (j - 1)] = internal.n_I13[shared->dim_n_I13_1 * (j - 1) + i - 1] + internal.n_I13[shared->dim_n_I13_1 * 0 + i - 1] - internal.ncu_I13[i - 1] - internal.vw_I13[i - 1];
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      int j = 3;
      state_next[shared->offset_variable_I13 + i - 1 + shared->dim_I13_1 * (j - 1)] = internal.n_I13[shared->dim_n_I13_1 * (j - 1) + i - 1] + internal.vw_I13[i - 1];
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      int j = 1;
      state_next[shared->offset_variable_I134 + i - 1 + shared->dim_I134_1 * (j - 1)] = internal.ncu_I134[i - 1];
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      int j = 2;
      state_next[shared->offset_variable_I134 + i - 1 + shared->dim_I134_1 * (j - 1)] = internal.n_I134[shared->dim_n_I134_1 * (j - 1) + i - 1] + internal.n_I134[shared->dim_n_I134_1 * 0 + i - 1] - internal.ncu_I134[i - 1] - internal.vw_I134[i - 1];
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      int j = 3;
      state_next[shared->offset_variable_I134 + i - 1 + shared->dim_I134_1 * (j - 1)] = internal.n_I134[shared->dim_n_I134_1 * (j - 1) + i - 1] + internal.vw_I134[i - 1];
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      int j = 1;
      state_next[shared->offset_variable_I143 + i - 1 + shared->dim_I143_1 * (j - 1)] = internal.ncu_I143[i - 1];
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      int j = 2;
      state_next[shared->offset_variable_I143 + i - 1 + shared->dim_I143_1 * (j - 1)] = internal.n_I143[shared->dim_n_I143_1 * (j - 1) + i - 1] + internal.n_I143[shared->dim_n_I143_1 * 0 + i - 1] - internal.ncu_I143[i - 1] - internal.vw_I143[i - 1];
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      int j = 3;
      state_next[shared->offset_variable_I143 + i - 1 + shared->dim_I143_1 * (j - 1)] = internal.n_I143[shared->dim_n_I143_1 * (j - 1) + i - 1] + internal.vw_I143[i - 1];
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      int j = 1;
      state_next[shared->offset_variable_I23 + i - 1 + shared->dim_I23_1 * (j - 1)] = internal.ncu_I23[i - 1];
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      int j = 2;
      state_next[shared->offset_variable_I23 + i - 1 + shared->dim_I23_1 * (j - 1)] = internal.n_I23[shared->dim_n_I23_1 * (j - 1) + i - 1] + internal.n_I23[shared->dim_n_I23_1 * 0 + i - 1] - internal.ncu_I23[i - 1] - internal.vw_I23[i - 1];
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      int j = 3;
      state_next[shared->offset_variable_I23 + i - 1 + shared->dim_I23_1 * (j - 1)] = internal.n_I23[shared->dim_n_I23_1 * (j - 1) + i - 1] + internal.vw_I23[i - 1];
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      int j = 1;
      state_next[shared->offset_variable_I234 + i - 1 + shared->dim_I234_1 * (j - 1)] = internal.ncu_I234[i - 1];
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      int j = 2;
      state_next[shared->offset_variable_I234 + i - 1 + shared->dim_I234_1 * (j - 1)] = internal.n_I234[shared->dim_n_I234_1 * (j - 1) + i - 1] + internal.n_I234[shared->dim_n_I234_1 * 0 + i - 1] - internal.ncu_I234[i - 1] - internal.vw_I234[i - 1];
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      int j = 3;
      state_next[shared->offset_variable_I234 + i - 1 + shared->dim_I234_1 * (j - 1)] = internal.n_I234[shared->dim_n_I234_1 * (j - 1) + i - 1] + internal.vw_I234[i - 1];
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      int j = 1;
      state_next[shared->offset_variable_I243 + i - 1 + shared->dim_I243_1 * (j - 1)] = internal.ncu_I243[i - 1];
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      int j = 2;
      state_next[shared->offset_variable_I243 + i - 1 + shared->dim_I243_1 * (j - 1)] = internal.n_I243[shared->dim_n_I243_1 * (j - 1) + i - 1] + internal.n_I243[shared->dim_n_I243_1 * 0 + i - 1] - internal.ncu_I243[i - 1] - internal.vw_I243[i - 1];
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      int j = 3;
      state_next[shared->offset_variable_I243 + i - 1 + shared->dim_I243_1 * (j - 1)] = internal.n_I243[shared->dim_n_I243_1 * (j - 1) + i - 1] + internal.vw_I243[i - 1];
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      int j = 1;
      state_next[shared->offset_variable_I32 + i - 1 + shared->dim_I32_1 * (j - 1)] = internal.ncu_I32[i - 1];
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      int j = 2;
      state_next[shared->offset_variable_I32 + i - 1 + shared->dim_I32_1 * (j - 1)] = internal.n_I32[shared->dim_n_I32_1 * (j - 1) + i - 1] + internal.n_I32[shared->dim_n_I32_1 * 0 + i - 1] - internal.ncu_I32[i - 1] - internal.vw_I32[i - 1];
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      int j = 3;
      state_next[shared->offset_variable_I32 + i - 1 + shared->dim_I32_1 * (j - 1)] = internal.n_I32[shared->dim_n_I32_1 * (j - 1) + i - 1] + internal.vw_I32[i - 1];
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      int j = 1;
      state_next[shared->offset_variable_I342 + i - 1 + shared->dim_I342_1 * (j - 1)] = internal.ncu_I342[i - 1];
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      int j = 2;
      state_next[shared->offset_variable_I342 + i - 1 + shared->dim_I342_1 * (j - 1)] = internal.n_I342[shared->dim_n_I342_1 * (j - 1) + i - 1] + internal.n_I342[shared->dim_n_I342_1 * 0 + i - 1] - internal.ncu_I342[i - 1] - internal.vw_I342[i - 1];
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      int j = 3;
      state_next[shared->offset_variable_I342 + i - 1 + shared->dim_I342_1 * (j - 1)] = internal.n_I342[shared->dim_n_I342_1 * (j - 1) + i - 1] + internal.vw_I342[i - 1];
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      int j = 1;
      state_next[shared->offset_variable_I42 + i - 1 + shared->dim_I42_1 * (j - 1)] = internal.ncu_I42[i - 1];
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      int j = 2;
      state_next[shared->offset_variable_I42 + i - 1 + shared->dim_I42_1 * (j - 1)] = internal.n_I42[shared->dim_n_I42_1 * (j - 1) + i - 1] + internal.n_I42[shared->dim_n_I42_1 * 0 + i - 1] - internal.ncu_I42[i - 1] - internal.vw_I42[i - 1];
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      int j = 3;
      state_next[shared->offset_variable_I42 + i - 1 + shared->dim_I42_1 * (j - 1)] = internal.n_I42[shared->dim_n_I42_1 * (j - 1) + i - 1] + internal.vw_I42[i - 1];
    }
    for (int i = 1; i <= shared->NYO; ++i) {
      for (int j = 1; j <= 4; ++j) {
        state_next[shared->offset_variable_out_dis_sero_unvacc + i - 1 + shared->dim_out_dis_sero_unvacc_1 * (j - 1)] = out_dis_sero_unvacc[shared->dim_out_dis_sero_unvacc_1 * (j - 1) + i - 1] + ((internal.out_update_switch[i - 1] == 0 ? 0 : internal.dis_sero_unvacc[j - 1]));
      }
    }
    for (int i = 1; i <= shared->NYO; ++i) {
      for (int j = 1; j <= 4; ++j) {
        state_next[shared->offset_variable_out_dis_sero_vacc + i - 1 + shared->dim_out_dis_sero_vacc_1 * (j - 1)] = out_dis_sero_vacc[shared->dim_out_dis_sero_vacc_1 * (j - 1) + i - 1] + ((internal.out_update_switch[i - 1] == 0 ? 0 : internal.dis_sero_vacc[j - 1]));
      }
    }
    for (int i = 1; i <= shared->NYO; ++i) {
      for (int j = 1; j <= 4; ++j) {
        state_next[shared->offset_variable_out_dis_sero_vacc_neg + i - 1 + shared->dim_out_dis_sero_vacc_neg_1 * (j - 1)] = out_dis_sero_vacc_neg[shared->dim_out_dis_sero_vacc_neg_1 * (j - 1) + i - 1] + ((internal.out_update_switch[i - 1] == 0 ? 0 : internal.dis_sero_vacc_neg[j - 1]));
      }
    }
    for (int i = 1; i <= shared->NYO; ++i) {
      for (int j = 1; j <= 4; ++j) {
        state_next[shared->offset_variable_out_sdis_sero_unvacc + i - 1 + shared->dim_out_sdis_sero_unvacc_1 * (j - 1)] = out_sdis_sero_unvacc[shared->dim_out_sdis_sero_unvacc_1 * (j - 1) + i - 1] + ((internal.out_update_switch[i - 1] == 0 ? 0 : internal.sdis_sero_unvacc[j - 1]));
      }
    }
    for (int i = 1; i <= shared->NYO; ++i) {
      for (int j = 1; j <= 4; ++j) {
        state_next[shared->offset_variable_out_sdis_sero_vacc + i - 1 + shared->dim_out_sdis_sero_vacc_1 * (j - 1)] = out_sdis_sero_vacc[shared->dim_out_sdis_sero_vacc_1 * (j - 1) + i - 1] + ((internal.out_update_switch[i - 1] == 0 ? 0 : internal.sdis_sero_vacc[j - 1]));
      }
    }
    for (int i = 1; i <= shared->NYO; ++i) {
      for (int j = 1; j <= 4; ++j) {
        state_next[shared->offset_variable_out_sdis_sero_vacc_neg + i - 1 + shared->dim_out_sdis_sero_vacc_neg_1 * (j - 1)] = out_sdis_sero_vacc_neg[shared->dim_out_sdis_sero_vacc_neg_1 * (j - 1) + i - 1] + ((internal.out_update_switch[i - 1] == 0 ? 0 : internal.sdis_sero_vacc_neg[j - 1]));
      }
    }
    state_next[30] = Y4T;
    for (int i = 1; i <= shared->N_age; ++i) {
      internal.vw_I14[i - 1] = dust::random::binomial<real_type>(rng_state, internal.n_I14[shared->dim_n_I14_1 * 1 + i - 1], shared->vacc_decay);
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      internal.vw_I2[i - 1] = dust::random::binomial<real_type>(rng_state, internal.n_I2[shared->dim_n_I2_1 * 1 + i - 1], shared->vacc_decay);
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      internal.vw_I24[i - 1] = dust::random::binomial<real_type>(rng_state, internal.n_I24[shared->dim_n_I24_1 * 1 + i - 1], shared->vacc_decay);
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      internal.vw_I34[i - 1] = dust::random::binomial<real_type>(rng_state, internal.n_I34[shared->dim_n_I34_1 * 1 + i - 1], shared->vacc_decay);
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      internal.vw_I43[i - 1] = dust::random::binomial<real_type>(rng_state, internal.n_I43[shared->dim_n_I43_1 * 1 + i - 1], shared->vacc_decay);
    }
    for (int i = 1; i <= 4; ++i) {
      internal.yll_sero_unvacc[i - 1] = odin_sum3<real_type>(internal.yll_sero.data(), 0, shared->dim_yll_sero_1, 0, 1, i - 1, i, shared->dim_yll_sero_1, shared->dim_yll_sero_12);
    }
    for (int i = 1; i <= 4; ++i) {
      internal.yll_sero_vacc[i - 1] = odin_sum3<real_type>(internal.yll_sero.data(), 0, shared->dim_yll_sero_1, 1, 2, i - 1, i, shared->dim_yll_sero_1, shared->dim_yll_sero_12) + odin_sum3<real_type>(internal.yll_sero.data(), 0, shared->dim_yll_sero_1, 2, 3, i - 1, i, shared->dim_yll_sero_1, shared->dim_yll_sero_12);
    }
    for (int i = 1; i <= 4; ++i) {
      internal.yll_sero_vacc_neg[i - 1] = odin_sum2<real_type>(internal.yll_sero_vacc_pri.data(), 0, shared->dim_yll_sero_vacc_pri_1, i - 1, i, shared->dim_yll_sero_vacc_pri_1);
    }
    real_type dis_all_pop = odin_sum1<real_type>(internal.dis_sero_pop.data(), 0, shared->dim_dis_sero_pop);
    real_type dis_all_vacc_pos = odin_sum1<real_type>(internal.dis_sero_vacc_pos.data(), 0, shared->dim_dis_sero_vacc_pos);
    real_type disc_dis_all_vacc = dis_all_vacc * cum_disc;
    real_type disc_sdis_all_vacc = sdis_all_vacc * cum_disc;
    real_type disc_yll_all_pop = disc_yll_all_vacc + disc_yll_all_unvacc;
    for (int i = 1; i <= shared->N_age; ++i) {
      for (int j = 1; j <= 3; ++j) {
        internal.n_I4[i - 1 + shared->dim_n_I4_1 * (j - 1)] = internal.nvacc_I4[shared->dim_nvacc_I4_1 * (j - 1) + i - 1] + I4[shared->dim_I4_1 * (j - 1) + i - 1] - internal.O_I4[shared->dim_O_I4_1 * (j - 1) + i - 1] + internal.infV_4[shared->dim_infV_4_1 * (j - 1) + i - 1] - internal.age_I4[shared->dim_age_I4_1 * (j - 1) + i + 1 - 1];
      }
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      internal.ncu_I3[i - 1] = dust::random::binomial<real_type>(rng_state, internal.n_I3[shared->dim_n_I3_1 * 0 + i - 1], internal.vcu_noncov[shared->dim_vcu_noncov_1 * 0 + i - 1]);
    }
    real_type sdis_all_pop = odin_sum1<real_type>(internal.sdis_sero_pop.data(), 0, shared->dim_sdis_sero_pop);
    real_type sdis_all_vacc_pos = odin_sum1<real_type>(internal.sdis_sero_vacc_pos.data(), 0, shared->dim_sdis_sero_vacc_pos);
    for (int i = 1; i <= shared->N_age; ++i) {
      int j = 1;
      state_next[shared->offset_variable_I14 + i - 1 + shared->dim_I14_1 * (j - 1)] = internal.ncu_I14[i - 1];
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      int j = 2;
      state_next[shared->offset_variable_I14 + i - 1 + shared->dim_I14_1 * (j - 1)] = internal.n_I14[shared->dim_n_I14_1 * (j - 1) + i - 1] + internal.n_I14[shared->dim_n_I14_1 * 0 + i - 1] - internal.ncu_I14[i - 1] - internal.vw_I14[i - 1];
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      int j = 3;
      state_next[shared->offset_variable_I14 + i - 1 + shared->dim_I14_1 * (j - 1)] = internal.n_I14[shared->dim_n_I14_1 * (j - 1) + i - 1] + internal.vw_I14[i - 1];
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      int j = 1;
      state_next[shared->offset_variable_I2 + i - 1 + shared->dim_I2_1 * (j - 1)] = internal.ncu_I2[i - 1];
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      int j = 2;
      state_next[shared->offset_variable_I2 + i - 1 + shared->dim_I2_1 * (j - 1)] = internal.n_I2[shared->dim_n_I2_1 * (j - 1) + i - 1] + internal.n_I2[shared->dim_n_I2_1 * 0 + i - 1] - internal.ncu_I2[i - 1] - internal.vw_I2[i - 1];
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      int j = 3;
      state_next[shared->offset_variable_I2 + i - 1 + shared->dim_I2_1 * (j - 1)] = internal.n_I2[shared->dim_n_I2_1 * (j - 1) + i - 1] + internal.vw_I2[i - 1];
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      int j = 1;
      state_next[shared->offset_variable_I24 + i - 1 + shared->dim_I24_1 * (j - 1)] = internal.ncu_I24[i - 1];
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      int j = 2;
      state_next[shared->offset_variable_I24 + i - 1 + shared->dim_I24_1 * (j - 1)] = internal.n_I24[shared->dim_n_I24_1 * (j - 1) + i - 1] + internal.n_I24[shared->dim_n_I24_1 * 0 + i - 1] - internal.ncu_I24[i - 1] - internal.vw_I24[i - 1];
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      int j = 3;
      state_next[shared->offset_variable_I24 + i - 1 + shared->dim_I24_1 * (j - 1)] = internal.n_I24[shared->dim_n_I24_1 * (j - 1) + i - 1] + internal.vw_I24[i - 1];
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      int j = 1;
      state_next[shared->offset_variable_I34 + i - 1 + shared->dim_I34_1 * (j - 1)] = internal.ncu_I34[i - 1];
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      int j = 2;
      state_next[shared->offset_variable_I34 + i - 1 + shared->dim_I34_1 * (j - 1)] = internal.n_I34[shared->dim_n_I34_1 * (j - 1) + i - 1] + internal.n_I34[shared->dim_n_I34_1 * 0 + i - 1] - internal.ncu_I34[i - 1] - internal.vw_I34[i - 1];
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      int j = 3;
      state_next[shared->offset_variable_I34 + i - 1 + shared->dim_I34_1 * (j - 1)] = internal.n_I34[shared->dim_n_I34_1 * (j - 1) + i - 1] + internal.vw_I34[i - 1];
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      int j = 1;
      state_next[shared->offset_variable_I43 + i - 1 + shared->dim_I43_1 * (j - 1)] = internal.ncu_I43[i - 1];
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      int j = 2;
      state_next[shared->offset_variable_I43 + i - 1 + shared->dim_I43_1 * (j - 1)] = internal.n_I43[shared->dim_n_I43_1 * (j - 1) + i - 1] + internal.n_I43[shared->dim_n_I43_1 * 0 + i - 1] - internal.ncu_I43[i - 1] - internal.vw_I43[i - 1];
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      int j = 3;
      state_next[shared->offset_variable_I43 + i - 1 + shared->dim_I43_1 * (j - 1)] = internal.n_I43[shared->dim_n_I43_1 * (j - 1) + i - 1] + internal.vw_I43[i - 1];
    }
    for (int i = 1; i <= shared->NYO; ++i) {
      state_next[shared->offset_variable_out_dis_all_unvacc + i - 1] = out_dis_all_unvacc[i - 1] + ((internal.out_update_switch[i - 1] == 0 ? 0 : dis_all_unvacc));
    }
    for (int i = 1; i <= shared->NYO; ++i) {
      state_next[shared->offset_variable_out_dis_all_vacc + i - 1] = out_dis_all_vacc[i - 1] + ((internal.out_update_switch[i - 1] == 0 ? 0 : dis_all_vacc));
    }
    for (int i = 1; i <= shared->NYO; ++i) {
      state_next[shared->offset_variable_out_dis_all_vacc_neg + i - 1] = out_dis_all_vacc_neg[i - 1] + ((internal.out_update_switch[i - 1] == 0 ? 0 : dis_all_vacc_neg));
    }
    for (int i = 1; i <= shared->NYO; ++i) {
      for (int j = 1; j <= 4; ++j) {
        state_next[shared->offset_variable_out_dis_sero_pop + i - 1 + shared->dim_out_dis_sero_pop_1 * (j - 1)] = out_dis_sero_pop[shared->dim_out_dis_sero_pop_1 * (j - 1) + i - 1] + ((internal.out_update_switch[i - 1] == 0 ? 0 : internal.dis_sero_pop[j - 1]));
      }
    }
    for (int i = 1; i <= shared->NYO; ++i) {
      for (int j = 1; j <= 4; ++j) {
        state_next[shared->offset_variable_out_dis_sero_vacc_pos + i - 1 + shared->dim_out_dis_sero_vacc_pos_1 * (j - 1)] = out_dis_sero_vacc_pos[shared->dim_out_dis_sero_vacc_pos_1 * (j - 1) + i - 1] + ((internal.out_update_switch[i - 1] == 0 ? 0 : internal.dis_sero_vacc_pos[j - 1]));
      }
    }
    for (int i = 1; i <= shared->NYO; ++i) {
      state_next[shared->offset_variable_out_disc_yll_all_vacc + i - 1] = out_disc_yll_all_vacc[i - 1] + ((internal.out_update_switch[i - 1] == 0 ? 0 : disc_yll_all_vacc));
    }
    for (int i = 1; i <= shared->NYO; ++i) {
      state_next[shared->offset_variable_out_sdis_all_unvacc + i - 1] = out_sdis_all_unvacc[i - 1] + ((internal.out_update_switch[i - 1] == 0 ? 0 : sdis_all_unvacc));
    }
    for (int i = 1; i <= shared->NYO; ++i) {
      state_next[shared->offset_variable_out_sdis_all_vacc + i - 1] = out_sdis_all_vacc[i - 1] + ((internal.out_update_switch[i - 1] == 0 ? 0 : sdis_all_vacc));
    }
    for (int i = 1; i <= shared->NYO; ++i) {
      state_next[shared->offset_variable_out_sdis_all_vacc_neg + i - 1] = out_sdis_all_vacc_neg[i - 1] + ((internal.out_update_switch[i - 1] == 0 ? 0 : sdis_all_vacc_neg));
    }
    for (int i = 1; i <= shared->NYO; ++i) {
      for (int j = 1; j <= 4; ++j) {
        state_next[shared->offset_variable_out_sdis_sero_pop + i - 1 + shared->dim_out_sdis_sero_pop_1 * (j - 1)] = out_sdis_sero_pop[shared->dim_out_sdis_sero_pop_1 * (j - 1) + i - 1] + ((internal.out_update_switch[i - 1] == 0 ? 0 : internal.sdis_sero_pop[j - 1]));
      }
    }
    for (int i = 1; i <= shared->NYO; ++i) {
      for (int j = 1; j <= 4; ++j) {
        state_next[shared->offset_variable_out_sdis_sero_vacc_pos + i - 1 + shared->dim_out_sdis_sero_vacc_pos_1 * (j - 1)] = out_sdis_sero_vacc_pos[shared->dim_out_sdis_sero_vacc_pos_1 * (j - 1) + i - 1] + ((internal.out_update_switch[i - 1] == 0 ? 0 : internal.sdis_sero_vacc_pos[j - 1]));
      }
    }
    for (int i = 1; i <= shared->NYO; ++i) {
      for (int j = 1; j <= 4; ++j) {
        state_next[shared->offset_variable_out_yll_sero_unvacc + i - 1 + shared->dim_out_yll_sero_unvacc_1 * (j - 1)] = out_yll_sero_unvacc[shared->dim_out_yll_sero_unvacc_1 * (j - 1) + i - 1] + ((internal.out_update_switch[i - 1] == 0 ? 0 : internal.yll_sero_unvacc[j - 1]));
      }
    }
    for (int i = 1; i <= shared->NYO; ++i) {
      for (int j = 1; j <= 4; ++j) {
        state_next[shared->offset_variable_out_yll_sero_vacc + i - 1 + shared->dim_out_yll_sero_vacc_1 * (j - 1)] = out_yll_sero_vacc[shared->dim_out_yll_sero_vacc_1 * (j - 1) + i - 1] + ((internal.out_update_switch[i - 1] == 0 ? 0 : internal.yll_sero_vacc[j - 1]));
      }
    }
    for (int i = 1; i <= shared->NYO; ++i) {
      for (int j = 1; j <= 4; ++j) {
        state_next[shared->offset_variable_out_yll_sero_vacc_neg + i - 1 + shared->dim_out_yll_sero_vacc_neg_1 * (j - 1)] = out_yll_sero_vacc_neg[shared->dim_out_yll_sero_vacc_neg_1 * (j - 1) + i - 1] + ((internal.out_update_switch[i - 1] == 0 ? 0 : internal.yll_sero_vacc_neg[j - 1]));
      }
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      internal.vw_I3[i - 1] = dust::random::binomial<real_type>(rng_state, internal.n_I3[shared->dim_n_I3_1 * 1 + i - 1], shared->vacc_decay);
    }
    real_type yll_all_unvacc = odin_sum1<real_type>(internal.yll_sero_unvacc.data(), 0, shared->dim_yll_sero_unvacc);
    real_type yll_all_vacc = odin_sum1<real_type>(internal.yll_sero_vacc.data(), 0, shared->dim_yll_sero_vacc);
    real_type yll_all_vacc_neg = odin_sum1<real_type>(internal.yll_sero_vacc_neg.data(), 0, shared->dim_yll_sero_vacc_neg);
    for (int i = 1; i <= 4; ++i) {
      internal.yll_sero_pop[i - 1] = internal.yll_sero_unvacc[i - 1] + internal.yll_sero_vacc[i - 1];
    }
    for (int i = 1; i <= 4; ++i) {
      internal.yll_sero_vacc_pos[i - 1] = internal.yll_sero_vacc[i - 1] - internal.yll_sero_vacc_neg[i - 1];
    }
    real_type disc_dis_all_pop = dis_all_pop * cum_disc;
    real_type disc_sdis_all_pop = sdis_all_pop * cum_disc;
    for (int i = 1; i <= shared->N_age; ++i) {
      internal.ncu_I4[i - 1] = dust::random::binomial<real_type>(rng_state, internal.n_I4[shared->dim_n_I4_1 * 0 + i - 1], internal.vcu_noncov[shared->dim_vcu_noncov_1 * 0 + i - 1]);
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      int j = 1;
      state_next[shared->offset_variable_I3 + i - 1 + shared->dim_I3_1 * (j - 1)] = internal.ncu_I3[i - 1];
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      int j = 2;
      state_next[shared->offset_variable_I3 + i - 1 + shared->dim_I3_1 * (j - 1)] = internal.n_I3[shared->dim_n_I3_1 * (j - 1) + i - 1] + internal.n_I3[shared->dim_n_I3_1 * 0 + i - 1] - internal.ncu_I3[i - 1] - internal.vw_I3[i - 1];
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      int j = 3;
      state_next[shared->offset_variable_I3 + i - 1 + shared->dim_I3_1 * (j - 1)] = internal.n_I3[shared->dim_n_I3_1 * (j - 1) + i - 1] + internal.vw_I3[i - 1];
    }
    for (int i = 1; i <= shared->NYO; ++i) {
      state_next[shared->offset_variable_out_dis_all_pop + i - 1] = out_dis_all_pop[i - 1] + ((internal.out_update_switch[i - 1] == 0 ? 0 : dis_all_pop));
    }
    for (int i = 1; i <= shared->NYO; ++i) {
      state_next[shared->offset_variable_out_dis_all_vacc_pos + i - 1] = out_dis_all_vacc_pos[i - 1] + ((internal.out_update_switch[i - 1] == 0 ? 0 : dis_all_vacc_pos));
    }
    for (int i = 1; i <= shared->NYO; ++i) {
      state_next[shared->offset_variable_out_disc_dis_all_vacc + i - 1] = out_disc_dis_all_vacc[i - 1] + ((internal.out_update_switch[i - 1] == 0 ? 0 : disc_dis_all_vacc));
    }
    for (int i = 1; i <= shared->NYO; ++i) {
      state_next[shared->offset_variable_out_disc_sdis_all_vacc + i - 1] = out_disc_sdis_all_vacc[i - 1] + ((internal.out_update_switch[i - 1] == 0 ? 0 : disc_sdis_all_vacc));
    }
    for (int i = 1; i <= shared->NYO; ++i) {
      state_next[shared->offset_variable_out_disc_yll_all_pop + i - 1] = out_disc_yll_all_pop[i - 1] + ((internal.out_update_switch[i - 1] == 0 ? 0 : disc_yll_all_pop));
    }
    for (int i = 1; i <= shared->NYO; ++i) {
      state_next[shared->offset_variable_out_sdis_all_pop + i - 1] = out_sdis_all_pop[i - 1] + ((internal.out_update_switch[i - 1] == 0 ? 0 : sdis_all_pop));
    }
    for (int i = 1; i <= shared->NYO; ++i) {
      state_next[shared->offset_variable_out_sdis_all_vacc_pos + i - 1] = out_sdis_all_vacc_pos[i - 1] + ((internal.out_update_switch[i - 1] == 0 ? 0 : sdis_all_vacc_pos));
    }
    for (int i = 1; i <= shared->NYO; ++i) {
      state_next[shared->offset_variable_out_yll_all_unvacc + i - 1] = out_yll_all_unvacc[i - 1] + ((internal.out_update_switch[i - 1] == 0 ? 0 : yll_all_unvacc));
    }
    for (int i = 1; i <= shared->NYO; ++i) {
      state_next[shared->offset_variable_out_yll_all_vacc + i - 1] = out_yll_all_vacc[i - 1] + ((internal.out_update_switch[i - 1] == 0 ? 0 : yll_all_vacc));
    }
    for (int i = 1; i <= shared->NYO; ++i) {
      state_next[shared->offset_variable_out_yll_all_vacc_neg + i - 1] = out_yll_all_vacc_neg[i - 1] + ((internal.out_update_switch[i - 1] == 0 ? 0 : yll_all_vacc_neg));
    }
    for (int i = 1; i <= shared->NYO; ++i) {
      for (int j = 1; j <= 4; ++j) {
        state_next[shared->offset_variable_out_yll_sero_pop + i - 1 + shared->dim_out_yll_sero_pop_1 * (j - 1)] = out_yll_sero_pop[shared->dim_out_yll_sero_pop_1 * (j - 1) + i - 1] + ((internal.out_update_switch[i - 1] == 0 ? 0 : internal.yll_sero_pop[j - 1]));
      }
    }
    for (int i = 1; i <= shared->NYO; ++i) {
      for (int j = 1; j <= 4; ++j) {
        state_next[shared->offset_variable_out_yll_sero_vacc_pos + i - 1 + shared->dim_out_yll_sero_vacc_pos_1 * (j - 1)] = out_yll_sero_vacc_pos[shared->dim_out_yll_sero_vacc_pos_1 * (j - 1) + i - 1] + ((internal.out_update_switch[i - 1] == 0 ? 0 : internal.yll_sero_vacc_pos[j - 1]));
      }
    }
    state_next[46] = ((shared->NUM_YEAR_ACCUM * dust::math::floor(YEAR / (real_type) shared->NUM_YEAR_ACCUM) == YEAR ? 0 : tot_inc_dis)) + 100000 * dis_all_pop / (real_type) NT;
    for (int i = 1; i <= shared->N_age; ++i) {
      internal.vw_I4[i - 1] = dust::random::binomial<real_type>(rng_state, internal.n_I4[shared->dim_n_I4_1 * 1 + i - 1], shared->vacc_decay);
    }
    real_type yll_all_pop = odin_sum1<real_type>(internal.yll_sero_pop.data(), 0, shared->dim_yll_sero_pop);
    real_type yll_all_vacc_pos = odin_sum1<real_type>(internal.yll_sero_vacc_pos.data(), 0, shared->dim_yll_sero_vacc_pos);
    for (int i = 1; i <= shared->N_age; ++i) {
      int j = 1;
      state_next[shared->offset_variable_I4 + i - 1 + shared->dim_I4_1 * (j - 1)] = internal.ncu_I4[i - 1];
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      int j = 2;
      state_next[shared->offset_variable_I4 + i - 1 + shared->dim_I4_1 * (j - 1)] = internal.n_I4[shared->dim_n_I4_1 * (j - 1) + i - 1] + internal.n_I4[shared->dim_n_I4_1 * 0 + i - 1] - internal.ncu_I4[i - 1] - internal.vw_I4[i - 1];
    }
    for (int i = 1; i <= shared->N_age; ++i) {
      int j = 3;
      state_next[shared->offset_variable_I4 + i - 1 + shared->dim_I4_1 * (j - 1)] = internal.n_I4[shared->dim_n_I4_1 * (j - 1) + i - 1] + internal.vw_I4[i - 1];
    }
    for (int i = 1; i <= shared->NYO; ++i) {
      state_next[shared->offset_variable_out_disc_dis_all_pop + i - 1] = out_disc_dis_all_pop[i - 1] + ((internal.out_update_switch[i - 1] == 0 ? 0 : disc_dis_all_pop));
    }
    for (int i = 1; i <= shared->NYO; ++i) {
      state_next[shared->offset_variable_out_disc_sdis_all_pop + i - 1] = out_disc_sdis_all_pop[i - 1] + ((internal.out_update_switch[i - 1] == 0 ? 0 : disc_sdis_all_pop));
    }
    for (int i = 1; i <= shared->NYO; ++i) {
      state_next[shared->offset_variable_out_yll_all_pop + i - 1] = out_yll_all_pop[i - 1] + ((internal.out_update_switch[i - 1] == 0 ? 0 : yll_all_pop));
    }
    for (int i = 1; i <= shared->NYO; ++i) {
      state_next[shared->offset_variable_out_yll_all_vacc_pos + i - 1] = out_yll_all_vacc_pos[i - 1] + ((internal.out_update_switch[i - 1] == 0 ? 0 : yll_all_vacc_pos));
    }
  }
private:
  std::shared_ptr<const shared_type> shared;
  internal_type internal;
};
template <typename real_type, typename container>
__host__ __device__ real_type odin_sum2(const container x, int from_i, int to_i, int from_j, int to_j, int dim_x_1) {
  real_type tot = 0.0;
  for (int j = from_j; j < to_j; ++j) {
    int jj = j * dim_x_1;
    for (int i = from_i; i < to_i; ++i) {
      tot += x[i + jj];
    }
  }
  return tot;
}
template <typename real_type, typename container>
__host__ __device__ real_type odin_sum3(const container x, int from_i, int to_i, int from_j, int to_j, int from_k, int to_k, int dim_x_1, int dim_x_12) {
  real_type tot = 0.0;
  for (int k = from_k; k < to_k; ++k) {
    int kk = k * dim_x_12;
    for (int j = from_j; j < to_j; ++j) {
      int jj = j * dim_x_1 + kk;
      for (int i = from_i; i < to_i; ++i) {
        tot += x[i + jj];
      }
    }
  }
  return tot;
}
#include <array>
#include <cpp11/R.hpp>
#include <cpp11/sexp.hpp>
#include <cpp11/doubles.hpp>
#include <cpp11/integers.hpp>
#include <cpp11/list.hpp>
#include <cpp11/strings.hpp>
#include <memory>
#include <vector>

template <typename T>
inline bool is_na(T x);

template <>
inline bool is_na(int x) {
  return x == NA_INTEGER;
}

template <>
inline bool is_na(double x) {
  return ISNA(x);
}

inline size_t object_length(cpp11::sexp x) {
  return ::Rf_xlength(x);
}

template <typename T>
void user_check_value(T value, const char *name, T min, T max) {
  if (is_na(value)) {
    cpp11::stop("'%s' must not be NA", name);
  }
  if (!is_na(min) && value < min) {
    cpp11::stop("Expected '%s' to be at least %g", name, (double) min);
  }
  if (!is_na(max) && value > max) {
    cpp11::stop("Expected '%s' to be at most %g", name, (double) max);
  }
}

template <typename T>
void user_check_array_value(const std::vector<T>& value, const char *name,
                            T min, T max) {
  for (auto& x : value) {
    user_check_value(x, name, min, max);
  }
}

inline size_t user_get_array_rank(cpp11::sexp x) {
  if (!::Rf_isArray(x)) {
    return 1;
  } else {
    cpp11::integers dim = cpp11::as_cpp<cpp11::integers>(x.attr("dim"));
    return dim.size();
  }
}

template <size_t N>
void user_check_array_rank(cpp11::sexp x, const char *name) {
  size_t rank = user_get_array_rank(x);
  if (rank != N) {
    if (N == 1) {
      cpp11::stop("Expected a vector for '%s'", name);
    } else if (N == 2) {
      cpp11::stop("Expected a matrix for '%s'", name);
    } else {
      cpp11::stop("Expected an array of rank %d for '%s'", N, name);
    }
  }
}

template <size_t N>
void user_check_array_dim(cpp11::sexp x, const char *name,
                          const std::array<int, N>& dim_expected) {
  cpp11::integers dim = cpp11::as_cpp<cpp11::integers>(x.attr("dim"));
  for (size_t i = 0; i < N; ++i) {
    if (dim[(int)i] != dim_expected[i]) {
      Rf_error("Incorrect size of dimension %d of '%s' (expected %d)",
               i + 1, name, dim_expected[i]);
    }
  }
}

template <>
inline void user_check_array_dim<1>(cpp11::sexp x, const char *name,
                                    const std::array<int, 1>& dim_expected) {
  if ((int)object_length(x) != dim_expected[0]) {
    cpp11::stop("Expected length %d value for '%s'", dim_expected[0], name);
  }
}

template <size_t N>
void user_set_array_dim(cpp11::sexp x, const char *name,
                        std::array<int, N>& dim) {
  cpp11::integers dim_given = cpp11::as_cpp<cpp11::integers>(x.attr("dim"));
  std::copy(dim_given.begin(), dim_given.end(), dim.begin());
}

template <>
inline void user_set_array_dim<1>(cpp11::sexp x, const char *name,
                                  std::array<int, 1>& dim) {
  dim[0] = object_length(x);
}

template <typename T>
T user_get_scalar(cpp11::list user, const char *name,
                  const T previous, T min, T max) {
  T ret = previous;
  cpp11::sexp x = user[name];
  if (x != R_NilValue) {
    if (object_length(x) != 1) {
      cpp11::stop("Expected a scalar numeric for '%s'", name);
    }
    // TODO: when we're getting out an integer this is a bit too relaxed
    if (TYPEOF(x) == REALSXP) {
      ret = cpp11::as_cpp<T>(x);
    } else if (TYPEOF(x) == INTSXP) {
      ret = cpp11::as_cpp<T>(x);
    } else {
      cpp11::stop("Expected a numeric value for %s", name);
    }
  }

  if (is_na(ret)) {
    cpp11::stop("Expected a value for '%s'", name);
  }
  user_check_value<T>(ret, name, min, max);
  return ret;
}

template <>
inline float user_get_scalar<float>(cpp11::list user, const char *name,
                                    const float previous, float min, float max) {
  double value = user_get_scalar<double>(user, name, previous, min, max);
  return static_cast<float>(value);
}

template <typename T>
std::vector<T> user_get_array_value(cpp11::sexp x, const char * name,
                                    T min, T max) {
  std::vector<T> ret = cpp11::as_cpp<std::vector<T>>(x);
  user_check_array_value<T>(ret, name, min, max);
  return ret;
}

template <typename T, size_t N>
std::vector<T> user_get_array_fixed(cpp11::list user, const char *name,
                                    const std::vector<T> previous,
                                    const std::array<int, N>& dim,
                                    T min, T max) {
  cpp11::sexp x = user[name];
  if (x == R_NilValue) {
    if (previous.size() == 0) {
      cpp11::stop("Expected a value for '%s'", name);
    }
    return previous;
  }

  user_check_array_rank<N>(x, name);
  user_check_array_dim<N>(x, name, dim);

  return user_get_array_value<T>(x, name, min, max);
}

template <typename T, size_t N>
std::vector<T> user_get_array_variable(cpp11::list user, const char *name,
                                       std::vector<T> previous,
                                       std::array<int, N>& dim,
                                       T min, T max) {
  cpp11::sexp x = user[name];
  if (x == R_NilValue) {
    if (previous.size() == 0) {
      cpp11::stop("Expected a value for '%s'", name);
    }
    return previous;
  }

  user_check_array_rank<N>(x, name);
  user_set_array_dim<N>(x, name, dim);

  return user_get_array_value<T>(x, name, min, max);
}

template <>
inline std::vector<float> user_get_array_value(cpp11::sexp x, const char * name,
                                               float min, float max) {
  // NOTE: possible under/overflow here for min/max because we've
  // downcast this.
  std::vector<double> value = user_get_array_value<double>(x, name, min, max);
  std::vector<float> ret(value.size());
  std::copy(value.begin(), value.end(), ret.begin());
  return ret;
}

// This is sum with inclusive "from", exclusive "to", following the
// same function in odin
template <typename real_type, typename container>
__host__ __device__
real_type odin_sum1(const container x, size_t from, size_t to) {
  real_type tot = 0.0;
  for (size_t i = from; i < to; ++i) {
    tot += x[i];
  }
  return tot;
}

inline cpp11::writable::integers integer_sequence(size_t from, size_t len) {
  cpp11::writable::integers ret(len);
  int* data = INTEGER(ret);
  for (size_t i = 0, j = from; i < len; ++i, ++j) {
    data[i] = j;
  }
  return ret;
}
namespace dust {
template<>
dust::pars_type<model> dust_pars<model>(cpp11::list user) {
  using real_type = typename model::real_type;
  auto shared = std::make_shared<model::shared_type>();
  model::internal_type internal;
  shared->Acrit = 3;
  shared->dim_age_rate_d_1 = 151;
  shared->dim_age_rate_d_2 = 29;
  shared->dim_age_removal_d_1 = 151;
  shared->dim_age_removal_d_2 = 29;
  shared->dim_births_d_1 = 151;
  shared->dim_births_d_2 = 2;
  shared->dim_coverage_d_1 = 77;
  shared->dim_coverage_d_2 = 2;
  shared->dim_dis_pri = 4;
  shared->dim_dis_quart = 4;
  shared->dim_dis_sec = 4;
  shared->dim_dis_sero_pop = 4;
  shared->dim_dis_sero_unvacc = 4;
  shared->dim_dis_sero_vacc = 4;
  shared->dim_dis_sero_vacc_neg = 4;
  shared->dim_dis_sero_vacc_pos = 4;
  shared->dim_dis_tert = 4;
  shared->dim_hl = 2;
  shared->dim_hs = 2;
  shared->dim_L_dis_1 = 4;
  shared->dim_L_dis_2 = 2;
  shared->dim_L_sdis_1 = 4;
  shared->dim_L_sdis_2 = 2;
  shared->dim_life_expec_d_1 = 151;
  shared->dim_life_expec_d_2 = 29;
  shared->dim_nc_cu_1 = 4;
  shared->dim_nc_cu_2 = 2;
  shared->dim_nc0_1 = 4;
  shared->dim_nc0_2 = 2;
  shared->dim_nc50_dis_1 = 4;
  shared->dim_nc50_dis_2 = 2;
  shared->dim_nc50_sdis_1 = 4;
  shared->dim_nc50_sdis_2 = 2;
  shared->dim_nnveai = 3;
  shared->dim_nveai = 3;
  shared->dim_phi_pri = 4;
  shared->dim_phi_quart = 4;
  shared->dim_phi_scale = 4;
  shared->dim_phi_sec = 4;
  shared->dim_phi_tert = 4;
  shared->dim_pop_size_d = 29;
  shared->dim_sdis_pri = 4;
  shared->dim_sdis_quart = 4;
  shared->dim_sdis_sec = 4;
  shared->dim_sdis_sero_pop = 4;
  shared->dim_sdis_sero_unvacc = 4;
  shared->dim_sdis_sero_vacc = 4;
  shared->dim_sdis_sero_vacc_neg = 4;
  shared->dim_sdis_sero_vacc_pos = 4;
  shared->dim_sdis_tert = 4;
  shared->dim_ts = 2;
  shared->dim_ws = 4;
  shared->dim_yll_sero_pop = 4;
  shared->dim_yll_sero_unvacc = 4;
  shared->dim_yll_sero_vacc = 4;
  shared->dim_yll_sero_vacc_neg = 4;
  shared->dim_yll_sero_vacc_pos = 4;
  shared->DT = 1;
  shared->FOIagescale = 1;
  shared->initial_cum_prop_seroneg_at_9 = 0;
  shared->initial_cum_prop_seroneg_at_vca = 0;
  shared->initial_exposed1 = 0;
  shared->initial_exposed2 = 0;
  shared->initial_exposed3 = 0;
  shared->initial_exposed4 = 0;
  shared->initial_inc_FOI1 = 0;
  shared->initial_inc_FOI2 = 0;
  shared->initial_inc_FOI3 = 0;
  shared->initial_inc_FOI4 = 0;
  shared->initial_infectious1 = 0;
  shared->initial_infectious2 = 0;
  shared->initial_infectious3 = 0;
  shared->initial_infectious4 = 0;
  shared->initial_Lwb = 0;
  shared->initial_Mwb_E1 = 0;
  shared->initial_Mwb_E2 = 0;
  shared->initial_Mwb_E3 = 0;
  shared->initial_Mwb_E4 = 0;
  shared->initial_Mwb_I1 = 0;
  shared->initial_Mwb_I2 = 0;
  shared->initial_Mwb_I3 = 0;
  shared->initial_Mwb_I4 = 0;
  shared->initial_Mwb_S = 0;
  shared->initial_Mwt_E1 = 0;
  shared->initial_Mwt_E2 = 0;
  shared->initial_Mwt_E3 = 0;
  shared->initial_Mwt_E4 = 0;
  shared->initial_NTv_out = 0;
  shared->initial_NTvE_out = 0;
  shared->initial_NTvS_out = 0;
  shared->initial_prop_seroneg_at_9_out = 0;
  shared->initial_prop_seroneg_at_vca_out = 0;
  shared->initial_tot_inc_dis = 0;
  shared->initial_tot_inc_FOI = 0;
  shared->initial_Y1T_out = 0;
  shared->initial_Y2T_out = 0;
  shared->initial_Y3T_out = 0;
  shared->initial_Y4T_out = 0;
  shared->N_age = 28;
  shared->NUM_YEAR_ACCUM = 4;
  shared->NYO = 20;
  shared->PI_C = static_cast<real_type>(3.1415926535900001);
  shared->rho_pri = 1;
  shared->rho_quart = 1;
  shared->rho_sec = 1;
  shared->rho_tert = 1;
  shared->vacc_by_serostatus = 0;
  shared->vacc_cu_coverage = 0;
  shared->vacc_cu_coverage_S = 0;
  shared->vacc_decay = 0;
  shared->vaccS_decay = 0;
  shared->Wb_cyto = 1;
  shared->Wb_eff = static_cast<real_type>(0.59999999999999998);
  shared->Wb_fF = static_cast<real_type>(0.84999999999999998);
  shared->Wb_fM = static_cast<real_type>(0.94999999999999996);
  shared->Wb_introduration = 60;
  shared->Wb_introlevel = 0;
  shared->Wb_introtime = 10000;
  shared->Wb_mat = static_cast<real_type>(0.94999999999999996);
  shared->Wb_relinf1 = 1;
  shared->Wb_relinf2 = 1;
  shared->Wb_relinf3 = 1;
  shared->Wb_relinf4 = 1;
  shared->YEAR_STEP = 1;
  internal.dis_sero_pop = std::vector<real_type>(shared->dim_dis_sero_pop);
  internal.dis_sero_unvacc = std::vector<real_type>(shared->dim_dis_sero_unvacc);
  internal.dis_sero_vacc = std::vector<real_type>(shared->dim_dis_sero_vacc);
  internal.dis_sero_vacc_neg = std::vector<real_type>(shared->dim_dis_sero_vacc_neg);
  internal.dis_sero_vacc_pos = std::vector<real_type>(shared->dim_dis_sero_vacc_pos);
  shared->nnveai = std::vector<real_type>(shared->dim_nnveai);
  shared->nveai = std::vector<real_type>(shared->dim_nveai);
  shared->phi_pri = std::vector<real_type>(shared->dim_phi_pri);
  shared->phi_quart = std::vector<real_type>(shared->dim_phi_quart);
  shared->phi_scale = std::vector<real_type>(shared->dim_phi_scale);
  shared->phi_sec = std::vector<real_type>(shared->dim_phi_sec);
  shared->phi_tert = std::vector<real_type>(shared->dim_phi_tert);
  internal.sdis_sero_pop = std::vector<real_type>(shared->dim_sdis_sero_pop);
  internal.sdis_sero_unvacc = std::vector<real_type>(shared->dim_sdis_sero_unvacc);
  internal.sdis_sero_vacc = std::vector<real_type>(shared->dim_sdis_sero_vacc);
  internal.sdis_sero_vacc_neg = std::vector<real_type>(shared->dim_sdis_sero_vacc_neg);
  internal.sdis_sero_vacc_pos = std::vector<real_type>(shared->dim_sdis_sero_vacc_pos);
  internal.yll_sero_pop = std::vector<real_type>(shared->dim_yll_sero_pop);
  internal.yll_sero_unvacc = std::vector<real_type>(shared->dim_yll_sero_unvacc);
  internal.yll_sero_vacc = std::vector<real_type>(shared->dim_yll_sero_vacc);
  internal.yll_sero_vacc_neg = std::vector<real_type>(shared->dim_yll_sero_vacc_neg);
  internal.yll_sero_vacc_pos = std::vector<real_type>(shared->dim_yll_sero_vacc_pos);
  shared->dim_age_rate_d = shared->dim_age_rate_d_1 * shared->dim_age_rate_d_2;
  shared->dim_age_removal_d = shared->dim_age_removal_d_1 * shared->dim_age_removal_d_2;
  shared->dim_agec = shared->N_age;
  shared->dim_agert = shared->N_age;
  shared->dim_births_d = shared->dim_births_d_1 * shared->dim_births_d_2;
  shared->dim_coverage_d = shared->dim_coverage_d_1 * shared->dim_coverage_d_2;
  shared->dim_cum_infection_pri = shared->N_age;
  shared->dim_cum_infection_priV = shared->N_age;
  shared->dim_cum_infection_sec = shared->N_age;
  shared->dim_cum_infection_secV = shared->N_age;
  shared->dim_cum_infection_tq = shared->N_age;
  shared->dim_cum_infection_tqV = shared->N_age;
  shared->dim_cur_age_rate = shared->N_age;
  shared->dim_death = shared->N_age;
  shared->dim_deathrt = shared->N_age;
  shared->dim_disc_yll_all_1 = shared->N_age;
  shared->dim_disc_yll_all_2 = 3;
  shared->dim_disease_sero_1 = shared->N_age;
  shared->dim_disease_sero_2 = 3;
  shared->dim_disease_sero_3 = 4;
  shared->dim_disease_sero_vacc_pri_1 = shared->N_age;
  shared->dim_disease_sero_vacc_pri_2 = 4;
  shared->dim_FOI1a = shared->N_age;
  shared->dim_FOI2a = shared->N_age;
  shared->dim_FOI3a = shared->N_age;
  shared->dim_FOI4a = shared->N_age;
  shared->dim_FOIas = shared->N_age;
  shared->dim_I1_1 = shared->N_age;
  shared->dim_I1_2 = 3;
  shared->dim_I12_1 = shared->N_age;
  shared->dim_I12_2 = 3;
  shared->dim_I123_1 = shared->N_age;
  shared->dim_I123_2 = 3;
  shared->dim_I1234_1 = shared->N_age;
  shared->dim_I1234_2 = 3;
  shared->dim_I124_1 = shared->N_age;
  shared->dim_I124_2 = 3;
  shared->dim_I1243_1 = shared->N_age;
  shared->dim_I1243_2 = 3;
  shared->dim_I13_1 = shared->N_age;
  shared->dim_I13_2 = 3;
  shared->dim_I132_1 = shared->N_age;
  shared->dim_I132_2 = 3;
  shared->dim_I134_1 = shared->N_age;
  shared->dim_I134_2 = 3;
  shared->dim_I1342_1 = shared->N_age;
  shared->dim_I1342_2 = 3;
  shared->dim_I14_1 = shared->N_age;
  shared->dim_I14_2 = 3;
  shared->dim_I142_1 = shared->N_age;
  shared->dim_I142_2 = 3;
  shared->dim_I143_1 = shared->N_age;
  shared->dim_I143_2 = 3;
  shared->dim_I2_1 = shared->N_age;
  shared->dim_I2_2 = 3;
  shared->dim_I21_1 = shared->N_age;
  shared->dim_I21_2 = 3;
  shared->dim_I23_1 = shared->N_age;
  shared->dim_I23_2 = 3;
  shared->dim_I231_1 = shared->N_age;
  shared->dim_I231_2 = 3;
  shared->dim_I234_1 = shared->N_age;
  shared->dim_I234_2 = 3;
  shared->dim_I2341_1 = shared->N_age;
  shared->dim_I2341_2 = 3;
  shared->dim_I24_1 = shared->N_age;
  shared->dim_I24_2 = 3;
  shared->dim_I241_1 = shared->N_age;
  shared->dim_I241_2 = 3;
  shared->dim_I243_1 = shared->N_age;
  shared->dim_I243_2 = 3;
  shared->dim_I3_1 = shared->N_age;
  shared->dim_I3_2 = 3;
  shared->dim_I31_1 = shared->N_age;
  shared->dim_I31_2 = 3;
  shared->dim_I32_1 = shared->N_age;
  shared->dim_I32_2 = 3;
  shared->dim_I34_1 = shared->N_age;
  shared->dim_I34_2 = 3;
  shared->dim_I341_1 = shared->N_age;
  shared->dim_I341_2 = 3;
  shared->dim_I342_1 = shared->N_age;
  shared->dim_I342_2 = 3;
  shared->dim_I4_1 = shared->N_age;
  shared->dim_I4_2 = 3;
  shared->dim_I41_1 = shared->N_age;
  shared->dim_I41_2 = 3;
  shared->dim_I42_1 = shared->N_age;
  shared->dim_I42_2 = 3;
  shared->dim_I43_1 = shared->N_age;
  shared->dim_I43_2 = 3;
  shared->dim_inf_1_1 = shared->N_age;
  shared->dim_inf_1_2 = 3;
  shared->dim_inf_12_1 = shared->N_age;
  shared->dim_inf_12_2 = 3;
  shared->dim_inf_123_1 = shared->N_age;
  shared->dim_inf_123_2 = 3;
  shared->dim_inf_1234_1 = shared->N_age;
  shared->dim_inf_1234_2 = 3;
  shared->dim_inf_124_1 = shared->N_age;
  shared->dim_inf_124_2 = 3;
  shared->dim_inf_1243_1 = shared->N_age;
  shared->dim_inf_1243_2 = 3;
  shared->dim_inf_13_1 = shared->N_age;
  shared->dim_inf_13_2 = 3;
  shared->dim_inf_132_1 = shared->N_age;
  shared->dim_inf_132_2 = 3;
  shared->dim_inf_134_1 = shared->N_age;
  shared->dim_inf_134_2 = 3;
  shared->dim_inf_1342_1 = shared->N_age;
  shared->dim_inf_1342_2 = 3;
  shared->dim_inf_14_1 = shared->N_age;
  shared->dim_inf_14_2 = 3;
  shared->dim_inf_142_1 = shared->N_age;
  shared->dim_inf_142_2 = 3;
  shared->dim_inf_143_1 = shared->N_age;
  shared->dim_inf_143_2 = 3;
  shared->dim_inf_2_1 = shared->N_age;
  shared->dim_inf_2_2 = 3;
  shared->dim_inf_21_1 = shared->N_age;
  shared->dim_inf_21_2 = 3;
  shared->dim_inf_23_1 = shared->N_age;
  shared->dim_inf_23_2 = 3;
  shared->dim_inf_231_1 = shared->N_age;
  shared->dim_inf_231_2 = 3;
  shared->dim_inf_234_1 = shared->N_age;
  shared->dim_inf_234_2 = 3;
  shared->dim_inf_2341_1 = shared->N_age;
  shared->dim_inf_2341_2 = 3;
  shared->dim_inf_24_1 = shared->N_age;
  shared->dim_inf_24_2 = 3;
  shared->dim_inf_241_1 = shared->N_age;
  shared->dim_inf_241_2 = 3;
  shared->dim_inf_243_1 = shared->N_age;
  shared->dim_inf_243_2 = 3;
  shared->dim_inf_3_1 = shared->N_age;
  shared->dim_inf_3_2 = 3;
  shared->dim_inf_31_1 = shared->N_age;
  shared->dim_inf_31_2 = 3;
  shared->dim_inf_32_1 = shared->N_age;
  shared->dim_inf_32_2 = 3;
  shared->dim_inf_34_1 = shared->N_age;
  shared->dim_inf_34_2 = 3;
  shared->dim_inf_341_1 = shared->N_age;
  shared->dim_inf_341_2 = 3;
  shared->dim_inf_342_1 = shared->N_age;
  shared->dim_inf_342_2 = 3;
  shared->dim_inf_4_1 = shared->N_age;
  shared->dim_inf_4_2 = 3;
  shared->dim_inf_41_1 = shared->N_age;
  shared->dim_inf_41_2 = 3;
  shared->dim_inf_42_1 = shared->N_age;
  shared->dim_inf_42_2 = 3;
  shared->dim_inf_43_1 = shared->N_age;
  shared->dim_inf_43_2 = 3;
  shared->dim_infection_pri_1 = shared->N_age;
  shared->dim_infection_pri_2 = 3;
  shared->dim_infection_sec_1 = shared->N_age;
  shared->dim_infection_sec_2 = 3;
  shared->dim_infection_tq_1 = shared->N_age;
  shared->dim_infection_tq_2 = 3;
  shared->dim_infV_1_1 = shared->N_age;
  shared->dim_infV_1_2 = 3;
  shared->dim_infV_2_1 = shared->N_age;
  shared->dim_infV_2_2 = 3;
  shared->dim_infV_3_1 = shared->N_age;
  shared->dim_infV_3_2 = 3;
  shared->dim_infV_4_1 = shared->N_age;
  shared->dim_infV_4_2 = 3;
  shared->dim_init_life_expec = shared->N_age;
  shared->dim_L_dis = shared->dim_L_dis_1 * shared->dim_L_dis_2;
  shared->dim_L_sdis = shared->dim_L_sdis_1 * shared->dim_L_sdis_2;
  shared->dim_life_expec = shared->N_age;
  shared->dim_life_expec_d = shared->dim_life_expec_d_1 * shared->dim_life_expec_d_2;
  shared->dim_mean_age = shared->N_age;
  shared->dim_n_I1_1 = shared->N_age;
  shared->dim_n_I1_2 = 3;
  shared->dim_n_I12_1 = shared->N_age;
  shared->dim_n_I12_2 = 3;
  shared->dim_n_I123_1 = shared->N_age;
  shared->dim_n_I123_2 = 3;
  shared->dim_n_I1234_1 = shared->N_age;
  shared->dim_n_I1234_2 = 3;
  shared->dim_n_I124_1 = shared->N_age;
  shared->dim_n_I124_2 = 3;
  shared->dim_n_I1243_1 = shared->N_age;
  shared->dim_n_I1243_2 = 3;
  shared->dim_n_I13_1 = shared->N_age;
  shared->dim_n_I13_2 = 3;
  shared->dim_n_I132_1 = shared->N_age;
  shared->dim_n_I132_2 = 3;
  shared->dim_n_I134_1 = shared->N_age;
  shared->dim_n_I134_2 = 3;
  shared->dim_n_I1342_1 = shared->N_age;
  shared->dim_n_I1342_2 = 3;
  shared->dim_n_I14_1 = shared->N_age;
  shared->dim_n_I14_2 = 3;
  shared->dim_n_I142_1 = shared->N_age;
  shared->dim_n_I142_2 = 3;
  shared->dim_n_I143_1 = shared->N_age;
  shared->dim_n_I143_2 = 3;
  shared->dim_n_I2_1 = shared->N_age;
  shared->dim_n_I2_2 = 3;
  shared->dim_n_I21_1 = shared->N_age;
  shared->dim_n_I21_2 = 3;
  shared->dim_n_I23_1 = shared->N_age;
  shared->dim_n_I23_2 = 3;
  shared->dim_n_I231_1 = shared->N_age;
  shared->dim_n_I231_2 = 3;
  shared->dim_n_I234_1 = shared->N_age;
  shared->dim_n_I234_2 = 3;
  shared->dim_n_I2341_1 = shared->N_age;
  shared->dim_n_I2341_2 = 3;
  shared->dim_n_I24_1 = shared->N_age;
  shared->dim_n_I24_2 = 3;
  shared->dim_n_I241_1 = shared->N_age;
  shared->dim_n_I241_2 = 3;
  shared->dim_n_I243_1 = shared->N_age;
  shared->dim_n_I243_2 = 3;
  shared->dim_n_I3_1 = shared->N_age;
  shared->dim_n_I3_2 = 3;
  shared->dim_n_I31_1 = shared->N_age;
  shared->dim_n_I31_2 = 3;
  shared->dim_n_I32_1 = shared->N_age;
  shared->dim_n_I32_2 = 3;
  shared->dim_n_I34_1 = shared->N_age;
  shared->dim_n_I34_2 = 3;
  shared->dim_n_I341_1 = shared->N_age;
  shared->dim_n_I341_2 = 3;
  shared->dim_n_I342_1 = shared->N_age;
  shared->dim_n_I342_2 = 3;
  shared->dim_n_I4_1 = shared->N_age;
  shared->dim_n_I4_2 = 3;
  shared->dim_n_I41_1 = shared->N_age;
  shared->dim_n_I41_2 = 3;
  shared->dim_n_I42_1 = shared->N_age;
  shared->dim_n_I42_2 = 3;
  shared->dim_n_I43_1 = shared->N_age;
  shared->dim_n_I43_2 = 3;
  shared->dim_N_init_age = shared->N_age;
  shared->dim_N_init_age0 = shared->N_age;
  shared->dim_n_R1_1 = shared->N_age;
  shared->dim_n_R1_2 = 3;
  shared->dim_n_R12_1 = shared->N_age;
  shared->dim_n_R12_2 = 3;
  shared->dim_n_R123_1 = shared->N_age;
  shared->dim_n_R123_2 = 3;
  shared->dim_n_R1234_1 = shared->N_age;
  shared->dim_n_R1234_2 = 3;
  shared->dim_n_R124_1 = shared->N_age;
  shared->dim_n_R124_2 = 3;
  shared->dim_n_R13_1 = shared->N_age;
  shared->dim_n_R13_2 = 3;
  shared->dim_n_R134_1 = shared->N_age;
  shared->dim_n_R134_2 = 3;
  shared->dim_n_R14_1 = shared->N_age;
  shared->dim_n_R14_2 = 3;
  shared->dim_n_R2_1 = shared->N_age;
  shared->dim_n_R2_2 = 3;
  shared->dim_n_R23_1 = shared->N_age;
  shared->dim_n_R23_2 = 3;
  shared->dim_n_R234_1 = shared->N_age;
  shared->dim_n_R234_2 = 3;
  shared->dim_n_R24_1 = shared->N_age;
  shared->dim_n_R24_2 = 3;
  shared->dim_n_R3_1 = shared->N_age;
  shared->dim_n_R3_2 = 3;
  shared->dim_n_R34_1 = shared->N_age;
  shared->dim_n_R34_2 = 3;
  shared->dim_n_R4_1 = shared->N_age;
  shared->dim_n_R4_2 = 3;
  shared->dim_n_S_1 = shared->N_age;
  shared->dim_n_S_2 = 3;
  shared->dim_nc_1 = 4;
  shared->dim_nc_2 = 2;
  shared->dim_nc_3 = shared->N_age;
  shared->dim_nc_cu = shared->dim_nc_cu_1 * shared->dim_nc_cu_2;
  shared->dim_nc0 = shared->dim_nc0_1 * shared->dim_nc0_2;
  shared->dim_nc50_age = shared->N_age;
  shared->dim_nc50_dis = shared->dim_nc50_dis_1 * shared->dim_nc50_dis_2;
  shared->dim_nc50_sdis = shared->dim_nc50_sdis_1 * shared->dim_nc50_sdis_2;
  shared->dim_ncu_I1 = shared->N_age;
  shared->dim_ncu_I12 = shared->N_age;
  shared->dim_ncu_I123 = shared->N_age;
  shared->dim_ncu_I1234 = shared->N_age;
  shared->dim_ncu_I124 = shared->N_age;
  shared->dim_ncu_I1243 = shared->N_age;
  shared->dim_ncu_I13 = shared->N_age;
  shared->dim_ncu_I132 = shared->N_age;
  shared->dim_ncu_I134 = shared->N_age;
  shared->dim_ncu_I1342 = shared->N_age;
  shared->dim_ncu_I14 = shared->N_age;
  shared->dim_ncu_I142 = shared->N_age;
  shared->dim_ncu_I143 = shared->N_age;
  shared->dim_ncu_I2 = shared->N_age;
  shared->dim_ncu_I21 = shared->N_age;
  shared->dim_ncu_I23 = shared->N_age;
  shared->dim_ncu_I231 = shared->N_age;
  shared->dim_ncu_I234 = shared->N_age;
  shared->dim_ncu_I2341 = shared->N_age;
  shared->dim_ncu_I24 = shared->N_age;
  shared->dim_ncu_I241 = shared->N_age;
  shared->dim_ncu_I243 = shared->N_age;
  shared->dim_ncu_I3 = shared->N_age;
  shared->dim_ncu_I31 = shared->N_age;
  shared->dim_ncu_I32 = shared->N_age;
  shared->dim_ncu_I34 = shared->N_age;
  shared->dim_ncu_I341 = shared->N_age;
  shared->dim_ncu_I342 = shared->N_age;
  shared->dim_ncu_I4 = shared->N_age;
  shared->dim_ncu_I41 = shared->N_age;
  shared->dim_ncu_I42 = shared->N_age;
  shared->dim_ncu_I43 = shared->N_age;
  shared->dim_ncu_R1 = shared->N_age;
  shared->dim_ncu_R12 = shared->N_age;
  shared->dim_ncu_R123 = shared->N_age;
  shared->dim_ncu_R1234 = shared->N_age;
  shared->dim_ncu_R124 = shared->N_age;
  shared->dim_ncu_R13 = shared->N_age;
  shared->dim_ncu_R134 = shared->N_age;
  shared->dim_ncu_R14 = shared->N_age;
  shared->dim_ncu_R2 = shared->N_age;
  shared->dim_ncu_R23 = shared->N_age;
  shared->dim_ncu_R234 = shared->N_age;
  shared->dim_ncu_R24 = shared->N_age;
  shared->dim_ncu_R3 = shared->N_age;
  shared->dim_ncu_R34 = shared->N_age;
  shared->dim_ncu_R4 = shared->N_age;
  shared->dim_ncu_S = shared->N_age;
  shared->dim_Ntotal_1 = shared->N_age;
  shared->dim_Ntotal_2 = 3;
  shared->dim_Ntotal_all = shared->N_age;
  shared->dim_Ntotal_nv = shared->N_age;
  shared->dim_Ntotal_nvS = shared->N_age;
  shared->dim_Ntotal_out = shared->N_age;
  shared->dim_Ntotal_v = shared->N_age;
  shared->dim_Ntotal_vS = shared->N_age;
  shared->dim_num_child_vacc_age = shared->N_age;
  shared->dim_num_child_vacc_age_neg = shared->N_age;
  shared->dim_num_cu_vacc_age = shared->N_age;
  shared->dim_num_cu_vacc_age_neg = shared->N_age;
  shared->dim_nvacc_I1_1 = shared->N_age;
  shared->dim_nvacc_I1_2 = 3;
  shared->dim_nvacc_I12_1 = shared->N_age;
  shared->dim_nvacc_I12_2 = 3;
  shared->dim_nvacc_I123_1 = shared->N_age;
  shared->dim_nvacc_I123_2 = 3;
  shared->dim_nvacc_I1234_1 = shared->N_age;
  shared->dim_nvacc_I1234_2 = 3;
  shared->dim_nvacc_I124_1 = shared->N_age;
  shared->dim_nvacc_I124_2 = 3;
  shared->dim_nvacc_I1243_1 = shared->N_age;
  shared->dim_nvacc_I1243_2 = 3;
  shared->dim_nvacc_I13_1 = shared->N_age;
  shared->dim_nvacc_I13_2 = 3;
  shared->dim_nvacc_I132_1 = shared->N_age;
  shared->dim_nvacc_I132_2 = 3;
  shared->dim_nvacc_I134_1 = shared->N_age;
  shared->dim_nvacc_I134_2 = 3;
  shared->dim_nvacc_I1342_1 = shared->N_age;
  shared->dim_nvacc_I1342_2 = 3;
  shared->dim_nvacc_I14_1 = shared->N_age;
  shared->dim_nvacc_I14_2 = 3;
  shared->dim_nvacc_I142_1 = shared->N_age;
  shared->dim_nvacc_I142_2 = 3;
  shared->dim_nvacc_I143_1 = shared->N_age;
  shared->dim_nvacc_I143_2 = 3;
  shared->dim_nvacc_I2_1 = shared->N_age;
  shared->dim_nvacc_I2_2 = 3;
  shared->dim_nvacc_I21_1 = shared->N_age;
  shared->dim_nvacc_I21_2 = 3;
  shared->dim_nvacc_I23_1 = shared->N_age;
  shared->dim_nvacc_I23_2 = 3;
  shared->dim_nvacc_I231_1 = shared->N_age;
  shared->dim_nvacc_I231_2 = 3;
  shared->dim_nvacc_I234_1 = shared->N_age;
  shared->dim_nvacc_I234_2 = 3;
  shared->dim_nvacc_I2341_1 = shared->N_age;
  shared->dim_nvacc_I2341_2 = 3;
  shared->dim_nvacc_I24_1 = shared->N_age;
  shared->dim_nvacc_I24_2 = 3;
  shared->dim_nvacc_I241_1 = shared->N_age;
  shared->dim_nvacc_I241_2 = 3;
  shared->dim_nvacc_I243_1 = shared->N_age;
  shared->dim_nvacc_I243_2 = 3;
  shared->dim_nvacc_I3_1 = shared->N_age;
  shared->dim_nvacc_I3_2 = 3;
  shared->dim_nvacc_I31_1 = shared->N_age;
  shared->dim_nvacc_I31_2 = 3;
  shared->dim_nvacc_I32_1 = shared->N_age;
  shared->dim_nvacc_I32_2 = 3;
  shared->dim_nvacc_I34_1 = shared->N_age;
  shared->dim_nvacc_I34_2 = 3;
  shared->dim_nvacc_I341_1 = shared->N_age;
  shared->dim_nvacc_I341_2 = 3;
  shared->dim_nvacc_I342_1 = shared->N_age;
  shared->dim_nvacc_I342_2 = 3;
  shared->dim_nvacc_I4_1 = shared->N_age;
  shared->dim_nvacc_I4_2 = 3;
  shared->dim_nvacc_I41_1 = shared->N_age;
  shared->dim_nvacc_I41_2 = 3;
  shared->dim_nvacc_I42_1 = shared->N_age;
  shared->dim_nvacc_I42_2 = 3;
  shared->dim_nvacc_I43_1 = shared->N_age;
  shared->dim_nvacc_I43_2 = 3;
  shared->dim_nvacc_R1_1 = shared->N_age;
  shared->dim_nvacc_R1_2 = 3;
  shared->dim_nvacc_R12_1 = shared->N_age;
  shared->dim_nvacc_R12_2 = 3;
  shared->dim_nvacc_R123_1 = shared->N_age;
  shared->dim_nvacc_R123_2 = 3;
  shared->dim_nvacc_R1234_1 = shared->N_age;
  shared->dim_nvacc_R1234_2 = 3;
  shared->dim_nvacc_R124_1 = shared->N_age;
  shared->dim_nvacc_R124_2 = 3;
  shared->dim_nvacc_R13_1 = shared->N_age;
  shared->dim_nvacc_R13_2 = 3;
  shared->dim_nvacc_R134_1 = shared->N_age;
  shared->dim_nvacc_R134_2 = 3;
  shared->dim_nvacc_R14_1 = shared->N_age;
  shared->dim_nvacc_R14_2 = 3;
  shared->dim_nvacc_R2_1 = shared->N_age;
  shared->dim_nvacc_R2_2 = 3;
  shared->dim_nvacc_R23_1 = shared->N_age;
  shared->dim_nvacc_R23_2 = 3;
  shared->dim_nvacc_R234_1 = shared->N_age;
  shared->dim_nvacc_R234_2 = 3;
  shared->dim_nvacc_R24_1 = shared->N_age;
  shared->dim_nvacc_R24_2 = 3;
  shared->dim_nvacc_R3_1 = shared->N_age;
  shared->dim_nvacc_R3_2 = 3;
  shared->dim_nvacc_R34_1 = shared->N_age;
  shared->dim_nvacc_R34_2 = 3;
  shared->dim_nvacc_R4_1 = shared->N_age;
  shared->dim_nvacc_R4_2 = 3;
  shared->dim_nvacc_S_1 = shared->N_age;
  shared->dim_nvacc_S_2 = 3;
  shared->dim_O_I1_1 = shared->N_age;
  shared->dim_O_I1_2 = 3;
  shared->dim_O_I12_1 = shared->N_age;
  shared->dim_O_I12_2 = 3;
  shared->dim_O_I123_1 = shared->N_age;
  shared->dim_O_I123_2 = 3;
  shared->dim_O_I1234_1 = shared->N_age;
  shared->dim_O_I1234_2 = 3;
  shared->dim_O_I124_1 = shared->N_age;
  shared->dim_O_I124_2 = 3;
  shared->dim_O_I1243_1 = shared->N_age;
  shared->dim_O_I1243_2 = 3;
  shared->dim_O_I13_1 = shared->N_age;
  shared->dim_O_I13_2 = 3;
  shared->dim_O_I132_1 = shared->N_age;
  shared->dim_O_I132_2 = 3;
  shared->dim_O_I134_1 = shared->N_age;
  shared->dim_O_I134_2 = 3;
  shared->dim_O_I1342_1 = shared->N_age;
  shared->dim_O_I1342_2 = 3;
  shared->dim_O_I14_1 = shared->N_age;
  shared->dim_O_I14_2 = 3;
  shared->dim_O_I142_1 = shared->N_age;
  shared->dim_O_I142_2 = 3;
  shared->dim_O_I143_1 = shared->N_age;
  shared->dim_O_I143_2 = 3;
  shared->dim_O_I2_1 = shared->N_age;
  shared->dim_O_I2_2 = 3;
  shared->dim_O_I21_1 = shared->N_age;
  shared->dim_O_I21_2 = 3;
  shared->dim_O_I23_1 = shared->N_age;
  shared->dim_O_I23_2 = 3;
  shared->dim_O_I231_1 = shared->N_age;
  shared->dim_O_I231_2 = 3;
  shared->dim_O_I234_1 = shared->N_age;
  shared->dim_O_I234_2 = 3;
  shared->dim_O_I2341_1 = shared->N_age;
  shared->dim_O_I2341_2 = 3;
  shared->dim_O_I24_1 = shared->N_age;
  shared->dim_O_I24_2 = 3;
  shared->dim_O_I241_1 = shared->N_age;
  shared->dim_O_I241_2 = 3;
  shared->dim_O_I243_1 = shared->N_age;
  shared->dim_O_I243_2 = 3;
  shared->dim_O_I3_1 = shared->N_age;
  shared->dim_O_I3_2 = 3;
  shared->dim_O_I31_1 = shared->N_age;
  shared->dim_O_I31_2 = 3;
  shared->dim_O_I32_1 = shared->N_age;
  shared->dim_O_I32_2 = 3;
  shared->dim_O_I34_1 = shared->N_age;
  shared->dim_O_I34_2 = 3;
  shared->dim_O_I341_1 = shared->N_age;
  shared->dim_O_I341_2 = 3;
  shared->dim_O_I342_1 = shared->N_age;
  shared->dim_O_I342_2 = 3;
  shared->dim_O_I4_1 = shared->N_age;
  shared->dim_O_I4_2 = 3;
  shared->dim_O_I41_1 = shared->N_age;
  shared->dim_O_I41_2 = 3;
  shared->dim_O_I42_1 = shared->N_age;
  shared->dim_O_I42_2 = 3;
  shared->dim_O_I43_1 = shared->N_age;
  shared->dim_O_I43_2 = 3;
  shared->dim_O_R1_1 = shared->N_age;
  shared->dim_O_R1_2 = 3;
  shared->dim_O_R12_1 = shared->N_age;
  shared->dim_O_R12_2 = 3;
  shared->dim_O_R123_1 = shared->N_age;
  shared->dim_O_R123_2 = 3;
  shared->dim_O_R1234_1 = shared->N_age;
  shared->dim_O_R1234_2 = 3;
  shared->dim_O_R124_1 = shared->N_age;
  shared->dim_O_R124_2 = 3;
  shared->dim_O_R13_1 = shared->N_age;
  shared->dim_O_R13_2 = 3;
  shared->dim_O_R134_1 = shared->N_age;
  shared->dim_O_R134_2 = 3;
  shared->dim_O_R14_1 = shared->N_age;
  shared->dim_O_R14_2 = 3;
  shared->dim_O_R2_1 = shared->N_age;
  shared->dim_O_R2_2 = 3;
  shared->dim_O_R23_1 = shared->N_age;
  shared->dim_O_R23_2 = 3;
  shared->dim_O_R234_1 = shared->N_age;
  shared->dim_O_R234_2 = 3;
  shared->dim_O_R24_1 = shared->N_age;
  shared->dim_O_R24_2 = 3;
  shared->dim_O_R3_1 = shared->N_age;
  shared->dim_O_R3_2 = 3;
  shared->dim_O_R34_1 = shared->N_age;
  shared->dim_O_R34_2 = 3;
  shared->dim_O_R4_1 = shared->N_age;
  shared->dim_O_R4_2 = 3;
  shared->dim_O_S_1 = shared->N_age;
  shared->dim_O_S_2 = 3;
  shared->dim_out_dis_all_pop = shared->NYO;
  shared->dim_out_dis_all_unvacc = shared->NYO;
  shared->dim_out_dis_all_vacc = shared->NYO;
  shared->dim_out_dis_all_vacc_neg = shared->NYO;
  shared->dim_out_dis_all_vacc_pos = shared->NYO;
  shared->dim_out_dis_sero_pop_1 = shared->NYO;
  shared->dim_out_dis_sero_pop_2 = 4;
  shared->dim_out_dis_sero_unvacc_1 = shared->NYO;
  shared->dim_out_dis_sero_unvacc_2 = 4;
  shared->dim_out_dis_sero_vacc_1 = shared->NYO;
  shared->dim_out_dis_sero_vacc_2 = 4;
  shared->dim_out_dis_sero_vacc_neg_1 = shared->NYO;
  shared->dim_out_dis_sero_vacc_neg_2 = 4;
  shared->dim_out_dis_sero_vacc_pos_1 = shared->NYO;
  shared->dim_out_dis_sero_vacc_pos_2 = 4;
  shared->dim_out_disc_dis_all_pop = shared->NYO;
  shared->dim_out_disc_dis_all_vacc = shared->NYO;
  shared->dim_out_disc_nvacc_all_pop = shared->NYO;
  shared->dim_out_disc_sdis_all_pop = shared->NYO;
  shared->dim_out_disc_sdis_all_vacc = shared->NYO;
  shared->dim_out_disc_yll_all_pop = shared->NYO;
  shared->dim_out_disc_yll_all_vacc = shared->NYO;
  shared->dim_out_nc_1 = 4;
  shared->dim_out_nc_2 = 2;
  shared->dim_out_nc_3 = shared->N_age;
  shared->dim_out_nvacc_all_neg = shared->NYO;
  shared->dim_out_nvacc_all_pop = shared->NYO;
  shared->dim_out_nvacc_all_pos = shared->NYO;
  shared->dim_out_prop_seroneg_at_9 = shared->NYO;
  shared->dim_out_prop_seroneg_at_vca = shared->NYO;
  shared->dim_out_RR_1 = 4;
  shared->dim_out_RR_2 = 2;
  shared->dim_out_RR_3 = shared->N_age;
  shared->dim_out_sdis_all_pop = shared->NYO;
  shared->dim_out_sdis_all_unvacc = shared->NYO;
  shared->dim_out_sdis_all_vacc = shared->NYO;
  shared->dim_out_sdis_all_vacc_neg = shared->NYO;
  shared->dim_out_sdis_all_vacc_pos = shared->NYO;
  shared->dim_out_sdis_sero_pop_1 = shared->NYO;
  shared->dim_out_sdis_sero_pop_2 = 4;
  shared->dim_out_sdis_sero_unvacc_1 = shared->NYO;
  shared->dim_out_sdis_sero_unvacc_2 = 4;
  shared->dim_out_sdis_sero_vacc_1 = shared->NYO;
  shared->dim_out_sdis_sero_vacc_2 = 4;
  shared->dim_out_sdis_sero_vacc_neg_1 = shared->NYO;
  shared->dim_out_sdis_sero_vacc_neg_2 = 4;
  shared->dim_out_sdis_sero_vacc_pos_1 = shared->NYO;
  shared->dim_out_sdis_sero_vacc_pos_2 = 4;
  shared->dim_out_time_from_last_dose = shared->N_age;
  shared->dim_out_update_switch = shared->NYO;
  shared->dim_out_yll_all_pop = shared->NYO;
  shared->dim_out_yll_all_unvacc = shared->NYO;
  shared->dim_out_yll_all_vacc = shared->NYO;
  shared->dim_out_yll_all_vacc_neg = shared->NYO;
  shared->dim_out_yll_all_vacc_pos = shared->NYO;
  shared->dim_out_yll_sero_pop_1 = shared->NYO;
  shared->dim_out_yll_sero_pop_2 = 4;
  shared->dim_out_yll_sero_unvacc_1 = shared->NYO;
  shared->dim_out_yll_sero_unvacc_2 = 4;
  shared->dim_out_yll_sero_vacc_1 = shared->NYO;
  shared->dim_out_yll_sero_vacc_2 = 4;
  shared->dim_out_yll_sero_vacc_neg_1 = shared->NYO;
  shared->dim_out_yll_sero_vacc_neg_2 = 4;
  shared->dim_out_yll_sero_vacc_pos_1 = shared->NYO;
  shared->dim_out_yll_sero_vacc_pos_2 = 4;
  shared->dim_R1_1 = shared->N_age;
  shared->dim_R1_2 = 3;
  shared->dim_R12_1 = shared->N_age;
  shared->dim_R12_2 = 3;
  shared->dim_R123_1 = shared->N_age;
  shared->dim_R123_2 = 3;
  shared->dim_R1234_1 = shared->N_age;
  shared->dim_R1234_2 = 3;
  shared->dim_R124_1 = shared->N_age;
  shared->dim_R124_2 = 3;
  shared->dim_R13_1 = shared->N_age;
  shared->dim_R13_2 = 3;
  shared->dim_R134_1 = shared->N_age;
  shared->dim_R134_2 = 3;
  shared->dim_R14_1 = shared->N_age;
  shared->dim_R14_2 = 3;
  shared->dim_R2_1 = shared->N_age;
  shared->dim_R2_2 = 3;
  shared->dim_R23_1 = shared->N_age;
  shared->dim_R23_2 = 3;
  shared->dim_R234_1 = shared->N_age;
  shared->dim_R234_2 = 3;
  shared->dim_R24_1 = shared->N_age;
  shared->dim_R24_2 = 3;
  shared->dim_R3_1 = shared->N_age;
  shared->dim_R3_2 = 3;
  shared->dim_R34_1 = shared->N_age;
  shared->dim_R34_2 = 3;
  shared->dim_R4_1 = shared->N_age;
  shared->dim_R4_2 = 3;
  shared->dim_recov_1_1 = shared->N_age;
  shared->dim_recov_1_2 = 3;
  shared->dim_recov_12_1 = shared->N_age;
  shared->dim_recov_12_2 = 3;
  shared->dim_recov_123_1 = shared->N_age;
  shared->dim_recov_123_2 = 3;
  shared->dim_recov_1234_1 = shared->N_age;
  shared->dim_recov_1234_2 = 3;
  shared->dim_recov_124_1 = shared->N_age;
  shared->dim_recov_124_2 = 3;
  shared->dim_recov_1243_1 = shared->N_age;
  shared->dim_recov_1243_2 = 3;
  shared->dim_recov_13_1 = shared->N_age;
  shared->dim_recov_13_2 = 3;
  shared->dim_recov_132_1 = shared->N_age;
  shared->dim_recov_132_2 = 3;
  shared->dim_recov_134_1 = shared->N_age;
  shared->dim_recov_134_2 = 3;
  shared->dim_recov_1342_1 = shared->N_age;
  shared->dim_recov_1342_2 = 3;
  shared->dim_recov_14_1 = shared->N_age;
  shared->dim_recov_14_2 = 3;
  shared->dim_recov_142_1 = shared->N_age;
  shared->dim_recov_142_2 = 3;
  shared->dim_recov_143_1 = shared->N_age;
  shared->dim_recov_143_2 = 3;
  shared->dim_recov_2_1 = shared->N_age;
  shared->dim_recov_2_2 = 3;
  shared->dim_recov_21_1 = shared->N_age;
  shared->dim_recov_21_2 = 3;
  shared->dim_recov_23_1 = shared->N_age;
  shared->dim_recov_23_2 = 3;
  shared->dim_recov_231_1 = shared->N_age;
  shared->dim_recov_231_2 = 3;
  shared->dim_recov_234_1 = shared->N_age;
  shared->dim_recov_234_2 = 3;
  shared->dim_recov_2341_1 = shared->N_age;
  shared->dim_recov_2341_2 = 3;
  shared->dim_recov_24_1 = shared->N_age;
  shared->dim_recov_24_2 = 3;
  shared->dim_recov_241_1 = shared->N_age;
  shared->dim_recov_241_2 = 3;
  shared->dim_recov_243_1 = shared->N_age;
  shared->dim_recov_243_2 = 3;
  shared->dim_recov_3_1 = shared->N_age;
  shared->dim_recov_3_2 = 3;
  shared->dim_recov_31_1 = shared->N_age;
  shared->dim_recov_31_2 = 3;
  shared->dim_recov_32_1 = shared->N_age;
  shared->dim_recov_32_2 = 3;
  shared->dim_recov_34_1 = shared->N_age;
  shared->dim_recov_34_2 = 3;
  shared->dim_recov_341_1 = shared->N_age;
  shared->dim_recov_341_2 = 3;
  shared->dim_recov_342_1 = shared->N_age;
  shared->dim_recov_342_2 = 3;
  shared->dim_recov_4_1 = shared->N_age;
  shared->dim_recov_4_2 = 3;
  shared->dim_recov_41_1 = shared->N_age;
  shared->dim_recov_41_2 = 3;
  shared->dim_recov_42_1 = shared->N_age;
  shared->dim_recov_42_2 = 3;
  shared->dim_recov_43_1 = shared->N_age;
  shared->dim_recov_43_2 = 3;
  shared->dim_rho1_1 = shared->N_age;
  shared->dim_rho1_2 = 3;
  shared->dim_rho12_1 = shared->N_age;
  shared->dim_rho12_2 = 3;
  shared->dim_rho123_1 = shared->N_age;
  shared->dim_rho123_2 = 3;
  shared->dim_rho1234_1 = shared->N_age;
  shared->dim_rho1234_2 = 3;
  shared->dim_rho124_1 = shared->N_age;
  shared->dim_rho124_2 = 3;
  shared->dim_rho1243_1 = shared->N_age;
  shared->dim_rho1243_2 = 3;
  shared->dim_rho13_1 = shared->N_age;
  shared->dim_rho13_2 = 3;
  shared->dim_rho132_1 = shared->N_age;
  shared->dim_rho132_2 = 3;
  shared->dim_rho134_1 = shared->N_age;
  shared->dim_rho134_2 = 3;
  shared->dim_rho1342_1 = shared->N_age;
  shared->dim_rho1342_2 = 3;
  shared->dim_rho14_1 = shared->N_age;
  shared->dim_rho14_2 = 3;
  shared->dim_rho142_1 = shared->N_age;
  shared->dim_rho142_2 = 3;
  shared->dim_rho143_1 = shared->N_age;
  shared->dim_rho143_2 = 3;
  shared->dim_rho2_1 = shared->N_age;
  shared->dim_rho2_2 = 3;
  shared->dim_rho21_1 = shared->N_age;
  shared->dim_rho21_2 = 3;
  shared->dim_rho23_1 = shared->N_age;
  shared->dim_rho23_2 = 3;
  shared->dim_rho231_1 = shared->N_age;
  shared->dim_rho231_2 = 3;
  shared->dim_rho234_1 = shared->N_age;
  shared->dim_rho234_2 = 3;
  shared->dim_rho2341_1 = shared->N_age;
  shared->dim_rho2341_2 = 3;
  shared->dim_rho24_1 = shared->N_age;
  shared->dim_rho24_2 = 3;
  shared->dim_rho241_1 = shared->N_age;
  shared->dim_rho241_2 = 3;
  shared->dim_rho243_1 = shared->N_age;
  shared->dim_rho243_2 = 3;
  shared->dim_rho3_1 = shared->N_age;
  shared->dim_rho3_2 = 3;
  shared->dim_rho31_1 = shared->N_age;
  shared->dim_rho31_2 = 3;
  shared->dim_rho32_1 = shared->N_age;
  shared->dim_rho32_2 = 3;
  shared->dim_rho34_1 = shared->N_age;
  shared->dim_rho34_2 = 3;
  shared->dim_rho341_1 = shared->N_age;
  shared->dim_rho341_2 = 3;
  shared->dim_rho342_1 = shared->N_age;
  shared->dim_rho342_2 = 3;
  shared->dim_rho4_1 = shared->N_age;
  shared->dim_rho4_2 = 3;
  shared->dim_rho41_1 = shared->N_age;
  shared->dim_rho41_2 = 3;
  shared->dim_rho42_1 = shared->N_age;
  shared->dim_rho42_2 = 3;
  shared->dim_rho43_1 = shared->N_age;
  shared->dim_rho43_2 = 3;
  shared->dim_RR_dis_1 = 4;
  shared->dim_RR_dis_2 = 2;
  shared->dim_RR_dis_3 = shared->N_age;
  shared->dim_RR_dis_cu_1 = 4;
  shared->dim_RR_dis_cu_2 = 2;
  shared->dim_RR_dis_cu_3 = shared->N_age;
  shared->dim_RR_dis_vc_1 = 4;
  shared->dim_RR_dis_vc_2 = 2;
  shared->dim_RR_dis_vc_3 = shared->N_age;
  shared->dim_RR_inf_1 = 4;
  shared->dim_RR_inf_2 = 2;
  shared->dim_RR_inf_3 = shared->N_age;
  shared->dim_RR_sdis_1 = 4;
  shared->dim_RR_sdis_2 = 2;
  shared->dim_RR_sdis_3 = shared->N_age;
  shared->dim_RR_sdis_cu_1 = 4;
  shared->dim_RR_sdis_cu_2 = 2;
  shared->dim_RR_sdis_cu_3 = shared->N_age;
  shared->dim_RR_sdis_vc_1 = 4;
  shared->dim_RR_sdis_vc_2 = 2;
  shared->dim_RR_sdis_vc_3 = shared->N_age;
  shared->dim_S_1 = shared->N_age;
  shared->dim_S_2 = 3;
  shared->dim_sdisease_sero_1 = shared->N_age;
  shared->dim_sdisease_sero_2 = 3;
  shared->dim_sdisease_sero_3 = 4;
  shared->dim_sdisease_sero_vacc_pri_1 = shared->N_age;
  shared->dim_sdisease_sero_vacc_pri_2 = 4;
  shared->dim_suscinitpop = shared->N_age;
  shared->dim_time_from_last_dose = shared->N_age;
  shared->dim_time_from_last_dose_base = shared->N_age;
  shared->dim_vacc_ct = shared->N_age;
  shared->dim_vcu_noncov_1 = shared->N_age;
  shared->dim_vcu_noncov_2 = 3;
  shared->dim_vcu_noncov_S_1 = shared->N_age;
  shared->dim_vcu_noncov_S_2 = 3;
  shared->dim_VE_seroneg1n = shared->NYO;
  shared->dim_VE_seroneg1p = shared->NYO;
  shared->dim_vw_I1 = shared->N_age;
  shared->dim_vw_I12 = shared->N_age;
  shared->dim_vw_I123 = shared->N_age;
  shared->dim_vw_I1234 = shared->N_age;
  shared->dim_vw_I124 = shared->N_age;
  shared->dim_vw_I1243 = shared->N_age;
  shared->dim_vw_I13 = shared->N_age;
  shared->dim_vw_I132 = shared->N_age;
  shared->dim_vw_I134 = shared->N_age;
  shared->dim_vw_I1342 = shared->N_age;
  shared->dim_vw_I14 = shared->N_age;
  shared->dim_vw_I142 = shared->N_age;
  shared->dim_vw_I143 = shared->N_age;
  shared->dim_vw_I2 = shared->N_age;
  shared->dim_vw_I21 = shared->N_age;
  shared->dim_vw_I23 = shared->N_age;
  shared->dim_vw_I231 = shared->N_age;
  shared->dim_vw_I234 = shared->N_age;
  shared->dim_vw_I2341 = shared->N_age;
  shared->dim_vw_I24 = shared->N_age;
  shared->dim_vw_I241 = shared->N_age;
  shared->dim_vw_I243 = shared->N_age;
  shared->dim_vw_I3 = shared->N_age;
  shared->dim_vw_I31 = shared->N_age;
  shared->dim_vw_I32 = shared->N_age;
  shared->dim_vw_I34 = shared->N_age;
  shared->dim_vw_I341 = shared->N_age;
  shared->dim_vw_I342 = shared->N_age;
  shared->dim_vw_I4 = shared->N_age;
  shared->dim_vw_I41 = shared->N_age;
  shared->dim_vw_I42 = shared->N_age;
  shared->dim_vw_I43 = shared->N_age;
  shared->dim_vw_R1 = shared->N_age;
  shared->dim_vw_R12 = shared->N_age;
  shared->dim_vw_R123 = shared->N_age;
  shared->dim_vw_R1234 = shared->N_age;
  shared->dim_vw_R124 = shared->N_age;
  shared->dim_vw_R13 = shared->N_age;
  shared->dim_vw_R134 = shared->N_age;
  shared->dim_vw_R14 = shared->N_age;
  shared->dim_vw_R2 = shared->N_age;
  shared->dim_vw_R23 = shared->N_age;
  shared->dim_vw_R234 = shared->N_age;
  shared->dim_vw_R24 = shared->N_age;
  shared->dim_vw_R3 = shared->N_age;
  shared->dim_vw_R34 = shared->N_age;
  shared->dim_vw_R4 = shared->N_age;
  shared->dim_vw_S = shared->N_age;
  shared->dim_Y1_1 = shared->N_age;
  shared->dim_Y1_2 = 3;
  shared->dim_Y2_1 = shared->N_age;
  shared->dim_Y2_2 = 3;
  shared->dim_Y3_1 = shared->N_age;
  shared->dim_Y3_2 = 3;
  shared->dim_Y4_1 = shared->N_age;
  shared->dim_Y4_2 = 3;
  shared->dim_yll_sero_1 = shared->N_age;
  shared->dim_yll_sero_2 = 3;
  shared->dim_yll_sero_3 = 4;
  shared->dim_yll_sero_vacc_pri_1 = shared->N_age;
  shared->dim_yll_sero_vacc_pri_2 = 4;
  shared->N_age_p1 = shared->N_age + 1;
  shared->vcov_cu_S = (shared->vacc_by_serostatus == 0 ? shared->vacc_cu_coverage_S : shared->vacc_cu_coverage);
  shared->Wb_relsusc1 = 1 - shared->Wb_eff;
  shared->Wb_relsusc2 = 1 - shared->Wb_eff;
  shared->Wb_relsusc3 = 1 - shared->Wb_eff;
  shared->Wb_relsusc4 = 1 - shared->Wb_eff;
  shared->agec = std::vector<real_type>(shared->dim_agec);
  internal.agert = std::vector<real_type>(shared->dim_agert);
  internal.cur_age_rate = std::vector<real_type>(shared->dim_cur_age_rate);
  internal.death = std::vector<real_type>(shared->dim_death);
  internal.deathrt = std::vector<real_type>(shared->dim_deathrt);
  internal.FOI1a = std::vector<real_type>(shared->dim_FOI1a);
  internal.FOI2a = std::vector<real_type>(shared->dim_FOI2a);
  internal.FOI3a = std::vector<real_type>(shared->dim_FOI3a);
  internal.FOI4a = std::vector<real_type>(shared->dim_FOI4a);
  shared->FOIas = std::vector<real_type>(shared->dim_FOIas);
  shared->init_life_expec = std::vector<real_type>(shared->dim_init_life_expec);
  shared->initial_cum_infection_pri = std::vector<real_type>(shared->dim_cum_infection_pri);
  shared->initial_cum_infection_priV = std::vector<real_type>(shared->dim_cum_infection_priV);
  shared->initial_cum_infection_sec = std::vector<real_type>(shared->dim_cum_infection_sec);
  shared->initial_cum_infection_secV = std::vector<real_type>(shared->dim_cum_infection_secV);
  shared->initial_cum_infection_tq = std::vector<real_type>(shared->dim_cum_infection_tq);
  shared->initial_cum_infection_tqV = std::vector<real_type>(shared->dim_cum_infection_tqV);
  shared->initial_Ntotal_out = std::vector<real_type>(shared->dim_Ntotal_out);
  shared->initial_out_dis_all_pop = std::vector<real_type>(shared->dim_out_dis_all_pop);
  shared->initial_out_dis_all_unvacc = std::vector<real_type>(shared->dim_out_dis_all_unvacc);
  shared->initial_out_dis_all_vacc = std::vector<real_type>(shared->dim_out_dis_all_vacc);
  shared->initial_out_dis_all_vacc_neg = std::vector<real_type>(shared->dim_out_dis_all_vacc_neg);
  shared->initial_out_dis_all_vacc_pos = std::vector<real_type>(shared->dim_out_dis_all_vacc_pos);
  shared->initial_out_disc_dis_all_pop = std::vector<real_type>(shared->dim_out_disc_dis_all_pop);
  shared->initial_out_disc_dis_all_vacc = std::vector<real_type>(shared->dim_out_disc_dis_all_vacc);
  shared->initial_out_disc_nvacc_all_pop = std::vector<real_type>(shared->dim_out_disc_nvacc_all_pop);
  shared->initial_out_disc_sdis_all_pop = std::vector<real_type>(shared->dim_out_disc_sdis_all_pop);
  shared->initial_out_disc_sdis_all_vacc = std::vector<real_type>(shared->dim_out_disc_sdis_all_vacc);
  shared->initial_out_disc_yll_all_pop = std::vector<real_type>(shared->dim_out_disc_yll_all_pop);
  shared->initial_out_disc_yll_all_vacc = std::vector<real_type>(shared->dim_out_disc_yll_all_vacc);
  shared->initial_out_nvacc_all_neg = std::vector<real_type>(shared->dim_out_nvacc_all_neg);
  shared->initial_out_nvacc_all_pop = std::vector<real_type>(shared->dim_out_nvacc_all_pop);
  shared->initial_out_nvacc_all_pos = std::vector<real_type>(shared->dim_out_nvacc_all_pos);
  shared->initial_out_prop_seroneg_at_9 = std::vector<real_type>(shared->dim_out_prop_seroneg_at_9);
  shared->initial_out_prop_seroneg_at_vca = std::vector<real_type>(shared->dim_out_prop_seroneg_at_vca);
  shared->initial_out_sdis_all_pop = std::vector<real_type>(shared->dim_out_sdis_all_pop);
  shared->initial_out_sdis_all_unvacc = std::vector<real_type>(shared->dim_out_sdis_all_unvacc);
  shared->initial_out_sdis_all_vacc = std::vector<real_type>(shared->dim_out_sdis_all_vacc);
  shared->initial_out_sdis_all_vacc_neg = std::vector<real_type>(shared->dim_out_sdis_all_vacc_neg);
  shared->initial_out_sdis_all_vacc_pos = std::vector<real_type>(shared->dim_out_sdis_all_vacc_pos);
  shared->initial_out_time_from_last_dose = std::vector<real_type>(shared->dim_out_time_from_last_dose);
  shared->initial_out_yll_all_pop = std::vector<real_type>(shared->dim_out_yll_all_pop);
  shared->initial_out_yll_all_unvacc = std::vector<real_type>(shared->dim_out_yll_all_unvacc);
  shared->initial_out_yll_all_vacc = std::vector<real_type>(shared->dim_out_yll_all_vacc);
  shared->initial_out_yll_all_vacc_neg = std::vector<real_type>(shared->dim_out_yll_all_vacc_neg);
  shared->initial_out_yll_all_vacc_pos = std::vector<real_type>(shared->dim_out_yll_all_vacc_pos);
  shared->initial_VE_seroneg1n = std::vector<real_type>(shared->dim_VE_seroneg1n);
  shared->initial_VE_seroneg1p = std::vector<real_type>(shared->dim_VE_seroneg1p);
  internal.life_expec = std::vector<real_type>(shared->dim_life_expec);
  shared->mean_age = std::vector<real_type>(shared->dim_mean_age);
  shared->N_init_age = std::vector<real_type>(shared->dim_N_init_age);
  shared->N_init_age0 = std::vector<real_type>(shared->dim_N_init_age0);
  internal.nc_cu = std::vector<real_type>(shared->dim_nc_cu);
  shared->nc50_age = std::vector<real_type>(shared->dim_nc50_age);
  internal.ncu_I1 = std::vector<real_type>(shared->dim_ncu_I1);
  internal.ncu_I12 = std::vector<real_type>(shared->dim_ncu_I12);
  internal.ncu_I123 = std::vector<real_type>(shared->dim_ncu_I123);
  internal.ncu_I1234 = std::vector<real_type>(shared->dim_ncu_I1234);
  internal.ncu_I124 = std::vector<real_type>(shared->dim_ncu_I124);
  internal.ncu_I1243 = std::vector<real_type>(shared->dim_ncu_I1243);
  internal.ncu_I13 = std::vector<real_type>(shared->dim_ncu_I13);
  internal.ncu_I132 = std::vector<real_type>(shared->dim_ncu_I132);
  internal.ncu_I134 = std::vector<real_type>(shared->dim_ncu_I134);
  internal.ncu_I1342 = std::vector<real_type>(shared->dim_ncu_I1342);
  internal.ncu_I14 = std::vector<real_type>(shared->dim_ncu_I14);
  internal.ncu_I142 = std::vector<real_type>(shared->dim_ncu_I142);
  internal.ncu_I143 = std::vector<real_type>(shared->dim_ncu_I143);
  internal.ncu_I2 = std::vector<real_type>(shared->dim_ncu_I2);
  internal.ncu_I21 = std::vector<real_type>(shared->dim_ncu_I21);
  internal.ncu_I23 = std::vector<real_type>(shared->dim_ncu_I23);
  internal.ncu_I231 = std::vector<real_type>(shared->dim_ncu_I231);
  internal.ncu_I234 = std::vector<real_type>(shared->dim_ncu_I234);
  internal.ncu_I2341 = std::vector<real_type>(shared->dim_ncu_I2341);
  internal.ncu_I24 = std::vector<real_type>(shared->dim_ncu_I24);
  internal.ncu_I241 = std::vector<real_type>(shared->dim_ncu_I241);
  internal.ncu_I243 = std::vector<real_type>(shared->dim_ncu_I243);
  internal.ncu_I3 = std::vector<real_type>(shared->dim_ncu_I3);
  internal.ncu_I31 = std::vector<real_type>(shared->dim_ncu_I31);
  internal.ncu_I32 = std::vector<real_type>(shared->dim_ncu_I32);
  internal.ncu_I34 = std::vector<real_type>(shared->dim_ncu_I34);
  internal.ncu_I341 = std::vector<real_type>(shared->dim_ncu_I341);
  internal.ncu_I342 = std::vector<real_type>(shared->dim_ncu_I342);
  internal.ncu_I4 = std::vector<real_type>(shared->dim_ncu_I4);
  internal.ncu_I41 = std::vector<real_type>(shared->dim_ncu_I41);
  internal.ncu_I42 = std::vector<real_type>(shared->dim_ncu_I42);
  internal.ncu_I43 = std::vector<real_type>(shared->dim_ncu_I43);
  internal.ncu_R1 = std::vector<real_type>(shared->dim_ncu_R1);
  internal.ncu_R12 = std::vector<real_type>(shared->dim_ncu_R12);
  internal.ncu_R123 = std::vector<real_type>(shared->dim_ncu_R123);
  internal.ncu_R1234 = std::vector<real_type>(shared->dim_ncu_R1234);
  internal.ncu_R124 = std::vector<real_type>(shared->dim_ncu_R124);
  internal.ncu_R13 = std::vector<real_type>(shared->dim_ncu_R13);
  internal.ncu_R134 = std::vector<real_type>(shared->dim_ncu_R134);
  internal.ncu_R14 = std::vector<real_type>(shared->dim_ncu_R14);
  internal.ncu_R2 = std::vector<real_type>(shared->dim_ncu_R2);
  internal.ncu_R23 = std::vector<real_type>(shared->dim_ncu_R23);
  internal.ncu_R234 = std::vector<real_type>(shared->dim_ncu_R234);
  internal.ncu_R24 = std::vector<real_type>(shared->dim_ncu_R24);
  internal.ncu_R3 = std::vector<real_type>(shared->dim_ncu_R3);
  internal.ncu_R34 = std::vector<real_type>(shared->dim_ncu_R34);
  internal.ncu_R4 = std::vector<real_type>(shared->dim_ncu_R4);
  internal.ncu_S = std::vector<real_type>(shared->dim_ncu_S);
  internal.Ntotal_all = std::vector<real_type>(shared->dim_Ntotal_all);
  internal.Ntotal_nv = std::vector<real_type>(shared->dim_Ntotal_nv);
  internal.Ntotal_nvS = std::vector<real_type>(shared->dim_Ntotal_nvS);
  internal.Ntotal_v = std::vector<real_type>(shared->dim_Ntotal_v);
  internal.Ntotal_vS = std::vector<real_type>(shared->dim_Ntotal_vS);
  internal.num_child_vacc_age = std::vector<real_type>(shared->dim_num_child_vacc_age);
  internal.num_child_vacc_age_neg = std::vector<real_type>(shared->dim_num_child_vacc_age_neg);
  internal.num_cu_vacc_age = std::vector<real_type>(shared->dim_num_cu_vacc_age);
  internal.num_cu_vacc_age_neg = std::vector<real_type>(shared->dim_num_cu_vacc_age_neg);
  internal.out_update_switch = std::vector<real_type>(shared->dim_out_update_switch);
  shared->suscinitpop = std::vector<real_type>(shared->dim_suscinitpop);
  internal.time_from_last_dose = std::vector<real_type>(shared->dim_time_from_last_dose);
  internal.time_from_last_dose_base = std::vector<real_type>(shared->dim_time_from_last_dose_base);
  internal.vacc_ct = std::vector<real_type>(shared->dim_vacc_ct);
  internal.vw_I1 = std::vector<real_type>(shared->dim_vw_I1);
  internal.vw_I12 = std::vector<real_type>(shared->dim_vw_I12);
  internal.vw_I123 = std::vector<real_type>(shared->dim_vw_I123);
  internal.vw_I1234 = std::vector<real_type>(shared->dim_vw_I1234);
  internal.vw_I124 = std::vector<real_type>(shared->dim_vw_I124);
  internal.vw_I1243 = std::vector<real_type>(shared->dim_vw_I1243);
  internal.vw_I13 = std::vector<real_type>(shared->dim_vw_I13);
  internal.vw_I132 = std::vector<real_type>(shared->dim_vw_I132);
  internal.vw_I134 = std::vector<real_type>(shared->dim_vw_I134);
  internal.vw_I1342 = std::vector<real_type>(shared->dim_vw_I1342);
  internal.vw_I14 = std::vector<real_type>(shared->dim_vw_I14);
  internal.vw_I142 = std::vector<real_type>(shared->dim_vw_I142);
  internal.vw_I143 = std::vector<real_type>(shared->dim_vw_I143);
  internal.vw_I2 = std::vector<real_type>(shared->dim_vw_I2);
  internal.vw_I21 = std::vector<real_type>(shared->dim_vw_I21);
  internal.vw_I23 = std::vector<real_type>(shared->dim_vw_I23);
  internal.vw_I231 = std::vector<real_type>(shared->dim_vw_I231);
  internal.vw_I234 = std::vector<real_type>(shared->dim_vw_I234);
  internal.vw_I2341 = std::vector<real_type>(shared->dim_vw_I2341);
  internal.vw_I24 = std::vector<real_type>(shared->dim_vw_I24);
  internal.vw_I241 = std::vector<real_type>(shared->dim_vw_I241);
  internal.vw_I243 = std::vector<real_type>(shared->dim_vw_I243);
  internal.vw_I3 = std::vector<real_type>(shared->dim_vw_I3);
  internal.vw_I31 = std::vector<real_type>(shared->dim_vw_I31);
  internal.vw_I32 = std::vector<real_type>(shared->dim_vw_I32);
  internal.vw_I34 = std::vector<real_type>(shared->dim_vw_I34);
  internal.vw_I341 = std::vector<real_type>(shared->dim_vw_I341);
  internal.vw_I342 = std::vector<real_type>(shared->dim_vw_I342);
  internal.vw_I4 = std::vector<real_type>(shared->dim_vw_I4);
  internal.vw_I41 = std::vector<real_type>(shared->dim_vw_I41);
  internal.vw_I42 = std::vector<real_type>(shared->dim_vw_I42);
  internal.vw_I43 = std::vector<real_type>(shared->dim_vw_I43);
  internal.vw_R1 = std::vector<real_type>(shared->dim_vw_R1);
  internal.vw_R12 = std::vector<real_type>(shared->dim_vw_R12);
  internal.vw_R123 = std::vector<real_type>(shared->dim_vw_R123);
  internal.vw_R1234 = std::vector<real_type>(shared->dim_vw_R1234);
  internal.vw_R124 = std::vector<real_type>(shared->dim_vw_R124);
  internal.vw_R13 = std::vector<real_type>(shared->dim_vw_R13);
  internal.vw_R134 = std::vector<real_type>(shared->dim_vw_R134);
  internal.vw_R14 = std::vector<real_type>(shared->dim_vw_R14);
  internal.vw_R2 = std::vector<real_type>(shared->dim_vw_R2);
  internal.vw_R23 = std::vector<real_type>(shared->dim_vw_R23);
  internal.vw_R234 = std::vector<real_type>(shared->dim_vw_R234);
  internal.vw_R24 = std::vector<real_type>(shared->dim_vw_R24);
  internal.vw_R3 = std::vector<real_type>(shared->dim_vw_R3);
  internal.vw_R34 = std::vector<real_type>(shared->dim_vw_R34);
  internal.vw_R4 = std::vector<real_type>(shared->dim_vw_R4);
  internal.vw_S = std::vector<real_type>(shared->dim_vw_S);
  shared->dim_age_I1_1 = shared->N_age_p1;
  shared->dim_age_I1_2 = 3;
  shared->dim_age_I12_1 = shared->N_age_p1;
  shared->dim_age_I12_2 = 3;
  shared->dim_age_I123_1 = shared->N_age_p1;
  shared->dim_age_I123_2 = 3;
  shared->dim_age_I1234_1 = shared->N_age_p1;
  shared->dim_age_I1234_2 = 3;
  shared->dim_age_I124_1 = shared->N_age_p1;
  shared->dim_age_I124_2 = 3;
  shared->dim_age_I1243_1 = shared->N_age_p1;
  shared->dim_age_I1243_2 = 3;
  shared->dim_age_I13_1 = shared->N_age_p1;
  shared->dim_age_I13_2 = 3;
  shared->dim_age_I132_1 = shared->N_age_p1;
  shared->dim_age_I132_2 = 3;
  shared->dim_age_I134_1 = shared->N_age_p1;
  shared->dim_age_I134_2 = 3;
  shared->dim_age_I1342_1 = shared->N_age_p1;
  shared->dim_age_I1342_2 = 3;
  shared->dim_age_I14_1 = shared->N_age_p1;
  shared->dim_age_I14_2 = 3;
  shared->dim_age_I142_1 = shared->N_age_p1;
  shared->dim_age_I142_2 = 3;
  shared->dim_age_I143_1 = shared->N_age_p1;
  shared->dim_age_I143_2 = 3;
  shared->dim_age_I2_1 = shared->N_age_p1;
  shared->dim_age_I2_2 = 3;
  shared->dim_age_I21_1 = shared->N_age_p1;
  shared->dim_age_I21_2 = 3;
  shared->dim_age_I23_1 = shared->N_age_p1;
  shared->dim_age_I23_2 = 3;
  shared->dim_age_I231_1 = shared->N_age_p1;
  shared->dim_age_I231_2 = 3;
  shared->dim_age_I234_1 = shared->N_age_p1;
  shared->dim_age_I234_2 = 3;
  shared->dim_age_I2341_1 = shared->N_age_p1;
  shared->dim_age_I2341_2 = 3;
  shared->dim_age_I24_1 = shared->N_age_p1;
  shared->dim_age_I24_2 = 3;
  shared->dim_age_I241_1 = shared->N_age_p1;
  shared->dim_age_I241_2 = 3;
  shared->dim_age_I243_1 = shared->N_age_p1;
  shared->dim_age_I243_2 = 3;
  shared->dim_age_I3_1 = shared->N_age_p1;
  shared->dim_age_I3_2 = 3;
  shared->dim_age_I31_1 = shared->N_age_p1;
  shared->dim_age_I31_2 = 3;
  shared->dim_age_I32_1 = shared->N_age_p1;
  shared->dim_age_I32_2 = 3;
  shared->dim_age_I34_1 = shared->N_age_p1;
  shared->dim_age_I34_2 = 3;
  shared->dim_age_I341_1 = shared->N_age_p1;
  shared->dim_age_I341_2 = 3;
  shared->dim_age_I342_1 = shared->N_age_p1;
  shared->dim_age_I342_2 = 3;
  shared->dim_age_I4_1 = shared->N_age_p1;
  shared->dim_age_I4_2 = 3;
  shared->dim_age_I41_1 = shared->N_age_p1;
  shared->dim_age_I41_2 = 3;
  shared->dim_age_I42_1 = shared->N_age_p1;
  shared->dim_age_I42_2 = 3;
  shared->dim_age_I43_1 = shared->N_age_p1;
  shared->dim_age_I43_2 = 3;
  shared->dim_age_R1_1 = shared->N_age_p1;
  shared->dim_age_R1_2 = 3;
  shared->dim_age_R12_1 = shared->N_age_p1;
  shared->dim_age_R12_2 = 3;
  shared->dim_age_R123_1 = shared->N_age_p1;
  shared->dim_age_R123_2 = 3;
  shared->dim_age_R1234_1 = shared->N_age_p1;
  shared->dim_age_R1234_2 = 3;
  shared->dim_age_R124_1 = shared->N_age_p1;
  shared->dim_age_R124_2 = 3;
  shared->dim_age_R13_1 = shared->N_age_p1;
  shared->dim_age_R13_2 = 3;
  shared->dim_age_R134_1 = shared->N_age_p1;
  shared->dim_age_R134_2 = 3;
  shared->dim_age_R14_1 = shared->N_age_p1;
  shared->dim_age_R14_2 = 3;
  shared->dim_age_R2_1 = shared->N_age_p1;
  shared->dim_age_R2_2 = 3;
  shared->dim_age_R23_1 = shared->N_age_p1;
  shared->dim_age_R23_2 = 3;
  shared->dim_age_R234_1 = shared->N_age_p1;
  shared->dim_age_R234_2 = 3;
  shared->dim_age_R24_1 = shared->N_age_p1;
  shared->dim_age_R24_2 = 3;
  shared->dim_age_R3_1 = shared->N_age_p1;
  shared->dim_age_R3_2 = 3;
  shared->dim_age_R34_1 = shared->N_age_p1;
  shared->dim_age_R34_2 = 3;
  shared->dim_age_R4_1 = shared->N_age_p1;
  shared->dim_age_R4_2 = 3;
  shared->dim_age_S_1 = shared->N_age_p1;
  shared->dim_age_S_2 = 3;
  shared->dim_ageb = shared->N_age_p1;
  shared->dim_disc_yll_all = shared->dim_disc_yll_all_1 * shared->dim_disc_yll_all_2;
  shared->dim_disease_sero = shared->dim_disease_sero_1 * shared->dim_disease_sero_2 * shared->dim_disease_sero_3;
  shared->dim_disease_sero_12 = shared->dim_disease_sero_1 * shared->dim_disease_sero_2;
  shared->dim_disease_sero_vacc_pri = shared->dim_disease_sero_vacc_pri_1 * shared->dim_disease_sero_vacc_pri_2;
  shared->dim_I1 = shared->dim_I1_1 * shared->dim_I1_2;
  shared->dim_I12 = shared->dim_I12_1 * shared->dim_I12_2;
  shared->dim_I123 = shared->dim_I123_1 * shared->dim_I123_2;
  shared->dim_I1234 = shared->dim_I1234_1 * shared->dim_I1234_2;
  shared->dim_I124 = shared->dim_I124_1 * shared->dim_I124_2;
  shared->dim_I1243 = shared->dim_I1243_1 * shared->dim_I1243_2;
  shared->dim_I13 = shared->dim_I13_1 * shared->dim_I13_2;
  shared->dim_I132 = shared->dim_I132_1 * shared->dim_I132_2;
  shared->dim_I134 = shared->dim_I134_1 * shared->dim_I134_2;
  shared->dim_I1342 = shared->dim_I1342_1 * shared->dim_I1342_2;
  shared->dim_I14 = shared->dim_I14_1 * shared->dim_I14_2;
  shared->dim_I142 = shared->dim_I142_1 * shared->dim_I142_2;
  shared->dim_I143 = shared->dim_I143_1 * shared->dim_I143_2;
  shared->dim_I2 = shared->dim_I2_1 * shared->dim_I2_2;
  shared->dim_I21 = shared->dim_I21_1 * shared->dim_I21_2;
  shared->dim_I23 = shared->dim_I23_1 * shared->dim_I23_2;
  shared->dim_I231 = shared->dim_I231_1 * shared->dim_I231_2;
  shared->dim_I234 = shared->dim_I234_1 * shared->dim_I234_2;
  shared->dim_I2341 = shared->dim_I2341_1 * shared->dim_I2341_2;
  shared->dim_I24 = shared->dim_I24_1 * shared->dim_I24_2;
  shared->dim_I241 = shared->dim_I241_1 * shared->dim_I241_2;
  shared->dim_I243 = shared->dim_I243_1 * shared->dim_I243_2;
  shared->dim_I3 = shared->dim_I3_1 * shared->dim_I3_2;
  shared->dim_I31 = shared->dim_I31_1 * shared->dim_I31_2;
  shared->dim_I32 = shared->dim_I32_1 * shared->dim_I32_2;
  shared->dim_I34 = shared->dim_I34_1 * shared->dim_I34_2;
  shared->dim_I341 = shared->dim_I341_1 * shared->dim_I341_2;
  shared->dim_I342 = shared->dim_I342_1 * shared->dim_I342_2;
  shared->dim_I4 = shared->dim_I4_1 * shared->dim_I4_2;
  shared->dim_I41 = shared->dim_I41_1 * shared->dim_I41_2;
  shared->dim_I42 = shared->dim_I42_1 * shared->dim_I42_2;
  shared->dim_I43 = shared->dim_I43_1 * shared->dim_I43_2;
  shared->dim_inf_1 = shared->dim_inf_1_1 * shared->dim_inf_1_2;
  shared->dim_inf_12 = shared->dim_inf_12_1 * shared->dim_inf_12_2;
  shared->dim_inf_123 = shared->dim_inf_123_1 * shared->dim_inf_123_2;
  shared->dim_inf_1234 = shared->dim_inf_1234_1 * shared->dim_inf_1234_2;
  shared->dim_inf_124 = shared->dim_inf_124_1 * shared->dim_inf_124_2;
  shared->dim_inf_1243 = shared->dim_inf_1243_1 * shared->dim_inf_1243_2;
  shared->dim_inf_13 = shared->dim_inf_13_1 * shared->dim_inf_13_2;
  shared->dim_inf_132 = shared->dim_inf_132_1 * shared->dim_inf_132_2;
  shared->dim_inf_134 = shared->dim_inf_134_1 * shared->dim_inf_134_2;
  shared->dim_inf_1342 = shared->dim_inf_1342_1 * shared->dim_inf_1342_2;
  shared->dim_inf_14 = shared->dim_inf_14_1 * shared->dim_inf_14_2;
  shared->dim_inf_142 = shared->dim_inf_142_1 * shared->dim_inf_142_2;
  shared->dim_inf_143 = shared->dim_inf_143_1 * shared->dim_inf_143_2;
  shared->dim_inf_2 = shared->dim_inf_2_1 * shared->dim_inf_2_2;
  shared->dim_inf_21 = shared->dim_inf_21_1 * shared->dim_inf_21_2;
  shared->dim_inf_23 = shared->dim_inf_23_1 * shared->dim_inf_23_2;
  shared->dim_inf_231 = shared->dim_inf_231_1 * shared->dim_inf_231_2;
  shared->dim_inf_234 = shared->dim_inf_234_1 * shared->dim_inf_234_2;
  shared->dim_inf_2341 = shared->dim_inf_2341_1 * shared->dim_inf_2341_2;
  shared->dim_inf_24 = shared->dim_inf_24_1 * shared->dim_inf_24_2;
  shared->dim_inf_241 = shared->dim_inf_241_1 * shared->dim_inf_241_2;
  shared->dim_inf_243 = shared->dim_inf_243_1 * shared->dim_inf_243_2;
  shared->dim_inf_3 = shared->dim_inf_3_1 * shared->dim_inf_3_2;
  shared->dim_inf_31 = shared->dim_inf_31_1 * shared->dim_inf_31_2;
  shared->dim_inf_32 = shared->dim_inf_32_1 * shared->dim_inf_32_2;
  shared->dim_inf_34 = shared->dim_inf_34_1 * shared->dim_inf_34_2;
  shared->dim_inf_341 = shared->dim_inf_341_1 * shared->dim_inf_341_2;
  shared->dim_inf_342 = shared->dim_inf_342_1 * shared->dim_inf_342_2;
  shared->dim_inf_4 = shared->dim_inf_4_1 * shared->dim_inf_4_2;
  shared->dim_inf_41 = shared->dim_inf_41_1 * shared->dim_inf_41_2;
  shared->dim_inf_42 = shared->dim_inf_42_1 * shared->dim_inf_42_2;
  shared->dim_inf_43 = shared->dim_inf_43_1 * shared->dim_inf_43_2;
  shared->dim_infection_pri = shared->dim_infection_pri_1 * shared->dim_infection_pri_2;
  shared->dim_infection_sec = shared->dim_infection_sec_1 * shared->dim_infection_sec_2;
  shared->dim_infection_tq = shared->dim_infection_tq_1 * shared->dim_infection_tq_2;
  shared->dim_infV_1 = shared->dim_infV_1_1 * shared->dim_infV_1_2;
  shared->dim_infV_2 = shared->dim_infV_2_1 * shared->dim_infV_2_2;
  shared->dim_infV_3 = shared->dim_infV_3_1 * shared->dim_infV_3_2;
  shared->dim_infV_4 = shared->dim_infV_4_1 * shared->dim_infV_4_2;
  shared->dim_n_I1 = shared->dim_n_I1_1 * shared->dim_n_I1_2;
  shared->dim_n_I12 = shared->dim_n_I12_1 * shared->dim_n_I12_2;
  shared->dim_n_I123 = shared->dim_n_I123_1 * shared->dim_n_I123_2;
  shared->dim_n_I1234 = shared->dim_n_I1234_1 * shared->dim_n_I1234_2;
  shared->dim_n_I124 = shared->dim_n_I124_1 * shared->dim_n_I124_2;
  shared->dim_n_I1243 = shared->dim_n_I1243_1 * shared->dim_n_I1243_2;
  shared->dim_n_I13 = shared->dim_n_I13_1 * shared->dim_n_I13_2;
  shared->dim_n_I132 = shared->dim_n_I132_1 * shared->dim_n_I132_2;
  shared->dim_n_I134 = shared->dim_n_I134_1 * shared->dim_n_I134_2;
  shared->dim_n_I1342 = shared->dim_n_I1342_1 * shared->dim_n_I1342_2;
  shared->dim_n_I14 = shared->dim_n_I14_1 * shared->dim_n_I14_2;
  shared->dim_n_I142 = shared->dim_n_I142_1 * shared->dim_n_I142_2;
  shared->dim_n_I143 = shared->dim_n_I143_1 * shared->dim_n_I143_2;
  shared->dim_n_I2 = shared->dim_n_I2_1 * shared->dim_n_I2_2;
  shared->dim_n_I21 = shared->dim_n_I21_1 * shared->dim_n_I21_2;
  shared->dim_n_I23 = shared->dim_n_I23_1 * shared->dim_n_I23_2;
  shared->dim_n_I231 = shared->dim_n_I231_1 * shared->dim_n_I231_2;
  shared->dim_n_I234 = shared->dim_n_I234_1 * shared->dim_n_I234_2;
  shared->dim_n_I2341 = shared->dim_n_I2341_1 * shared->dim_n_I2341_2;
  shared->dim_n_I24 = shared->dim_n_I24_1 * shared->dim_n_I24_2;
  shared->dim_n_I241 = shared->dim_n_I241_1 * shared->dim_n_I241_2;
  shared->dim_n_I243 = shared->dim_n_I243_1 * shared->dim_n_I243_2;
  shared->dim_n_I3 = shared->dim_n_I3_1 * shared->dim_n_I3_2;
  shared->dim_n_I31 = shared->dim_n_I31_1 * shared->dim_n_I31_2;
  shared->dim_n_I32 = shared->dim_n_I32_1 * shared->dim_n_I32_2;
  shared->dim_n_I34 = shared->dim_n_I34_1 * shared->dim_n_I34_2;
  shared->dim_n_I341 = shared->dim_n_I341_1 * shared->dim_n_I341_2;
  shared->dim_n_I342 = shared->dim_n_I342_1 * shared->dim_n_I342_2;
  shared->dim_n_I4 = shared->dim_n_I4_1 * shared->dim_n_I4_2;
  shared->dim_n_I41 = shared->dim_n_I41_1 * shared->dim_n_I41_2;
  shared->dim_n_I42 = shared->dim_n_I42_1 * shared->dim_n_I42_2;
  shared->dim_n_I43 = shared->dim_n_I43_1 * shared->dim_n_I43_2;
  shared->dim_n_R1 = shared->dim_n_R1_1 * shared->dim_n_R1_2;
  shared->dim_n_R12 = shared->dim_n_R12_1 * shared->dim_n_R12_2;
  shared->dim_n_R123 = shared->dim_n_R123_1 * shared->dim_n_R123_2;
  shared->dim_n_R1234 = shared->dim_n_R1234_1 * shared->dim_n_R1234_2;
  shared->dim_n_R124 = shared->dim_n_R124_1 * shared->dim_n_R124_2;
  shared->dim_n_R13 = shared->dim_n_R13_1 * shared->dim_n_R13_2;
  shared->dim_n_R134 = shared->dim_n_R134_1 * shared->dim_n_R134_2;
  shared->dim_n_R14 = shared->dim_n_R14_1 * shared->dim_n_R14_2;
  shared->dim_n_R2 = shared->dim_n_R2_1 * shared->dim_n_R2_2;
  shared->dim_n_R23 = shared->dim_n_R23_1 * shared->dim_n_R23_2;
  shared->dim_n_R234 = shared->dim_n_R234_1 * shared->dim_n_R234_2;
  shared->dim_n_R24 = shared->dim_n_R24_1 * shared->dim_n_R24_2;
  shared->dim_n_R3 = shared->dim_n_R3_1 * shared->dim_n_R3_2;
  shared->dim_n_R34 = shared->dim_n_R34_1 * shared->dim_n_R34_2;
  shared->dim_n_R4 = shared->dim_n_R4_1 * shared->dim_n_R4_2;
  shared->dim_n_S = shared->dim_n_S_1 * shared->dim_n_S_2;
  shared->dim_nc = shared->dim_nc_1 * shared->dim_nc_2 * shared->dim_nc_3;
  shared->dim_nc_12 = shared->dim_nc_1 * shared->dim_nc_2;
  shared->dim_Ntotal = shared->dim_Ntotal_1 * shared->dim_Ntotal_2;
  shared->dim_nvacc_I1 = shared->dim_nvacc_I1_1 * shared->dim_nvacc_I1_2;
  shared->dim_nvacc_I12 = shared->dim_nvacc_I12_1 * shared->dim_nvacc_I12_2;
  shared->dim_nvacc_I123 = shared->dim_nvacc_I123_1 * shared->dim_nvacc_I123_2;
  shared->dim_nvacc_I1234 = shared->dim_nvacc_I1234_1 * shared->dim_nvacc_I1234_2;
  shared->dim_nvacc_I124 = shared->dim_nvacc_I124_1 * shared->dim_nvacc_I124_2;
  shared->dim_nvacc_I1243 = shared->dim_nvacc_I1243_1 * shared->dim_nvacc_I1243_2;
  shared->dim_nvacc_I13 = shared->dim_nvacc_I13_1 * shared->dim_nvacc_I13_2;
  shared->dim_nvacc_I132 = shared->dim_nvacc_I132_1 * shared->dim_nvacc_I132_2;
  shared->dim_nvacc_I134 = shared->dim_nvacc_I134_1 * shared->dim_nvacc_I134_2;
  shared->dim_nvacc_I1342 = shared->dim_nvacc_I1342_1 * shared->dim_nvacc_I1342_2;
  shared->dim_nvacc_I14 = shared->dim_nvacc_I14_1 * shared->dim_nvacc_I14_2;
  shared->dim_nvacc_I142 = shared->dim_nvacc_I142_1 * shared->dim_nvacc_I142_2;
  shared->dim_nvacc_I143 = shared->dim_nvacc_I143_1 * shared->dim_nvacc_I143_2;
  shared->dim_nvacc_I2 = shared->dim_nvacc_I2_1 * shared->dim_nvacc_I2_2;
  shared->dim_nvacc_I21 = shared->dim_nvacc_I21_1 * shared->dim_nvacc_I21_2;
  shared->dim_nvacc_I23 = shared->dim_nvacc_I23_1 * shared->dim_nvacc_I23_2;
  shared->dim_nvacc_I231 = shared->dim_nvacc_I231_1 * shared->dim_nvacc_I231_2;
  shared->dim_nvacc_I234 = shared->dim_nvacc_I234_1 * shared->dim_nvacc_I234_2;
  shared->dim_nvacc_I2341 = shared->dim_nvacc_I2341_1 * shared->dim_nvacc_I2341_2;
  shared->dim_nvacc_I24 = shared->dim_nvacc_I24_1 * shared->dim_nvacc_I24_2;
  shared->dim_nvacc_I241 = shared->dim_nvacc_I241_1 * shared->dim_nvacc_I241_2;
  shared->dim_nvacc_I243 = shared->dim_nvacc_I243_1 * shared->dim_nvacc_I243_2;
  shared->dim_nvacc_I3 = shared->dim_nvacc_I3_1 * shared->dim_nvacc_I3_2;
  shared->dim_nvacc_I31 = shared->dim_nvacc_I31_1 * shared->dim_nvacc_I31_2;
  shared->dim_nvacc_I32 = shared->dim_nvacc_I32_1 * shared->dim_nvacc_I32_2;
  shared->dim_nvacc_I34 = shared->dim_nvacc_I34_1 * shared->dim_nvacc_I34_2;
  shared->dim_nvacc_I341 = shared->dim_nvacc_I341_1 * shared->dim_nvacc_I341_2;
  shared->dim_nvacc_I342 = shared->dim_nvacc_I342_1 * shared->dim_nvacc_I342_2;
  shared->dim_nvacc_I4 = shared->dim_nvacc_I4_1 * shared->dim_nvacc_I4_2;
  shared->dim_nvacc_I41 = shared->dim_nvacc_I41_1 * shared->dim_nvacc_I41_2;
  shared->dim_nvacc_I42 = shared->dim_nvacc_I42_1 * shared->dim_nvacc_I42_2;
  shared->dim_nvacc_I43 = shared->dim_nvacc_I43_1 * shared->dim_nvacc_I43_2;
  shared->dim_nvacc_R1 = shared->dim_nvacc_R1_1 * shared->dim_nvacc_R1_2;
  shared->dim_nvacc_R12 = shared->dim_nvacc_R12_1 * shared->dim_nvacc_R12_2;
  shared->dim_nvacc_R123 = shared->dim_nvacc_R123_1 * shared->dim_nvacc_R123_2;
  shared->dim_nvacc_R1234 = shared->dim_nvacc_R1234_1 * shared->dim_nvacc_R1234_2;
  shared->dim_nvacc_R124 = shared->dim_nvacc_R124_1 * shared->dim_nvacc_R124_2;
  shared->dim_nvacc_R13 = shared->dim_nvacc_R13_1 * shared->dim_nvacc_R13_2;
  shared->dim_nvacc_R134 = shared->dim_nvacc_R134_1 * shared->dim_nvacc_R134_2;
  shared->dim_nvacc_R14 = shared->dim_nvacc_R14_1 * shared->dim_nvacc_R14_2;
  shared->dim_nvacc_R2 = shared->dim_nvacc_R2_1 * shared->dim_nvacc_R2_2;
  shared->dim_nvacc_R23 = shared->dim_nvacc_R23_1 * shared->dim_nvacc_R23_2;
  shared->dim_nvacc_R234 = shared->dim_nvacc_R234_1 * shared->dim_nvacc_R234_2;
  shared->dim_nvacc_R24 = shared->dim_nvacc_R24_1 * shared->dim_nvacc_R24_2;
  shared->dim_nvacc_R3 = shared->dim_nvacc_R3_1 * shared->dim_nvacc_R3_2;
  shared->dim_nvacc_R34 = shared->dim_nvacc_R34_1 * shared->dim_nvacc_R34_2;
  shared->dim_nvacc_R4 = shared->dim_nvacc_R4_1 * shared->dim_nvacc_R4_2;
  shared->dim_nvacc_S = shared->dim_nvacc_S_1 * shared->dim_nvacc_S_2;
  shared->dim_O_I1 = shared->dim_O_I1_1 * shared->dim_O_I1_2;
  shared->dim_O_I12 = shared->dim_O_I12_1 * shared->dim_O_I12_2;
  shared->dim_O_I123 = shared->dim_O_I123_1 * shared->dim_O_I123_2;
  shared->dim_O_I1234 = shared->dim_O_I1234_1 * shared->dim_O_I1234_2;
  shared->dim_O_I124 = shared->dim_O_I124_1 * shared->dim_O_I124_2;
  shared->dim_O_I1243 = shared->dim_O_I1243_1 * shared->dim_O_I1243_2;
  shared->dim_O_I13 = shared->dim_O_I13_1 * shared->dim_O_I13_2;
  shared->dim_O_I132 = shared->dim_O_I132_1 * shared->dim_O_I132_2;
  shared->dim_O_I134 = shared->dim_O_I134_1 * shared->dim_O_I134_2;
  shared->dim_O_I1342 = shared->dim_O_I1342_1 * shared->dim_O_I1342_2;
  shared->dim_O_I14 = shared->dim_O_I14_1 * shared->dim_O_I14_2;
  shared->dim_O_I142 = shared->dim_O_I142_1 * shared->dim_O_I142_2;
  shared->dim_O_I143 = shared->dim_O_I143_1 * shared->dim_O_I143_2;
  shared->dim_O_I2 = shared->dim_O_I2_1 * shared->dim_O_I2_2;
  shared->dim_O_I21 = shared->dim_O_I21_1 * shared->dim_O_I21_2;
  shared->dim_O_I23 = shared->dim_O_I23_1 * shared->dim_O_I23_2;
  shared->dim_O_I231 = shared->dim_O_I231_1 * shared->dim_O_I231_2;
  shared->dim_O_I234 = shared->dim_O_I234_1 * shared->dim_O_I234_2;
  shared->dim_O_I2341 = shared->dim_O_I2341_1 * shared->dim_O_I2341_2;
  shared->dim_O_I24 = shared->dim_O_I24_1 * shared->dim_O_I24_2;
  shared->dim_O_I241 = shared->dim_O_I241_1 * shared->dim_O_I241_2;
  shared->dim_O_I243 = shared->dim_O_I243_1 * shared->dim_O_I243_2;
  shared->dim_O_I3 = shared->dim_O_I3_1 * shared->dim_O_I3_2;
  shared->dim_O_I31 = shared->dim_O_I31_1 * shared->dim_O_I31_2;
  shared->dim_O_I32 = shared->dim_O_I32_1 * shared->dim_O_I32_2;
  shared->dim_O_I34 = shared->dim_O_I34_1 * shared->dim_O_I34_2;
  shared->dim_O_I341 = shared->dim_O_I341_1 * shared->dim_O_I341_2;
  shared->dim_O_I342 = shared->dim_O_I342_1 * shared->dim_O_I342_2;
  shared->dim_O_I4 = shared->dim_O_I4_1 * shared->dim_O_I4_2;
  shared->dim_O_I41 = shared->dim_O_I41_1 * shared->dim_O_I41_2;
  shared->dim_O_I42 = shared->dim_O_I42_1 * shared->dim_O_I42_2;
  shared->dim_O_I43 = shared->dim_O_I43_1 * shared->dim_O_I43_2;
  shared->dim_O_R1 = shared->dim_O_R1_1 * shared->dim_O_R1_2;
  shared->dim_O_R12 = shared->dim_O_R12_1 * shared->dim_O_R12_2;
  shared->dim_O_R123 = shared->dim_O_R123_1 * shared->dim_O_R123_2;
  shared->dim_O_R1234 = shared->dim_O_R1234_1 * shared->dim_O_R1234_2;
  shared->dim_O_R124 = shared->dim_O_R124_1 * shared->dim_O_R124_2;
  shared->dim_O_R13 = shared->dim_O_R13_1 * shared->dim_O_R13_2;
  shared->dim_O_R134 = shared->dim_O_R134_1 * shared->dim_O_R134_2;
  shared->dim_O_R14 = shared->dim_O_R14_1 * shared->dim_O_R14_2;
  shared->dim_O_R2 = shared->dim_O_R2_1 * shared->dim_O_R2_2;
  shared->dim_O_R23 = shared->dim_O_R23_1 * shared->dim_O_R23_2;
  shared->dim_O_R234 = shared->dim_O_R234_1 * shared->dim_O_R234_2;
  shared->dim_O_R24 = shared->dim_O_R24_1 * shared->dim_O_R24_2;
  shared->dim_O_R3 = shared->dim_O_R3_1 * shared->dim_O_R3_2;
  shared->dim_O_R34 = shared->dim_O_R34_1 * shared->dim_O_R34_2;
  shared->dim_O_R4 = shared->dim_O_R4_1 * shared->dim_O_R4_2;
  shared->dim_O_S = shared->dim_O_S_1 * shared->dim_O_S_2;
  shared->dim_out_dis_sero_pop = shared->dim_out_dis_sero_pop_1 * shared->dim_out_dis_sero_pop_2;
  shared->dim_out_dis_sero_unvacc = shared->dim_out_dis_sero_unvacc_1 * shared->dim_out_dis_sero_unvacc_2;
  shared->dim_out_dis_sero_vacc = shared->dim_out_dis_sero_vacc_1 * shared->dim_out_dis_sero_vacc_2;
  shared->dim_out_dis_sero_vacc_neg = shared->dim_out_dis_sero_vacc_neg_1 * shared->dim_out_dis_sero_vacc_neg_2;
  shared->dim_out_dis_sero_vacc_pos = shared->dim_out_dis_sero_vacc_pos_1 * shared->dim_out_dis_sero_vacc_pos_2;
  shared->dim_out_nc = shared->dim_out_nc_1 * shared->dim_out_nc_2 * shared->dim_out_nc_3;
  shared->dim_out_nc_12 = shared->dim_out_nc_1 * shared->dim_out_nc_2;
  shared->dim_out_RR = shared->dim_out_RR_1 * shared->dim_out_RR_2 * shared->dim_out_RR_3;
  shared->dim_out_RR_12 = shared->dim_out_RR_1 * shared->dim_out_RR_2;
  shared->dim_out_sdis_sero_pop = shared->dim_out_sdis_sero_pop_1 * shared->dim_out_sdis_sero_pop_2;
  shared->dim_out_sdis_sero_unvacc = shared->dim_out_sdis_sero_unvacc_1 * shared->dim_out_sdis_sero_unvacc_2;
  shared->dim_out_sdis_sero_vacc = shared->dim_out_sdis_sero_vacc_1 * shared->dim_out_sdis_sero_vacc_2;
  shared->dim_out_sdis_sero_vacc_neg = shared->dim_out_sdis_sero_vacc_neg_1 * shared->dim_out_sdis_sero_vacc_neg_2;
  shared->dim_out_sdis_sero_vacc_pos = shared->dim_out_sdis_sero_vacc_pos_1 * shared->dim_out_sdis_sero_vacc_pos_2;
  shared->dim_out_yll_sero_pop = shared->dim_out_yll_sero_pop_1 * shared->dim_out_yll_sero_pop_2;
  shared->dim_out_yll_sero_unvacc = shared->dim_out_yll_sero_unvacc_1 * shared->dim_out_yll_sero_unvacc_2;
  shared->dim_out_yll_sero_vacc = shared->dim_out_yll_sero_vacc_1 * shared->dim_out_yll_sero_vacc_2;
  shared->dim_out_yll_sero_vacc_neg = shared->dim_out_yll_sero_vacc_neg_1 * shared->dim_out_yll_sero_vacc_neg_2;
  shared->dim_out_yll_sero_vacc_pos = shared->dim_out_yll_sero_vacc_pos_1 * shared->dim_out_yll_sero_vacc_pos_2;
  shared->dim_R1 = shared->dim_R1_1 * shared->dim_R1_2;
  shared->dim_R12 = shared->dim_R12_1 * shared->dim_R12_2;
  shared->dim_R123 = shared->dim_R123_1 * shared->dim_R123_2;
  shared->dim_R1234 = shared->dim_R1234_1 * shared->dim_R1234_2;
  shared->dim_R124 = shared->dim_R124_1 * shared->dim_R124_2;
  shared->dim_R13 = shared->dim_R13_1 * shared->dim_R13_2;
  shared->dim_R134 = shared->dim_R134_1 * shared->dim_R134_2;
  shared->dim_R14 = shared->dim_R14_1 * shared->dim_R14_2;
  shared->dim_R2 = shared->dim_R2_1 * shared->dim_R2_2;
  shared->dim_R23 = shared->dim_R23_1 * shared->dim_R23_2;
  shared->dim_R234 = shared->dim_R234_1 * shared->dim_R234_2;
  shared->dim_R24 = shared->dim_R24_1 * shared->dim_R24_2;
  shared->dim_R3 = shared->dim_R3_1 * shared->dim_R3_2;
  shared->dim_R34 = shared->dim_R34_1 * shared->dim_R34_2;
  shared->dim_R4 = shared->dim_R4_1 * shared->dim_R4_2;
  shared->dim_recov_1 = shared->dim_recov_1_1 * shared->dim_recov_1_2;
  shared->dim_recov_12 = shared->dim_recov_12_1 * shared->dim_recov_12_2;
  shared->dim_recov_123 = shared->dim_recov_123_1 * shared->dim_recov_123_2;
  shared->dim_recov_1234 = shared->dim_recov_1234_1 * shared->dim_recov_1234_2;
  shared->dim_recov_124 = shared->dim_recov_124_1 * shared->dim_recov_124_2;
  shared->dim_recov_1243 = shared->dim_recov_1243_1 * shared->dim_recov_1243_2;
  shared->dim_recov_13 = shared->dim_recov_13_1 * shared->dim_recov_13_2;
  shared->dim_recov_132 = shared->dim_recov_132_1 * shared->dim_recov_132_2;
  shared->dim_recov_134 = shared->dim_recov_134_1 * shared->dim_recov_134_2;
  shared->dim_recov_1342 = shared->dim_recov_1342_1 * shared->dim_recov_1342_2;
  shared->dim_recov_14 = shared->dim_recov_14_1 * shared->dim_recov_14_2;
  shared->dim_recov_142 = shared->dim_recov_142_1 * shared->dim_recov_142_2;
  shared->dim_recov_143 = shared->dim_recov_143_1 * shared->dim_recov_143_2;
  shared->dim_recov_2 = shared->dim_recov_2_1 * shared->dim_recov_2_2;
  shared->dim_recov_21 = shared->dim_recov_21_1 * shared->dim_recov_21_2;
  shared->dim_recov_23 = shared->dim_recov_23_1 * shared->dim_recov_23_2;
  shared->dim_recov_231 = shared->dim_recov_231_1 * shared->dim_recov_231_2;
  shared->dim_recov_234 = shared->dim_recov_234_1 * shared->dim_recov_234_2;
  shared->dim_recov_2341 = shared->dim_recov_2341_1 * shared->dim_recov_2341_2;
  shared->dim_recov_24 = shared->dim_recov_24_1 * shared->dim_recov_24_2;
  shared->dim_recov_241 = shared->dim_recov_241_1 * shared->dim_recov_241_2;
  shared->dim_recov_243 = shared->dim_recov_243_1 * shared->dim_recov_243_2;
  shared->dim_recov_3 = shared->dim_recov_3_1 * shared->dim_recov_3_2;
  shared->dim_recov_31 = shared->dim_recov_31_1 * shared->dim_recov_31_2;
  shared->dim_recov_32 = shared->dim_recov_32_1 * shared->dim_recov_32_2;
  shared->dim_recov_34 = shared->dim_recov_34_1 * shared->dim_recov_34_2;
  shared->dim_recov_341 = shared->dim_recov_341_1 * shared->dim_recov_341_2;
  shared->dim_recov_342 = shared->dim_recov_342_1 * shared->dim_recov_342_2;
  shared->dim_recov_4 = shared->dim_recov_4_1 * shared->dim_recov_4_2;
  shared->dim_recov_41 = shared->dim_recov_41_1 * shared->dim_recov_41_2;
  shared->dim_recov_42 = shared->dim_recov_42_1 * shared->dim_recov_42_2;
  shared->dim_recov_43 = shared->dim_recov_43_1 * shared->dim_recov_43_2;
  shared->dim_rho1 = shared->dim_rho1_1 * shared->dim_rho1_2;
  shared->dim_rho12 = shared->dim_rho12_1 * shared->dim_rho12_2;
  shared->dim_rho123 = shared->dim_rho123_1 * shared->dim_rho123_2;
  shared->dim_rho1234 = shared->dim_rho1234_1 * shared->dim_rho1234_2;
  shared->dim_rho124 = shared->dim_rho124_1 * shared->dim_rho124_2;
  shared->dim_rho1243 = shared->dim_rho1243_1 * shared->dim_rho1243_2;
  shared->dim_rho13 = shared->dim_rho13_1 * shared->dim_rho13_2;
  shared->dim_rho132 = shared->dim_rho132_1 * shared->dim_rho132_2;
  shared->dim_rho134 = shared->dim_rho134_1 * shared->dim_rho134_2;
  shared->dim_rho1342 = shared->dim_rho1342_1 * shared->dim_rho1342_2;
  shared->dim_rho14 = shared->dim_rho14_1 * shared->dim_rho14_2;
  shared->dim_rho142 = shared->dim_rho142_1 * shared->dim_rho142_2;
  shared->dim_rho143 = shared->dim_rho143_1 * shared->dim_rho143_2;
  shared->dim_rho2 = shared->dim_rho2_1 * shared->dim_rho2_2;
  shared->dim_rho21 = shared->dim_rho21_1 * shared->dim_rho21_2;
  shared->dim_rho23 = shared->dim_rho23_1 * shared->dim_rho23_2;
  shared->dim_rho231 = shared->dim_rho231_1 * shared->dim_rho231_2;
  shared->dim_rho234 = shared->dim_rho234_1 * shared->dim_rho234_2;
  shared->dim_rho2341 = shared->dim_rho2341_1 * shared->dim_rho2341_2;
  shared->dim_rho24 = shared->dim_rho24_1 * shared->dim_rho24_2;
  shared->dim_rho241 = shared->dim_rho241_1 * shared->dim_rho241_2;
  shared->dim_rho243 = shared->dim_rho243_1 * shared->dim_rho243_2;
  shared->dim_rho3 = shared->dim_rho3_1 * shared->dim_rho3_2;
  shared->dim_rho31 = shared->dim_rho31_1 * shared->dim_rho31_2;
  shared->dim_rho32 = shared->dim_rho32_1 * shared->dim_rho32_2;
  shared->dim_rho34 = shared->dim_rho34_1 * shared->dim_rho34_2;
  shared->dim_rho341 = shared->dim_rho341_1 * shared->dim_rho341_2;
  shared->dim_rho342 = shared->dim_rho342_1 * shared->dim_rho342_2;
  shared->dim_rho4 = shared->dim_rho4_1 * shared->dim_rho4_2;
  shared->dim_rho41 = shared->dim_rho41_1 * shared->dim_rho41_2;
  shared->dim_rho42 = shared->dim_rho42_1 * shared->dim_rho42_2;
  shared->dim_rho43 = shared->dim_rho43_1 * shared->dim_rho43_2;
  shared->dim_RR_dis = shared->dim_RR_dis_1 * shared->dim_RR_dis_2 * shared->dim_RR_dis_3;
  shared->dim_RR_dis_12 = shared->dim_RR_dis_1 * shared->dim_RR_dis_2;
  shared->dim_RR_dis_cu = shared->dim_RR_dis_cu_1 * shared->dim_RR_dis_cu_2 * shared->dim_RR_dis_cu_3;
  shared->dim_RR_dis_cu_12 = shared->dim_RR_dis_cu_1 * shared->dim_RR_dis_cu_2;
  shared->dim_RR_dis_vc = shared->dim_RR_dis_vc_1 * shared->dim_RR_dis_vc_2 * shared->dim_RR_dis_vc_3;
  shared->dim_RR_dis_vc_12 = shared->dim_RR_dis_vc_1 * shared->dim_RR_dis_vc_2;
  shared->dim_RR_inf = shared->dim_RR_inf_1 * shared->dim_RR_inf_2 * shared->dim_RR_inf_3;
  shared->dim_RR_inf_12 = shared->dim_RR_inf_1 * shared->dim_RR_inf_2;
  shared->dim_RR_sdis = shared->dim_RR_sdis_1 * shared->dim_RR_sdis_2 * shared->dim_RR_sdis_3;
  shared->dim_RR_sdis_12 = shared->dim_RR_sdis_1 * shared->dim_RR_sdis_2;
  shared->dim_RR_sdis_cu = shared->dim_RR_sdis_cu_1 * shared->dim_RR_sdis_cu_2 * shared->dim_RR_sdis_cu_3;
  shared->dim_RR_sdis_cu_12 = shared->dim_RR_sdis_cu_1 * shared->dim_RR_sdis_cu_2;
  shared->dim_RR_sdis_vc = shared->dim_RR_sdis_vc_1 * shared->dim_RR_sdis_vc_2 * shared->dim_RR_sdis_vc_3;
  shared->dim_RR_sdis_vc_12 = shared->dim_RR_sdis_vc_1 * shared->dim_RR_sdis_vc_2;
  shared->dim_S = shared->dim_S_1 * shared->dim_S_2;
  shared->dim_sdisease_sero = shared->dim_sdisease_sero_1 * shared->dim_sdisease_sero_2 * shared->dim_sdisease_sero_3;
  shared->dim_sdisease_sero_12 = shared->dim_sdisease_sero_1 * shared->dim_sdisease_sero_2;
  shared->dim_sdisease_sero_vacc_pri = shared->dim_sdisease_sero_vacc_pri_1 * shared->dim_sdisease_sero_vacc_pri_2;
  shared->dim_vacc_cu_age_weight = shared->N_age_p1;
  shared->dim_vacc_noncov_1 = shared->N_age_p1;
  shared->dim_vacc_noncov_2 = 3;
  shared->dim_vacc_noncov_S_1 = shared->N_age_p1;
  shared->dim_vacc_noncov_S_2 = 3;
  shared->dim_vcu_noncov = shared->dim_vcu_noncov_1 * shared->dim_vcu_noncov_2;
  shared->dim_vcu_noncov_S = shared->dim_vcu_noncov_S_1 * shared->dim_vcu_noncov_S_2;
  shared->dim_Y1 = shared->dim_Y1_1 * shared->dim_Y1_2;
  shared->dim_Y2 = shared->dim_Y2_1 * shared->dim_Y2_2;
  shared->dim_Y3 = shared->dim_Y3_1 * shared->dim_Y3_2;
  shared->dim_Y4 = shared->dim_Y4_1 * shared->dim_Y4_2;
  shared->dim_yll_sero = shared->dim_yll_sero_1 * shared->dim_yll_sero_2 * shared->dim_yll_sero_3;
  shared->dim_yll_sero_12 = shared->dim_yll_sero_1 * shared->dim_yll_sero_2;
  shared->dim_yll_sero_vacc_pri = shared->dim_yll_sero_vacc_pri_1 * shared->dim_yll_sero_vacc_pri_2;
  for (int i = 1; i <= shared->N_age; ++i) {
    shared->initial_cum_infection_pri[i - 1] = 0;
  }
  for (int i = 1; i <= shared->N_age; ++i) {
    shared->initial_cum_infection_priV[i - 1] = 0;
  }
  for (int i = 1; i <= shared->N_age; ++i) {
    shared->initial_cum_infection_sec[i - 1] = 0;
  }
  for (int i = 1; i <= shared->N_age; ++i) {
    shared->initial_cum_infection_secV[i - 1] = 0;
  }
  for (int i = 1; i <= shared->N_age; ++i) {
    shared->initial_cum_infection_tq[i - 1] = 0;
  }
  for (int i = 1; i <= shared->N_age; ++i) {
    shared->initial_cum_infection_tqV[i - 1] = 0;
  }
  for (int i = 1; i <= shared->NYO; ++i) {
    shared->initial_out_dis_all_pop[i - 1] = 0;
  }
  for (int i = 1; i <= shared->NYO; ++i) {
    shared->initial_out_dis_all_unvacc[i - 1] = 0;
  }
  for (int i = 1; i <= shared->NYO; ++i) {
    shared->initial_out_dis_all_vacc[i - 1] = 0;
  }
  for (int i = 1; i <= shared->NYO; ++i) {
    shared->initial_out_dis_all_vacc_neg[i - 1] = 0;
  }
  for (int i = 1; i <= shared->NYO; ++i) {
    shared->initial_out_dis_all_vacc_pos[i - 1] = 0;
  }
  for (int i = 1; i <= shared->NYO; ++i) {
    shared->initial_out_disc_dis_all_pop[i - 1] = 0;
  }
  for (int i = 1; i <= shared->NYO; ++i) {
    shared->initial_out_disc_dis_all_vacc[i - 1] = 0;
  }
  for (int i = 1; i <= shared->NYO; ++i) {
    shared->initial_out_disc_nvacc_all_pop[i - 1] = 0;
  }
  for (int i = 1; i <= shared->NYO; ++i) {
    shared->initial_out_disc_sdis_all_pop[i - 1] = 0;
  }
  for (int i = 1; i <= shared->NYO; ++i) {
    shared->initial_out_disc_sdis_all_vacc[i - 1] = 0;
  }
  for (int i = 1; i <= shared->NYO; ++i) {
    shared->initial_out_disc_yll_all_pop[i - 1] = 0;
  }
  for (int i = 1; i <= shared->NYO; ++i) {
    shared->initial_out_disc_yll_all_vacc[i - 1] = 0;
  }
  for (int i = 1; i <= shared->NYO; ++i) {
    shared->initial_out_nvacc_all_neg[i - 1] = 0;
  }
  for (int i = 1; i <= shared->NYO; ++i) {
    shared->initial_out_nvacc_all_pop[i - 1] = 0;
  }
  for (int i = 1; i <= shared->NYO; ++i) {
    shared->initial_out_nvacc_all_pos[i - 1] = 0;
  }
  for (int i = 1; i <= shared->NYO; ++i) {
    shared->initial_out_prop_seroneg_at_9[i - 1] = 0;
  }
  for (int i = 1; i <= shared->NYO; ++i) {
    shared->initial_out_prop_seroneg_at_vca[i - 1] = 0;
  }
  for (int i = 1; i <= shared->NYO; ++i) {
    shared->initial_out_sdis_all_pop[i - 1] = 0;
  }
  for (int i = 1; i <= shared->NYO; ++i) {
    shared->initial_out_sdis_all_unvacc[i - 1] = 0;
  }
  for (int i = 1; i <= shared->NYO; ++i) {
    shared->initial_out_sdis_all_vacc[i - 1] = 0;
  }
  for (int i = 1; i <= shared->NYO; ++i) {
    shared->initial_out_sdis_all_vacc_neg[i - 1] = 0;
  }
  for (int i = 1; i <= shared->NYO; ++i) {
    shared->initial_out_sdis_all_vacc_pos[i - 1] = 0;
  }
  for (int i = 1; i <= shared->N_age; ++i) {
    shared->initial_out_time_from_last_dose[i - 1] = 0;
  }
  for (int i = 1; i <= shared->NYO; ++i) {
    shared->initial_out_yll_all_pop[i - 1] = 0;
  }
  for (int i = 1; i <= shared->NYO; ++i) {
    shared->initial_out_yll_all_unvacc[i - 1] = 0;
  }
  for (int i = 1; i <= shared->NYO; ++i) {
    shared->initial_out_yll_all_vacc[i - 1] = 0;
  }
  for (int i = 1; i <= shared->NYO; ++i) {
    shared->initial_out_yll_all_vacc_neg[i - 1] = 0;
  }
  for (int i = 1; i <= shared->NYO; ++i) {
    shared->initial_out_yll_all_vacc_pos[i - 1] = 0;
  }
  for (int i = 1; i <= shared->NYO; ++i) {
    shared->initial_VE_seroneg1n[i - 1] = 0;
  }
  for (int i = 1; i <= shared->NYO; ++i) {
    shared->initial_VE_seroneg1p[i - 1] = 0;
  }
  {
     int i = 1;
     shared->nnveai[i - 1] = 0;
  }
  for (int i = 2; i <= 3; ++i) {
    shared->nnveai[i - 1] = 0;
  }
  {
     int i = 1;
     shared->nveai[i - 1] = 1;
  }
  for (int i = 2; i <= 3; ++i) {
    shared->nveai[i - 1] = 1;
  }
  shared->offset_variable_cum_infection_pri = shared->dim_Ntotal_out + shared->dim_out_time_from_last_dose + 47;
  shared->offset_variable_cum_infection_priV = shared->dim_cum_infection_pri + shared->dim_Ntotal_out + shared->dim_out_time_from_last_dose + 47;
  shared->offset_variable_cum_infection_sec = shared->dim_cum_infection_pri + shared->dim_cum_infection_priV + shared->dim_Ntotal_out + shared->dim_out_time_from_last_dose + 47;
  shared->offset_variable_cum_infection_secV = shared->dim_cum_infection_pri + shared->dim_cum_infection_priV + shared->dim_cum_infection_sec + shared->dim_Ntotal_out + shared->dim_out_time_from_last_dose + 47;
  shared->offset_variable_cum_infection_tq = shared->dim_cum_infection_pri + shared->dim_cum_infection_priV + shared->dim_cum_infection_sec + shared->dim_cum_infection_secV + shared->dim_Ntotal_out + shared->dim_out_time_from_last_dose + 47;
  shared->offset_variable_cum_infection_tqV = shared->dim_cum_infection_pri + shared->dim_cum_infection_priV + shared->dim_cum_infection_sec + shared->dim_cum_infection_secV + shared->dim_cum_infection_tq + shared->dim_Ntotal_out + shared->dim_out_time_from_last_dose + 47;
  shared->offset_variable_Ntotal_out = shared->dim_out_time_from_last_dose + 47;
  shared->offset_variable_out_dis_all_pop = shared->dim_cum_infection_pri + shared->dim_cum_infection_priV + shared->dim_cum_infection_sec + shared->dim_cum_infection_secV + shared->dim_cum_infection_tq + shared->dim_cum_infection_tqV + shared->dim_Ntotal_out + shared->dim_out_prop_seroneg_at_9 + shared->dim_out_prop_seroneg_at_vca + shared->dim_out_time_from_last_dose + shared->dim_VE_seroneg1n + shared->dim_VE_seroneg1p + 47;
  shared->offset_variable_out_dis_all_unvacc = shared->dim_cum_infection_pri + shared->dim_cum_infection_priV + shared->dim_cum_infection_sec + shared->dim_cum_infection_secV + shared->dim_cum_infection_tq + shared->dim_cum_infection_tqV + shared->dim_Ntotal_out + shared->dim_out_dis_all_pop + shared->dim_out_prop_seroneg_at_9 + shared->dim_out_prop_seroneg_at_vca + shared->dim_out_time_from_last_dose + shared->dim_VE_seroneg1n + shared->dim_VE_seroneg1p + 47;
  shared->offset_variable_out_dis_all_vacc = shared->dim_cum_infection_pri + shared->dim_cum_infection_priV + shared->dim_cum_infection_sec + shared->dim_cum_infection_secV + shared->dim_cum_infection_tq + shared->dim_cum_infection_tqV + shared->dim_Ntotal_out + shared->dim_out_dis_all_pop + shared->dim_out_dis_all_unvacc + shared->dim_out_prop_seroneg_at_9 + shared->dim_out_prop_seroneg_at_vca + shared->dim_out_time_from_last_dose + shared->dim_VE_seroneg1n + shared->dim_VE_seroneg1p + 47;
  shared->offset_variable_out_dis_all_vacc_neg = shared->dim_cum_infection_pri + shared->dim_cum_infection_priV + shared->dim_cum_infection_sec + shared->dim_cum_infection_secV + shared->dim_cum_infection_tq + shared->dim_cum_infection_tqV + shared->dim_Ntotal_out + shared->dim_out_dis_all_pop + shared->dim_out_dis_all_unvacc + shared->dim_out_dis_all_vacc + shared->dim_out_prop_seroneg_at_9 + shared->dim_out_prop_seroneg_at_vca + shared->dim_out_time_from_last_dose + shared->dim_VE_seroneg1n + shared->dim_VE_seroneg1p + 47;
  shared->offset_variable_out_dis_all_vacc_pos = shared->dim_cum_infection_pri + shared->dim_cum_infection_priV + shared->dim_cum_infection_sec + shared->dim_cum_infection_secV + shared->dim_cum_infection_tq + shared->dim_cum_infection_tqV + shared->dim_Ntotal_out + shared->dim_out_dis_all_pop + shared->dim_out_dis_all_unvacc + shared->dim_out_dis_all_vacc + shared->dim_out_dis_all_vacc_neg + shared->dim_out_prop_seroneg_at_9 + shared->dim_out_prop_seroneg_at_vca + shared->dim_out_time_from_last_dose + shared->dim_VE_seroneg1n + shared->dim_VE_seroneg1p + 47;
  shared->offset_variable_out_disc_dis_all_pop = shared->dim_cum_infection_pri + shared->dim_cum_infection_priV + shared->dim_cum_infection_sec + shared->dim_cum_infection_secV + shared->dim_cum_infection_tq + shared->dim_cum_infection_tqV + shared->dim_Ntotal_out + shared->dim_out_dis_all_pop + shared->dim_out_dis_all_unvacc + shared->dim_out_dis_all_vacc + shared->dim_out_dis_all_vacc_neg + shared->dim_out_dis_all_vacc_pos + shared->dim_out_prop_seroneg_at_9 + shared->dim_out_prop_seroneg_at_vca + shared->dim_out_time_from_last_dose + shared->dim_VE_seroneg1n + shared->dim_VE_seroneg1p + 47;
  shared->offset_variable_out_disc_dis_all_vacc = shared->dim_cum_infection_pri + shared->dim_cum_infection_priV + shared->dim_cum_infection_sec + shared->dim_cum_infection_secV + shared->dim_cum_infection_tq + shared->dim_cum_infection_tqV + shared->dim_Ntotal_out + shared->dim_out_dis_all_pop + shared->dim_out_dis_all_unvacc + shared->dim_out_dis_all_vacc + shared->dim_out_dis_all_vacc_neg + shared->dim_out_dis_all_vacc_pos + shared->dim_out_disc_dis_all_pop + shared->dim_out_prop_seroneg_at_9 + shared->dim_out_prop_seroneg_at_vca + shared->dim_out_time_from_last_dose + shared->dim_VE_seroneg1n + shared->dim_VE_seroneg1p + 47;
  shared->offset_variable_out_disc_nvacc_all_pop = shared->dim_cum_infection_pri + shared->dim_cum_infection_priV + shared->dim_cum_infection_sec + shared->dim_cum_infection_secV + shared->dim_cum_infection_tq + shared->dim_cum_infection_tqV + shared->dim_Ntotal_out + shared->dim_out_dis_all_pop + shared->dim_out_dis_all_unvacc + shared->dim_out_dis_all_vacc + shared->dim_out_dis_all_vacc_neg + shared->dim_out_dis_all_vacc_pos + shared->dim_out_disc_dis_all_pop + shared->dim_out_disc_dis_all_vacc + shared->dim_out_disc_sdis_all_pop + shared->dim_out_disc_sdis_all_vacc + shared->dim_out_disc_yll_all_pop + shared->dim_out_disc_yll_all_vacc + shared->dim_out_nvacc_all_neg + shared->dim_out_nvacc_all_pop + shared->dim_out_nvacc_all_pos + shared->dim_out_prop_seroneg_at_9 + shared->dim_out_prop_seroneg_at_vca + shared->dim_out_sdis_all_pop + shared->dim_out_sdis_all_unvacc + shared->dim_out_sdis_all_vacc + shared->dim_out_sdis_all_vacc_neg + shared->dim_out_sdis_all_vacc_pos + shared->dim_out_time_from_last_dose + shared->dim_out_yll_all_pop + shared->dim_out_yll_all_unvacc + shared->dim_out_yll_all_vacc + shared->dim_out_yll_all_vacc_neg + shared->dim_out_yll_all_vacc_pos + shared->dim_VE_seroneg1n + shared->dim_VE_seroneg1p + 47;
  shared->offset_variable_out_disc_sdis_all_pop = shared->dim_cum_infection_pri + shared->dim_cum_infection_priV + shared->dim_cum_infection_sec + shared->dim_cum_infection_secV + shared->dim_cum_infection_tq + shared->dim_cum_infection_tqV + shared->dim_Ntotal_out + shared->dim_out_dis_all_pop + shared->dim_out_dis_all_unvacc + shared->dim_out_dis_all_vacc + shared->dim_out_dis_all_vacc_neg + shared->dim_out_dis_all_vacc_pos + shared->dim_out_disc_dis_all_pop + shared->dim_out_disc_dis_all_vacc + shared->dim_out_prop_seroneg_at_9 + shared->dim_out_prop_seroneg_at_vca + shared->dim_out_sdis_all_pop + shared->dim_out_sdis_all_unvacc + shared->dim_out_sdis_all_vacc + shared->dim_out_sdis_all_vacc_neg + shared->dim_out_sdis_all_vacc_pos + shared->dim_out_time_from_last_dose + shared->dim_VE_seroneg1n + shared->dim_VE_seroneg1p + 47;
  shared->offset_variable_out_disc_sdis_all_vacc = shared->dim_cum_infection_pri + shared->dim_cum_infection_priV + shared->dim_cum_infection_sec + shared->dim_cum_infection_secV + shared->dim_cum_infection_tq + shared->dim_cum_infection_tqV + shared->dim_Ntotal_out + shared->dim_out_dis_all_pop + shared->dim_out_dis_all_unvacc + shared->dim_out_dis_all_vacc + shared->dim_out_dis_all_vacc_neg + shared->dim_out_dis_all_vacc_pos + shared->dim_out_disc_dis_all_pop + shared->dim_out_disc_dis_all_vacc + shared->dim_out_disc_sdis_all_pop + shared->dim_out_prop_seroneg_at_9 + shared->dim_out_prop_seroneg_at_vca + shared->dim_out_sdis_all_pop + shared->dim_out_sdis_all_unvacc + shared->dim_out_sdis_all_vacc + shared->dim_out_sdis_all_vacc_neg + shared->dim_out_sdis_all_vacc_pos + shared->dim_out_time_from_last_dose + shared->dim_VE_seroneg1n + shared->dim_VE_seroneg1p + 47;
  shared->offset_variable_out_disc_yll_all_pop = shared->dim_cum_infection_pri + shared->dim_cum_infection_priV + shared->dim_cum_infection_sec + shared->dim_cum_infection_secV + shared->dim_cum_infection_tq + shared->dim_cum_infection_tqV + shared->dim_Ntotal_out + shared->dim_out_dis_all_pop + shared->dim_out_dis_all_unvacc + shared->dim_out_dis_all_vacc + shared->dim_out_dis_all_vacc_neg + shared->dim_out_dis_all_vacc_pos + shared->dim_out_disc_dis_all_pop + shared->dim_out_disc_dis_all_vacc + shared->dim_out_disc_sdis_all_pop + shared->dim_out_disc_sdis_all_vacc + shared->dim_out_prop_seroneg_at_9 + shared->dim_out_prop_seroneg_at_vca + shared->dim_out_sdis_all_pop + shared->dim_out_sdis_all_unvacc + shared->dim_out_sdis_all_vacc + shared->dim_out_sdis_all_vacc_neg + shared->dim_out_sdis_all_vacc_pos + shared->dim_out_time_from_last_dose + shared->dim_out_yll_all_pop + shared->dim_out_yll_all_unvacc + shared->dim_out_yll_all_vacc + shared->dim_out_yll_all_vacc_neg + shared->dim_out_yll_all_vacc_pos + shared->dim_VE_seroneg1n + shared->dim_VE_seroneg1p + 47;
  shared->offset_variable_out_disc_yll_all_vacc = shared->dim_cum_infection_pri + shared->dim_cum_infection_priV + shared->dim_cum_infection_sec + shared->dim_cum_infection_secV + shared->dim_cum_infection_tq + shared->dim_cum_infection_tqV + shared->dim_Ntotal_out + shared->dim_out_dis_all_pop + shared->dim_out_dis_all_unvacc + shared->dim_out_dis_all_vacc + shared->dim_out_dis_all_vacc_neg + shared->dim_out_dis_all_vacc_pos + shared->dim_out_disc_dis_all_pop + shared->dim_out_disc_dis_all_vacc + shared->dim_out_disc_sdis_all_pop + shared->dim_out_disc_sdis_all_vacc + shared->dim_out_disc_yll_all_pop + shared->dim_out_prop_seroneg_at_9 + shared->dim_out_prop_seroneg_at_vca + shared->dim_out_sdis_all_pop + shared->dim_out_sdis_all_unvacc + shared->dim_out_sdis_all_vacc + shared->dim_out_sdis_all_vacc_neg + shared->dim_out_sdis_all_vacc_pos + shared->dim_out_time_from_last_dose + shared->dim_out_yll_all_pop + shared->dim_out_yll_all_unvacc + shared->dim_out_yll_all_vacc + shared->dim_out_yll_all_vacc_neg + shared->dim_out_yll_all_vacc_pos + shared->dim_VE_seroneg1n + shared->dim_VE_seroneg1p + 47;
  shared->offset_variable_out_nvacc_all_neg = shared->dim_cum_infection_pri + shared->dim_cum_infection_priV + shared->dim_cum_infection_sec + shared->dim_cum_infection_secV + shared->dim_cum_infection_tq + shared->dim_cum_infection_tqV + shared->dim_Ntotal_out + shared->dim_out_dis_all_pop + shared->dim_out_dis_all_unvacc + shared->dim_out_dis_all_vacc + shared->dim_out_dis_all_vacc_neg + shared->dim_out_dis_all_vacc_pos + shared->dim_out_disc_dis_all_pop + shared->dim_out_disc_dis_all_vacc + shared->dim_out_disc_sdis_all_pop + shared->dim_out_disc_sdis_all_vacc + shared->dim_out_disc_yll_all_pop + shared->dim_out_disc_yll_all_vacc + shared->dim_out_nvacc_all_pop + shared->dim_out_prop_seroneg_at_9 + shared->dim_out_prop_seroneg_at_vca + shared->dim_out_sdis_all_pop + shared->dim_out_sdis_all_unvacc + shared->dim_out_sdis_all_vacc + shared->dim_out_sdis_all_vacc_neg + shared->dim_out_sdis_all_vacc_pos + shared->dim_out_time_from_last_dose + shared->dim_out_yll_all_pop + shared->dim_out_yll_all_unvacc + shared->dim_out_yll_all_vacc + shared->dim_out_yll_all_vacc_neg + shared->dim_out_yll_all_vacc_pos + shared->dim_VE_seroneg1n + shared->dim_VE_seroneg1p + 47;
  shared->offset_variable_out_nvacc_all_pop = shared->dim_cum_infection_pri + shared->dim_cum_infection_priV + shared->dim_cum_infection_sec + shared->dim_cum_infection_secV + shared->dim_cum_infection_tq + shared->dim_cum_infection_tqV + shared->dim_Ntotal_out + shared->dim_out_dis_all_pop + shared->dim_out_dis_all_unvacc + shared->dim_out_dis_all_vacc + shared->dim_out_dis_all_vacc_neg + shared->dim_out_dis_all_vacc_pos + shared->dim_out_disc_dis_all_pop + shared->dim_out_disc_dis_all_vacc + shared->dim_out_disc_sdis_all_pop + shared->dim_out_disc_sdis_all_vacc + shared->dim_out_disc_yll_all_pop + shared->dim_out_disc_yll_all_vacc + shared->dim_out_prop_seroneg_at_9 + shared->dim_out_prop_seroneg_at_vca + shared->dim_out_sdis_all_pop + shared->dim_out_sdis_all_unvacc + shared->dim_out_sdis_all_vacc + shared->dim_out_sdis_all_vacc_neg + shared->dim_out_sdis_all_vacc_pos + shared->dim_out_time_from_last_dose + shared->dim_out_yll_all_pop + shared->dim_out_yll_all_unvacc + shared->dim_out_yll_all_vacc + shared->dim_out_yll_all_vacc_neg + shared->dim_out_yll_all_vacc_pos + shared->dim_VE_seroneg1n + shared->dim_VE_seroneg1p + 47;
  shared->offset_variable_out_nvacc_all_pos = shared->dim_cum_infection_pri + shared->dim_cum_infection_priV + shared->dim_cum_infection_sec + shared->dim_cum_infection_secV + shared->dim_cum_infection_tq + shared->dim_cum_infection_tqV + shared->dim_Ntotal_out + shared->dim_out_dis_all_pop + shared->dim_out_dis_all_unvacc + shared->dim_out_dis_all_vacc + shared->dim_out_dis_all_vacc_neg + shared->dim_out_dis_all_vacc_pos + shared->dim_out_disc_dis_all_pop + shared->dim_out_disc_dis_all_vacc + shared->dim_out_disc_sdis_all_pop + shared->dim_out_disc_sdis_all_vacc + shared->dim_out_disc_yll_all_pop + shared->dim_out_disc_yll_all_vacc + shared->dim_out_nvacc_all_neg + shared->dim_out_nvacc_all_pop + shared->dim_out_prop_seroneg_at_9 + shared->dim_out_prop_seroneg_at_vca + shared->dim_out_sdis_all_pop + shared->dim_out_sdis_all_unvacc + shared->dim_out_sdis_all_vacc + shared->dim_out_sdis_all_vacc_neg + shared->dim_out_sdis_all_vacc_pos + shared->dim_out_time_from_last_dose + shared->dim_out_yll_all_pop + shared->dim_out_yll_all_unvacc + shared->dim_out_yll_all_vacc + shared->dim_out_yll_all_vacc_neg + shared->dim_out_yll_all_vacc_pos + shared->dim_VE_seroneg1n + shared->dim_VE_seroneg1p + 47;
  shared->offset_variable_out_prop_seroneg_at_9 = shared->dim_cum_infection_pri + shared->dim_cum_infection_priV + shared->dim_cum_infection_sec + shared->dim_cum_infection_secV + shared->dim_cum_infection_tq + shared->dim_cum_infection_tqV + shared->dim_Ntotal_out + shared->dim_out_time_from_last_dose + shared->dim_VE_seroneg1n + shared->dim_VE_seroneg1p + 47;
  shared->offset_variable_out_prop_seroneg_at_vca = shared->dim_cum_infection_pri + shared->dim_cum_infection_priV + shared->dim_cum_infection_sec + shared->dim_cum_infection_secV + shared->dim_cum_infection_tq + shared->dim_cum_infection_tqV + shared->dim_Ntotal_out + shared->dim_out_prop_seroneg_at_9 + shared->dim_out_time_from_last_dose + shared->dim_VE_seroneg1n + shared->dim_VE_seroneg1p + 47;
  shared->offset_variable_out_sdis_all_pop = shared->dim_cum_infection_pri + shared->dim_cum_infection_priV + shared->dim_cum_infection_sec + shared->dim_cum_infection_secV + shared->dim_cum_infection_tq + shared->dim_cum_infection_tqV + shared->dim_Ntotal_out + shared->dim_out_dis_all_pop + shared->dim_out_dis_all_unvacc + shared->dim_out_dis_all_vacc + shared->dim_out_dis_all_vacc_neg + shared->dim_out_dis_all_vacc_pos + shared->dim_out_disc_dis_all_pop + shared->dim_out_disc_dis_all_vacc + shared->dim_out_prop_seroneg_at_9 + shared->dim_out_prop_seroneg_at_vca + shared->dim_out_time_from_last_dose + shared->dim_VE_seroneg1n + shared->dim_VE_seroneg1p + 47;
  shared->offset_variable_out_sdis_all_unvacc = shared->dim_cum_infection_pri + shared->dim_cum_infection_priV + shared->dim_cum_infection_sec + shared->dim_cum_infection_secV + shared->dim_cum_infection_tq + shared->dim_cum_infection_tqV + shared->dim_Ntotal_out + shared->dim_out_dis_all_pop + shared->dim_out_dis_all_unvacc + shared->dim_out_dis_all_vacc + shared->dim_out_dis_all_vacc_neg + shared->dim_out_dis_all_vacc_pos + shared->dim_out_disc_dis_all_pop + shared->dim_out_disc_dis_all_vacc + shared->dim_out_prop_seroneg_at_9 + shared->dim_out_prop_seroneg_at_vca + shared->dim_out_sdis_all_pop + shared->dim_out_time_from_last_dose + shared->dim_VE_seroneg1n + shared->dim_VE_seroneg1p + 47;
  shared->offset_variable_out_sdis_all_vacc = shared->dim_cum_infection_pri + shared->dim_cum_infection_priV + shared->dim_cum_infection_sec + shared->dim_cum_infection_secV + shared->dim_cum_infection_tq + shared->dim_cum_infection_tqV + shared->dim_Ntotal_out + shared->dim_out_dis_all_pop + shared->dim_out_dis_all_unvacc + shared->dim_out_dis_all_vacc + shared->dim_out_dis_all_vacc_neg + shared->dim_out_dis_all_vacc_pos + shared->dim_out_disc_dis_all_pop + shared->dim_out_disc_dis_all_vacc + shared->dim_out_prop_seroneg_at_9 + shared->dim_out_prop_seroneg_at_vca + shared->dim_out_sdis_all_pop + shared->dim_out_sdis_all_unvacc + shared->dim_out_time_from_last_dose + shared->dim_VE_seroneg1n + shared->dim_VE_seroneg1p + 47;
  shared->offset_variable_out_sdis_all_vacc_neg = shared->dim_cum_infection_pri + shared->dim_cum_infection_priV + shared->dim_cum_infection_sec + shared->dim_cum_infection_secV + shared->dim_cum_infection_tq + shared->dim_cum_infection_tqV + shared->dim_Ntotal_out + shared->dim_out_dis_all_pop + shared->dim_out_dis_all_unvacc + shared->dim_out_dis_all_vacc + shared->dim_out_dis_all_vacc_neg + shared->dim_out_dis_all_vacc_pos + shared->dim_out_disc_dis_all_pop + shared->dim_out_disc_dis_all_vacc + shared->dim_out_prop_seroneg_at_9 + shared->dim_out_prop_seroneg_at_vca + shared->dim_out_sdis_all_pop + shared->dim_out_sdis_all_unvacc + shared->dim_out_sdis_all_vacc + shared->dim_out_time_from_last_dose + shared->dim_VE_seroneg1n + shared->dim_VE_seroneg1p + 47;
  shared->offset_variable_out_sdis_all_vacc_pos = shared->dim_cum_infection_pri + shared->dim_cum_infection_priV + shared->dim_cum_infection_sec + shared->dim_cum_infection_secV + shared->dim_cum_infection_tq + shared->dim_cum_infection_tqV + shared->dim_Ntotal_out + shared->dim_out_dis_all_pop + shared->dim_out_dis_all_unvacc + shared->dim_out_dis_all_vacc + shared->dim_out_dis_all_vacc_neg + shared->dim_out_dis_all_vacc_pos + shared->dim_out_disc_dis_all_pop + shared->dim_out_disc_dis_all_vacc + shared->dim_out_prop_seroneg_at_9 + shared->dim_out_prop_seroneg_at_vca + shared->dim_out_sdis_all_pop + shared->dim_out_sdis_all_unvacc + shared->dim_out_sdis_all_vacc + shared->dim_out_sdis_all_vacc_neg + shared->dim_out_time_from_last_dose + shared->dim_VE_seroneg1n + shared->dim_VE_seroneg1p + 47;
  shared->offset_variable_out_yll_all_pop = shared->dim_cum_infection_pri + shared->dim_cum_infection_priV + shared->dim_cum_infection_sec + shared->dim_cum_infection_secV + shared->dim_cum_infection_tq + shared->dim_cum_infection_tqV + shared->dim_Ntotal_out + shared->dim_out_dis_all_pop + shared->dim_out_dis_all_unvacc + shared->dim_out_dis_all_vacc + shared->dim_out_dis_all_vacc_neg + shared->dim_out_dis_all_vacc_pos + shared->dim_out_disc_dis_all_pop + shared->dim_out_disc_dis_all_vacc + shared->dim_out_disc_sdis_all_pop + shared->dim_out_disc_sdis_all_vacc + shared->dim_out_prop_seroneg_at_9 + shared->dim_out_prop_seroneg_at_vca + shared->dim_out_sdis_all_pop + shared->dim_out_sdis_all_unvacc + shared->dim_out_sdis_all_vacc + shared->dim_out_sdis_all_vacc_neg + shared->dim_out_sdis_all_vacc_pos + shared->dim_out_time_from_last_dose + shared->dim_VE_seroneg1n + shared->dim_VE_seroneg1p + 47;
  shared->offset_variable_out_yll_all_unvacc = shared->dim_cum_infection_pri + shared->dim_cum_infection_priV + shared->dim_cum_infection_sec + shared->dim_cum_infection_secV + shared->dim_cum_infection_tq + shared->dim_cum_infection_tqV + shared->dim_Ntotal_out + shared->dim_out_dis_all_pop + shared->dim_out_dis_all_unvacc + shared->dim_out_dis_all_vacc + shared->dim_out_dis_all_vacc_neg + shared->dim_out_dis_all_vacc_pos + shared->dim_out_disc_dis_all_pop + shared->dim_out_disc_dis_all_vacc + shared->dim_out_disc_sdis_all_pop + shared->dim_out_disc_sdis_all_vacc + shared->dim_out_prop_seroneg_at_9 + shared->dim_out_prop_seroneg_at_vca + shared->dim_out_sdis_all_pop + shared->dim_out_sdis_all_unvacc + shared->dim_out_sdis_all_vacc + shared->dim_out_sdis_all_vacc_neg + shared->dim_out_sdis_all_vacc_pos + shared->dim_out_time_from_last_dose + shared->dim_out_yll_all_pop + shared->dim_VE_seroneg1n + shared->dim_VE_seroneg1p + 47;
  shared->offset_variable_out_yll_all_vacc = shared->dim_cum_infection_pri + shared->dim_cum_infection_priV + shared->dim_cum_infection_sec + shared->dim_cum_infection_secV + shared->dim_cum_infection_tq + shared->dim_cum_infection_tqV + shared->dim_Ntotal_out + shared->dim_out_dis_all_pop + shared->dim_out_dis_all_unvacc + shared->dim_out_dis_all_vacc + shared->dim_out_dis_all_vacc_neg + shared->dim_out_dis_all_vacc_pos + shared->dim_out_disc_dis_all_pop + shared->dim_out_disc_dis_all_vacc + shared->dim_out_disc_sdis_all_pop + shared->dim_out_disc_sdis_all_vacc + shared->dim_out_prop_seroneg_at_9 + shared->dim_out_prop_seroneg_at_vca + shared->dim_out_sdis_all_pop + shared->dim_out_sdis_all_unvacc + shared->dim_out_sdis_all_vacc + shared->dim_out_sdis_all_vacc_neg + shared->dim_out_sdis_all_vacc_pos + shared->dim_out_time_from_last_dose + shared->dim_out_yll_all_pop + shared->dim_out_yll_all_unvacc + shared->dim_VE_seroneg1n + shared->dim_VE_seroneg1p + 47;
  shared->offset_variable_out_yll_all_vacc_neg = shared->dim_cum_infection_pri + shared->dim_cum_infection_priV + shared->dim_cum_infection_sec + shared->dim_cum_infection_secV + shared->dim_cum_infection_tq + shared->dim_cum_infection_tqV + shared->dim_Ntotal_out + shared->dim_out_dis_all_pop + shared->dim_out_dis_all_unvacc + shared->dim_out_dis_all_vacc + shared->dim_out_dis_all_vacc_neg + shared->dim_out_dis_all_vacc_pos + shared->dim_out_disc_dis_all_pop + shared->dim_out_disc_dis_all_vacc + shared->dim_out_disc_sdis_all_pop + shared->dim_out_disc_sdis_all_vacc + shared->dim_out_prop_seroneg_at_9 + shared->dim_out_prop_seroneg_at_vca + shared->dim_out_sdis_all_pop + shared->dim_out_sdis_all_unvacc + shared->dim_out_sdis_all_vacc + shared->dim_out_sdis_all_vacc_neg + shared->dim_out_sdis_all_vacc_pos + shared->dim_out_time_from_last_dose + shared->dim_out_yll_all_pop + shared->dim_out_yll_all_unvacc + shared->dim_out_yll_all_vacc + shared->dim_VE_seroneg1n + shared->dim_VE_seroneg1p + 47;
  shared->offset_variable_out_yll_all_vacc_pos = shared->dim_cum_infection_pri + shared->dim_cum_infection_priV + shared->dim_cum_infection_sec + shared->dim_cum_infection_secV + shared->dim_cum_infection_tq + shared->dim_cum_infection_tqV + shared->dim_Ntotal_out + shared->dim_out_dis_all_pop + shared->dim_out_dis_all_unvacc + shared->dim_out_dis_all_vacc + shared->dim_out_dis_all_vacc_neg + shared->dim_out_dis_all_vacc_pos + shared->dim_out_disc_dis_all_pop + shared->dim_out_disc_dis_all_vacc + shared->dim_out_disc_sdis_all_pop + shared->dim_out_disc_sdis_all_vacc + shared->dim_out_prop_seroneg_at_9 + shared->dim_out_prop_seroneg_at_vca + shared->dim_out_sdis_all_pop + shared->dim_out_sdis_all_unvacc + shared->dim_out_sdis_all_vacc + shared->dim_out_sdis_all_vacc_neg + shared->dim_out_sdis_all_vacc_pos + shared->dim_out_time_from_last_dose + shared->dim_out_yll_all_pop + shared->dim_out_yll_all_unvacc + shared->dim_out_yll_all_vacc + shared->dim_out_yll_all_vacc_neg + shared->dim_VE_seroneg1n + shared->dim_VE_seroneg1p + 47;
  shared->offset_variable_S = shared->dim_cum_infection_pri + shared->dim_cum_infection_priV + shared->dim_cum_infection_sec + shared->dim_cum_infection_secV + shared->dim_cum_infection_tq + shared->dim_cum_infection_tqV + shared->dim_Ntotal_out + shared->dim_out_dis_all_pop + shared->dim_out_dis_all_unvacc + shared->dim_out_dis_all_vacc + shared->dim_out_dis_all_vacc_neg + shared->dim_out_dis_all_vacc_pos + shared->dim_out_disc_dis_all_pop + shared->dim_out_disc_dis_all_vacc + shared->dim_out_disc_nvacc_all_pop + shared->dim_out_disc_sdis_all_pop + shared->dim_out_disc_sdis_all_vacc + shared->dim_out_disc_yll_all_pop + shared->dim_out_disc_yll_all_vacc + shared->dim_out_nvacc_all_neg + shared->dim_out_nvacc_all_pop + shared->dim_out_nvacc_all_pos + shared->dim_out_prop_seroneg_at_9 + shared->dim_out_prop_seroneg_at_vca + shared->dim_out_sdis_all_pop + shared->dim_out_sdis_all_unvacc + shared->dim_out_sdis_all_vacc + shared->dim_out_sdis_all_vacc_neg + shared->dim_out_sdis_all_vacc_pos + shared->dim_out_time_from_last_dose + shared->dim_out_yll_all_pop + shared->dim_out_yll_all_unvacc + shared->dim_out_yll_all_vacc + shared->dim_out_yll_all_vacc_neg + shared->dim_out_yll_all_vacc_pos + shared->dim_VE_seroneg1n + shared->dim_VE_seroneg1p + 47;
  shared->offset_variable_VE_seroneg1n = shared->dim_cum_infection_pri + shared->dim_cum_infection_priV + shared->dim_cum_infection_sec + shared->dim_cum_infection_secV + shared->dim_cum_infection_tq + shared->dim_cum_infection_tqV + shared->dim_Ntotal_out + shared->dim_out_time_from_last_dose + 47;
  shared->offset_variable_VE_seroneg1p = shared->dim_cum_infection_pri + shared->dim_cum_infection_priV + shared->dim_cum_infection_sec + shared->dim_cum_infection_secV + shared->dim_cum_infection_tq + shared->dim_cum_infection_tqV + shared->dim_Ntotal_out + shared->dim_out_time_from_last_dose + shared->dim_VE_seroneg1n + 47;
  shared->vacc_cu_maxage = shared->N_age_p1;
  shared->vacc_cu_minage = shared->N_age_p1;
  for (int i = 1; i <= 20; ++i) {
    shared->agec[i - 1] = 1;
  }
  for (int i = 21; i <= 28; ++i) {
    shared->agec[i - 1] = 10;
  }
  shared->ageb = std::vector<real_type>(shared->dim_ageb);
  internal.disc_yll_all = std::vector<real_type>(shared->dim_disc_yll_all);
  internal.disease_sero = std::vector<real_type>(shared->dim_disease_sero);
  internal.disease_sero_vacc_pri = std::vector<real_type>(shared->dim_disease_sero_vacc_pri);
  internal.inf_1 = std::vector<real_type>(shared->dim_inf_1);
  internal.inf_12 = std::vector<real_type>(shared->dim_inf_12);
  internal.inf_123 = std::vector<real_type>(shared->dim_inf_123);
  internal.inf_1234 = std::vector<real_type>(shared->dim_inf_1234);
  internal.inf_124 = std::vector<real_type>(shared->dim_inf_124);
  internal.inf_1243 = std::vector<real_type>(shared->dim_inf_1243);
  internal.inf_13 = std::vector<real_type>(shared->dim_inf_13);
  internal.inf_132 = std::vector<real_type>(shared->dim_inf_132);
  internal.inf_134 = std::vector<real_type>(shared->dim_inf_134);
  internal.inf_1342 = std::vector<real_type>(shared->dim_inf_1342);
  internal.inf_14 = std::vector<real_type>(shared->dim_inf_14);
  internal.inf_142 = std::vector<real_type>(shared->dim_inf_142);
  internal.inf_143 = std::vector<real_type>(shared->dim_inf_143);
  internal.inf_2 = std::vector<real_type>(shared->dim_inf_2);
  internal.inf_21 = std::vector<real_type>(shared->dim_inf_21);
  internal.inf_23 = std::vector<real_type>(shared->dim_inf_23);
  internal.inf_231 = std::vector<real_type>(shared->dim_inf_231);
  internal.inf_234 = std::vector<real_type>(shared->dim_inf_234);
  internal.inf_2341 = std::vector<real_type>(shared->dim_inf_2341);
  internal.inf_24 = std::vector<real_type>(shared->dim_inf_24);
  internal.inf_241 = std::vector<real_type>(shared->dim_inf_241);
  internal.inf_243 = std::vector<real_type>(shared->dim_inf_243);
  internal.inf_3 = std::vector<real_type>(shared->dim_inf_3);
  internal.inf_31 = std::vector<real_type>(shared->dim_inf_31);
  internal.inf_32 = std::vector<real_type>(shared->dim_inf_32);
  internal.inf_34 = std::vector<real_type>(shared->dim_inf_34);
  internal.inf_341 = std::vector<real_type>(shared->dim_inf_341);
  internal.inf_342 = std::vector<real_type>(shared->dim_inf_342);
  internal.inf_4 = std::vector<real_type>(shared->dim_inf_4);
  internal.inf_41 = std::vector<real_type>(shared->dim_inf_41);
  internal.inf_42 = std::vector<real_type>(shared->dim_inf_42);
  internal.inf_43 = std::vector<real_type>(shared->dim_inf_43);
  internal.infection_pri = std::vector<real_type>(shared->dim_infection_pri);
  internal.infection_sec = std::vector<real_type>(shared->dim_infection_sec);
  internal.infection_tq = std::vector<real_type>(shared->dim_infection_tq);
  internal.infV_1 = std::vector<real_type>(shared->dim_infV_1);
  internal.infV_2 = std::vector<real_type>(shared->dim_infV_2);
  internal.infV_3 = std::vector<real_type>(shared->dim_infV_3);
  internal.infV_4 = std::vector<real_type>(shared->dim_infV_4);
  shared->initial_I1 = std::vector<real_type>(shared->dim_I1);
  shared->initial_I12 = std::vector<real_type>(shared->dim_I12);
  shared->initial_I123 = std::vector<real_type>(shared->dim_I123);
  shared->initial_I1234 = std::vector<real_type>(shared->dim_I1234);
  shared->initial_I124 = std::vector<real_type>(shared->dim_I124);
  shared->initial_I1243 = std::vector<real_type>(shared->dim_I1243);
  shared->initial_I13 = std::vector<real_type>(shared->dim_I13);
  shared->initial_I132 = std::vector<real_type>(shared->dim_I132);
  shared->initial_I134 = std::vector<real_type>(shared->dim_I134);
  shared->initial_I1342 = std::vector<real_type>(shared->dim_I1342);
  shared->initial_I14 = std::vector<real_type>(shared->dim_I14);
  shared->initial_I142 = std::vector<real_type>(shared->dim_I142);
  shared->initial_I143 = std::vector<real_type>(shared->dim_I143);
  shared->initial_I2 = std::vector<real_type>(shared->dim_I2);
  shared->initial_I21 = std::vector<real_type>(shared->dim_I21);
  shared->initial_I23 = std::vector<real_type>(shared->dim_I23);
  shared->initial_I231 = std::vector<real_type>(shared->dim_I231);
  shared->initial_I234 = std::vector<real_type>(shared->dim_I234);
  shared->initial_I2341 = std::vector<real_type>(shared->dim_I2341);
  shared->initial_I24 = std::vector<real_type>(shared->dim_I24);
  shared->initial_I241 = std::vector<real_type>(shared->dim_I241);
  shared->initial_I243 = std::vector<real_type>(shared->dim_I243);
  shared->initial_I3 = std::vector<real_type>(shared->dim_I3);
  shared->initial_I31 = std::vector<real_type>(shared->dim_I31);
  shared->initial_I32 = std::vector<real_type>(shared->dim_I32);
  shared->initial_I34 = std::vector<real_type>(shared->dim_I34);
  shared->initial_I341 = std::vector<real_type>(shared->dim_I341);
  shared->initial_I342 = std::vector<real_type>(shared->dim_I342);
  shared->initial_I4 = std::vector<real_type>(shared->dim_I4);
  shared->initial_I41 = std::vector<real_type>(shared->dim_I41);
  shared->initial_I42 = std::vector<real_type>(shared->dim_I42);
  shared->initial_I43 = std::vector<real_type>(shared->dim_I43);
  shared->initial_out_dis_sero_pop = std::vector<real_type>(shared->dim_out_dis_sero_pop);
  shared->initial_out_dis_sero_unvacc = std::vector<real_type>(shared->dim_out_dis_sero_unvacc);
  shared->initial_out_dis_sero_vacc = std::vector<real_type>(shared->dim_out_dis_sero_vacc);
  shared->initial_out_dis_sero_vacc_neg = std::vector<real_type>(shared->dim_out_dis_sero_vacc_neg);
  shared->initial_out_dis_sero_vacc_pos = std::vector<real_type>(shared->dim_out_dis_sero_vacc_pos);
  shared->initial_out_nc = std::vector<real_type>(shared->dim_out_nc);
  shared->initial_out_RR = std::vector<real_type>(shared->dim_out_RR);
  shared->initial_out_sdis_sero_pop = std::vector<real_type>(shared->dim_out_sdis_sero_pop);
  shared->initial_out_sdis_sero_unvacc = std::vector<real_type>(shared->dim_out_sdis_sero_unvacc);
  shared->initial_out_sdis_sero_vacc = std::vector<real_type>(shared->dim_out_sdis_sero_vacc);
  shared->initial_out_sdis_sero_vacc_neg = std::vector<real_type>(shared->dim_out_sdis_sero_vacc_neg);
  shared->initial_out_sdis_sero_vacc_pos = std::vector<real_type>(shared->dim_out_sdis_sero_vacc_pos);
  shared->initial_out_yll_sero_pop = std::vector<real_type>(shared->dim_out_yll_sero_pop);
  shared->initial_out_yll_sero_unvacc = std::vector<real_type>(shared->dim_out_yll_sero_unvacc);
  shared->initial_out_yll_sero_vacc = std::vector<real_type>(shared->dim_out_yll_sero_vacc);
  shared->initial_out_yll_sero_vacc_neg = std::vector<real_type>(shared->dim_out_yll_sero_vacc_neg);
  shared->initial_out_yll_sero_vacc_pos = std::vector<real_type>(shared->dim_out_yll_sero_vacc_pos);
  shared->initial_R1 = std::vector<real_type>(shared->dim_R1);
  shared->initial_R12 = std::vector<real_type>(shared->dim_R12);
  shared->initial_R123 = std::vector<real_type>(shared->dim_R123);
  shared->initial_R1234 = std::vector<real_type>(shared->dim_R1234);
  shared->initial_R124 = std::vector<real_type>(shared->dim_R124);
  shared->initial_R13 = std::vector<real_type>(shared->dim_R13);
  shared->initial_R134 = std::vector<real_type>(shared->dim_R134);
  shared->initial_R14 = std::vector<real_type>(shared->dim_R14);
  shared->initial_R2 = std::vector<real_type>(shared->dim_R2);
  shared->initial_R23 = std::vector<real_type>(shared->dim_R23);
  shared->initial_R234 = std::vector<real_type>(shared->dim_R234);
  shared->initial_R24 = std::vector<real_type>(shared->dim_R24);
  shared->initial_R3 = std::vector<real_type>(shared->dim_R3);
  shared->initial_R34 = std::vector<real_type>(shared->dim_R34);
  shared->initial_R4 = std::vector<real_type>(shared->dim_R4);
  shared->initial_S = std::vector<real_type>(shared->dim_S);
  internal.n_I1 = std::vector<real_type>(shared->dim_n_I1);
  internal.n_I12 = std::vector<real_type>(shared->dim_n_I12);
  internal.n_I123 = std::vector<real_type>(shared->dim_n_I123);
  internal.n_I1234 = std::vector<real_type>(shared->dim_n_I1234);
  internal.n_I124 = std::vector<real_type>(shared->dim_n_I124);
  internal.n_I1243 = std::vector<real_type>(shared->dim_n_I1243);
  internal.n_I13 = std::vector<real_type>(shared->dim_n_I13);
  internal.n_I132 = std::vector<real_type>(shared->dim_n_I132);
  internal.n_I134 = std::vector<real_type>(shared->dim_n_I134);
  internal.n_I1342 = std::vector<real_type>(shared->dim_n_I1342);
  internal.n_I14 = std::vector<real_type>(shared->dim_n_I14);
  internal.n_I142 = std::vector<real_type>(shared->dim_n_I142);
  internal.n_I143 = std::vector<real_type>(shared->dim_n_I143);
  internal.n_I2 = std::vector<real_type>(shared->dim_n_I2);
  internal.n_I21 = std::vector<real_type>(shared->dim_n_I21);
  internal.n_I23 = std::vector<real_type>(shared->dim_n_I23);
  internal.n_I231 = std::vector<real_type>(shared->dim_n_I231);
  internal.n_I234 = std::vector<real_type>(shared->dim_n_I234);
  internal.n_I2341 = std::vector<real_type>(shared->dim_n_I2341);
  internal.n_I24 = std::vector<real_type>(shared->dim_n_I24);
  internal.n_I241 = std::vector<real_type>(shared->dim_n_I241);
  internal.n_I243 = std::vector<real_type>(shared->dim_n_I243);
  internal.n_I3 = std::vector<real_type>(shared->dim_n_I3);
  internal.n_I31 = std::vector<real_type>(shared->dim_n_I31);
  internal.n_I32 = std::vector<real_type>(shared->dim_n_I32);
  internal.n_I34 = std::vector<real_type>(shared->dim_n_I34);
  internal.n_I341 = std::vector<real_type>(shared->dim_n_I341);
  internal.n_I342 = std::vector<real_type>(shared->dim_n_I342);
  internal.n_I4 = std::vector<real_type>(shared->dim_n_I4);
  internal.n_I41 = std::vector<real_type>(shared->dim_n_I41);
  internal.n_I42 = std::vector<real_type>(shared->dim_n_I42);
  internal.n_I43 = std::vector<real_type>(shared->dim_n_I43);
  internal.n_R1 = std::vector<real_type>(shared->dim_n_R1);
  internal.n_R12 = std::vector<real_type>(shared->dim_n_R12);
  internal.n_R123 = std::vector<real_type>(shared->dim_n_R123);
  internal.n_R1234 = std::vector<real_type>(shared->dim_n_R1234);
  internal.n_R124 = std::vector<real_type>(shared->dim_n_R124);
  internal.n_R13 = std::vector<real_type>(shared->dim_n_R13);
  internal.n_R134 = std::vector<real_type>(shared->dim_n_R134);
  internal.n_R14 = std::vector<real_type>(shared->dim_n_R14);
  internal.n_R2 = std::vector<real_type>(shared->dim_n_R2);
  internal.n_R23 = std::vector<real_type>(shared->dim_n_R23);
  internal.n_R234 = std::vector<real_type>(shared->dim_n_R234);
  internal.n_R24 = std::vector<real_type>(shared->dim_n_R24);
  internal.n_R3 = std::vector<real_type>(shared->dim_n_R3);
  internal.n_R34 = std::vector<real_type>(shared->dim_n_R34);
  internal.n_R4 = std::vector<real_type>(shared->dim_n_R4);
  internal.n_S = std::vector<real_type>(shared->dim_n_S);
  internal.nc = std::vector<real_type>(shared->dim_nc);
  internal.Ntotal = std::vector<real_type>(shared->dim_Ntotal);
  internal.nvacc_I1 = std::vector<real_type>(shared->dim_nvacc_I1);
  internal.nvacc_I12 = std::vector<real_type>(shared->dim_nvacc_I12);
  internal.nvacc_I123 = std::vector<real_type>(shared->dim_nvacc_I123);
  internal.nvacc_I1234 = std::vector<real_type>(shared->dim_nvacc_I1234);
  internal.nvacc_I124 = std::vector<real_type>(shared->dim_nvacc_I124);
  internal.nvacc_I1243 = std::vector<real_type>(shared->dim_nvacc_I1243);
  internal.nvacc_I13 = std::vector<real_type>(shared->dim_nvacc_I13);
  internal.nvacc_I132 = std::vector<real_type>(shared->dim_nvacc_I132);
  internal.nvacc_I134 = std::vector<real_type>(shared->dim_nvacc_I134);
  internal.nvacc_I1342 = std::vector<real_type>(shared->dim_nvacc_I1342);
  internal.nvacc_I14 = std::vector<real_type>(shared->dim_nvacc_I14);
  internal.nvacc_I142 = std::vector<real_type>(shared->dim_nvacc_I142);
  internal.nvacc_I143 = std::vector<real_type>(shared->dim_nvacc_I143);
  internal.nvacc_I2 = std::vector<real_type>(shared->dim_nvacc_I2);
  internal.nvacc_I21 = std::vector<real_type>(shared->dim_nvacc_I21);
  internal.nvacc_I23 = std::vector<real_type>(shared->dim_nvacc_I23);
  internal.nvacc_I231 = std::vector<real_type>(shared->dim_nvacc_I231);
  internal.nvacc_I234 = std::vector<real_type>(shared->dim_nvacc_I234);
  internal.nvacc_I2341 = std::vector<real_type>(shared->dim_nvacc_I2341);
  internal.nvacc_I24 = std::vector<real_type>(shared->dim_nvacc_I24);
  internal.nvacc_I241 = std::vector<real_type>(shared->dim_nvacc_I241);
  internal.nvacc_I243 = std::vector<real_type>(shared->dim_nvacc_I243);
  internal.nvacc_I3 = std::vector<real_type>(shared->dim_nvacc_I3);
  internal.nvacc_I31 = std::vector<real_type>(shared->dim_nvacc_I31);
  internal.nvacc_I32 = std::vector<real_type>(shared->dim_nvacc_I32);
  internal.nvacc_I34 = std::vector<real_type>(shared->dim_nvacc_I34);
  internal.nvacc_I341 = std::vector<real_type>(shared->dim_nvacc_I341);
  internal.nvacc_I342 = std::vector<real_type>(shared->dim_nvacc_I342);
  internal.nvacc_I4 = std::vector<real_type>(shared->dim_nvacc_I4);
  internal.nvacc_I41 = std::vector<real_type>(shared->dim_nvacc_I41);
  internal.nvacc_I42 = std::vector<real_type>(shared->dim_nvacc_I42);
  internal.nvacc_I43 = std::vector<real_type>(shared->dim_nvacc_I43);
  internal.nvacc_R1 = std::vector<real_type>(shared->dim_nvacc_R1);
  internal.nvacc_R12 = std::vector<real_type>(shared->dim_nvacc_R12);
  internal.nvacc_R123 = std::vector<real_type>(shared->dim_nvacc_R123);
  internal.nvacc_R1234 = std::vector<real_type>(shared->dim_nvacc_R1234);
  internal.nvacc_R124 = std::vector<real_type>(shared->dim_nvacc_R124);
  internal.nvacc_R13 = std::vector<real_type>(shared->dim_nvacc_R13);
  internal.nvacc_R134 = std::vector<real_type>(shared->dim_nvacc_R134);
  internal.nvacc_R14 = std::vector<real_type>(shared->dim_nvacc_R14);
  internal.nvacc_R2 = std::vector<real_type>(shared->dim_nvacc_R2);
  internal.nvacc_R23 = std::vector<real_type>(shared->dim_nvacc_R23);
  internal.nvacc_R234 = std::vector<real_type>(shared->dim_nvacc_R234);
  internal.nvacc_R24 = std::vector<real_type>(shared->dim_nvacc_R24);
  internal.nvacc_R3 = std::vector<real_type>(shared->dim_nvacc_R3);
  internal.nvacc_R34 = std::vector<real_type>(shared->dim_nvacc_R34);
  internal.nvacc_R4 = std::vector<real_type>(shared->dim_nvacc_R4);
  internal.nvacc_S = std::vector<real_type>(shared->dim_nvacc_S);
  internal.O_I1 = std::vector<real_type>(shared->dim_O_I1);
  internal.O_I12 = std::vector<real_type>(shared->dim_O_I12);
  internal.O_I123 = std::vector<real_type>(shared->dim_O_I123);
  internal.O_I1234 = std::vector<real_type>(shared->dim_O_I1234);
  internal.O_I124 = std::vector<real_type>(shared->dim_O_I124);
  internal.O_I1243 = std::vector<real_type>(shared->dim_O_I1243);
  internal.O_I13 = std::vector<real_type>(shared->dim_O_I13);
  internal.O_I132 = std::vector<real_type>(shared->dim_O_I132);
  internal.O_I134 = std::vector<real_type>(shared->dim_O_I134);
  internal.O_I1342 = std::vector<real_type>(shared->dim_O_I1342);
  internal.O_I14 = std::vector<real_type>(shared->dim_O_I14);
  internal.O_I142 = std::vector<real_type>(shared->dim_O_I142);
  internal.O_I143 = std::vector<real_type>(shared->dim_O_I143);
  internal.O_I2 = std::vector<real_type>(shared->dim_O_I2);
  internal.O_I21 = std::vector<real_type>(shared->dim_O_I21);
  internal.O_I23 = std::vector<real_type>(shared->dim_O_I23);
  internal.O_I231 = std::vector<real_type>(shared->dim_O_I231);
  internal.O_I234 = std::vector<real_type>(shared->dim_O_I234);
  internal.O_I2341 = std::vector<real_type>(shared->dim_O_I2341);
  internal.O_I24 = std::vector<real_type>(shared->dim_O_I24);
  internal.O_I241 = std::vector<real_type>(shared->dim_O_I241);
  internal.O_I243 = std::vector<real_type>(shared->dim_O_I243);
  internal.O_I3 = std::vector<real_type>(shared->dim_O_I3);
  internal.O_I31 = std::vector<real_type>(shared->dim_O_I31);
  internal.O_I32 = std::vector<real_type>(shared->dim_O_I32);
  internal.O_I34 = std::vector<real_type>(shared->dim_O_I34);
  internal.O_I341 = std::vector<real_type>(shared->dim_O_I341);
  internal.O_I342 = std::vector<real_type>(shared->dim_O_I342);
  internal.O_I4 = std::vector<real_type>(shared->dim_O_I4);
  internal.O_I41 = std::vector<real_type>(shared->dim_O_I41);
  internal.O_I42 = std::vector<real_type>(shared->dim_O_I42);
  internal.O_I43 = std::vector<real_type>(shared->dim_O_I43);
  internal.O_R1 = std::vector<real_type>(shared->dim_O_R1);
  internal.O_R12 = std::vector<real_type>(shared->dim_O_R12);
  internal.O_R123 = std::vector<real_type>(shared->dim_O_R123);
  internal.O_R1234 = std::vector<real_type>(shared->dim_O_R1234);
  internal.O_R124 = std::vector<real_type>(shared->dim_O_R124);
  internal.O_R13 = std::vector<real_type>(shared->dim_O_R13);
  internal.O_R134 = std::vector<real_type>(shared->dim_O_R134);
  internal.O_R14 = std::vector<real_type>(shared->dim_O_R14);
  internal.O_R2 = std::vector<real_type>(shared->dim_O_R2);
  internal.O_R23 = std::vector<real_type>(shared->dim_O_R23);
  internal.O_R234 = std::vector<real_type>(shared->dim_O_R234);
  internal.O_R24 = std::vector<real_type>(shared->dim_O_R24);
  internal.O_R3 = std::vector<real_type>(shared->dim_O_R3);
  internal.O_R34 = std::vector<real_type>(shared->dim_O_R34);
  internal.O_R4 = std::vector<real_type>(shared->dim_O_R4);
  internal.O_S = std::vector<real_type>(shared->dim_O_S);
  internal.recov_1 = std::vector<real_type>(shared->dim_recov_1);
  internal.recov_12 = std::vector<real_type>(shared->dim_recov_12);
  internal.recov_123 = std::vector<real_type>(shared->dim_recov_123);
  internal.recov_1234 = std::vector<real_type>(shared->dim_recov_1234);
  internal.recov_124 = std::vector<real_type>(shared->dim_recov_124);
  internal.recov_1243 = std::vector<real_type>(shared->dim_recov_1243);
  internal.recov_13 = std::vector<real_type>(shared->dim_recov_13);
  internal.recov_132 = std::vector<real_type>(shared->dim_recov_132);
  internal.recov_134 = std::vector<real_type>(shared->dim_recov_134);
  internal.recov_1342 = std::vector<real_type>(shared->dim_recov_1342);
  internal.recov_14 = std::vector<real_type>(shared->dim_recov_14);
  internal.recov_142 = std::vector<real_type>(shared->dim_recov_142);
  internal.recov_143 = std::vector<real_type>(shared->dim_recov_143);
  internal.recov_2 = std::vector<real_type>(shared->dim_recov_2);
  internal.recov_21 = std::vector<real_type>(shared->dim_recov_21);
  internal.recov_23 = std::vector<real_type>(shared->dim_recov_23);
  internal.recov_231 = std::vector<real_type>(shared->dim_recov_231);
  internal.recov_234 = std::vector<real_type>(shared->dim_recov_234);
  internal.recov_2341 = std::vector<real_type>(shared->dim_recov_2341);
  internal.recov_24 = std::vector<real_type>(shared->dim_recov_24);
  internal.recov_241 = std::vector<real_type>(shared->dim_recov_241);
  internal.recov_243 = std::vector<real_type>(shared->dim_recov_243);
  internal.recov_3 = std::vector<real_type>(shared->dim_recov_3);
  internal.recov_31 = std::vector<real_type>(shared->dim_recov_31);
  internal.recov_32 = std::vector<real_type>(shared->dim_recov_32);
  internal.recov_34 = std::vector<real_type>(shared->dim_recov_34);
  internal.recov_341 = std::vector<real_type>(shared->dim_recov_341);
  internal.recov_342 = std::vector<real_type>(shared->dim_recov_342);
  internal.recov_4 = std::vector<real_type>(shared->dim_recov_4);
  internal.recov_41 = std::vector<real_type>(shared->dim_recov_41);
  internal.recov_42 = std::vector<real_type>(shared->dim_recov_42);
  internal.recov_43 = std::vector<real_type>(shared->dim_recov_43);
  internal.rho1 = std::vector<real_type>(shared->dim_rho1);
  internal.rho12 = std::vector<real_type>(shared->dim_rho12);
  internal.rho123 = std::vector<real_type>(shared->dim_rho123);
  internal.rho1234 = std::vector<real_type>(shared->dim_rho1234);
  internal.rho124 = std::vector<real_type>(shared->dim_rho124);
  internal.rho1243 = std::vector<real_type>(shared->dim_rho1243);
  internal.rho13 = std::vector<real_type>(shared->dim_rho13);
  internal.rho132 = std::vector<real_type>(shared->dim_rho132);
  internal.rho134 = std::vector<real_type>(shared->dim_rho134);
  internal.rho1342 = std::vector<real_type>(shared->dim_rho1342);
  internal.rho14 = std::vector<real_type>(shared->dim_rho14);
  internal.rho142 = std::vector<real_type>(shared->dim_rho142);
  internal.rho143 = std::vector<real_type>(shared->dim_rho143);
  internal.rho2 = std::vector<real_type>(shared->dim_rho2);
  internal.rho21 = std::vector<real_type>(shared->dim_rho21);
  internal.rho23 = std::vector<real_type>(shared->dim_rho23);
  internal.rho231 = std::vector<real_type>(shared->dim_rho231);
  internal.rho234 = std::vector<real_type>(shared->dim_rho234);
  internal.rho2341 = std::vector<real_type>(shared->dim_rho2341);
  internal.rho24 = std::vector<real_type>(shared->dim_rho24);
  internal.rho241 = std::vector<real_type>(shared->dim_rho241);
  internal.rho243 = std::vector<real_type>(shared->dim_rho243);
  internal.rho3 = std::vector<real_type>(shared->dim_rho3);
  internal.rho31 = std::vector<real_type>(shared->dim_rho31);
  internal.rho32 = std::vector<real_type>(shared->dim_rho32);
  internal.rho34 = std::vector<real_type>(shared->dim_rho34);
  internal.rho341 = std::vector<real_type>(shared->dim_rho341);
  internal.rho342 = std::vector<real_type>(shared->dim_rho342);
  internal.rho4 = std::vector<real_type>(shared->dim_rho4);
  internal.rho41 = std::vector<real_type>(shared->dim_rho41);
  internal.rho42 = std::vector<real_type>(shared->dim_rho42);
  internal.rho43 = std::vector<real_type>(shared->dim_rho43);
  internal.RR_dis = std::vector<real_type>(shared->dim_RR_dis);
  internal.RR_dis_cu = std::vector<real_type>(shared->dim_RR_dis_cu);
  internal.RR_dis_vc = std::vector<real_type>(shared->dim_RR_dis_vc);
  internal.RR_inf = std::vector<real_type>(shared->dim_RR_inf);
  internal.RR_sdis = std::vector<real_type>(shared->dim_RR_sdis);
  internal.RR_sdis_cu = std::vector<real_type>(shared->dim_RR_sdis_cu);
  internal.RR_sdis_vc = std::vector<real_type>(shared->dim_RR_sdis_vc);
  internal.sdisease_sero = std::vector<real_type>(shared->dim_sdisease_sero);
  internal.sdisease_sero_vacc_pri = std::vector<real_type>(shared->dim_sdisease_sero_vacc_pri);
  shared->vacc_cu_age_weight = std::vector<real_type>(shared->dim_vacc_cu_age_weight);
  internal.vcu_noncov = std::vector<real_type>(shared->dim_vcu_noncov);
  internal.vcu_noncov_S = std::vector<real_type>(shared->dim_vcu_noncov_S);
  internal.Y1 = std::vector<real_type>(shared->dim_Y1);
  internal.Y2 = std::vector<real_type>(shared->dim_Y2);
  internal.Y3 = std::vector<real_type>(shared->dim_Y3);
  internal.Y4 = std::vector<real_type>(shared->dim_Y4);
  internal.yll_sero = std::vector<real_type>(shared->dim_yll_sero);
  internal.yll_sero_vacc_pri = std::vector<real_type>(shared->dim_yll_sero_vacc_pri);
  shared->dim_age_I1 = shared->dim_age_I1_1 * shared->dim_age_I1_2;
  shared->dim_age_I12 = shared->dim_age_I12_1 * shared->dim_age_I12_2;
  shared->dim_age_I123 = shared->dim_age_I123_1 * shared->dim_age_I123_2;
  shared->dim_age_I1234 = shared->dim_age_I1234_1 * shared->dim_age_I1234_2;
  shared->dim_age_I124 = shared->dim_age_I124_1 * shared->dim_age_I124_2;
  shared->dim_age_I1243 = shared->dim_age_I1243_1 * shared->dim_age_I1243_2;
  shared->dim_age_I13 = shared->dim_age_I13_1 * shared->dim_age_I13_2;
  shared->dim_age_I132 = shared->dim_age_I132_1 * shared->dim_age_I132_2;
  shared->dim_age_I134 = shared->dim_age_I134_1 * shared->dim_age_I134_2;
  shared->dim_age_I1342 = shared->dim_age_I1342_1 * shared->dim_age_I1342_2;
  shared->dim_age_I14 = shared->dim_age_I14_1 * shared->dim_age_I14_2;
  shared->dim_age_I142 = shared->dim_age_I142_1 * shared->dim_age_I142_2;
  shared->dim_age_I143 = shared->dim_age_I143_1 * shared->dim_age_I143_2;
  shared->dim_age_I2 = shared->dim_age_I2_1 * shared->dim_age_I2_2;
  shared->dim_age_I21 = shared->dim_age_I21_1 * shared->dim_age_I21_2;
  shared->dim_age_I23 = shared->dim_age_I23_1 * shared->dim_age_I23_2;
  shared->dim_age_I231 = shared->dim_age_I231_1 * shared->dim_age_I231_2;
  shared->dim_age_I234 = shared->dim_age_I234_1 * shared->dim_age_I234_2;
  shared->dim_age_I2341 = shared->dim_age_I2341_1 * shared->dim_age_I2341_2;
  shared->dim_age_I24 = shared->dim_age_I24_1 * shared->dim_age_I24_2;
  shared->dim_age_I241 = shared->dim_age_I241_1 * shared->dim_age_I241_2;
  shared->dim_age_I243 = shared->dim_age_I243_1 * shared->dim_age_I243_2;
  shared->dim_age_I3 = shared->dim_age_I3_1 * shared->dim_age_I3_2;
  shared->dim_age_I31 = shared->dim_age_I31_1 * shared->dim_age_I31_2;
  shared->dim_age_I32 = shared->dim_age_I32_1 * shared->dim_age_I32_2;
  shared->dim_age_I34 = shared->dim_age_I34_1 * shared->dim_age_I34_2;
  shared->dim_age_I341 = shared->dim_age_I341_1 * shared->dim_age_I341_2;
  shared->dim_age_I342 = shared->dim_age_I342_1 * shared->dim_age_I342_2;
  shared->dim_age_I4 = shared->dim_age_I4_1 * shared->dim_age_I4_2;
  shared->dim_age_I41 = shared->dim_age_I41_1 * shared->dim_age_I41_2;
  shared->dim_age_I42 = shared->dim_age_I42_1 * shared->dim_age_I42_2;
  shared->dim_age_I43 = shared->dim_age_I43_1 * shared->dim_age_I43_2;
  shared->dim_age_R1 = shared->dim_age_R1_1 * shared->dim_age_R1_2;
  shared->dim_age_R12 = shared->dim_age_R12_1 * shared->dim_age_R12_2;
  shared->dim_age_R123 = shared->dim_age_R123_1 * shared->dim_age_R123_2;
  shared->dim_age_R1234 = shared->dim_age_R1234_1 * shared->dim_age_R1234_2;
  shared->dim_age_R124 = shared->dim_age_R124_1 * shared->dim_age_R124_2;
  shared->dim_age_R13 = shared->dim_age_R13_1 * shared->dim_age_R13_2;
  shared->dim_age_R134 = shared->dim_age_R134_1 * shared->dim_age_R134_2;
  shared->dim_age_R14 = shared->dim_age_R14_1 * shared->dim_age_R14_2;
  shared->dim_age_R2 = shared->dim_age_R2_1 * shared->dim_age_R2_2;
  shared->dim_age_R23 = shared->dim_age_R23_1 * shared->dim_age_R23_2;
  shared->dim_age_R234 = shared->dim_age_R234_1 * shared->dim_age_R234_2;
  shared->dim_age_R24 = shared->dim_age_R24_1 * shared->dim_age_R24_2;
  shared->dim_age_R3 = shared->dim_age_R3_1 * shared->dim_age_R3_2;
  shared->dim_age_R34 = shared->dim_age_R34_1 * shared->dim_age_R34_2;
  shared->dim_age_R4 = shared->dim_age_R4_1 * shared->dim_age_R4_2;
  shared->dim_age_S = shared->dim_age_S_1 * shared->dim_age_S_2;
  shared->dim_vacc_noncov = shared->dim_vacc_noncov_1 * shared->dim_vacc_noncov_2;
  shared->dim_vacc_noncov_S = shared->dim_vacc_noncov_S_1 * shared->dim_vacc_noncov_S_2;
  for (int i = 1; i <= shared->N_age; ++i) {
    shared->FOIas[i - 1] = (i > shared->Acrit ? shared->FOIagescale : 1);
  }
  for (int i = 1; i <= shared->N_age; ++i) {
    for (int j = 1; j <= 3; ++j) {
      shared->initial_I1[i - 1 + shared->dim_I1_1 * (j - 1)] = 0;
    }
  }
  for (int i = 1; i <= shared->N_age; ++i) {
    for (int j = 1; j <= 3; ++j) {
      shared->initial_I12[i - 1 + shared->dim_I12_1 * (j - 1)] = 0;
    }
  }
  for (int i = 1; i <= shared->N_age; ++i) {
    for (int j = 1; j <= 3; ++j) {
      shared->initial_I123[i - 1 + shared->dim_I123_1 * (j - 1)] = 0;
    }
  }
  for (int i = 1; i <= shared->N_age; ++i) {
    for (int j = 1; j <= 3; ++j) {
      shared->initial_I1234[i - 1 + shared->dim_I1234_1 * (j - 1)] = 0;
    }
  }
  for (int i = 1; i <= shared->N_age; ++i) {
    for (int j = 1; j <= 3; ++j) {
      shared->initial_I124[i - 1 + shared->dim_I124_1 * (j - 1)] = 0;
    }
  }
  for (int i = 1; i <= shared->N_age; ++i) {
    for (int j = 1; j <= 3; ++j) {
      shared->initial_I1243[i - 1 + shared->dim_I1243_1 * (j - 1)] = 0;
    }
  }
  for (int i = 1; i <= shared->N_age; ++i) {
    for (int j = 1; j <= 3; ++j) {
      shared->initial_I13[i - 1 + shared->dim_I13_1 * (j - 1)] = 0;
    }
  }
  for (int i = 1; i <= shared->N_age; ++i) {
    for (int j = 1; j <= 3; ++j) {
      shared->initial_I132[i - 1 + shared->dim_I132_1 * (j - 1)] = 0;
    }
  }
  for (int i = 1; i <= shared->N_age; ++i) {
    for (int j = 1; j <= 3; ++j) {
      shared->initial_I134[i - 1 + shared->dim_I134_1 * (j - 1)] = 0;
    }
  }
  for (int i = 1; i <= shared->N_age; ++i) {
    for (int j = 1; j <= 3; ++j) {
      shared->initial_I1342[i - 1 + shared->dim_I1342_1 * (j - 1)] = 0;
    }
  }
  for (int i = 1; i <= shared->N_age; ++i) {
    for (int j = 1; j <= 3; ++j) {
      shared->initial_I14[i - 1 + shared->dim_I14_1 * (j - 1)] = 0;
    }
  }
  for (int i = 1; i <= shared->N_age; ++i) {
    for (int j = 1; j <= 3; ++j) {
      shared->initial_I142[i - 1 + shared->dim_I142_1 * (j - 1)] = 0;
    }
  }
  for (int i = 1; i <= shared->N_age; ++i) {
    for (int j = 1; j <= 3; ++j) {
      shared->initial_I143[i - 1 + shared->dim_I143_1 * (j - 1)] = 0;
    }
  }
  for (int i = 1; i <= shared->N_age; ++i) {
    for (int j = 1; j <= 3; ++j) {
      shared->initial_I2[i - 1 + shared->dim_I2_1 * (j - 1)] = 0;
    }
  }
  for (int i = 1; i <= shared->N_age; ++i) {
    for (int j = 1; j <= 3; ++j) {
      shared->initial_I21[i - 1 + shared->dim_I21_1 * (j - 1)] = 0;
    }
  }
  for (int i = 1; i <= shared->N_age; ++i) {
    for (int j = 1; j <= 3; ++j) {
      shared->initial_I23[i - 1 + shared->dim_I23_1 * (j - 1)] = 0;
    }
  }
  for (int i = 1; i <= shared->N_age; ++i) {
    for (int j = 1; j <= 3; ++j) {
      shared->initial_I231[i - 1 + shared->dim_I231_1 * (j - 1)] = 0;
    }
  }
  for (int i = 1; i <= shared->N_age; ++i) {
    for (int j = 1; j <= 3; ++j) {
      shared->initial_I234[i - 1 + shared->dim_I234_1 * (j - 1)] = 0;
    }
  }
  for (int i = 1; i <= shared->N_age; ++i) {
    for (int j = 1; j <= 3; ++j) {
      shared->initial_I2341[i - 1 + shared->dim_I2341_1 * (j - 1)] = 0;
    }
  }
  for (int i = 1; i <= shared->N_age; ++i) {
    for (int j = 1; j <= 3; ++j) {
      shared->initial_I24[i - 1 + shared->dim_I24_1 * (j - 1)] = 0;
    }
  }
  for (int i = 1; i <= shared->N_age; ++i) {
    for (int j = 1; j <= 3; ++j) {
      shared->initial_I241[i - 1 + shared->dim_I241_1 * (j - 1)] = 0;
    }
  }
  for (int i = 1; i <= shared->N_age; ++i) {
    for (int j = 1; j <= 3; ++j) {
      shared->initial_I243[i - 1 + shared->dim_I243_1 * (j - 1)] = 0;
    }
  }
  for (int i = 1; i <= shared->N_age; ++i) {
    for (int j = 1; j <= 3; ++j) {
      shared->initial_I3[i - 1 + shared->dim_I3_1 * (j - 1)] = 0;
    }
  }
  for (int i = 1; i <= shared->N_age; ++i) {
    for (int j = 1; j <= 3; ++j) {
      shared->initial_I31[i - 1 + shared->dim_I31_1 * (j - 1)] = 0;
    }
  }
  for (int i = 1; i <= shared->N_age; ++i) {
    for (int j = 1; j <= 3; ++j) {
      shared->initial_I32[i - 1 + shared->dim_I32_1 * (j - 1)] = 0;
    }
  }
  for (int i = 1; i <= shared->N_age; ++i) {
    for (int j = 1; j <= 3; ++j) {
      shared->initial_I34[i - 1 + shared->dim_I34_1 * (j - 1)] = 0;
    }
  }
  for (int i = 1; i <= shared->N_age; ++i) {
    for (int j = 1; j <= 3; ++j) {
      shared->initial_I341[i - 1 + shared->dim_I341_1 * (j - 1)] = 0;
    }
  }
  for (int i = 1; i <= shared->N_age; ++i) {
    for (int j = 1; j <= 3; ++j) {
      shared->initial_I342[i - 1 + shared->dim_I342_1 * (j - 1)] = 0;
    }
  }
  for (int i = 1; i <= shared->N_age; ++i) {
    for (int j = 1; j <= 3; ++j) {
      shared->initial_I4[i - 1 + shared->dim_I4_1 * (j - 1)] = 0;
    }
  }
  for (int i = 1; i <= shared->N_age; ++i) {
    for (int j = 1; j <= 3; ++j) {
      shared->initial_I41[i - 1 + shared->dim_I41_1 * (j - 1)] = 0;
    }
  }
  for (int i = 1; i <= shared->N_age; ++i) {
    for (int j = 1; j <= 3; ++j) {
      shared->initial_I42[i - 1 + shared->dim_I42_1 * (j - 1)] = 0;
    }
  }
  for (int i = 1; i <= shared->N_age; ++i) {
    for (int j = 1; j <= 3; ++j) {
      shared->initial_I43[i - 1 + shared->dim_I43_1 * (j - 1)] = 0;
    }
  }
  for (int i = 1; i <= shared->NYO; ++i) {
    for (int j = 1; j <= 4; ++j) {
      shared->initial_out_dis_sero_pop[i - 1 + shared->dim_out_dis_sero_pop_1 * (j - 1)] = 0;
    }
  }
  for (int i = 1; i <= shared->NYO; ++i) {
    for (int j = 1; j <= 4; ++j) {
      shared->initial_out_dis_sero_unvacc[i - 1 + shared->dim_out_dis_sero_unvacc_1 * (j - 1)] = 0;
    }
  }
  for (int i = 1; i <= shared->NYO; ++i) {
    for (int j = 1; j <= 4; ++j) {
      shared->initial_out_dis_sero_vacc[i - 1 + shared->dim_out_dis_sero_vacc_1 * (j - 1)] = 0;
    }
  }
  for (int i = 1; i <= shared->NYO; ++i) {
    for (int j = 1; j <= 4; ++j) {
      shared->initial_out_dis_sero_vacc_neg[i - 1 + shared->dim_out_dis_sero_vacc_neg_1 * (j - 1)] = 0;
    }
  }
  for (int i = 1; i <= shared->NYO; ++i) {
    for (int j = 1; j <= 4; ++j) {
      shared->initial_out_dis_sero_vacc_pos[i - 1 + shared->dim_out_dis_sero_vacc_pos_1 * (j - 1)] = 0;
    }
  }
  for (int i = 1; i <= 4; ++i) {
    for (int j = 1; j <= 2; ++j) {
      for (int k = 1; k <= shared->N_age; ++k) {
        shared->initial_out_nc[i - 1 + shared->dim_out_nc_1 * (j - 1) + shared->dim_out_nc_12 * (k - 1)] = 0;
      }
    }
  }
  for (int i = 1; i <= 4; ++i) {
    for (int j = 1; j <= 2; ++j) {
      for (int k = 1; k <= shared->N_age; ++k) {
        shared->initial_out_RR[i - 1 + shared->dim_out_RR_1 * (j - 1) + shared->dim_out_RR_12 * (k - 1)] = 0;
      }
    }
  }
  for (int i = 1; i <= shared->NYO; ++i) {
    for (int j = 1; j <= 4; ++j) {
      shared->initial_out_sdis_sero_pop[i - 1 + shared->dim_out_sdis_sero_pop_1 * (j - 1)] = 0;
    }
  }
  for (int i = 1; i <= shared->NYO; ++i) {
    for (int j = 1; j <= 4; ++j) {
      shared->initial_out_sdis_sero_unvacc[i - 1 + shared->dim_out_sdis_sero_unvacc_1 * (j - 1)] = 0;
    }
  }
  for (int i = 1; i <= shared->NYO; ++i) {
    for (int j = 1; j <= 4; ++j) {
      shared->initial_out_sdis_sero_vacc[i - 1 + shared->dim_out_sdis_sero_vacc_1 * (j - 1)] = 0;
    }
  }
  for (int i = 1; i <= shared->NYO; ++i) {
    for (int j = 1; j <= 4; ++j) {
      shared->initial_out_sdis_sero_vacc_neg[i - 1 + shared->dim_out_sdis_sero_vacc_neg_1 * (j - 1)] = 0;
    }
  }
  for (int i = 1; i <= shared->NYO; ++i) {
    for (int j = 1; j <= 4; ++j) {
      shared->initial_out_sdis_sero_vacc_pos[i - 1 + shared->dim_out_sdis_sero_vacc_pos_1 * (j - 1)] = 0;
    }
  }
  for (int i = 1; i <= shared->NYO; ++i) {
    for (int j = 1; j <= 4; ++j) {
      shared->initial_out_yll_sero_pop[i - 1 + shared->dim_out_yll_sero_pop_1 * (j - 1)] = 0;
    }
  }
  for (int i = 1; i <= shared->NYO; ++i) {
    for (int j = 1; j <= 4; ++j) {
      shared->initial_out_yll_sero_unvacc[i - 1 + shared->dim_out_yll_sero_unvacc_1 * (j - 1)] = 0;
    }
  }
  for (int i = 1; i <= shared->NYO; ++i) {
    for (int j = 1; j <= 4; ++j) {
      shared->initial_out_yll_sero_vacc[i - 1 + shared->dim_out_yll_sero_vacc_1 * (j - 1)] = 0;
    }
  }
  for (int i = 1; i <= shared->NYO; ++i) {
    for (int j = 1; j <= 4; ++j) {
      shared->initial_out_yll_sero_vacc_neg[i - 1 + shared->dim_out_yll_sero_vacc_neg_1 * (j - 1)] = 0;
    }
  }
  for (int i = 1; i <= shared->NYO; ++i) {
    for (int j = 1; j <= 4; ++j) {
      shared->initial_out_yll_sero_vacc_pos[i - 1 + shared->dim_out_yll_sero_vacc_pos_1 * (j - 1)] = 0;
    }
  }
  shared->offset_variable_I1 = shared->dim_cum_infection_pri + shared->dim_cum_infection_priV + shared->dim_cum_infection_sec + shared->dim_cum_infection_secV + shared->dim_cum_infection_tq + shared->dim_cum_infection_tqV + shared->dim_Ntotal_out + shared->dim_out_dis_all_pop + shared->dim_out_dis_all_unvacc + shared->dim_out_dis_all_vacc + shared->dim_out_dis_all_vacc_neg + shared->dim_out_dis_all_vacc_pos + shared->dim_out_disc_dis_all_pop + shared->dim_out_disc_dis_all_vacc + shared->dim_out_disc_nvacc_all_pop + shared->dim_out_disc_sdis_all_pop + shared->dim_out_disc_sdis_all_vacc + shared->dim_out_disc_yll_all_pop + shared->dim_out_disc_yll_all_vacc + shared->dim_out_nvacc_all_neg + shared->dim_out_nvacc_all_pop + shared->dim_out_nvacc_all_pos + shared->dim_out_prop_seroneg_at_9 + shared->dim_out_prop_seroneg_at_vca + shared->dim_out_sdis_all_pop + shared->dim_out_sdis_all_unvacc + shared->dim_out_sdis_all_vacc + shared->dim_out_sdis_all_vacc_neg + shared->dim_out_sdis_all_vacc_pos + shared->dim_out_time_from_last_dose + shared->dim_out_yll_all_pop + shared->dim_out_yll_all_unvacc + shared->dim_out_yll_all_vacc + shared->dim_out_yll_all_vacc_neg + shared->dim_out_yll_all_vacc_pos + shared->dim_S + shared->dim_VE_seroneg1n + shared->dim_VE_seroneg1p + 47;
  shared->offset_variable_I12 = shared->dim_cum_infection_pri + shared->dim_cum_infection_priV + shared->dim_cum_infection_sec + shared->dim_cum_infection_secV + shared->dim_cum_infection_tq + shared->dim_cum_infection_tqV + shared->dim_I1 + shared->dim_I2 + shared->dim_I21 + shared->dim_I3 + shared->dim_I31 + shared->dim_I4 + shared->dim_I41 + shared->dim_Ntotal_out + shared->dim_out_dis_all_pop + shared->dim_out_dis_all_unvacc + shared->dim_out_dis_all_vacc + shared->dim_out_dis_all_vacc_neg + shared->dim_out_dis_all_vacc_pos + shared->dim_out_disc_dis_all_pop + shared->dim_out_disc_dis_all_vacc + shared->dim_out_disc_nvacc_all_pop + shared->dim_out_disc_sdis_all_pop + shared->dim_out_disc_sdis_all_vacc + shared->dim_out_disc_yll_all_pop + shared->dim_out_disc_yll_all_vacc + shared->dim_out_nvacc_all_neg + shared->dim_out_nvacc_all_pop + shared->dim_out_nvacc_all_pos + shared->dim_out_prop_seroneg_at_9 + shared->dim_out_prop_seroneg_at_vca + shared->dim_out_sdis_all_pop + shared->dim_out_sdis_all_unvacc + shared->dim_out_sdis_all_vacc + shared->dim_out_sdis_all_vacc_neg + shared->dim_out_sdis_all_vacc_pos + shared->dim_out_time_from_last_dose + shared->dim_out_yll_all_pop + shared->dim_out_yll_all_unvacc + shared->dim_out_yll_all_vacc + shared->dim_out_yll_all_vacc_neg + shared->dim_out_yll_all_vacc_pos + shared->dim_R1 + shared->dim_R2 + shared->dim_R3 + shared->dim_R4 + shared->dim_S + shared->dim_VE_seroneg1n + shared->dim_VE_seroneg1p + 47;
  shared->offset_variable_I123 = shared->dim_cum_infection_pri + shared->dim_cum_infection_priV + shared->dim_cum_infection_sec + shared->dim_cum_infection_secV + shared->dim_cum_infection_tq + shared->dim_cum_infection_tqV + shared->dim_I1 + shared->dim_I12 + shared->dim_I13 + shared->dim_I132 + shared->dim_I14 + shared->dim_I142 + shared->dim_I2 + shared->dim_I21 + shared->dim_I23 + shared->dim_I231 + shared->dim_I24 + shared->dim_I241 + shared->dim_I3 + shared->dim_I31 + shared->dim_I32 + shared->dim_I34 + shared->dim_I341 + shared->dim_I342 + shared->dim_I4 + shared->dim_I41 + shared->dim_I42 + shared->dim_I43 + shared->dim_Ntotal_out + shared->dim_out_dis_all_pop + shared->dim_out_dis_all_unvacc + shared->dim_out_dis_all_vacc + shared->dim_out_dis_all_vacc_neg + shared->dim_out_dis_all_vacc_pos + shared->dim_out_disc_dis_all_pop + shared->dim_out_disc_dis_all_vacc + shared->dim_out_disc_nvacc_all_pop + shared->dim_out_disc_sdis_all_pop + shared->dim_out_disc_sdis_all_vacc + shared->dim_out_disc_yll_all_pop + shared->dim_out_disc_yll_all_vacc + shared->dim_out_nvacc_all_neg + shared->dim_out_nvacc_all_pop + shared->dim_out_nvacc_all_pos + shared->dim_out_prop_seroneg_at_9 + shared->dim_out_prop_seroneg_at_vca + shared->dim_out_sdis_all_pop + shared->dim_out_sdis_all_unvacc + shared->dim_out_sdis_all_vacc + shared->dim_out_sdis_all_vacc_neg + shared->dim_out_sdis_all_vacc_pos + shared->dim_out_time_from_last_dose + shared->dim_out_yll_all_pop + shared->dim_out_yll_all_unvacc + shared->dim_out_yll_all_vacc + shared->dim_out_yll_all_vacc_neg + shared->dim_out_yll_all_vacc_pos + shared->dim_R1 + shared->dim_R12 + shared->dim_R13 + shared->dim_R14 + shared->dim_R2 + shared->dim_R23 + shared->dim_R24 + shared->dim_R3 + shared->dim_R34 + shared->dim_R4 + shared->dim_S + shared->dim_VE_seroneg1n + shared->dim_VE_seroneg1p + 47;
  shared->offset_variable_I1234 = shared->dim_cum_infection_pri + shared->dim_cum_infection_priV + shared->dim_cum_infection_sec + shared->dim_cum_infection_secV + shared->dim_cum_infection_tq + shared->dim_cum_infection_tqV + shared->dim_I1 + shared->dim_I12 + shared->dim_I123 + shared->dim_I124 + shared->dim_I1243 + shared->dim_I13 + shared->dim_I132 + shared->dim_I134 + shared->dim_I1342 + shared->dim_I14 + shared->dim_I142 + shared->dim_I143 + shared->dim_I2 + shared->dim_I21 + shared->dim_I23 + shared->dim_I231 + shared->dim_I234 + shared->dim_I2341 + shared->dim_I24 + shared->dim_I241 + shared->dim_I243 + shared->dim_I3 + shared->dim_I31 + shared->dim_I32 + shared->dim_I34 + shared->dim_I341 + shared->dim_I342 + shared->dim_I4 + shared->dim_I41 + shared->dim_I42 + shared->dim_I43 + shared->dim_Ntotal_out + shared->dim_out_dis_all_pop + shared->dim_out_dis_all_unvacc + shared->dim_out_dis_all_vacc + shared->dim_out_dis_all_vacc_neg + shared->dim_out_dis_all_vacc_pos + shared->dim_out_disc_dis_all_pop + shared->dim_out_disc_dis_all_vacc + shared->dim_out_disc_nvacc_all_pop + shared->dim_out_disc_sdis_all_pop + shared->dim_out_disc_sdis_all_vacc + shared->dim_out_disc_yll_all_pop + shared->dim_out_disc_yll_all_vacc + shared->dim_out_nvacc_all_neg + shared->dim_out_nvacc_all_pop + shared->dim_out_nvacc_all_pos + shared->dim_out_prop_seroneg_at_9 + shared->dim_out_prop_seroneg_at_vca + shared->dim_out_sdis_all_pop + shared->dim_out_sdis_all_unvacc + shared->dim_out_sdis_all_vacc + shared->dim_out_sdis_all_vacc_neg + shared->dim_out_sdis_all_vacc_pos + shared->dim_out_time_from_last_dose + shared->dim_out_yll_all_pop + shared->dim_out_yll_all_unvacc + shared->dim_out_yll_all_vacc + shared->dim_out_yll_all_vacc_neg + shared->dim_out_yll_all_vacc_pos + shared->dim_R1 + shared->dim_R12 + shared->dim_R123 + shared->dim_R124 + shared->dim_R13 + shared->dim_R134 + shared->dim_R14 + shared->dim_R2 + shared->dim_R23 + shared->dim_R234 + shared->dim_R24 + shared->dim_R3 + shared->dim_R34 + shared->dim_R4 + shared->dim_S + shared->dim_VE_seroneg1n + shared->dim_VE_seroneg1p + 47;
  shared->offset_variable_I124 = shared->dim_cum_infection_pri + shared->dim_cum_infection_priV + shared->dim_cum_infection_sec + shared->dim_cum_infection_secV + shared->dim_cum_infection_tq + shared->dim_cum_infection_tqV + shared->dim_I1 + shared->dim_I12 + shared->dim_I123 + shared->dim_I13 + shared->dim_I132 + shared->dim_I14 + shared->dim_I142 + shared->dim_I143 + shared->dim_I2 + shared->dim_I21 + shared->dim_I23 + shared->dim_I231 + shared->dim_I24 + shared->dim_I241 + shared->dim_I243 + shared->dim_I3 + shared->dim_I31 + shared->dim_I32 + shared->dim_I34 + shared->dim_I341 + shared->dim_I342 + shared->dim_I4 + shared->dim_I41 + shared->dim_I42 + shared->dim_I43 + shared->dim_Ntotal_out + shared->dim_out_dis_all_pop + shared->dim_out_dis_all_unvacc + shared->dim_out_dis_all_vacc + shared->dim_out_dis_all_vacc_neg + shared->dim_out_dis_all_vacc_pos + shared->dim_out_disc_dis_all_pop + shared->dim_out_disc_dis_all_vacc + shared->dim_out_disc_nvacc_all_pop + shared->dim_out_disc_sdis_all_pop + shared->dim_out_disc_sdis_all_vacc + shared->dim_out_disc_yll_all_pop + shared->dim_out_disc_yll_all_vacc + shared->dim_out_nvacc_all_neg + shared->dim_out_nvacc_all_pop + shared->dim_out_nvacc_all_pos + shared->dim_out_prop_seroneg_at_9 + shared->dim_out_prop_seroneg_at_vca + shared->dim_out_sdis_all_pop + shared->dim_out_sdis_all_unvacc + shared->dim_out_sdis_all_vacc + shared->dim_out_sdis_all_vacc_neg + shared->dim_out_sdis_all_vacc_pos + shared->dim_out_time_from_last_dose + shared->dim_out_yll_all_pop + shared->dim_out_yll_all_unvacc + shared->dim_out_yll_all_vacc + shared->dim_out_yll_all_vacc_neg + shared->dim_out_yll_all_vacc_pos + shared->dim_R1 + shared->dim_R12 + shared->dim_R13 + shared->dim_R14 + shared->dim_R2 + shared->dim_R23 + shared->dim_R24 + shared->dim_R3 + shared->dim_R34 + shared->dim_R4 + shared->dim_S + shared->dim_VE_seroneg1n + shared->dim_VE_seroneg1p + 47;
  shared->offset_variable_I1243 = shared->dim_cum_infection_pri + shared->dim_cum_infection_priV + shared->dim_cum_infection_sec + shared->dim_cum_infection_secV + shared->dim_cum_infection_tq + shared->dim_cum_infection_tqV + shared->dim_I1 + shared->dim_I12 + shared->dim_I123 + shared->dim_I124 + shared->dim_I13 + shared->dim_I132 + shared->dim_I134 + shared->dim_I1342 + shared->dim_I14 + shared->dim_I142 + shared->dim_I143 + shared->dim_I2 + shared->dim_I21 + shared->dim_I23 + shared->dim_I231 + shared->dim_I234 + shared->dim_I2341 + shared->dim_I24 + shared->dim_I241 + shared->dim_I243 + shared->dim_I3 + shared->dim_I31 + shared->dim_I32 + shared->dim_I34 + shared->dim_I341 + shared->dim_I342 + shared->dim_I4 + shared->dim_I41 + shared->dim_I42 + shared->dim_I43 + shared->dim_Ntotal_out + shared->dim_out_dis_all_pop + shared->dim_out_dis_all_unvacc + shared->dim_out_dis_all_vacc + shared->dim_out_dis_all_vacc_neg + shared->dim_out_dis_all_vacc_pos + shared->dim_out_disc_dis_all_pop + shared->dim_out_disc_dis_all_vacc + shared->dim_out_disc_nvacc_all_pop + shared->dim_out_disc_sdis_all_pop + shared->dim_out_disc_sdis_all_vacc + shared->dim_out_disc_yll_all_pop + shared->dim_out_disc_yll_all_vacc + shared->dim_out_nvacc_all_neg + shared->dim_out_nvacc_all_pop + shared->dim_out_nvacc_all_pos + shared->dim_out_prop_seroneg_at_9 + shared->dim_out_prop_seroneg_at_vca + shared->dim_out_sdis_all_pop + shared->dim_out_sdis_all_unvacc + shared->dim_out_sdis_all_vacc + shared->dim_out_sdis_all_vacc_neg + shared->dim_out_sdis_all_vacc_pos + shared->dim_out_time_from_last_dose + shared->dim_out_yll_all_pop + shared->dim_out_yll_all_unvacc + shared->dim_out_yll_all_vacc + shared->dim_out_yll_all_vacc_neg + shared->dim_out_yll_all_vacc_pos + shared->dim_R1 + shared->dim_R12 + shared->dim_R123 + shared->dim_R124 + shared->dim_R13 + shared->dim_R134 + shared->dim_R14 + shared->dim_R2 + shared->dim_R23 + shared->dim_R234 + shared->dim_R24 + shared->dim_R3 + shared->dim_R34 + shared->dim_R4 + shared->dim_S + shared->dim_VE_seroneg1n + shared->dim_VE_seroneg1p + 47;
  shared->offset_variable_I13 = shared->dim_cum_infection_pri + shared->dim_cum_infection_priV + shared->dim_cum_infection_sec + shared->dim_cum_infection_secV + shared->dim_cum_infection_tq + shared->dim_cum_infection_tqV + shared->dim_I1 + shared->dim_I12 + shared->dim_I2 + shared->dim_I21 + shared->dim_I3 + shared->dim_I31 + shared->dim_I32 + shared->dim_I4 + shared->dim_I41 + shared->dim_I42 + shared->dim_Ntotal_out + shared->dim_out_dis_all_pop + shared->dim_out_dis_all_unvacc + shared->dim_out_dis_all_vacc + shared->dim_out_dis_all_vacc_neg + shared->dim_out_dis_all_vacc_pos + shared->dim_out_disc_dis_all_pop + shared->dim_out_disc_dis_all_vacc + shared->dim_out_disc_nvacc_all_pop + shared->dim_out_disc_sdis_all_pop + shared->dim_out_disc_sdis_all_vacc + shared->dim_out_disc_yll_all_pop + shared->dim_out_disc_yll_all_vacc + shared->dim_out_nvacc_all_neg + shared->dim_out_nvacc_all_pop + shared->dim_out_nvacc_all_pos + shared->dim_out_prop_seroneg_at_9 + shared->dim_out_prop_seroneg_at_vca + shared->dim_out_sdis_all_pop + shared->dim_out_sdis_all_unvacc + shared->dim_out_sdis_all_vacc + shared->dim_out_sdis_all_vacc_neg + shared->dim_out_sdis_all_vacc_pos + shared->dim_out_time_from_last_dose + shared->dim_out_yll_all_pop + shared->dim_out_yll_all_unvacc + shared->dim_out_yll_all_vacc + shared->dim_out_yll_all_vacc_neg + shared->dim_out_yll_all_vacc_pos + shared->dim_R1 + shared->dim_R2 + shared->dim_R3 + shared->dim_R4 + shared->dim_S + shared->dim_VE_seroneg1n + shared->dim_VE_seroneg1p + 47;
  shared->offset_variable_I132 = shared->dim_cum_infection_pri + shared->dim_cum_infection_priV + shared->dim_cum_infection_sec + shared->dim_cum_infection_secV + shared->dim_cum_infection_tq + shared->dim_cum_infection_tqV + shared->dim_I1 + shared->dim_I12 + shared->dim_I13 + shared->dim_I14 + shared->dim_I2 + shared->dim_I21 + shared->dim_I23 + shared->dim_I231 + shared->dim_I24 + shared->dim_I241 + shared->dim_I3 + shared->dim_I31 + shared->dim_I32 + shared->dim_I34 + shared->dim_I341 + shared->dim_I4 + shared->dim_I41 + shared->dim_I42 + shared->dim_I43 + shared->dim_Ntotal_out + shared->dim_out_dis_all_pop + shared->dim_out_dis_all_unvacc + shared->dim_out_dis_all_vacc + shared->dim_out_dis_all_vacc_neg + shared->dim_out_dis_all_vacc_pos + shared->dim_out_disc_dis_all_pop + shared->dim_out_disc_dis_all_vacc + shared->dim_out_disc_nvacc_all_pop + shared->dim_out_disc_sdis_all_pop + shared->dim_out_disc_sdis_all_vacc + shared->dim_out_disc_yll_all_pop + shared->dim_out_disc_yll_all_vacc + shared->dim_out_nvacc_all_neg + shared->dim_out_nvacc_all_pop + shared->dim_out_nvacc_all_pos + shared->dim_out_prop_seroneg_at_9 + shared->dim_out_prop_seroneg_at_vca + shared->dim_out_sdis_all_pop + shared->dim_out_sdis_all_unvacc + shared->dim_out_sdis_all_vacc + shared->dim_out_sdis_all_vacc_neg + shared->dim_out_sdis_all_vacc_pos + shared->dim_out_time_from_last_dose + shared->dim_out_yll_all_pop + shared->dim_out_yll_all_unvacc + shared->dim_out_yll_all_vacc + shared->dim_out_yll_all_vacc_neg + shared->dim_out_yll_all_vacc_pos + shared->dim_R1 + shared->dim_R12 + shared->dim_R13 + shared->dim_R14 + shared->dim_R2 + shared->dim_R23 + shared->dim_R24 + shared->dim_R3 + shared->dim_R34 + shared->dim_R4 + shared->dim_S + shared->dim_VE_seroneg1n + shared->dim_VE_seroneg1p + 47;
  shared->offset_variable_I134 = shared->dim_cum_infection_pri + shared->dim_cum_infection_priV + shared->dim_cum_infection_sec + shared->dim_cum_infection_secV + shared->dim_cum_infection_tq + shared->dim_cum_infection_tqV + shared->dim_I1 + shared->dim_I12 + shared->dim_I123 + shared->dim_I124 + shared->dim_I13 + shared->dim_I132 + shared->dim_I14 + shared->dim_I142 + shared->dim_I143 + shared->dim_I2 + shared->dim_I21 + shared->dim_I23 + shared->dim_I231 + shared->dim_I24 + shared->dim_I241 + shared->dim_I243 + shared->dim_I3 + shared->dim_I31 + shared->dim_I32 + shared->dim_I34 + shared->dim_I341 + shared->dim_I342 + shared->dim_I4 + shared->dim_I41 + shared->dim_I42 + shared->dim_I43 + shared->dim_Ntotal_out + shared->dim_out_dis_all_pop + shared->dim_out_dis_all_unvacc + shared->dim_out_dis_all_vacc + shared->dim_out_dis_all_vacc_neg + shared->dim_out_dis_all_vacc_pos + shared->dim_out_disc_dis_all_pop + shared->dim_out_disc_dis_all_vacc + shared->dim_out_disc_nvacc_all_pop + shared->dim_out_disc_sdis_all_pop + shared->dim_out_disc_sdis_all_vacc + shared->dim_out_disc_yll_all_pop + shared->dim_out_disc_yll_all_vacc + shared->dim_out_nvacc_all_neg + shared->dim_out_nvacc_all_pop + shared->dim_out_nvacc_all_pos + shared->dim_out_prop_seroneg_at_9 + shared->dim_out_prop_seroneg_at_vca + shared->dim_out_sdis_all_pop + shared->dim_out_sdis_all_unvacc + shared->dim_out_sdis_all_vacc + shared->dim_out_sdis_all_vacc_neg + shared->dim_out_sdis_all_vacc_pos + shared->dim_out_time_from_last_dose + shared->dim_out_yll_all_pop + shared->dim_out_yll_all_unvacc + shared->dim_out_yll_all_vacc + shared->dim_out_yll_all_vacc_neg + shared->dim_out_yll_all_vacc_pos + shared->dim_R1 + shared->dim_R12 + shared->dim_R13 + shared->dim_R14 + shared->dim_R2 + shared->dim_R23 + shared->dim_R24 + shared->dim_R3 + shared->dim_R34 + shared->dim_R4 + shared->dim_S + shared->dim_VE_seroneg1n + shared->dim_VE_seroneg1p + 47;
  shared->offset_variable_I1342 = shared->dim_cum_infection_pri + shared->dim_cum_infection_priV + shared->dim_cum_infection_sec + shared->dim_cum_infection_secV + shared->dim_cum_infection_tq + shared->dim_cum_infection_tqV + shared->dim_I1 + shared->dim_I12 + shared->dim_I123 + shared->dim_I124 + shared->dim_I13 + shared->dim_I132 + shared->dim_I134 + shared->dim_I14 + shared->dim_I142 + shared->dim_I143 + shared->dim_I2 + shared->dim_I21 + shared->dim_I23 + shared->dim_I231 + shared->dim_I234 + shared->dim_I2341 + shared->dim_I24 + shared->dim_I241 + shared->dim_I243 + shared->dim_I3 + shared->dim_I31 + shared->dim_I32 + shared->dim_I34 + shared->dim_I341 + shared->dim_I342 + shared->dim_I4 + shared->dim_I41 + shared->dim_I42 + shared->dim_I43 + shared->dim_Ntotal_out + shared->dim_out_dis_all_pop + shared->dim_out_dis_all_unvacc + shared->dim_out_dis_all_vacc + shared->dim_out_dis_all_vacc_neg + shared->dim_out_dis_all_vacc_pos + shared->dim_out_disc_dis_all_pop + shared->dim_out_disc_dis_all_vacc + shared->dim_out_disc_nvacc_all_pop + shared->dim_out_disc_sdis_all_pop + shared->dim_out_disc_sdis_all_vacc + shared->dim_out_disc_yll_all_pop + shared->dim_out_disc_yll_all_vacc + shared->dim_out_nvacc_all_neg + shared->dim_out_nvacc_all_pop + shared->dim_out_nvacc_all_pos + shared->dim_out_prop_seroneg_at_9 + shared->dim_out_prop_seroneg_at_vca + shared->dim_out_sdis_all_pop + shared->dim_out_sdis_all_unvacc + shared->dim_out_sdis_all_vacc + shared->dim_out_sdis_all_vacc_neg + shared->dim_out_sdis_all_vacc_pos + shared->dim_out_time_from_last_dose + shared->dim_out_yll_all_pop + shared->dim_out_yll_all_unvacc + shared->dim_out_yll_all_vacc + shared->dim_out_yll_all_vacc_neg + shared->dim_out_yll_all_vacc_pos + shared->dim_R1 + shared->dim_R12 + shared->dim_R123 + shared->dim_R124 + shared->dim_R13 + shared->dim_R134 + shared->dim_R14 + shared->dim_R2 + shared->dim_R23 + shared->dim_R234 + shared->dim_R24 + shared->dim_R3 + shared->dim_R34 + shared->dim_R4 + shared->dim_S + shared->dim_VE_seroneg1n + shared->dim_VE_seroneg1p + 47;
  shared->offset_variable_I14 = shared->dim_cum_infection_pri + shared->dim_cum_infection_priV + shared->dim_cum_infection_sec + shared->dim_cum_infection_secV + shared->dim_cum_infection_tq + shared->dim_cum_infection_tqV + shared->dim_I1 + shared->dim_I12 + shared->dim_I13 + shared->dim_I2 + shared->dim_I21 + shared->dim_I23 + shared->dim_I3 + shared->dim_I31 + shared->dim_I32 + shared->dim_I4 + shared->dim_I41 + shared->dim_I42 + shared->dim_I43 + shared->dim_Ntotal_out + shared->dim_out_dis_all_pop + shared->dim_out_dis_all_unvacc + shared->dim_out_dis_all_vacc + shared->dim_out_dis_all_vacc_neg + shared->dim_out_dis_all_vacc_pos + shared->dim_out_disc_dis_all_pop + shared->dim_out_disc_dis_all_vacc + shared->dim_out_disc_nvacc_all_pop + shared->dim_out_disc_sdis_all_pop + shared->dim_out_disc_sdis_all_vacc + shared->dim_out_disc_yll_all_pop + shared->dim_out_disc_yll_all_vacc + shared->dim_out_nvacc_all_neg + shared->dim_out_nvacc_all_pop + shared->dim_out_nvacc_all_pos + shared->dim_out_prop_seroneg_at_9 + shared->dim_out_prop_seroneg_at_vca + shared->dim_out_sdis_all_pop + shared->dim_out_sdis_all_unvacc + shared->dim_out_sdis_all_vacc + shared->dim_out_sdis_all_vacc_neg + shared->dim_out_sdis_all_vacc_pos + shared->dim_out_time_from_last_dose + shared->dim_out_yll_all_pop + shared->dim_out_yll_all_unvacc + shared->dim_out_yll_all_vacc + shared->dim_out_yll_all_vacc_neg + shared->dim_out_yll_all_vacc_pos + shared->dim_R1 + shared->dim_R2 + shared->dim_R3 + shared->dim_R4 + shared->dim_S + shared->dim_VE_seroneg1n + shared->dim_VE_seroneg1p + 47;
  shared->offset_variable_I142 = shared->dim_cum_infection_pri + shared->dim_cum_infection_priV + shared->dim_cum_infection_sec + shared->dim_cum_infection_secV + shared->dim_cum_infection_tq + shared->dim_cum_infection_tqV + shared->dim_I1 + shared->dim_I12 + shared->dim_I13 + shared->dim_I132 + shared->dim_I14 + shared->dim_I2 + shared->dim_I21 + shared->dim_I23 + shared->dim_I231 + shared->dim_I24 + shared->dim_I241 + shared->dim_I3 + shared->dim_I31 + shared->dim_I32 + shared->dim_I34 + shared->dim_I341 + shared->dim_I4 + shared->dim_I41 + shared->dim_I42 + shared->dim_I43 + shared->dim_Ntotal_out + shared->dim_out_dis_all_pop + shared->dim_out_dis_all_unvacc + shared->dim_out_dis_all_vacc + shared->dim_out_dis_all_vacc_neg + shared->dim_out_dis_all_vacc_pos + shared->dim_out_disc_dis_all_pop + shared->dim_out_disc_dis_all_vacc + shared->dim_out_disc_nvacc_all_pop + shared->dim_out_disc_sdis_all_pop + shared->dim_out_disc_sdis_all_vacc + shared->dim_out_disc_yll_all_pop + shared->dim_out_disc_yll_all_vacc + shared->dim_out_nvacc_all_neg + shared->dim_out_nvacc_all_pop + shared->dim_out_nvacc_all_pos + shared->dim_out_prop_seroneg_at_9 + shared->dim_out_prop_seroneg_at_vca + shared->dim_out_sdis_all_pop + shared->dim_out_sdis_all_unvacc + shared->dim_out_sdis_all_vacc + shared->dim_out_sdis_all_vacc_neg + shared->dim_out_sdis_all_vacc_pos + shared->dim_out_time_from_last_dose + shared->dim_out_yll_all_pop + shared->dim_out_yll_all_unvacc + shared->dim_out_yll_all_vacc + shared->dim_out_yll_all_vacc_neg + shared->dim_out_yll_all_vacc_pos + shared->dim_R1 + shared->dim_R12 + shared->dim_R13 + shared->dim_R14 + shared->dim_R2 + shared->dim_R23 + shared->dim_R24 + shared->dim_R3 + shared->dim_R34 + shared->dim_R4 + shared->dim_S + shared->dim_VE_seroneg1n + shared->dim_VE_seroneg1p + 47;
  shared->offset_variable_I143 = shared->dim_cum_infection_pri + shared->dim_cum_infection_priV + shared->dim_cum_infection_sec + shared->dim_cum_infection_secV + shared->dim_cum_infection_tq + shared->dim_cum_infection_tqV + shared->dim_I1 + shared->dim_I12 + shared->dim_I123 + shared->dim_I13 + shared->dim_I132 + shared->dim_I14 + shared->dim_I142 + shared->dim_I2 + shared->dim_I21 + shared->dim_I23 + shared->dim_I231 + shared->dim_I24 + shared->dim_I241 + shared->dim_I3 + shared->dim_I31 + shared->dim_I32 + shared->dim_I34 + shared->dim_I341 + shared->dim_I342 + shared->dim_I4 + shared->dim_I41 + shared->dim_I42 + shared->dim_I43 + shared->dim_Ntotal_out + shared->dim_out_dis_all_pop + shared->dim_out_dis_all_unvacc + shared->dim_out_dis_all_vacc + shared->dim_out_dis_all_vacc_neg + shared->dim_out_dis_all_vacc_pos + shared->dim_out_disc_dis_all_pop + shared->dim_out_disc_dis_all_vacc + shared->dim_out_disc_nvacc_all_pop + shared->dim_out_disc_sdis_all_pop + shared->dim_out_disc_sdis_all_vacc + shared->dim_out_disc_yll_all_pop + shared->dim_out_disc_yll_all_vacc + shared->dim_out_nvacc_all_neg + shared->dim_out_nvacc_all_pop + shared->dim_out_nvacc_all_pos + shared->dim_out_prop_seroneg_at_9 + shared->dim_out_prop_seroneg_at_vca + shared->dim_out_sdis_all_pop + shared->dim_out_sdis_all_unvacc + shared->dim_out_sdis_all_vacc + shared->dim_out_sdis_all_vacc_neg + shared->dim_out_sdis_all_vacc_pos + shared->dim_out_time_from_last_dose + shared->dim_out_yll_all_pop + shared->dim_out_yll_all_unvacc + shared->dim_out_yll_all_vacc + shared->dim_out_yll_all_vacc_neg + shared->dim_out_yll_all_vacc_pos + shared->dim_R1 + shared->dim_R12 + shared->dim_R13 + shared->dim_R14 + shared->dim_R2 + shared->dim_R23 + shared->dim_R24 + shared->dim_R3 + shared->dim_R34 + shared->dim_R4 + shared->dim_S + shared->dim_VE_seroneg1n + shared->dim_VE_seroneg1p + 47;
  shared->offset_variable_I2 = shared->dim_cum_infection_pri + shared->dim_cum_infection_priV + shared->dim_cum_infection_sec + shared->dim_cum_infection_secV + shared->dim_cum_infection_tq + shared->dim_cum_infection_tqV + shared->dim_I1 + shared->dim_Ntotal_out + shared->dim_out_dis_all_pop + shared->dim_out_dis_all_unvacc + shared->dim_out_dis_all_vacc + shared->dim_out_dis_all_vacc_neg + shared->dim_out_dis_all_vacc_pos + shared->dim_out_disc_dis_all_pop + shared->dim_out_disc_dis_all_vacc + shared->dim_out_disc_nvacc_all_pop + shared->dim_out_disc_sdis_all_pop + shared->dim_out_disc_sdis_all_vacc + shared->dim_out_disc_yll_all_pop + shared->dim_out_disc_yll_all_vacc + shared->dim_out_nvacc_all_neg + shared->dim_out_nvacc_all_pop + shared->dim_out_nvacc_all_pos + shared->dim_out_prop_seroneg_at_9 + shared->dim_out_prop_seroneg_at_vca + shared->dim_out_sdis_all_pop + shared->dim_out_sdis_all_unvacc + shared->dim_out_sdis_all_vacc + shared->dim_out_sdis_all_vacc_neg + shared->dim_out_sdis_all_vacc_pos + shared->dim_out_time_from_last_dose + shared->dim_out_yll_all_pop + shared->dim_out_yll_all_unvacc + shared->dim_out_yll_all_vacc + shared->dim_out_yll_all_vacc_neg + shared->dim_out_yll_all_vacc_pos + shared->dim_S + shared->dim_VE_seroneg1n + shared->dim_VE_seroneg1p + 47;
  shared->offset_variable_I21 = shared->dim_cum_infection_pri + shared->dim_cum_infection_priV + shared->dim_cum_infection_sec + shared->dim_cum_infection_secV + shared->dim_cum_infection_tq + shared->dim_cum_infection_tqV + shared->dim_I1 + shared->dim_I2 + shared->dim_I3 + shared->dim_I4 + shared->dim_Ntotal_out + shared->dim_out_dis_all_pop + shared->dim_out_dis_all_unvacc + shared->dim_out_dis_all_vacc + shared->dim_out_dis_all_vacc_neg + shared->dim_out_dis_all_vacc_pos + shared->dim_out_disc_dis_all_pop + shared->dim_out_disc_dis_all_vacc + shared->dim_out_disc_nvacc_all_pop + shared->dim_out_disc_sdis_all_pop + shared->dim_out_disc_sdis_all_vacc + shared->dim_out_disc_yll_all_pop + shared->dim_out_disc_yll_all_vacc + shared->dim_out_nvacc_all_neg + shared->dim_out_nvacc_all_pop + shared->dim_out_nvacc_all_pos + shared->dim_out_prop_seroneg_at_9 + shared->dim_out_prop_seroneg_at_vca + shared->dim_out_sdis_all_pop + shared->dim_out_sdis_all_unvacc + shared->dim_out_sdis_all_vacc + shared->dim_out_sdis_all_vacc_neg + shared->dim_out_sdis_all_vacc_pos + shared->dim_out_time_from_last_dose + shared->dim_out_yll_all_pop + shared->dim_out_yll_all_unvacc + shared->dim_out_yll_all_vacc + shared->dim_out_yll_all_vacc_neg + shared->dim_out_yll_all_vacc_pos + shared->dim_R1 + shared->dim_R2 + shared->dim_R3 + shared->dim_R4 + shared->dim_S + shared->dim_VE_seroneg1n + shared->dim_VE_seroneg1p + 47;
  shared->offset_variable_I23 = shared->dim_cum_infection_pri + shared->dim_cum_infection_priV + shared->dim_cum_infection_sec + shared->dim_cum_infection_secV + shared->dim_cum_infection_tq + shared->dim_cum_infection_tqV + shared->dim_I1 + shared->dim_I12 + shared->dim_I13 + shared->dim_I2 + shared->dim_I21 + shared->dim_I3 + shared->dim_I31 + shared->dim_I32 + shared->dim_I4 + shared->dim_I41 + shared->dim_I42 + shared->dim_Ntotal_out + shared->dim_out_dis_all_pop + shared->dim_out_dis_all_unvacc + shared->dim_out_dis_all_vacc + shared->dim_out_dis_all_vacc_neg + shared->dim_out_dis_all_vacc_pos + shared->dim_out_disc_dis_all_pop + shared->dim_out_disc_dis_all_vacc + shared->dim_out_disc_nvacc_all_pop + shared->dim_out_disc_sdis_all_pop + shared->dim_out_disc_sdis_all_vacc + shared->dim_out_disc_yll_all_pop + shared->dim_out_disc_yll_all_vacc + shared->dim_out_nvacc_all_neg + shared->dim_out_nvacc_all_pop + shared->dim_out_nvacc_all_pos + shared->dim_out_prop_seroneg_at_9 + shared->dim_out_prop_seroneg_at_vca + shared->dim_out_sdis_all_pop + shared->dim_out_sdis_all_unvacc + shared->dim_out_sdis_all_vacc + shared->dim_out_sdis_all_vacc_neg + shared->dim_out_sdis_all_vacc_pos + shared->dim_out_time_from_last_dose + shared->dim_out_yll_all_pop + shared->dim_out_yll_all_unvacc + shared->dim_out_yll_all_vacc + shared->dim_out_yll_all_vacc_neg + shared->dim_out_yll_all_vacc_pos + shared->dim_R1 + shared->dim_R2 + shared->dim_R3 + shared->dim_R4 + shared->dim_S + shared->dim_VE_seroneg1n + shared->dim_VE_seroneg1p + 47;
  shared->offset_variable_I231 = shared->dim_cum_infection_pri + shared->dim_cum_infection_priV + shared->dim_cum_infection_sec + shared->dim_cum_infection_secV + shared->dim_cum_infection_tq + shared->dim_cum_infection_tqV + shared->dim_I1 + shared->dim_I12 + shared->dim_I13 + shared->dim_I14 + shared->dim_I2 + shared->dim_I21 + shared->dim_I23 + shared->dim_I24 + shared->dim_I3 + shared->dim_I31 + shared->dim_I32 + shared->dim_I34 + shared->dim_I4 + shared->dim_I41 + shared->dim_I42 + shared->dim_I43 + shared->dim_Ntotal_out + shared->dim_out_dis_all_pop + shared->dim_out_dis_all_unvacc + shared->dim_out_dis_all_vacc + shared->dim_out_dis_all_vacc_neg + shared->dim_out_dis_all_vacc_pos + shared->dim_out_disc_dis_all_pop + shared->dim_out_disc_dis_all_vacc + shared->dim_out_disc_nvacc_all_pop + shared->dim_out_disc_sdis_all_pop + shared->dim_out_disc_sdis_all_vacc + shared->dim_out_disc_yll_all_pop + shared->dim_out_disc_yll_all_vacc + shared->dim_out_nvacc_all_neg + shared->dim_out_nvacc_all_pop + shared->dim_out_nvacc_all_pos + shared->dim_out_prop_seroneg_at_9 + shared->dim_out_prop_seroneg_at_vca + shared->dim_out_sdis_all_pop + shared->dim_out_sdis_all_unvacc + shared->dim_out_sdis_all_vacc + shared->dim_out_sdis_all_vacc_neg + shared->dim_out_sdis_all_vacc_pos + shared->dim_out_time_from_last_dose + shared->dim_out_yll_all_pop + shared->dim_out_yll_all_unvacc + shared->dim_out_yll_all_vacc + shared->dim_out_yll_all_vacc_neg + shared->dim_out_yll_all_vacc_pos + shared->dim_R1 + shared->dim_R12 + shared->dim_R13 + shared->dim_R14 + shared->dim_R2 + shared->dim_R23 + shared->dim_R24 + shared->dim_R3 + shared->dim_R34 + shared->dim_R4 + shared->dim_S + shared->dim_VE_seroneg1n + shared->dim_VE_seroneg1p + 47;
  shared->offset_variable_I234 = shared->dim_cum_infection_pri + shared->dim_cum_infection_priV + shared->dim_cum_infection_sec + shared->dim_cum_infection_secV + shared->dim_cum_infection_tq + shared->dim_cum_infection_tqV + shared->dim_I1 + shared->dim_I12 + shared->dim_I123 + shared->dim_I124 + shared->dim_I13 + shared->dim_I132 + shared->dim_I134 + shared->dim_I14 + shared->dim_I142 + shared->dim_I143 + shared->dim_I2 + shared->dim_I21 + shared->dim_I23 + shared->dim_I231 + shared->dim_I24 + shared->dim_I241 + shared->dim_I243 + shared->dim_I3 + shared->dim_I31 + shared->dim_I32 + shared->dim_I34 + shared->dim_I341 + shared->dim_I342 + shared->dim_I4 + shared->dim_I41 + shared->dim_I42 + shared->dim_I43 + shared->dim_Ntotal_out + shared->dim_out_dis_all_pop + shared->dim_out_dis_all_unvacc + shared->dim_out_dis_all_vacc + shared->dim_out_dis_all_vacc_neg + shared->dim_out_dis_all_vacc_pos + shared->dim_out_disc_dis_all_pop + shared->dim_out_disc_dis_all_vacc + shared->dim_out_disc_nvacc_all_pop + shared->dim_out_disc_sdis_all_pop + shared->dim_out_disc_sdis_all_vacc + shared->dim_out_disc_yll_all_pop + shared->dim_out_disc_yll_all_vacc + shared->dim_out_nvacc_all_neg + shared->dim_out_nvacc_all_pop + shared->dim_out_nvacc_all_pos + shared->dim_out_prop_seroneg_at_9 + shared->dim_out_prop_seroneg_at_vca + shared->dim_out_sdis_all_pop + shared->dim_out_sdis_all_unvacc + shared->dim_out_sdis_all_vacc + shared->dim_out_sdis_all_vacc_neg + shared->dim_out_sdis_all_vacc_pos + shared->dim_out_time_from_last_dose + shared->dim_out_yll_all_pop + shared->dim_out_yll_all_unvacc + shared->dim_out_yll_all_vacc + shared->dim_out_yll_all_vacc_neg + shared->dim_out_yll_all_vacc_pos + shared->dim_R1 + shared->dim_R12 + shared->dim_R13 + shared->dim_R14 + shared->dim_R2 + shared->dim_R23 + shared->dim_R24 + shared->dim_R3 + shared->dim_R34 + shared->dim_R4 + shared->dim_S + shared->dim_VE_seroneg1n + shared->dim_VE_seroneg1p + 47;
  shared->offset_variable_I2341 = shared->dim_cum_infection_pri + shared->dim_cum_infection_priV + shared->dim_cum_infection_sec + shared->dim_cum_infection_secV + shared->dim_cum_infection_tq + shared->dim_cum_infection_tqV + shared->dim_I1 + shared->dim_I12 + shared->dim_I123 + shared->dim_I124 + shared->dim_I13 + shared->dim_I132 + shared->dim_I134 + shared->dim_I14 + shared->dim_I142 + shared->dim_I143 + shared->dim_I2 + shared->dim_I21 + shared->dim_I23 + shared->dim_I231 + shared->dim_I234 + shared->dim_I24 + shared->dim_I241 + shared->dim_I243 + shared->dim_I3 + shared->dim_I31 + shared->dim_I32 + shared->dim_I34 + shared->dim_I341 + shared->dim_I342 + shared->dim_I4 + shared->dim_I41 + shared->dim_I42 + shared->dim_I43 + shared->dim_Ntotal_out + shared->dim_out_dis_all_pop + shared->dim_out_dis_all_unvacc + shared->dim_out_dis_all_vacc + shared->dim_out_dis_all_vacc_neg + shared->dim_out_dis_all_vacc_pos + shared->dim_out_disc_dis_all_pop + shared->dim_out_disc_dis_all_vacc + shared->dim_out_disc_nvacc_all_pop + shared->dim_out_disc_sdis_all_pop + shared->dim_out_disc_sdis_all_vacc + shared->dim_out_disc_yll_all_pop + shared->dim_out_disc_yll_all_vacc + shared->dim_out_nvacc_all_neg + shared->dim_out_nvacc_all_pop + shared->dim_out_nvacc_all_pos + shared->dim_out_prop_seroneg_at_9 + shared->dim_out_prop_seroneg_at_vca + shared->dim_out_sdis_all_pop + shared->dim_out_sdis_all_unvacc + shared->dim_out_sdis_all_vacc + shared->dim_out_sdis_all_vacc_neg + shared->dim_out_sdis_all_vacc_pos + shared->dim_out_time_from_last_dose + shared->dim_out_yll_all_pop + shared->dim_out_yll_all_unvacc + shared->dim_out_yll_all_vacc + shared->dim_out_yll_all_vacc_neg + shared->dim_out_yll_all_vacc_pos + shared->dim_R1 + shared->dim_R12 + shared->dim_R123 + shared->dim_R124 + shared->dim_R13 + shared->dim_R134 + shared->dim_R14 + shared->dim_R2 + shared->dim_R23 + shared->dim_R234 + shared->dim_R24 + shared->dim_R3 + shared->dim_R34 + shared->dim_R4 + shared->dim_S + shared->dim_VE_seroneg1n + shared->dim_VE_seroneg1p + 47;
  shared->offset_variable_I24 = shared->dim_cum_infection_pri + shared->dim_cum_infection_priV + shared->dim_cum_infection_sec + shared->dim_cum_infection_secV + shared->dim_cum_infection_tq + shared->dim_cum_infection_tqV + shared->dim_I1 + shared->dim_I12 + shared->dim_I13 + shared->dim_I14 + shared->dim_I2 + shared->dim_I21 + shared->dim_I23 + shared->dim_I3 + shared->dim_I31 + shared->dim_I32 + shared->dim_I4 + shared->dim_I41 + shared->dim_I42 + shared->dim_I43 + shared->dim_Ntotal_out + shared->dim_out_dis_all_pop + shared->dim_out_dis_all_unvacc + shared->dim_out_dis_all_vacc + shared->dim_out_dis_all_vacc_neg + shared->dim_out_dis_all_vacc_pos + shared->dim_out_disc_dis_all_pop + shared->dim_out_disc_dis_all_vacc + shared->dim_out_disc_nvacc_all_pop + shared->dim_out_disc_sdis_all_pop + shared->dim_out_disc_sdis_all_vacc + shared->dim_out_disc_yll_all_pop + shared->dim_out_disc_yll_all_vacc + shared->dim_out_nvacc_all_neg + shared->dim_out_nvacc_all_pop + shared->dim_out_nvacc_all_pos + shared->dim_out_prop_seroneg_at_9 + shared->dim_out_prop_seroneg_at_vca + shared->dim_out_sdis_all_pop + shared->dim_out_sdis_all_unvacc + shared->dim_out_sdis_all_vacc + shared->dim_out_sdis_all_vacc_neg + shared->dim_out_sdis_all_vacc_pos + shared->dim_out_time_from_last_dose + shared->dim_out_yll_all_pop + shared->dim_out_yll_all_unvacc + shared->dim_out_yll_all_vacc + shared->dim_out_yll_all_vacc_neg + shared->dim_out_yll_all_vacc_pos + shared->dim_R1 + shared->dim_R2 + shared->dim_R3 + shared->dim_R4 + shared->dim_S + shared->dim_VE_seroneg1n + shared->dim_VE_seroneg1p + 47;
  shared->offset_variable_I241 = shared->dim_cum_infection_pri + shared->dim_cum_infection_priV + shared->dim_cum_infection_sec + shared->dim_cum_infection_secV + shared->dim_cum_infection_tq + shared->dim_cum_infection_tqV + shared->dim_I1 + shared->dim_I12 + shared->dim_I13 + shared->dim_I14 + shared->dim_I2 + shared->dim_I21 + shared->dim_I23 + shared->dim_I231 + shared->dim_I24 + shared->dim_I3 + shared->dim_I31 + shared->dim_I32 + shared->dim_I34 + shared->dim_I4 + shared->dim_I41 + shared->dim_I42 + shared->dim_I43 + shared->dim_Ntotal_out + shared->dim_out_dis_all_pop + shared->dim_out_dis_all_unvacc + shared->dim_out_dis_all_vacc + shared->dim_out_dis_all_vacc_neg + shared->dim_out_dis_all_vacc_pos + shared->dim_out_disc_dis_all_pop + shared->dim_out_disc_dis_all_vacc + shared->dim_out_disc_nvacc_all_pop + shared->dim_out_disc_sdis_all_pop + shared->dim_out_disc_sdis_all_vacc + shared->dim_out_disc_yll_all_pop + shared->dim_out_disc_yll_all_vacc + shared->dim_out_nvacc_all_neg + shared->dim_out_nvacc_all_pop + shared->dim_out_nvacc_all_pos + shared->dim_out_prop_seroneg_at_9 + shared->dim_out_prop_seroneg_at_vca + shared->dim_out_sdis_all_pop + shared->dim_out_sdis_all_unvacc + shared->dim_out_sdis_all_vacc + shared->dim_out_sdis_all_vacc_neg + shared->dim_out_sdis_all_vacc_pos + shared->dim_out_time_from_last_dose + shared->dim_out_yll_all_pop + shared->dim_out_yll_all_unvacc + shared->dim_out_yll_all_vacc + shared->dim_out_yll_all_vacc_neg + shared->dim_out_yll_all_vacc_pos + shared->dim_R1 + shared->dim_R12 + shared->dim_R13 + shared->dim_R14 + shared->dim_R2 + shared->dim_R23 + shared->dim_R24 + shared->dim_R3 + shared->dim_R34 + shared->dim_R4 + shared->dim_S + shared->dim_VE_seroneg1n + shared->dim_VE_seroneg1p + 47;
  shared->offset_variable_I243 = shared->dim_cum_infection_pri + shared->dim_cum_infection_priV + shared->dim_cum_infection_sec + shared->dim_cum_infection_secV + shared->dim_cum_infection_tq + shared->dim_cum_infection_tqV + shared->dim_I1 + shared->dim_I12 + shared->dim_I123 + shared->dim_I13 + shared->dim_I132 + shared->dim_I14 + shared->dim_I142 + shared->dim_I143 + shared->dim_I2 + shared->dim_I21 + shared->dim_I23 + shared->dim_I231 + shared->dim_I24 + shared->dim_I241 + shared->dim_I3 + shared->dim_I31 + shared->dim_I32 + shared->dim_I34 + shared->dim_I341 + shared->dim_I342 + shared->dim_I4 + shared->dim_I41 + shared->dim_I42 + shared->dim_I43 + shared->dim_Ntotal_out + shared->dim_out_dis_all_pop + shared->dim_out_dis_all_unvacc + shared->dim_out_dis_all_vacc + shared->dim_out_dis_all_vacc_neg + shared->dim_out_dis_all_vacc_pos + shared->dim_out_disc_dis_all_pop + shared->dim_out_disc_dis_all_vacc + shared->dim_out_disc_nvacc_all_pop + shared->dim_out_disc_sdis_all_pop + shared->dim_out_disc_sdis_all_vacc + shared->dim_out_disc_yll_all_pop + shared->dim_out_disc_yll_all_vacc + shared->dim_out_nvacc_all_neg + shared->dim_out_nvacc_all_pop + shared->dim_out_nvacc_all_pos + shared->dim_out_prop_seroneg_at_9 + shared->dim_out_prop_seroneg_at_vca + shared->dim_out_sdis_all_pop + shared->dim_out_sdis_all_unvacc + shared->dim_out_sdis_all_vacc + shared->dim_out_sdis_all_vacc_neg + shared->dim_out_sdis_all_vacc_pos + shared->dim_out_time_from_last_dose + shared->dim_out_yll_all_pop + shared->dim_out_yll_all_unvacc + shared->dim_out_yll_all_vacc + shared->dim_out_yll_all_vacc_neg + shared->dim_out_yll_all_vacc_pos + shared->dim_R1 + shared->dim_R12 + shared->dim_R13 + shared->dim_R14 + shared->dim_R2 + shared->dim_R23 + shared->dim_R24 + shared->dim_R3 + shared->dim_R34 + shared->dim_R4 + shared->dim_S + shared->dim_VE_seroneg1n + shared->dim_VE_seroneg1p + 47;
  shared->offset_variable_I3 = shared->dim_cum_infection_pri + shared->dim_cum_infection_priV + shared->dim_cum_infection_sec + shared->dim_cum_infection_secV + shared->dim_cum_infection_tq + shared->dim_cum_infection_tqV + shared->dim_I1 + shared->dim_I2 + shared->dim_Ntotal_out + shared->dim_out_dis_all_pop + shared->dim_out_dis_all_unvacc + shared->dim_out_dis_all_vacc + shared->dim_out_dis_all_vacc_neg + shared->dim_out_dis_all_vacc_pos + shared->dim_out_disc_dis_all_pop + shared->dim_out_disc_dis_all_vacc + shared->dim_out_disc_nvacc_all_pop + shared->dim_out_disc_sdis_all_pop + shared->dim_out_disc_sdis_all_vacc + shared->dim_out_disc_yll_all_pop + shared->dim_out_disc_yll_all_vacc + shared->dim_out_nvacc_all_neg + shared->dim_out_nvacc_all_pop + shared->dim_out_nvacc_all_pos + shared->dim_out_prop_seroneg_at_9 + shared->dim_out_prop_seroneg_at_vca + shared->dim_out_sdis_all_pop + shared->dim_out_sdis_all_unvacc + shared->dim_out_sdis_all_vacc + shared->dim_out_sdis_all_vacc_neg + shared->dim_out_sdis_all_vacc_pos + shared->dim_out_time_from_last_dose + shared->dim_out_yll_all_pop + shared->dim_out_yll_all_unvacc + shared->dim_out_yll_all_vacc + shared->dim_out_yll_all_vacc_neg + shared->dim_out_yll_all_vacc_pos + shared->dim_S + shared->dim_VE_seroneg1n + shared->dim_VE_seroneg1p + 47;
  shared->offset_variable_I31 = shared->dim_cum_infection_pri + shared->dim_cum_infection_priV + shared->dim_cum_infection_sec + shared->dim_cum_infection_secV + shared->dim_cum_infection_tq + shared->dim_cum_infection_tqV + shared->dim_I1 + shared->dim_I2 + shared->dim_I21 + shared->dim_I3 + shared->dim_I4 + shared->dim_Ntotal_out + shared->dim_out_dis_all_pop + shared->dim_out_dis_all_unvacc + shared->dim_out_dis_all_vacc + shared->dim_out_dis_all_vacc_neg + shared->dim_out_dis_all_vacc_pos + shared->dim_out_disc_dis_all_pop + shared->dim_out_disc_dis_all_vacc + shared->dim_out_disc_nvacc_all_pop + shared->dim_out_disc_sdis_all_pop + shared->dim_out_disc_sdis_all_vacc + shared->dim_out_disc_yll_all_pop + shared->dim_out_disc_yll_all_vacc + shared->dim_out_nvacc_all_neg + shared->dim_out_nvacc_all_pop + shared->dim_out_nvacc_all_pos + shared->dim_out_prop_seroneg_at_9 + shared->dim_out_prop_seroneg_at_vca + shared->dim_out_sdis_all_pop + shared->dim_out_sdis_all_unvacc + shared->dim_out_sdis_all_vacc + shared->dim_out_sdis_all_vacc_neg + shared->dim_out_sdis_all_vacc_pos + shared->dim_out_time_from_last_dose + shared->dim_out_yll_all_pop + shared->dim_out_yll_all_unvacc + shared->dim_out_yll_all_vacc + shared->dim_out_yll_all_vacc_neg + shared->dim_out_yll_all_vacc_pos + shared->dim_R1 + shared->dim_R2 + shared->dim_R3 + shared->dim_R4 + shared->dim_S + shared->dim_VE_seroneg1n + shared->dim_VE_seroneg1p + 47;
  shared->offset_variable_I32 = shared->dim_cum_infection_pri + shared->dim_cum_infection_priV + shared->dim_cum_infection_sec + shared->dim_cum_infection_secV + shared->dim_cum_infection_tq + shared->dim_cum_infection_tqV + shared->dim_I1 + shared->dim_I12 + shared->dim_I2 + shared->dim_I21 + shared->dim_I3 + shared->dim_I31 + shared->dim_I4 + shared->dim_I41 + shared->dim_Ntotal_out + shared->dim_out_dis_all_pop + shared->dim_out_dis_all_unvacc + shared->dim_out_dis_all_vacc + shared->dim_out_dis_all_vacc_neg + shared->dim_out_dis_all_vacc_pos + shared->dim_out_disc_dis_all_pop + shared->dim_out_disc_dis_all_vacc + shared->dim_out_disc_nvacc_all_pop + shared->dim_out_disc_sdis_all_pop + shared->dim_out_disc_sdis_all_vacc + shared->dim_out_disc_yll_all_pop + shared->dim_out_disc_yll_all_vacc + shared->dim_out_nvacc_all_neg + shared->dim_out_nvacc_all_pop + shared->dim_out_nvacc_all_pos + shared->dim_out_prop_seroneg_at_9 + shared->dim_out_prop_seroneg_at_vca + shared->dim_out_sdis_all_pop + shared->dim_out_sdis_all_unvacc + shared->dim_out_sdis_all_vacc + shared->dim_out_sdis_all_vacc_neg + shared->dim_out_sdis_all_vacc_pos + shared->dim_out_time_from_last_dose + shared->dim_out_yll_all_pop + shared->dim_out_yll_all_unvacc + shared->dim_out_yll_all_vacc + shared->dim_out_yll_all_vacc_neg + shared->dim_out_yll_all_vacc_pos + shared->dim_R1 + shared->dim_R2 + shared->dim_R3 + shared->dim_R4 + shared->dim_S + shared->dim_VE_seroneg1n + shared->dim_VE_seroneg1p + 47;
  shared->offset_variable_I34 = shared->dim_cum_infection_pri + shared->dim_cum_infection_priV + shared->dim_cum_infection_sec + shared->dim_cum_infection_secV + shared->dim_cum_infection_tq + shared->dim_cum_infection_tqV + shared->dim_I1 + shared->dim_I12 + shared->dim_I13 + shared->dim_I14 + shared->dim_I2 + shared->dim_I21 + shared->dim_I23 + shared->dim_I24 + shared->dim_I3 + shared->dim_I31 + shared->dim_I32 + shared->dim_I4 + shared->dim_I41 + shared->dim_I42 + shared->dim_I43 + shared->dim_Ntotal_out + shared->dim_out_dis_all_pop + shared->dim_out_dis_all_unvacc + shared->dim_out_dis_all_vacc + shared->dim_out_dis_all_vacc_neg + shared->dim_out_dis_all_vacc_pos + shared->dim_out_disc_dis_all_pop + shared->dim_out_disc_dis_all_vacc + shared->dim_out_disc_nvacc_all_pop + shared->dim_out_disc_sdis_all_pop + shared->dim_out_disc_sdis_all_vacc + shared->dim_out_disc_yll_all_pop + shared->dim_out_disc_yll_all_vacc + shared->dim_out_nvacc_all_neg + shared->dim_out_nvacc_all_pop + shared->dim_out_nvacc_all_pos + shared->dim_out_prop_seroneg_at_9 + shared->dim_out_prop_seroneg_at_vca + shared->dim_out_sdis_all_pop + shared->dim_out_sdis_all_unvacc + shared->dim_out_sdis_all_vacc + shared->dim_out_sdis_all_vacc_neg + shared->dim_out_sdis_all_vacc_pos + shared->dim_out_time_from_last_dose + shared->dim_out_yll_all_pop + shared->dim_out_yll_all_unvacc + shared->dim_out_yll_all_vacc + shared->dim_out_yll_all_vacc_neg + shared->dim_out_yll_all_vacc_pos + shared->dim_R1 + shared->dim_R2 + shared->dim_R3 + shared->dim_R4 + shared->dim_S + shared->dim_VE_seroneg1n + shared->dim_VE_seroneg1p + 47;
  shared->offset_variable_I341 = shared->dim_cum_infection_pri + shared->dim_cum_infection_priV + shared->dim_cum_infection_sec + shared->dim_cum_infection_secV + shared->dim_cum_infection_tq + shared->dim_cum_infection_tqV + shared->dim_I1 + shared->dim_I12 + shared->dim_I13 + shared->dim_I14 + shared->dim_I2 + shared->dim_I21 + shared->dim_I23 + shared->dim_I231 + shared->dim_I24 + shared->dim_I241 + shared->dim_I3 + shared->dim_I31 + shared->dim_I32 + shared->dim_I34 + shared->dim_I4 + shared->dim_I41 + shared->dim_I42 + shared->dim_I43 + shared->dim_Ntotal_out + shared->dim_out_dis_all_pop + shared->dim_out_dis_all_unvacc + shared->dim_out_dis_all_vacc + shared->dim_out_dis_all_vacc_neg + shared->dim_out_dis_all_vacc_pos + shared->dim_out_disc_dis_all_pop + shared->dim_out_disc_dis_all_vacc + shared->dim_out_disc_nvacc_all_pop + shared->dim_out_disc_sdis_all_pop + shared->dim_out_disc_sdis_all_vacc + shared->dim_out_disc_yll_all_pop + shared->dim_out_disc_yll_all_vacc + shared->dim_out_nvacc_all_neg + shared->dim_out_nvacc_all_pop + shared->dim_out_nvacc_all_pos + shared->dim_out_prop_seroneg_at_9 + shared->dim_out_prop_seroneg_at_vca + shared->dim_out_sdis_all_pop + shared->dim_out_sdis_all_unvacc + shared->dim_out_sdis_all_vacc + shared->dim_out_sdis_all_vacc_neg + shared->dim_out_sdis_all_vacc_pos + shared->dim_out_time_from_last_dose + shared->dim_out_yll_all_pop + shared->dim_out_yll_all_unvacc + shared->dim_out_yll_all_vacc + shared->dim_out_yll_all_vacc_neg + shared->dim_out_yll_all_vacc_pos + shared->dim_R1 + shared->dim_R12 + shared->dim_R13 + shared->dim_R14 + shared->dim_R2 + shared->dim_R23 + shared->dim_R24 + shared->dim_R3 + shared->dim_R34 + shared->dim_R4 + shared->dim_S + shared->dim_VE_seroneg1n + shared->dim_VE_seroneg1p + 47;
  shared->offset_variable_I342 = shared->dim_cum_infection_pri + shared->dim_cum_infection_priV + shared->dim_cum_infection_sec + shared->dim_cum_infection_secV + shared->dim_cum_infection_tq + shared->dim_cum_infection_tqV + shared->dim_I1 + shared->dim_I12 + shared->dim_I13 + shared->dim_I132 + shared->dim_I14 + shared->dim_I142 + shared->dim_I2 + shared->dim_I21 + shared->dim_I23 + shared->dim_I231 + shared->dim_I24 + shared->dim_I241 + shared->dim_I3 + shared->dim_I31 + shared->dim_I32 + shared->dim_I34 + shared->dim_I341 + shared->dim_I4 + shared->dim_I41 + shared->dim_I42 + shared->dim_I43 + shared->dim_Ntotal_out + shared->dim_out_dis_all_pop + shared->dim_out_dis_all_unvacc + shared->dim_out_dis_all_vacc + shared->dim_out_dis_all_vacc_neg + shared->dim_out_dis_all_vacc_pos + shared->dim_out_disc_dis_all_pop + shared->dim_out_disc_dis_all_vacc + shared->dim_out_disc_nvacc_all_pop + shared->dim_out_disc_sdis_all_pop + shared->dim_out_disc_sdis_all_vacc + shared->dim_out_disc_yll_all_pop + shared->dim_out_disc_yll_all_vacc + shared->dim_out_nvacc_all_neg + shared->dim_out_nvacc_all_pop + shared->dim_out_nvacc_all_pos + shared->dim_out_prop_seroneg_at_9 + shared->dim_out_prop_seroneg_at_vca + shared->dim_out_sdis_all_pop + shared->dim_out_sdis_all_unvacc + shared->dim_out_sdis_all_vacc + shared->dim_out_sdis_all_vacc_neg + shared->dim_out_sdis_all_vacc_pos + shared->dim_out_time_from_last_dose + shared->dim_out_yll_all_pop + shared->dim_out_yll_all_unvacc + shared->dim_out_yll_all_vacc + shared->dim_out_yll_all_vacc_neg + shared->dim_out_yll_all_vacc_pos + shared->dim_R1 + shared->dim_R12 + shared->dim_R13 + shared->dim_R14 + shared->dim_R2 + shared->dim_R23 + shared->dim_R24 + shared->dim_R3 + shared->dim_R34 + shared->dim_R4 + shared->dim_S + shared->dim_VE_seroneg1n + shared->dim_VE_seroneg1p + 47;
  shared->offset_variable_I4 = shared->dim_cum_infection_pri + shared->dim_cum_infection_priV + shared->dim_cum_infection_sec + shared->dim_cum_infection_secV + shared->dim_cum_infection_tq + shared->dim_cum_infection_tqV + shared->dim_I1 + shared->dim_I2 + shared->dim_I3 + shared->dim_Ntotal_out + shared->dim_out_dis_all_pop + shared->dim_out_dis_all_unvacc + shared->dim_out_dis_all_vacc + shared->dim_out_dis_all_vacc_neg + shared->dim_out_dis_all_vacc_pos + shared->dim_out_disc_dis_all_pop + shared->dim_out_disc_dis_all_vacc + shared->dim_out_disc_nvacc_all_pop + shared->dim_out_disc_sdis_all_pop + shared->dim_out_disc_sdis_all_vacc + shared->dim_out_disc_yll_all_pop + shared->dim_out_disc_yll_all_vacc + shared->dim_out_nvacc_all_neg + shared->dim_out_nvacc_all_pop + shared->dim_out_nvacc_all_pos + shared->dim_out_prop_seroneg_at_9 + shared->dim_out_prop_seroneg_at_vca + shared->dim_out_sdis_all_pop + shared->dim_out_sdis_all_unvacc + shared->dim_out_sdis_all_vacc + shared->dim_out_sdis_all_vacc_neg + shared->dim_out_sdis_all_vacc_pos + shared->dim_out_time_from_last_dose + shared->dim_out_yll_all_pop + shared->dim_out_yll_all_unvacc + shared->dim_out_yll_all_vacc + shared->dim_out_yll_all_vacc_neg + shared->dim_out_yll_all_vacc_pos + shared->dim_S + shared->dim_VE_seroneg1n + shared->dim_VE_seroneg1p + 47;
  shared->offset_variable_I41 = shared->dim_cum_infection_pri + shared->dim_cum_infection_priV + shared->dim_cum_infection_sec + shared->dim_cum_infection_secV + shared->dim_cum_infection_tq + shared->dim_cum_infection_tqV + shared->dim_I1 + shared->dim_I2 + shared->dim_I21 + shared->dim_I3 + shared->dim_I31 + shared->dim_I4 + shared->dim_Ntotal_out + shared->dim_out_dis_all_pop + shared->dim_out_dis_all_unvacc + shared->dim_out_dis_all_vacc + shared->dim_out_dis_all_vacc_neg + shared->dim_out_dis_all_vacc_pos + shared->dim_out_disc_dis_all_pop + shared->dim_out_disc_dis_all_vacc + shared->dim_out_disc_nvacc_all_pop + shared->dim_out_disc_sdis_all_pop + shared->dim_out_disc_sdis_all_vacc + shared->dim_out_disc_yll_all_pop + shared->dim_out_disc_yll_all_vacc + shared->dim_out_nvacc_all_neg + shared->dim_out_nvacc_all_pop + shared->dim_out_nvacc_all_pos + shared->dim_out_prop_seroneg_at_9 + shared->dim_out_prop_seroneg_at_vca + shared->dim_out_sdis_all_pop + shared->dim_out_sdis_all_unvacc + shared->dim_out_sdis_all_vacc + shared->dim_out_sdis_all_vacc_neg + shared->dim_out_sdis_all_vacc_pos + shared->dim_out_time_from_last_dose + shared->dim_out_yll_all_pop + shared->dim_out_yll_all_unvacc + shared->dim_out_yll_all_vacc + shared->dim_out_yll_all_vacc_neg + shared->dim_out_yll_all_vacc_pos + shared->dim_R1 + shared->dim_R2 + shared->dim_R3 + shared->dim_R4 + shared->dim_S + shared->dim_VE_seroneg1n + shared->dim_VE_seroneg1p + 47;
  shared->offset_variable_I42 = shared->dim_cum_infection_pri + shared->dim_cum_infection_priV + shared->dim_cum_infection_sec + shared->dim_cum_infection_secV + shared->dim_cum_infection_tq + shared->dim_cum_infection_tqV + shared->dim_I1 + shared->dim_I12 + shared->dim_I2 + shared->dim_I21 + shared->dim_I3 + shared->dim_I31 + shared->dim_I32 + shared->dim_I4 + shared->dim_I41 + shared->dim_Ntotal_out + shared->dim_out_dis_all_pop + shared->dim_out_dis_all_unvacc + shared->dim_out_dis_all_vacc + shared->dim_out_dis_all_vacc_neg + shared->dim_out_dis_all_vacc_pos + shared->dim_out_disc_dis_all_pop + shared->dim_out_disc_dis_all_vacc + shared->dim_out_disc_nvacc_all_pop + shared->dim_out_disc_sdis_all_pop + shared->dim_out_disc_sdis_all_vacc + shared->dim_out_disc_yll_all_pop + shared->dim_out_disc_yll_all_vacc + shared->dim_out_nvacc_all_neg + shared->dim_out_nvacc_all_pop + shared->dim_out_nvacc_all_pos + shared->dim_out_prop_seroneg_at_9 + shared->dim_out_prop_seroneg_at_vca + shared->dim_out_sdis_all_pop + shared->dim_out_sdis_all_unvacc + shared->dim_out_sdis_all_vacc + shared->dim_out_sdis_all_vacc_neg + shared->dim_out_sdis_all_vacc_pos + shared->dim_out_time_from_last_dose + shared->dim_out_yll_all_pop + shared->dim_out_yll_all_unvacc + shared->dim_out_yll_all_vacc + shared->dim_out_yll_all_vacc_neg + shared->dim_out_yll_all_vacc_pos + shared->dim_R1 + shared->dim_R2 + shared->dim_R3 + shared->dim_R4 + shared->dim_S + shared->dim_VE_seroneg1n + shared->dim_VE_seroneg1p + 47;
  shared->offset_variable_I43 = shared->dim_cum_infection_pri + shared->dim_cum_infection_priV + shared->dim_cum_infection_sec + shared->dim_cum_infection_secV + shared->dim_cum_infection_tq + shared->dim_cum_infection_tqV + shared->dim_I1 + shared->dim_I12 + shared->dim_I13 + shared->dim_I2 + shared->dim_I21 + shared->dim_I23 + shared->dim_I3 + shared->dim_I31 + shared->dim_I32 + shared->dim_I4 + shared->dim_I41 + shared->dim_I42 + shared->dim_Ntotal_out + shared->dim_out_dis_all_pop + shared->dim_out_dis_all_unvacc + shared->dim_out_dis_all_vacc + shared->dim_out_dis_all_vacc_neg + shared->dim_out_dis_all_vacc_pos + shared->dim_out_disc_dis_all_pop + shared->dim_out_disc_dis_all_vacc + shared->dim_out_disc_nvacc_all_pop + shared->dim_out_disc_sdis_all_pop + shared->dim_out_disc_sdis_all_vacc + shared->dim_out_disc_yll_all_pop + shared->dim_out_disc_yll_all_vacc + shared->dim_out_nvacc_all_neg + shared->dim_out_nvacc_all_pop + shared->dim_out_nvacc_all_pos + shared->dim_out_prop_seroneg_at_9 + shared->dim_out_prop_seroneg_at_vca + shared->dim_out_sdis_all_pop + shared->dim_out_sdis_all_unvacc + shared->dim_out_sdis_all_vacc + shared->dim_out_sdis_all_vacc_neg + shared->dim_out_sdis_all_vacc_pos + shared->dim_out_time_from_last_dose + shared->dim_out_yll_all_pop + shared->dim_out_yll_all_unvacc + shared->dim_out_yll_all_vacc + shared->dim_out_yll_all_vacc_neg + shared->dim_out_yll_all_vacc_pos + shared->dim_R1 + shared->dim_R2 + shared->dim_R3 + shared->dim_R4 + shared->dim_S + shared->dim_VE_seroneg1n + shared->dim_VE_seroneg1p + 47;
  shared->offset_variable_out_dis_sero_pop = shared->dim_cum_infection_pri + shared->dim_cum_infection_priV + shared->dim_cum_infection_sec + shared->dim_cum_infection_secV + shared->dim_cum_infection_tq + shared->dim_cum_infection_tqV + shared->dim_I1 + shared->dim_I12 + shared->dim_I123 + shared->dim_I1234 + shared->dim_I124 + shared->dim_I1243 + shared->dim_I13 + shared->dim_I132 + shared->dim_I134 + shared->dim_I1342 + shared->dim_I14 + shared->dim_I142 + shared->dim_I143 + shared->dim_I2 + shared->dim_I21 + shared->dim_I23 + shared->dim_I231 + shared->dim_I234 + shared->dim_I2341 + shared->dim_I24 + shared->dim_I241 + shared->dim_I243 + shared->dim_I3 + shared->dim_I31 + shared->dim_I32 + shared->dim_I34 + shared->dim_I341 + shared->dim_I342 + shared->dim_I4 + shared->dim_I41 + shared->dim_I42 + shared->dim_I43 + shared->dim_Ntotal_out + shared->dim_out_dis_all_pop + shared->dim_out_dis_all_unvacc + shared->dim_out_dis_all_vacc + shared->dim_out_dis_all_vacc_neg + shared->dim_out_dis_all_vacc_pos + shared->dim_out_disc_dis_all_pop + shared->dim_out_disc_dis_all_vacc + shared->dim_out_disc_nvacc_all_pop + shared->dim_out_disc_sdis_all_pop + shared->dim_out_disc_sdis_all_vacc + shared->dim_out_disc_yll_all_pop + shared->dim_out_disc_yll_all_vacc + shared->dim_out_nvacc_all_neg + shared->dim_out_nvacc_all_pop + shared->dim_out_nvacc_all_pos + shared->dim_out_prop_seroneg_at_9 + shared->dim_out_prop_seroneg_at_vca + shared->dim_out_sdis_all_pop + shared->dim_out_sdis_all_unvacc + shared->dim_out_sdis_all_vacc + shared->dim_out_sdis_all_vacc_neg + shared->dim_out_sdis_all_vacc_pos + shared->dim_out_time_from_last_dose + shared->dim_out_yll_all_pop + shared->dim_out_yll_all_unvacc + shared->dim_out_yll_all_vacc + shared->dim_out_yll_all_vacc_neg + shared->dim_out_yll_all_vacc_pos + shared->dim_R1 + shared->dim_R12 + shared->dim_R123 + shared->dim_R1234 + shared->dim_R124 + shared->dim_R13 + shared->dim_R134 + shared->dim_R14 + shared->dim_R2 + shared->dim_R23 + shared->dim_R234 + shared->dim_R24 + shared->dim_R3 + shared->dim_R34 + shared->dim_R4 + shared->dim_S + shared->dim_VE_seroneg1n + shared->dim_VE_seroneg1p + 47;
  shared->offset_variable_out_dis_sero_unvacc = shared->dim_cum_infection_pri + shared->dim_cum_infection_priV + shared->dim_cum_infection_sec + shared->dim_cum_infection_secV + shared->dim_cum_infection_tq + shared->dim_cum_infection_tqV + shared->dim_I1 + shared->dim_I12 + shared->dim_I123 + shared->dim_I1234 + shared->dim_I124 + shared->dim_I1243 + shared->dim_I13 + shared->dim_I132 + shared->dim_I134 + shared->dim_I1342 + shared->dim_I14 + shared->dim_I142 + shared->dim_I143 + shared->dim_I2 + shared->dim_I21 + shared->dim_I23 + shared->dim_I231 + shared->dim_I234 + shared->dim_I2341 + shared->dim_I24 + shared->dim_I241 + shared->dim_I243 + shared->dim_I3 + shared->dim_I31 + shared->dim_I32 + shared->dim_I34 + shared->dim_I341 + shared->dim_I342 + shared->dim_I4 + shared->dim_I41 + shared->dim_I42 + shared->dim_I43 + shared->dim_Ntotal_out + shared->dim_out_dis_all_pop + shared->dim_out_dis_all_unvacc + shared->dim_out_dis_all_vacc + shared->dim_out_dis_all_vacc_neg + shared->dim_out_dis_all_vacc_pos + shared->dim_out_dis_sero_pop + shared->dim_out_disc_dis_all_pop + shared->dim_out_disc_dis_all_vacc + shared->dim_out_disc_nvacc_all_pop + shared->dim_out_disc_sdis_all_pop + shared->dim_out_disc_sdis_all_vacc + shared->dim_out_disc_yll_all_pop + shared->dim_out_disc_yll_all_vacc + shared->dim_out_nvacc_all_neg + shared->dim_out_nvacc_all_pop + shared->dim_out_nvacc_all_pos + shared->dim_out_prop_seroneg_at_9 + shared->dim_out_prop_seroneg_at_vca + shared->dim_out_sdis_all_pop + shared->dim_out_sdis_all_unvacc + shared->dim_out_sdis_all_vacc + shared->dim_out_sdis_all_vacc_neg + shared->dim_out_sdis_all_vacc_pos + shared->dim_out_time_from_last_dose + shared->dim_out_yll_all_pop + shared->dim_out_yll_all_unvacc + shared->dim_out_yll_all_vacc + shared->dim_out_yll_all_vacc_neg + shared->dim_out_yll_all_vacc_pos + shared->dim_R1 + shared->dim_R12 + shared->dim_R123 + shared->dim_R1234 + shared->dim_R124 + shared->dim_R13 + shared->dim_R134 + shared->dim_R14 + shared->dim_R2 + shared->dim_R23 + shared->dim_R234 + shared->dim_R24 + shared->dim_R3 + shared->dim_R34 + shared->dim_R4 + shared->dim_S + shared->dim_VE_seroneg1n + shared->dim_VE_seroneg1p + 47;
  shared->offset_variable_out_dis_sero_vacc = shared->dim_cum_infection_pri + shared->dim_cum_infection_priV + shared->dim_cum_infection_sec + shared->dim_cum_infection_secV + shared->dim_cum_infection_tq + shared->dim_cum_infection_tqV + shared->dim_I1 + shared->dim_I12 + shared->dim_I123 + shared->dim_I1234 + shared->dim_I124 + shared->dim_I1243 + shared->dim_I13 + shared->dim_I132 + shared->dim_I134 + shared->dim_I1342 + shared->dim_I14 + shared->dim_I142 + shared->dim_I143 + shared->dim_I2 + shared->dim_I21 + shared->dim_I23 + shared->dim_I231 + shared->dim_I234 + shared->dim_I2341 + shared->dim_I24 + shared->dim_I241 + shared->dim_I243 + shared->dim_I3 + shared->dim_I31 + shared->dim_I32 + shared->dim_I34 + shared->dim_I341 + shared->dim_I342 + shared->dim_I4 + shared->dim_I41 + shared->dim_I42 + shared->dim_I43 + shared->dim_Ntotal_out + shared->dim_out_dis_all_pop + shared->dim_out_dis_all_unvacc + shared->dim_out_dis_all_vacc + shared->dim_out_dis_all_vacc_neg + shared->dim_out_dis_all_vacc_pos + shared->dim_out_dis_sero_pop + shared->dim_out_dis_sero_unvacc + shared->dim_out_disc_dis_all_pop + shared->dim_out_disc_dis_all_vacc + shared->dim_out_disc_nvacc_all_pop + shared->dim_out_disc_sdis_all_pop + shared->dim_out_disc_sdis_all_vacc + shared->dim_out_disc_yll_all_pop + shared->dim_out_disc_yll_all_vacc + shared->dim_out_nvacc_all_neg + shared->dim_out_nvacc_all_pop + shared->dim_out_nvacc_all_pos + shared->dim_out_prop_seroneg_at_9 + shared->dim_out_prop_seroneg_at_vca + shared->dim_out_sdis_all_pop + shared->dim_out_sdis_all_unvacc + shared->dim_out_sdis_all_vacc + shared->dim_out_sdis_all_vacc_neg + shared->dim_out_sdis_all_vacc_pos + shared->dim_out_time_from_last_dose + shared->dim_out_yll_all_pop + shared->dim_out_yll_all_unvacc + shared->dim_out_yll_all_vacc + shared->dim_out_yll_all_vacc_neg + shared->dim_out_yll_all_vacc_pos + shared->dim_R1 + shared->dim_R12 + shared->dim_R123 + shared->dim_R1234 + shared->dim_R124 + shared->dim_R13 + shared->dim_R134 + shared->dim_R14 + shared->dim_R2 + shared->dim_R23 + shared->dim_R234 + shared->dim_R24 + shared->dim_R3 + shared->dim_R34 + shared->dim_R4 + shared->dim_S + shared->dim_VE_seroneg1n + shared->dim_VE_seroneg1p + 47;
  shared->offset_variable_out_dis_sero_vacc_neg = shared->dim_cum_infection_pri + shared->dim_cum_infection_priV + shared->dim_cum_infection_sec + shared->dim_cum_infection_secV + shared->dim_cum_infection_tq + shared->dim_cum_infection_tqV + shared->dim_I1 + shared->dim_I12 + shared->dim_I123 + shared->dim_I1234 + shared->dim_I124 + shared->dim_I1243 + shared->dim_I13 + shared->dim_I132 + shared->dim_I134 + shared->dim_I1342 + shared->dim_I14 + shared->dim_I142 + shared->dim_I143 + shared->dim_I2 + shared->dim_I21 + shared->dim_I23 + shared->dim_I231 + shared->dim_I234 + shared->dim_I2341 + shared->dim_I24 + shared->dim_I241 + shared->dim_I243 + shared->dim_I3 + shared->dim_I31 + shared->dim_I32 + shared->dim_I34 + shared->dim_I341 + shared->dim_I342 + shared->dim_I4 + shared->dim_I41 + shared->dim_I42 + shared->dim_I43 + shared->dim_Ntotal_out + shared->dim_out_dis_all_pop + shared->dim_out_dis_all_unvacc + shared->dim_out_dis_all_vacc + shared->dim_out_dis_all_vacc_neg + shared->dim_out_dis_all_vacc_pos + shared->dim_out_dis_sero_pop + shared->dim_out_dis_sero_unvacc + shared->dim_out_dis_sero_vacc + shared->dim_out_disc_dis_all_pop + shared->dim_out_disc_dis_all_vacc + shared->dim_out_disc_nvacc_all_pop + shared->dim_out_disc_sdis_all_pop + shared->dim_out_disc_sdis_all_vacc + shared->dim_out_disc_yll_all_pop + shared->dim_out_disc_yll_all_vacc + shared->dim_out_nvacc_all_neg + shared->dim_out_nvacc_all_pop + shared->dim_out_nvacc_all_pos + shared->dim_out_prop_seroneg_at_9 + shared->dim_out_prop_seroneg_at_vca + shared->dim_out_sdis_all_pop + shared->dim_out_sdis_all_unvacc + shared->dim_out_sdis_all_vacc + shared->dim_out_sdis_all_vacc_neg + shared->dim_out_sdis_all_vacc_pos + shared->dim_out_time_from_last_dose + shared->dim_out_yll_all_pop + shared->dim_out_yll_all_unvacc + shared->dim_out_yll_all_vacc + shared->dim_out_yll_all_vacc_neg + shared->dim_out_yll_all_vacc_pos + shared->dim_R1 + shared->dim_R12 + shared->dim_R123 + shared->dim_R1234 + shared->dim_R124 + shared->dim_R13 + shared->dim_R134 + shared->dim_R14 + shared->dim_R2 + shared->dim_R23 + shared->dim_R234 + shared->dim_R24 + shared->dim_R3 + shared->dim_R34 + shared->dim_R4 + shared->dim_S + shared->dim_VE_seroneg1n + shared->dim_VE_seroneg1p + 47;
  shared->offset_variable_out_dis_sero_vacc_pos = shared->dim_cum_infection_pri + shared->dim_cum_infection_priV + shared->dim_cum_infection_sec + shared->dim_cum_infection_secV + shared->dim_cum_infection_tq + shared->dim_cum_infection_tqV + shared->dim_I1 + shared->dim_I12 + shared->dim_I123 + shared->dim_I1234 + shared->dim_I124 + shared->dim_I1243 + shared->dim_I13 + shared->dim_I132 + shared->dim_I134 + shared->dim_I1342 + shared->dim_I14 + shared->dim_I142 + shared->dim_I143 + shared->dim_I2 + shared->dim_I21 + shared->dim_I23 + shared->dim_I231 + shared->dim_I234 + shared->dim_I2341 + shared->dim_I24 + shared->dim_I241 + shared->dim_I243 + shared->dim_I3 + shared->dim_I31 + shared->dim_I32 + shared->dim_I34 + shared->dim_I341 + shared->dim_I342 + shared->dim_I4 + shared->dim_I41 + shared->dim_I42 + shared->dim_I43 + shared->dim_Ntotal_out + shared->dim_out_dis_all_pop + shared->dim_out_dis_all_unvacc + shared->dim_out_dis_all_vacc + shared->dim_out_dis_all_vacc_neg + shared->dim_out_dis_all_vacc_pos + shared->dim_out_dis_sero_pop + shared->dim_out_dis_sero_unvacc + shared->dim_out_dis_sero_vacc + shared->dim_out_dis_sero_vacc_neg + shared->dim_out_disc_dis_all_pop + shared->dim_out_disc_dis_all_vacc + shared->dim_out_disc_nvacc_all_pop + shared->dim_out_disc_sdis_all_pop + shared->dim_out_disc_sdis_all_vacc + shared->dim_out_disc_yll_all_pop + shared->dim_out_disc_yll_all_vacc + shared->dim_out_nvacc_all_neg + shared->dim_out_nvacc_all_pop + shared->dim_out_nvacc_all_pos + shared->dim_out_prop_seroneg_at_9 + shared->dim_out_prop_seroneg_at_vca + shared->dim_out_sdis_all_pop + shared->dim_out_sdis_all_unvacc + shared->dim_out_sdis_all_vacc + shared->dim_out_sdis_all_vacc_neg + shared->dim_out_sdis_all_vacc_pos + shared->dim_out_time_from_last_dose + shared->dim_out_yll_all_pop + shared->dim_out_yll_all_unvacc + shared->dim_out_yll_all_vacc + shared->dim_out_yll_all_vacc_neg + shared->dim_out_yll_all_vacc_pos + shared->dim_R1 + shared->dim_R12 + shared->dim_R123 + shared->dim_R1234 + shared->dim_R124 + shared->dim_R13 + shared->dim_R134 + shared->dim_R14 + shared->dim_R2 + shared->dim_R23 + shared->dim_R234 + shared->dim_R24 + shared->dim_R3 + shared->dim_R34 + shared->dim_R4 + shared->dim_S + shared->dim_VE_seroneg1n + shared->dim_VE_seroneg1p + 47;
  shared->offset_variable_out_nc = shared->dim_cum_infection_pri + shared->dim_cum_infection_priV + shared->dim_cum_infection_sec + shared->dim_cum_infection_secV + shared->dim_cum_infection_tq + shared->dim_cum_infection_tqV + shared->dim_I1 + shared->dim_I12 + shared->dim_I123 + shared->dim_I1234 + shared->dim_I124 + shared->dim_I1243 + shared->dim_I13 + shared->dim_I132 + shared->dim_I134 + shared->dim_I1342 + shared->dim_I14 + shared->dim_I142 + shared->dim_I143 + shared->dim_I2 + shared->dim_I21 + shared->dim_I23 + shared->dim_I231 + shared->dim_I234 + shared->dim_I2341 + shared->dim_I24 + shared->dim_I241 + shared->dim_I243 + shared->dim_I3 + shared->dim_I31 + shared->dim_I32 + shared->dim_I34 + shared->dim_I341 + shared->dim_I342 + shared->dim_I4 + shared->dim_I41 + shared->dim_I42 + shared->dim_I43 + shared->dim_Ntotal_out + shared->dim_out_dis_all_pop + shared->dim_out_dis_all_unvacc + shared->dim_out_dis_all_vacc + shared->dim_out_dis_all_vacc_neg + shared->dim_out_dis_all_vacc_pos + shared->dim_out_dis_sero_pop + shared->dim_out_dis_sero_unvacc + shared->dim_out_dis_sero_vacc + shared->dim_out_dis_sero_vacc_neg + shared->dim_out_dis_sero_vacc_pos + shared->dim_out_disc_dis_all_pop + shared->dim_out_disc_dis_all_vacc + shared->dim_out_disc_nvacc_all_pop + shared->dim_out_disc_sdis_all_pop + shared->dim_out_disc_sdis_all_vacc + shared->dim_out_disc_yll_all_pop + shared->dim_out_disc_yll_all_vacc + shared->dim_out_nvacc_all_neg + shared->dim_out_nvacc_all_pop + shared->dim_out_nvacc_all_pos + shared->dim_out_prop_seroneg_at_9 + shared->dim_out_prop_seroneg_at_vca + shared->dim_out_sdis_all_pop + shared->dim_out_sdis_all_unvacc + shared->dim_out_sdis_all_vacc + shared->dim_out_sdis_all_vacc_neg + shared->dim_out_sdis_all_vacc_pos + shared->dim_out_sdis_sero_pop + shared->dim_out_sdis_sero_unvacc + shared->dim_out_sdis_sero_vacc + shared->dim_out_sdis_sero_vacc_neg + shared->dim_out_sdis_sero_vacc_pos + shared->dim_out_time_from_last_dose + shared->dim_out_yll_all_pop + shared->dim_out_yll_all_unvacc + shared->dim_out_yll_all_vacc + shared->dim_out_yll_all_vacc_neg + shared->dim_out_yll_all_vacc_pos + shared->dim_out_yll_sero_pop + shared->dim_out_yll_sero_unvacc + shared->dim_out_yll_sero_vacc + shared->dim_out_yll_sero_vacc_neg + shared->dim_out_yll_sero_vacc_pos + shared->dim_R1 + shared->dim_R12 + shared->dim_R123 + shared->dim_R1234 + shared->dim_R124 + shared->dim_R13 + shared->dim_R134 + shared->dim_R14 + shared->dim_R2 + shared->dim_R23 + shared->dim_R234 + shared->dim_R24 + shared->dim_R3 + shared->dim_R34 + shared->dim_R4 + shared->dim_S + shared->dim_VE_seroneg1n + shared->dim_VE_seroneg1p + 47;
  shared->offset_variable_out_RR = shared->dim_cum_infection_pri + shared->dim_cum_infection_priV + shared->dim_cum_infection_sec + shared->dim_cum_infection_secV + shared->dim_cum_infection_tq + shared->dim_cum_infection_tqV + shared->dim_I1 + shared->dim_I12 + shared->dim_I123 + shared->dim_I1234 + shared->dim_I124 + shared->dim_I1243 + shared->dim_I13 + shared->dim_I132 + shared->dim_I134 + shared->dim_I1342 + shared->dim_I14 + shared->dim_I142 + shared->dim_I143 + shared->dim_I2 + shared->dim_I21 + shared->dim_I23 + shared->dim_I231 + shared->dim_I234 + shared->dim_I2341 + shared->dim_I24 + shared->dim_I241 + shared->dim_I243 + shared->dim_I3 + shared->dim_I31 + shared->dim_I32 + shared->dim_I34 + shared->dim_I341 + shared->dim_I342 + shared->dim_I4 + shared->dim_I41 + shared->dim_I42 + shared->dim_I43 + shared->dim_Ntotal_out + shared->dim_out_dis_all_pop + shared->dim_out_dis_all_unvacc + shared->dim_out_dis_all_vacc + shared->dim_out_dis_all_vacc_neg + shared->dim_out_dis_all_vacc_pos + shared->dim_out_dis_sero_pop + shared->dim_out_dis_sero_unvacc + shared->dim_out_dis_sero_vacc + shared->dim_out_dis_sero_vacc_neg + shared->dim_out_dis_sero_vacc_pos + shared->dim_out_disc_dis_all_pop + shared->dim_out_disc_dis_all_vacc + shared->dim_out_disc_nvacc_all_pop + shared->dim_out_disc_sdis_all_pop + shared->dim_out_disc_sdis_all_vacc + shared->dim_out_disc_yll_all_pop + shared->dim_out_disc_yll_all_vacc + shared->dim_out_nc + shared->dim_out_nvacc_all_neg + shared->dim_out_nvacc_all_pop + shared->dim_out_nvacc_all_pos + shared->dim_out_prop_seroneg_at_9 + shared->dim_out_prop_seroneg_at_vca + shared->dim_out_sdis_all_pop + shared->dim_out_sdis_all_unvacc + shared->dim_out_sdis_all_vacc + shared->dim_out_sdis_all_vacc_neg + shared->dim_out_sdis_all_vacc_pos + shared->dim_out_sdis_sero_pop + shared->dim_out_sdis_sero_unvacc + shared->dim_out_sdis_sero_vacc + shared->dim_out_sdis_sero_vacc_neg + shared->dim_out_sdis_sero_vacc_pos + shared->dim_out_time_from_last_dose + shared->dim_out_yll_all_pop + shared->dim_out_yll_all_unvacc + shared->dim_out_yll_all_vacc + shared->dim_out_yll_all_vacc_neg + shared->dim_out_yll_all_vacc_pos + shared->dim_out_yll_sero_pop + shared->dim_out_yll_sero_unvacc + shared->dim_out_yll_sero_vacc + shared->dim_out_yll_sero_vacc_neg + shared->dim_out_yll_sero_vacc_pos + shared->dim_R1 + shared->dim_R12 + shared->dim_R123 + shared->dim_R1234 + shared->dim_R124 + shared->dim_R13 + shared->dim_R134 + shared->dim_R14 + shared->dim_R2 + shared->dim_R23 + shared->dim_R234 + shared->dim_R24 + shared->dim_R3 + shared->dim_R34 + shared->dim_R4 + shared->dim_S + shared->dim_VE_seroneg1n + shared->dim_VE_seroneg1p + 47;
  shared->offset_variable_out_sdis_sero_pop = shared->dim_cum_infection_pri + shared->dim_cum_infection_priV + shared->dim_cum_infection_sec + shared->dim_cum_infection_secV + shared->dim_cum_infection_tq + shared->dim_cum_infection_tqV + shared->dim_I1 + shared->dim_I12 + shared->dim_I123 + shared->dim_I1234 + shared->dim_I124 + shared->dim_I1243 + shared->dim_I13 + shared->dim_I132 + shared->dim_I134 + shared->dim_I1342 + shared->dim_I14 + shared->dim_I142 + shared->dim_I143 + shared->dim_I2 + shared->dim_I21 + shared->dim_I23 + shared->dim_I231 + shared->dim_I234 + shared->dim_I2341 + shared->dim_I24 + shared->dim_I241 + shared->dim_I243 + shared->dim_I3 + shared->dim_I31 + shared->dim_I32 + shared->dim_I34 + shared->dim_I341 + shared->dim_I342 + shared->dim_I4 + shared->dim_I41 + shared->dim_I42 + shared->dim_I43 + shared->dim_Ntotal_out + shared->dim_out_dis_all_pop + shared->dim_out_dis_all_unvacc + shared->dim_out_dis_all_vacc + shared->dim_out_dis_all_vacc_neg + shared->dim_out_dis_all_vacc_pos + shared->dim_out_dis_sero_pop + shared->dim_out_dis_sero_unvacc + shared->dim_out_dis_sero_vacc + shared->dim_out_dis_sero_vacc_neg + shared->dim_out_dis_sero_vacc_pos + shared->dim_out_disc_dis_all_pop + shared->dim_out_disc_dis_all_vacc + shared->dim_out_disc_nvacc_all_pop + shared->dim_out_disc_sdis_all_pop + shared->dim_out_disc_sdis_all_vacc + shared->dim_out_disc_yll_all_pop + shared->dim_out_disc_yll_all_vacc + shared->dim_out_nvacc_all_neg + shared->dim_out_nvacc_all_pop + shared->dim_out_nvacc_all_pos + shared->dim_out_prop_seroneg_at_9 + shared->dim_out_prop_seroneg_at_vca + shared->dim_out_sdis_all_pop + shared->dim_out_sdis_all_unvacc + shared->dim_out_sdis_all_vacc + shared->dim_out_sdis_all_vacc_neg + shared->dim_out_sdis_all_vacc_pos + shared->dim_out_time_from_last_dose + shared->dim_out_yll_all_pop + shared->dim_out_yll_all_unvacc + shared->dim_out_yll_all_vacc + shared->dim_out_yll_all_vacc_neg + shared->dim_out_yll_all_vacc_pos + shared->dim_R1 + shared->dim_R12 + shared->dim_R123 + shared->dim_R1234 + shared->dim_R124 + shared->dim_R13 + shared->dim_R134 + shared->dim_R14 + shared->dim_R2 + shared->dim_R23 + shared->dim_R234 + shared->dim_R24 + shared->dim_R3 + shared->dim_R34 + shared->dim_R4 + shared->dim_S + shared->dim_VE_seroneg1n + shared->dim_VE_seroneg1p + 47;
  shared->offset_variable_out_sdis_sero_unvacc = shared->dim_cum_infection_pri + shared->dim_cum_infection_priV + shared->dim_cum_infection_sec + shared->dim_cum_infection_secV + shared->dim_cum_infection_tq + shared->dim_cum_infection_tqV + shared->dim_I1 + shared->dim_I12 + shared->dim_I123 + shared->dim_I1234 + shared->dim_I124 + shared->dim_I1243 + shared->dim_I13 + shared->dim_I132 + shared->dim_I134 + shared->dim_I1342 + shared->dim_I14 + shared->dim_I142 + shared->dim_I143 + shared->dim_I2 + shared->dim_I21 + shared->dim_I23 + shared->dim_I231 + shared->dim_I234 + shared->dim_I2341 + shared->dim_I24 + shared->dim_I241 + shared->dim_I243 + shared->dim_I3 + shared->dim_I31 + shared->dim_I32 + shared->dim_I34 + shared->dim_I341 + shared->dim_I342 + shared->dim_I4 + shared->dim_I41 + shared->dim_I42 + shared->dim_I43 + shared->dim_Ntotal_out + shared->dim_out_dis_all_pop + shared->dim_out_dis_all_unvacc + shared->dim_out_dis_all_vacc + shared->dim_out_dis_all_vacc_neg + shared->dim_out_dis_all_vacc_pos + shared->dim_out_dis_sero_pop + shared->dim_out_dis_sero_unvacc + shared->dim_out_dis_sero_vacc + shared->dim_out_dis_sero_vacc_neg + shared->dim_out_dis_sero_vacc_pos + shared->dim_out_disc_dis_all_pop + shared->dim_out_disc_dis_all_vacc + shared->dim_out_disc_nvacc_all_pop + shared->dim_out_disc_sdis_all_pop + shared->dim_out_disc_sdis_all_vacc + shared->dim_out_disc_yll_all_pop + shared->dim_out_disc_yll_all_vacc + shared->dim_out_nvacc_all_neg + shared->dim_out_nvacc_all_pop + shared->dim_out_nvacc_all_pos + shared->dim_out_prop_seroneg_at_9 + shared->dim_out_prop_seroneg_at_vca + shared->dim_out_sdis_all_pop + shared->dim_out_sdis_all_unvacc + shared->dim_out_sdis_all_vacc + shared->dim_out_sdis_all_vacc_neg + shared->dim_out_sdis_all_vacc_pos + shared->dim_out_sdis_sero_pop + shared->dim_out_time_from_last_dose + shared->dim_out_yll_all_pop + shared->dim_out_yll_all_unvacc + shared->dim_out_yll_all_vacc + shared->dim_out_yll_all_vacc_neg + shared->dim_out_yll_all_vacc_pos + shared->dim_R1 + shared->dim_R12 + shared->dim_R123 + shared->dim_R1234 + shared->dim_R124 + shared->dim_R13 + shared->dim_R134 + shared->dim_R14 + shared->dim_R2 + shared->dim_R23 + shared->dim_R234 + shared->dim_R24 + shared->dim_R3 + shared->dim_R34 + shared->dim_R4 + shared->dim_S + shared->dim_VE_seroneg1n + shared->dim_VE_seroneg1p + 47;
  shared->offset_variable_out_sdis_sero_vacc = shared->dim_cum_infection_pri + shared->dim_cum_infection_priV + shared->dim_cum_infection_sec + shared->dim_cum_infection_secV + shared->dim_cum_infection_tq + shared->dim_cum_infection_tqV + shared->dim_I1 + shared->dim_I12 + shared->dim_I123 + shared->dim_I1234 + shared->dim_I124 + shared->dim_I1243 + shared->dim_I13 + shared->dim_I132 + shared->dim_I134 + shared->dim_I1342 + shared->dim_I14 + shared->dim_I142 + shared->dim_I143 + shared->dim_I2 + shared->dim_I21 + shared->dim_I23 + shared->dim_I231 + shared->dim_I234 + shared->dim_I2341 + shared->dim_I24 + shared->dim_I241 + shared->dim_I243 + shared->dim_I3 + shared->dim_I31 + shared->dim_I32 + shared->dim_I34 + shared->dim_I341 + shared->dim_I342 + shared->dim_I4 + shared->dim_I41 + shared->dim_I42 + shared->dim_I43 + shared->dim_Ntotal_out + shared->dim_out_dis_all_pop + shared->dim_out_dis_all_unvacc + shared->dim_out_dis_all_vacc + shared->dim_out_dis_all_vacc_neg + shared->dim_out_dis_all_vacc_pos + shared->dim_out_dis_sero_pop + shared->dim_out_dis_sero_unvacc + shared->dim_out_dis_sero_vacc + shared->dim_out_dis_sero_vacc_neg + shared->dim_out_dis_sero_vacc_pos + shared->dim_out_disc_dis_all_pop + shared->dim_out_disc_dis_all_vacc + shared->dim_out_disc_nvacc_all_pop + shared->dim_out_disc_sdis_all_pop + shared->dim_out_disc_sdis_all_vacc + shared->dim_out_disc_yll_all_pop + shared->dim_out_disc_yll_all_vacc + shared->dim_out_nvacc_all_neg + shared->dim_out_nvacc_all_pop + shared->dim_out_nvacc_all_pos + shared->dim_out_prop_seroneg_at_9 + shared->dim_out_prop_seroneg_at_vca + shared->dim_out_sdis_all_pop + shared->dim_out_sdis_all_unvacc + shared->dim_out_sdis_all_vacc + shared->dim_out_sdis_all_vacc_neg + shared->dim_out_sdis_all_vacc_pos + shared->dim_out_sdis_sero_pop + shared->dim_out_sdis_sero_unvacc + shared->dim_out_time_from_last_dose + shared->dim_out_yll_all_pop + shared->dim_out_yll_all_unvacc + shared->dim_out_yll_all_vacc + shared->dim_out_yll_all_vacc_neg + shared->dim_out_yll_all_vacc_pos + shared->dim_R1 + shared->dim_R12 + shared->dim_R123 + shared->dim_R1234 + shared->dim_R124 + shared->dim_R13 + shared->dim_R134 + shared->dim_R14 + shared->dim_R2 + shared->dim_R23 + shared->dim_R234 + shared->dim_R24 + shared->dim_R3 + shared->dim_R34 + shared->dim_R4 + shared->dim_S + shared->dim_VE_seroneg1n + shared->dim_VE_seroneg1p + 47;
  shared->offset_variable_out_sdis_sero_vacc_neg = shared->dim_cum_infection_pri + shared->dim_cum_infection_priV + shared->dim_cum_infection_sec + shared->dim_cum_infection_secV + shared->dim_cum_infection_tq + shared->dim_cum_infection_tqV + shared->dim_I1 + shared->dim_I12 + shared->dim_I123 + shared->dim_I1234 + shared->dim_I124 + shared->dim_I1243 + shared->dim_I13 + shared->dim_I132 + shared->dim_I134 + shared->dim_I1342 + shared->dim_I14 + shared->dim_I142 + shared->dim_I143 + shared->dim_I2 + shared->dim_I21 + shared->dim_I23 + shared->dim_I231 + shared->dim_I234 + shared->dim_I2341 + shared->dim_I24 + shared->dim_I241 + shared->dim_I243 + shared->dim_I3 + shared->dim_I31 + shared->dim_I32 + shared->dim_I34 + shared->dim_I341 + shared->dim_I342 + shared->dim_I4 + shared->dim_I41 + shared->dim_I42 + shared->dim_I43 + shared->dim_Ntotal_out + shared->dim_out_dis_all_pop + shared->dim_out_dis_all_unvacc + shared->dim_out_dis_all_vacc + shared->dim_out_dis_all_vacc_neg + shared->dim_out_dis_all_vacc_pos + shared->dim_out_dis_sero_pop + shared->dim_out_dis_sero_unvacc + shared->dim_out_dis_sero_vacc + shared->dim_out_dis_sero_vacc_neg + shared->dim_out_dis_sero_vacc_pos + shared->dim_out_disc_dis_all_pop + shared->dim_out_disc_dis_all_vacc + shared->dim_out_disc_nvacc_all_pop + shared->dim_out_disc_sdis_all_pop + shared->dim_out_disc_sdis_all_vacc + shared->dim_out_disc_yll_all_pop + shared->dim_out_disc_yll_all_vacc + shared->dim_out_nvacc_all_neg + shared->dim_out_nvacc_all_pop + shared->dim_out_nvacc_all_pos + shared->dim_out_prop_seroneg_at_9 + shared->dim_out_prop_seroneg_at_vca + shared->dim_out_sdis_all_pop + shared->dim_out_sdis_all_unvacc + shared->dim_out_sdis_all_vacc + shared->dim_out_sdis_all_vacc_neg + shared->dim_out_sdis_all_vacc_pos + shared->dim_out_sdis_sero_pop + shared->dim_out_sdis_sero_unvacc + shared->dim_out_sdis_sero_vacc + shared->dim_out_time_from_last_dose + shared->dim_out_yll_all_pop + shared->dim_out_yll_all_unvacc + shared->dim_out_yll_all_vacc + shared->dim_out_yll_all_vacc_neg + shared->dim_out_yll_all_vacc_pos + shared->dim_R1 + shared->dim_R12 + shared->dim_R123 + shared->dim_R1234 + shared->dim_R124 + shared->dim_R13 + shared->dim_R134 + shared->dim_R14 + shared->dim_R2 + shared->dim_R23 + shared->dim_R234 + shared->dim_R24 + shared->dim_R3 + shared->dim_R34 + shared->dim_R4 + shared->dim_S + shared->dim_VE_seroneg1n + shared->dim_VE_seroneg1p + 47;
  shared->offset_variable_out_sdis_sero_vacc_pos = shared->dim_cum_infection_pri + shared->dim_cum_infection_priV + shared->dim_cum_infection_sec + shared->dim_cum_infection_secV + shared->dim_cum_infection_tq + shared->dim_cum_infection_tqV + shared->dim_I1 + shared->dim_I12 + shared->dim_I123 + shared->dim_I1234 + shared->dim_I124 + shared->dim_I1243 + shared->dim_I13 + shared->dim_I132 + shared->dim_I134 + shared->dim_I1342 + shared->dim_I14 + shared->dim_I142 + shared->dim_I143 + shared->dim_I2 + shared->dim_I21 + shared->dim_I23 + shared->dim_I231 + shared->dim_I234 + shared->dim_I2341 + shared->dim_I24 + shared->dim_I241 + shared->dim_I243 + shared->dim_I3 + shared->dim_I31 + shared->dim_I32 + shared->dim_I34 + shared->dim_I341 + shared->dim_I342 + shared->dim_I4 + shared->dim_I41 + shared->dim_I42 + shared->dim_I43 + shared->dim_Ntotal_out + shared->dim_out_dis_all_pop + shared->dim_out_dis_all_unvacc + shared->dim_out_dis_all_vacc + shared->dim_out_dis_all_vacc_neg + shared->dim_out_dis_all_vacc_pos + shared->dim_out_dis_sero_pop + shared->dim_out_dis_sero_unvacc + shared->dim_out_dis_sero_vacc + shared->dim_out_dis_sero_vacc_neg + shared->dim_out_dis_sero_vacc_pos + shared->dim_out_disc_dis_all_pop + shared->dim_out_disc_dis_all_vacc + shared->dim_out_disc_nvacc_all_pop + shared->dim_out_disc_sdis_all_pop + shared->dim_out_disc_sdis_all_vacc + shared->dim_out_disc_yll_all_pop + shared->dim_out_disc_yll_all_vacc + shared->dim_out_nvacc_all_neg + shared->dim_out_nvacc_all_pop + shared->dim_out_nvacc_all_pos + shared->dim_out_prop_seroneg_at_9 + shared->dim_out_prop_seroneg_at_vca + shared->dim_out_sdis_all_pop + shared->dim_out_sdis_all_unvacc + shared->dim_out_sdis_all_vacc + shared->dim_out_sdis_all_vacc_neg + shared->dim_out_sdis_all_vacc_pos + shared->dim_out_sdis_sero_pop + shared->dim_out_sdis_sero_unvacc + shared->dim_out_sdis_sero_vacc + shared->dim_out_sdis_sero_vacc_neg + shared->dim_out_time_from_last_dose + shared->dim_out_yll_all_pop + shared->dim_out_yll_all_unvacc + shared->dim_out_yll_all_vacc + shared->dim_out_yll_all_vacc_neg + shared->dim_out_yll_all_vacc_pos + shared->dim_R1 + shared->dim_R12 + shared->dim_R123 + shared->dim_R1234 + shared->dim_R124 + shared->dim_R13 + shared->dim_R134 + shared->dim_R14 + shared->dim_R2 + shared->dim_R23 + shared->dim_R234 + shared->dim_R24 + shared->dim_R3 + shared->dim_R34 + shared->dim_R4 + shared->dim_S + shared->dim_VE_seroneg1n + shared->dim_VE_seroneg1p + 47;
  shared->offset_variable_out_yll_sero_pop = shared->dim_cum_infection_pri + shared->dim_cum_infection_priV + shared->dim_cum_infection_sec + shared->dim_cum_infection_secV + shared->dim_cum_infection_tq + shared->dim_cum_infection_tqV + shared->dim_I1 + shared->dim_I12 + shared->dim_I123 + shared->dim_I1234 + shared->dim_I124 + shared->dim_I1243 + shared->dim_I13 + shared->dim_I132 + shared->dim_I134 + shared->dim_I1342 + shared->dim_I14 + shared->dim_I142 + shared->dim_I143 + shared->dim_I2 + shared->dim_I21 + shared->dim_I23 + shared->dim_I231 + shared->dim_I234 + shared->dim_I2341 + shared->dim_I24 + shared->dim_I241 + shared->dim_I243 + shared->dim_I3 + shared->dim_I31 + shared->dim_I32 + shared->dim_I34 + shared->dim_I341 + shared->dim_I342 + shared->dim_I4 + shared->dim_I41 + shared->dim_I42 + shared->dim_I43 + shared->dim_Ntotal_out + shared->dim_out_dis_all_pop + shared->dim_out_dis_all_unvacc + shared->dim_out_dis_all_vacc + shared->dim_out_dis_all_vacc_neg + shared->dim_out_dis_all_vacc_pos + shared->dim_out_dis_sero_pop + shared->dim_out_dis_sero_unvacc + shared->dim_out_dis_sero_vacc + shared->dim_out_dis_sero_vacc_neg + shared->dim_out_dis_sero_vacc_pos + shared->dim_out_disc_dis_all_pop + shared->dim_out_disc_dis_all_vacc + shared->dim_out_disc_nvacc_all_pop + shared->dim_out_disc_sdis_all_pop + shared->dim_out_disc_sdis_all_vacc + shared->dim_out_disc_yll_all_pop + shared->dim_out_disc_yll_all_vacc + shared->dim_out_nvacc_all_neg + shared->dim_out_nvacc_all_pop + shared->dim_out_nvacc_all_pos + shared->dim_out_prop_seroneg_at_9 + shared->dim_out_prop_seroneg_at_vca + shared->dim_out_sdis_all_pop + shared->dim_out_sdis_all_unvacc + shared->dim_out_sdis_all_vacc + shared->dim_out_sdis_all_vacc_neg + shared->dim_out_sdis_all_vacc_pos + shared->dim_out_sdis_sero_pop + shared->dim_out_sdis_sero_unvacc + shared->dim_out_sdis_sero_vacc + shared->dim_out_sdis_sero_vacc_neg + shared->dim_out_sdis_sero_vacc_pos + shared->dim_out_time_from_last_dose + shared->dim_out_yll_all_pop + shared->dim_out_yll_all_unvacc + shared->dim_out_yll_all_vacc + shared->dim_out_yll_all_vacc_neg + shared->dim_out_yll_all_vacc_pos + shared->dim_R1 + shared->dim_R12 + shared->dim_R123 + shared->dim_R1234 + shared->dim_R124 + shared->dim_R13 + shared->dim_R134 + shared->dim_R14 + shared->dim_R2 + shared->dim_R23 + shared->dim_R234 + shared->dim_R24 + shared->dim_R3 + shared->dim_R34 + shared->dim_R4 + shared->dim_S + shared->dim_VE_seroneg1n + shared->dim_VE_seroneg1p + 47;
  shared->offset_variable_out_yll_sero_unvacc = shared->dim_cum_infection_pri + shared->dim_cum_infection_priV + shared->dim_cum_infection_sec + shared->dim_cum_infection_secV + shared->dim_cum_infection_tq + shared->dim_cum_infection_tqV + shared->dim_I1 + shared->dim_I12 + shared->dim_I123 + shared->dim_I1234 + shared->dim_I124 + shared->dim_I1243 + shared->dim_I13 + shared->dim_I132 + shared->dim_I134 + shared->dim_I1342 + shared->dim_I14 + shared->dim_I142 + shared->dim_I143 + shared->dim_I2 + shared->dim_I21 + shared->dim_I23 + shared->dim_I231 + shared->dim_I234 + shared->dim_I2341 + shared->dim_I24 + shared->dim_I241 + shared->dim_I243 + shared->dim_I3 + shared->dim_I31 + shared->dim_I32 + shared->dim_I34 + shared->dim_I341 + shared->dim_I342 + shared->dim_I4 + shared->dim_I41 + shared->dim_I42 + shared->dim_I43 + shared->dim_Ntotal_out + shared->dim_out_dis_all_pop + shared->dim_out_dis_all_unvacc + shared->dim_out_dis_all_vacc + shared->dim_out_dis_all_vacc_neg + shared->dim_out_dis_all_vacc_pos + shared->dim_out_dis_sero_pop + shared->dim_out_dis_sero_unvacc + shared->dim_out_dis_sero_vacc + shared->dim_out_dis_sero_vacc_neg + shared->dim_out_dis_sero_vacc_pos + shared->dim_out_disc_dis_all_pop + shared->dim_out_disc_dis_all_vacc + shared->dim_out_disc_nvacc_all_pop + shared->dim_out_disc_sdis_all_pop + shared->dim_out_disc_sdis_all_vacc + shared->dim_out_disc_yll_all_pop + shared->dim_out_disc_yll_all_vacc + shared->dim_out_nvacc_all_neg + shared->dim_out_nvacc_all_pop + shared->dim_out_nvacc_all_pos + shared->dim_out_prop_seroneg_at_9 + shared->dim_out_prop_seroneg_at_vca + shared->dim_out_sdis_all_pop + shared->dim_out_sdis_all_unvacc + shared->dim_out_sdis_all_vacc + shared->dim_out_sdis_all_vacc_neg + shared->dim_out_sdis_all_vacc_pos + shared->dim_out_sdis_sero_pop + shared->dim_out_sdis_sero_unvacc + shared->dim_out_sdis_sero_vacc + shared->dim_out_sdis_sero_vacc_neg + shared->dim_out_sdis_sero_vacc_pos + shared->dim_out_time_from_last_dose + shared->dim_out_yll_all_pop + shared->dim_out_yll_all_unvacc + shared->dim_out_yll_all_vacc + shared->dim_out_yll_all_vacc_neg + shared->dim_out_yll_all_vacc_pos + shared->dim_out_yll_sero_pop + shared->dim_R1 + shared->dim_R12 + shared->dim_R123 + shared->dim_R1234 + shared->dim_R124 + shared->dim_R13 + shared->dim_R134 + shared->dim_R14 + shared->dim_R2 + shared->dim_R23 + shared->dim_R234 + shared->dim_R24 + shared->dim_R3 + shared->dim_R34 + shared->dim_R4 + shared->dim_S + shared->dim_VE_seroneg1n + shared->dim_VE_seroneg1p + 47;
  shared->offset_variable_out_yll_sero_vacc = shared->dim_cum_infection_pri + shared->dim_cum_infection_priV + shared->dim_cum_infection_sec + shared->dim_cum_infection_secV + shared->dim_cum_infection_tq + shared->dim_cum_infection_tqV + shared->dim_I1 + shared->dim_I12 + shared->dim_I123 + shared->dim_I1234 + shared->dim_I124 + shared->dim_I1243 + shared->dim_I13 + shared->dim_I132 + shared->dim_I134 + shared->dim_I1342 + shared->dim_I14 + shared->dim_I142 + shared->dim_I143 + shared->dim_I2 + shared->dim_I21 + shared->dim_I23 + shared->dim_I231 + shared->dim_I234 + shared->dim_I2341 + shared->dim_I24 + shared->dim_I241 + shared->dim_I243 + shared->dim_I3 + shared->dim_I31 + shared->dim_I32 + shared->dim_I34 + shared->dim_I341 + shared->dim_I342 + shared->dim_I4 + shared->dim_I41 + shared->dim_I42 + shared->dim_I43 + shared->dim_Ntotal_out + shared->dim_out_dis_all_pop + shared->dim_out_dis_all_unvacc + shared->dim_out_dis_all_vacc + shared->dim_out_dis_all_vacc_neg + shared->dim_out_dis_all_vacc_pos + shared->dim_out_dis_sero_pop + shared->dim_out_dis_sero_unvacc + shared->dim_out_dis_sero_vacc + shared->dim_out_dis_sero_vacc_neg + shared->dim_out_dis_sero_vacc_pos + shared->dim_out_disc_dis_all_pop + shared->dim_out_disc_dis_all_vacc + shared->dim_out_disc_nvacc_all_pop + shared->dim_out_disc_sdis_all_pop + shared->dim_out_disc_sdis_all_vacc + shared->dim_out_disc_yll_all_pop + shared->dim_out_disc_yll_all_vacc + shared->dim_out_nvacc_all_neg + shared->dim_out_nvacc_all_pop + shared->dim_out_nvacc_all_pos + shared->dim_out_prop_seroneg_at_9 + shared->dim_out_prop_seroneg_at_vca + shared->dim_out_sdis_all_pop + shared->dim_out_sdis_all_unvacc + shared->dim_out_sdis_all_vacc + shared->dim_out_sdis_all_vacc_neg + shared->dim_out_sdis_all_vacc_pos + shared->dim_out_sdis_sero_pop + shared->dim_out_sdis_sero_unvacc + shared->dim_out_sdis_sero_vacc + shared->dim_out_sdis_sero_vacc_neg + shared->dim_out_sdis_sero_vacc_pos + shared->dim_out_time_from_last_dose + shared->dim_out_yll_all_pop + shared->dim_out_yll_all_unvacc + shared->dim_out_yll_all_vacc + shared->dim_out_yll_all_vacc_neg + shared->dim_out_yll_all_vacc_pos + shared->dim_out_yll_sero_pop + shared->dim_out_yll_sero_unvacc + shared->dim_R1 + shared->dim_R12 + shared->dim_R123 + shared->dim_R1234 + shared->dim_R124 + shared->dim_R13 + shared->dim_R134 + shared->dim_R14 + shared->dim_R2 + shared->dim_R23 + shared->dim_R234 + shared->dim_R24 + shared->dim_R3 + shared->dim_R34 + shared->dim_R4 + shared->dim_S + shared->dim_VE_seroneg1n + shared->dim_VE_seroneg1p + 47;
  shared->offset_variable_out_yll_sero_vacc_neg = shared->dim_cum_infection_pri + shared->dim_cum_infection_priV + shared->dim_cum_infection_sec + shared->dim_cum_infection_secV + shared->dim_cum_infection_tq + shared->dim_cum_infection_tqV + shared->dim_I1 + shared->dim_I12 + shared->dim_I123 + shared->dim_I1234 + shared->dim_I124 + shared->dim_I1243 + shared->dim_I13 + shared->dim_I132 + shared->dim_I134 + shared->dim_I1342 + shared->dim_I14 + shared->dim_I142 + shared->dim_I143 + shared->dim_I2 + shared->dim_I21 + shared->dim_I23 + shared->dim_I231 + shared->dim_I234 + shared->dim_I2341 + shared->dim_I24 + shared->dim_I241 + shared->dim_I243 + shared->dim_I3 + shared->dim_I31 + shared->dim_I32 + shared->dim_I34 + shared->dim_I341 + shared->dim_I342 + shared->dim_I4 + shared->dim_I41 + shared->dim_I42 + shared->dim_I43 + shared->dim_Ntotal_out + shared->dim_out_dis_all_pop + shared->dim_out_dis_all_unvacc + shared->dim_out_dis_all_vacc + shared->dim_out_dis_all_vacc_neg + shared->dim_out_dis_all_vacc_pos + shared->dim_out_dis_sero_pop + shared->dim_out_dis_sero_unvacc + shared->dim_out_dis_sero_vacc + shared->dim_out_dis_sero_vacc_neg + shared->dim_out_dis_sero_vacc_pos + shared->dim_out_disc_dis_all_pop + shared->dim_out_disc_dis_all_vacc + shared->dim_out_disc_nvacc_all_pop + shared->dim_out_disc_sdis_all_pop + shared->dim_out_disc_sdis_all_vacc + shared->dim_out_disc_yll_all_pop + shared->dim_out_disc_yll_all_vacc + shared->dim_out_nvacc_all_neg + shared->dim_out_nvacc_all_pop + shared->dim_out_nvacc_all_pos + shared->dim_out_prop_seroneg_at_9 + shared->dim_out_prop_seroneg_at_vca + shared->dim_out_sdis_all_pop + shared->dim_out_sdis_all_unvacc + shared->dim_out_sdis_all_vacc + shared->dim_out_sdis_all_vacc_neg + shared->dim_out_sdis_all_vacc_pos + shared->dim_out_sdis_sero_pop + shared->dim_out_sdis_sero_unvacc + shared->dim_out_sdis_sero_vacc + shared->dim_out_sdis_sero_vacc_neg + shared->dim_out_sdis_sero_vacc_pos + shared->dim_out_time_from_last_dose + shared->dim_out_yll_all_pop + shared->dim_out_yll_all_unvacc + shared->dim_out_yll_all_vacc + shared->dim_out_yll_all_vacc_neg + shared->dim_out_yll_all_vacc_pos + shared->dim_out_yll_sero_pop + shared->dim_out_yll_sero_unvacc + shared->dim_out_yll_sero_vacc + shared->dim_R1 + shared->dim_R12 + shared->dim_R123 + shared->dim_R1234 + shared->dim_R124 + shared->dim_R13 + shared->dim_R134 + shared->dim_R14 + shared->dim_R2 + shared->dim_R23 + shared->dim_R234 + shared->dim_R24 + shared->dim_R3 + shared->dim_R34 + shared->dim_R4 + shared->dim_S + shared->dim_VE_seroneg1n + shared->dim_VE_seroneg1p + 47;
  shared->offset_variable_out_yll_sero_vacc_pos = shared->dim_cum_infection_pri + shared->dim_cum_infection_priV + shared->dim_cum_infection_sec + shared->dim_cum_infection_secV + shared->dim_cum_infection_tq + shared->dim_cum_infection_tqV + shared->dim_I1 + shared->dim_I12 + shared->dim_I123 + shared->dim_I1234 + shared->dim_I124 + shared->dim_I1243 + shared->dim_I13 + shared->dim_I132 + shared->dim_I134 + shared->dim_I1342 + shared->dim_I14 + shared->dim_I142 + shared->dim_I143 + shared->dim_I2 + shared->dim_I21 + shared->dim_I23 + shared->dim_I231 + shared->dim_I234 + shared->dim_I2341 + shared->dim_I24 + shared->dim_I241 + shared->dim_I243 + shared->dim_I3 + shared->dim_I31 + shared->dim_I32 + shared->dim_I34 + shared->dim_I341 + shared->dim_I342 + shared->dim_I4 + shared->dim_I41 + shared->dim_I42 + shared->dim_I43 + shared->dim_Ntotal_out + shared->dim_out_dis_all_pop + shared->dim_out_dis_all_unvacc + shared->dim_out_dis_all_vacc + shared->dim_out_dis_all_vacc_neg + shared->dim_out_dis_all_vacc_pos + shared->dim_out_dis_sero_pop + shared->dim_out_dis_sero_unvacc + shared->dim_out_dis_sero_vacc + shared->dim_out_dis_sero_vacc_neg + shared->dim_out_dis_sero_vacc_pos + shared->dim_out_disc_dis_all_pop + shared->dim_out_disc_dis_all_vacc + shared->dim_out_disc_nvacc_all_pop + shared->dim_out_disc_sdis_all_pop + shared->dim_out_disc_sdis_all_vacc + shared->dim_out_disc_yll_all_pop + shared->dim_out_disc_yll_all_vacc + shared->dim_out_nvacc_all_neg + shared->dim_out_nvacc_all_pop + shared->dim_out_nvacc_all_pos + shared->dim_out_prop_seroneg_at_9 + shared->dim_out_prop_seroneg_at_vca + shared->dim_out_sdis_all_pop + shared->dim_out_sdis_all_unvacc + shared->dim_out_sdis_all_vacc + shared->dim_out_sdis_all_vacc_neg + shared->dim_out_sdis_all_vacc_pos + shared->dim_out_sdis_sero_pop + shared->dim_out_sdis_sero_unvacc + shared->dim_out_sdis_sero_vacc + shared->dim_out_sdis_sero_vacc_neg + shared->dim_out_sdis_sero_vacc_pos + shared->dim_out_time_from_last_dose + shared->dim_out_yll_all_pop + shared->dim_out_yll_all_unvacc + shared->dim_out_yll_all_vacc + shared->dim_out_yll_all_vacc_neg + shared->dim_out_yll_all_vacc_pos + shared->dim_out_yll_sero_pop + shared->dim_out_yll_sero_unvacc + shared->dim_out_yll_sero_vacc + shared->dim_out_yll_sero_vacc_neg + shared->dim_R1 + shared->dim_R12 + shared->dim_R123 + shared->dim_R1234 + shared->dim_R124 + shared->dim_R13 + shared->dim_R134 + shared->dim_R14 + shared->dim_R2 + shared->dim_R23 + shared->dim_R234 + shared->dim_R24 + shared->dim_R3 + shared->dim_R34 + shared->dim_R4 + shared->dim_S + shared->dim_VE_seroneg1n + shared->dim_VE_seroneg1p + 47;
  shared->offset_variable_R1 = shared->dim_cum_infection_pri + shared->dim_cum_infection_priV + shared->dim_cum_infection_sec + shared->dim_cum_infection_secV + shared->dim_cum_infection_tq + shared->dim_cum_infection_tqV + shared->dim_I1 + shared->dim_I2 + shared->dim_I3 + shared->dim_I4 + shared->dim_Ntotal_out + shared->dim_out_dis_all_pop + shared->dim_out_dis_all_unvacc + shared->dim_out_dis_all_vacc + shared->dim_out_dis_all_vacc_neg + shared->dim_out_dis_all_vacc_pos + shared->dim_out_disc_dis_all_pop + shared->dim_out_disc_dis_all_vacc + shared->dim_out_disc_nvacc_all_pop + shared->dim_out_disc_sdis_all_pop + shared->dim_out_disc_sdis_all_vacc + shared->dim_out_disc_yll_all_pop + shared->dim_out_disc_yll_all_vacc + shared->dim_out_nvacc_all_neg + shared->dim_out_nvacc_all_pop + shared->dim_out_nvacc_all_pos + shared->dim_out_prop_seroneg_at_9 + shared->dim_out_prop_seroneg_at_vca + shared->dim_out_sdis_all_pop + shared->dim_out_sdis_all_unvacc + shared->dim_out_sdis_all_vacc + shared->dim_out_sdis_all_vacc_neg + shared->dim_out_sdis_all_vacc_pos + shared->dim_out_time_from_last_dose + shared->dim_out_yll_all_pop + shared->dim_out_yll_all_unvacc + shared->dim_out_yll_all_vacc + shared->dim_out_yll_all_vacc_neg + shared->dim_out_yll_all_vacc_pos + shared->dim_S + shared->dim_VE_seroneg1n + shared->dim_VE_seroneg1p + 47;
  shared->offset_variable_R12 = shared->dim_cum_infection_pri + shared->dim_cum_infection_priV + shared->dim_cum_infection_sec + shared->dim_cum_infection_secV + shared->dim_cum_infection_tq + shared->dim_cum_infection_tqV + shared->dim_I1 + shared->dim_I12 + shared->dim_I13 + shared->dim_I14 + shared->dim_I2 + shared->dim_I21 + shared->dim_I23 + shared->dim_I24 + shared->dim_I3 + shared->dim_I31 + shared->dim_I32 + shared->dim_I34 + shared->dim_I4 + shared->dim_I41 + shared->dim_I42 + shared->dim_I43 + shared->dim_Ntotal_out + shared->dim_out_dis_all_pop + shared->dim_out_dis_all_unvacc + shared->dim_out_dis_all_vacc + shared->dim_out_dis_all_vacc_neg + shared->dim_out_dis_all_vacc_pos + shared->dim_out_disc_dis_all_pop + shared->dim_out_disc_dis_all_vacc + shared->dim_out_disc_nvacc_all_pop + shared->dim_out_disc_sdis_all_pop + shared->dim_out_disc_sdis_all_vacc + shared->dim_out_disc_yll_all_pop + shared->dim_out_disc_yll_all_vacc + shared->dim_out_nvacc_all_neg + shared->dim_out_nvacc_all_pop + shared->dim_out_nvacc_all_pos + shared->dim_out_prop_seroneg_at_9 + shared->dim_out_prop_seroneg_at_vca + shared->dim_out_sdis_all_pop + shared->dim_out_sdis_all_unvacc + shared->dim_out_sdis_all_vacc + shared->dim_out_sdis_all_vacc_neg + shared->dim_out_sdis_all_vacc_pos + shared->dim_out_time_from_last_dose + shared->dim_out_yll_all_pop + shared->dim_out_yll_all_unvacc + shared->dim_out_yll_all_vacc + shared->dim_out_yll_all_vacc_neg + shared->dim_out_yll_all_vacc_pos + shared->dim_R1 + shared->dim_R2 + shared->dim_R3 + shared->dim_R4 + shared->dim_S + shared->dim_VE_seroneg1n + shared->dim_VE_seroneg1p + 47;
  shared->offset_variable_R123 = shared->dim_cum_infection_pri + shared->dim_cum_infection_priV + shared->dim_cum_infection_sec + shared->dim_cum_infection_secV + shared->dim_cum_infection_tq + shared->dim_cum_infection_tqV + shared->dim_I1 + shared->dim_I12 + shared->dim_I123 + shared->dim_I124 + shared->dim_I13 + shared->dim_I132 + shared->dim_I134 + shared->dim_I14 + shared->dim_I142 + shared->dim_I143 + shared->dim_I2 + shared->dim_I21 + shared->dim_I23 + shared->dim_I231 + shared->dim_I234 + shared->dim_I24 + shared->dim_I241 + shared->dim_I243 + shared->dim_I3 + shared->dim_I31 + shared->dim_I32 + shared->dim_I34 + shared->dim_I341 + shared->dim_I342 + shared->dim_I4 + shared->dim_I41 + shared->dim_I42 + shared->dim_I43 + shared->dim_Ntotal_out + shared->dim_out_dis_all_pop + shared->dim_out_dis_all_unvacc + shared->dim_out_dis_all_vacc + shared->dim_out_dis_all_vacc_neg + shared->dim_out_dis_all_vacc_pos + shared->dim_out_disc_dis_all_pop + shared->dim_out_disc_dis_all_vacc + shared->dim_out_disc_nvacc_all_pop + shared->dim_out_disc_sdis_all_pop + shared->dim_out_disc_sdis_all_vacc + shared->dim_out_disc_yll_all_pop + shared->dim_out_disc_yll_all_vacc + shared->dim_out_nvacc_all_neg + shared->dim_out_nvacc_all_pop + shared->dim_out_nvacc_all_pos + shared->dim_out_prop_seroneg_at_9 + shared->dim_out_prop_seroneg_at_vca + shared->dim_out_sdis_all_pop + shared->dim_out_sdis_all_unvacc + shared->dim_out_sdis_all_vacc + shared->dim_out_sdis_all_vacc_neg + shared->dim_out_sdis_all_vacc_pos + shared->dim_out_time_from_last_dose + shared->dim_out_yll_all_pop + shared->dim_out_yll_all_unvacc + shared->dim_out_yll_all_vacc + shared->dim_out_yll_all_vacc_neg + shared->dim_out_yll_all_vacc_pos + shared->dim_R1 + shared->dim_R12 + shared->dim_R13 + shared->dim_R14 + shared->dim_R2 + shared->dim_R23 + shared->dim_R24 + shared->dim_R3 + shared->dim_R34 + shared->dim_R4 + shared->dim_S + shared->dim_VE_seroneg1n + shared->dim_VE_seroneg1p + 47;
  shared->offset_variable_R1234 = shared->dim_cum_infection_pri + shared->dim_cum_infection_priV + shared->dim_cum_infection_sec + shared->dim_cum_infection_secV + shared->dim_cum_infection_tq + shared->dim_cum_infection_tqV + shared->dim_I1 + shared->dim_I12 + shared->dim_I123 + shared->dim_I1234 + shared->dim_I124 + shared->dim_I1243 + shared->dim_I13 + shared->dim_I132 + shared->dim_I134 + shared->dim_I1342 + shared->dim_I14 + shared->dim_I142 + shared->dim_I143 + shared->dim_I2 + shared->dim_I21 + shared->dim_I23 + shared->dim_I231 + shared->dim_I234 + shared->dim_I2341 + shared->dim_I24 + shared->dim_I241 + shared->dim_I243 + shared->dim_I3 + shared->dim_I31 + shared->dim_I32 + shared->dim_I34 + shared->dim_I341 + shared->dim_I342 + shared->dim_I4 + shared->dim_I41 + shared->dim_I42 + shared->dim_I43 + shared->dim_Ntotal_out + shared->dim_out_dis_all_pop + shared->dim_out_dis_all_unvacc + shared->dim_out_dis_all_vacc + shared->dim_out_dis_all_vacc_neg + shared->dim_out_dis_all_vacc_pos + shared->dim_out_disc_dis_all_pop + shared->dim_out_disc_dis_all_vacc + shared->dim_out_disc_nvacc_all_pop + shared->dim_out_disc_sdis_all_pop + shared->dim_out_disc_sdis_all_vacc + shared->dim_out_disc_yll_all_pop + shared->dim_out_disc_yll_all_vacc + shared->dim_out_nvacc_all_neg + shared->dim_out_nvacc_all_pop + shared->dim_out_nvacc_all_pos + shared->dim_out_prop_seroneg_at_9 + shared->dim_out_prop_seroneg_at_vca + shared->dim_out_sdis_all_pop + shared->dim_out_sdis_all_unvacc + shared->dim_out_sdis_all_vacc + shared->dim_out_sdis_all_vacc_neg + shared->dim_out_sdis_all_vacc_pos + shared->dim_out_time_from_last_dose + shared->dim_out_yll_all_pop + shared->dim_out_yll_all_unvacc + shared->dim_out_yll_all_vacc + shared->dim_out_yll_all_vacc_neg + shared->dim_out_yll_all_vacc_pos + shared->dim_R1 + shared->dim_R12 + shared->dim_R123 + shared->dim_R124 + shared->dim_R13 + shared->dim_R134 + shared->dim_R14 + shared->dim_R2 + shared->dim_R23 + shared->dim_R234 + shared->dim_R24 + shared->dim_R3 + shared->dim_R34 + shared->dim_R4 + shared->dim_S + shared->dim_VE_seroneg1n + shared->dim_VE_seroneg1p + 47;
  shared->offset_variable_R124 = shared->dim_cum_infection_pri + shared->dim_cum_infection_priV + shared->dim_cum_infection_sec + shared->dim_cum_infection_secV + shared->dim_cum_infection_tq + shared->dim_cum_infection_tqV + shared->dim_I1 + shared->dim_I12 + shared->dim_I123 + shared->dim_I124 + shared->dim_I13 + shared->dim_I132 + shared->dim_I134 + shared->dim_I14 + shared->dim_I142 + shared->dim_I143 + shared->dim_I2 + shared->dim_I21 + shared->dim_I23 + shared->dim_I231 + shared->dim_I234 + shared->dim_I24 + shared->dim_I241 + shared->dim_I243 + shared->dim_I3 + shared->dim_I31 + shared->dim_I32 + shared->dim_I34 + shared->dim_I341 + shared->dim_I342 + shared->dim_I4 + shared->dim_I41 + shared->dim_I42 + shared->dim_I43 + shared->dim_Ntotal_out + shared->dim_out_dis_all_pop + shared->dim_out_dis_all_unvacc + shared->dim_out_dis_all_vacc + shared->dim_out_dis_all_vacc_neg + shared->dim_out_dis_all_vacc_pos + shared->dim_out_disc_dis_all_pop + shared->dim_out_disc_dis_all_vacc + shared->dim_out_disc_nvacc_all_pop + shared->dim_out_disc_sdis_all_pop + shared->dim_out_disc_sdis_all_vacc + shared->dim_out_disc_yll_all_pop + shared->dim_out_disc_yll_all_vacc + shared->dim_out_nvacc_all_neg + shared->dim_out_nvacc_all_pop + shared->dim_out_nvacc_all_pos + shared->dim_out_prop_seroneg_at_9 + shared->dim_out_prop_seroneg_at_vca + shared->dim_out_sdis_all_pop + shared->dim_out_sdis_all_unvacc + shared->dim_out_sdis_all_vacc + shared->dim_out_sdis_all_vacc_neg + shared->dim_out_sdis_all_vacc_pos + shared->dim_out_time_from_last_dose + shared->dim_out_yll_all_pop + shared->dim_out_yll_all_unvacc + shared->dim_out_yll_all_vacc + shared->dim_out_yll_all_vacc_neg + shared->dim_out_yll_all_vacc_pos + shared->dim_R1 + shared->dim_R12 + shared->dim_R123 + shared->dim_R13 + shared->dim_R14 + shared->dim_R2 + shared->dim_R23 + shared->dim_R24 + shared->dim_R3 + shared->dim_R34 + shared->dim_R4 + shared->dim_S + shared->dim_VE_seroneg1n + shared->dim_VE_seroneg1p + 47;
  shared->offset_variable_R13 = shared->dim_cum_infection_pri + shared->dim_cum_infection_priV + shared->dim_cum_infection_sec + shared->dim_cum_infection_secV + shared->dim_cum_infection_tq + shared->dim_cum_infection_tqV + shared->dim_I1 + shared->dim_I12 + shared->dim_I13 + shared->dim_I14 + shared->dim_I2 + shared->dim_I21 + shared->dim_I23 + shared->dim_I24 + shared->dim_I3 + shared->dim_I31 + shared->dim_I32 + shared->dim_I34 + shared->dim_I4 + shared->dim_I41 + shared->dim_I42 + shared->dim_I43 + shared->dim_Ntotal_out + shared->dim_out_dis_all_pop + shared->dim_out_dis_all_unvacc + shared->dim_out_dis_all_vacc + shared->dim_out_dis_all_vacc_neg + shared->dim_out_dis_all_vacc_pos + shared->dim_out_disc_dis_all_pop + shared->dim_out_disc_dis_all_vacc + shared->dim_out_disc_nvacc_all_pop + shared->dim_out_disc_sdis_all_pop + shared->dim_out_disc_sdis_all_vacc + shared->dim_out_disc_yll_all_pop + shared->dim_out_disc_yll_all_vacc + shared->dim_out_nvacc_all_neg + shared->dim_out_nvacc_all_pop + shared->dim_out_nvacc_all_pos + shared->dim_out_prop_seroneg_at_9 + shared->dim_out_prop_seroneg_at_vca + shared->dim_out_sdis_all_pop + shared->dim_out_sdis_all_unvacc + shared->dim_out_sdis_all_vacc + shared->dim_out_sdis_all_vacc_neg + shared->dim_out_sdis_all_vacc_pos + shared->dim_out_time_from_last_dose + shared->dim_out_yll_all_pop + shared->dim_out_yll_all_unvacc + shared->dim_out_yll_all_vacc + shared->dim_out_yll_all_vacc_neg + shared->dim_out_yll_all_vacc_pos + shared->dim_R1 + shared->dim_R12 + shared->dim_R2 + shared->dim_R3 + shared->dim_R4 + shared->dim_S + shared->dim_VE_seroneg1n + shared->dim_VE_seroneg1p + 47;
  shared->offset_variable_R134 = shared->dim_cum_infection_pri + shared->dim_cum_infection_priV + shared->dim_cum_infection_sec + shared->dim_cum_infection_secV + shared->dim_cum_infection_tq + shared->dim_cum_infection_tqV + shared->dim_I1 + shared->dim_I12 + shared->dim_I123 + shared->dim_I124 + shared->dim_I13 + shared->dim_I132 + shared->dim_I134 + shared->dim_I14 + shared->dim_I142 + shared->dim_I143 + shared->dim_I2 + shared->dim_I21 + shared->dim_I23 + shared->dim_I231 + shared->dim_I234 + shared->dim_I24 + shared->dim_I241 + shared->dim_I243 + shared->dim_I3 + shared->dim_I31 + shared->dim_I32 + shared->dim_I34 + shared->dim_I341 + shared->dim_I342 + shared->dim_I4 + shared->dim_I41 + shared->dim_I42 + shared->dim_I43 + shared->dim_Ntotal_out + shared->dim_out_dis_all_pop + shared->dim_out_dis_all_unvacc + shared->dim_out_dis_all_vacc + shared->dim_out_dis_all_vacc_neg + shared->dim_out_dis_all_vacc_pos + shared->dim_out_disc_dis_all_pop + shared->dim_out_disc_dis_all_vacc + shared->dim_out_disc_nvacc_all_pop + shared->dim_out_disc_sdis_all_pop + shared->dim_out_disc_sdis_all_vacc + shared->dim_out_disc_yll_all_pop + shared->dim_out_disc_yll_all_vacc + shared->dim_out_nvacc_all_neg + shared->dim_out_nvacc_all_pop + shared->dim_out_nvacc_all_pos + shared->dim_out_prop_seroneg_at_9 + shared->dim_out_prop_seroneg_at_vca + shared->dim_out_sdis_all_pop + shared->dim_out_sdis_all_unvacc + shared->dim_out_sdis_all_vacc + shared->dim_out_sdis_all_vacc_neg + shared->dim_out_sdis_all_vacc_pos + shared->dim_out_time_from_last_dose + shared->dim_out_yll_all_pop + shared->dim_out_yll_all_unvacc + shared->dim_out_yll_all_vacc + shared->dim_out_yll_all_vacc_neg + shared->dim_out_yll_all_vacc_pos + shared->dim_R1 + shared->dim_R12 + shared->dim_R123 + shared->dim_R124 + shared->dim_R13 + shared->dim_R14 + shared->dim_R2 + shared->dim_R23 + shared->dim_R24 + shared->dim_R3 + shared->dim_R34 + shared->dim_R4 + shared->dim_S + shared->dim_VE_seroneg1n + shared->dim_VE_seroneg1p + 47;
  shared->offset_variable_R14 = shared->dim_cum_infection_pri + shared->dim_cum_infection_priV + shared->dim_cum_infection_sec + shared->dim_cum_infection_secV + shared->dim_cum_infection_tq + shared->dim_cum_infection_tqV + shared->dim_I1 + shared->dim_I12 + shared->dim_I13 + shared->dim_I14 + shared->dim_I2 + shared->dim_I21 + shared->dim_I23 + shared->dim_I24 + shared->dim_I3 + shared->dim_I31 + shared->dim_I32 + shared->dim_I34 + shared->dim_I4 + shared->dim_I41 + shared->dim_I42 + shared->dim_I43 + shared->dim_Ntotal_out + shared->dim_out_dis_all_pop + shared->dim_out_dis_all_unvacc + shared->dim_out_dis_all_vacc + shared->dim_out_dis_all_vacc_neg + shared->dim_out_dis_all_vacc_pos + shared->dim_out_disc_dis_all_pop + shared->dim_out_disc_dis_all_vacc + shared->dim_out_disc_nvacc_all_pop + shared->dim_out_disc_sdis_all_pop + shared->dim_out_disc_sdis_all_vacc + shared->dim_out_disc_yll_all_pop + shared->dim_out_disc_yll_all_vacc + shared->dim_out_nvacc_all_neg + shared->dim_out_nvacc_all_pop + shared->dim_out_nvacc_all_pos + shared->dim_out_prop_seroneg_at_9 + shared->dim_out_prop_seroneg_at_vca + shared->dim_out_sdis_all_pop + shared->dim_out_sdis_all_unvacc + shared->dim_out_sdis_all_vacc + shared->dim_out_sdis_all_vacc_neg + shared->dim_out_sdis_all_vacc_pos + shared->dim_out_time_from_last_dose + shared->dim_out_yll_all_pop + shared->dim_out_yll_all_unvacc + shared->dim_out_yll_all_vacc + shared->dim_out_yll_all_vacc_neg + shared->dim_out_yll_all_vacc_pos + shared->dim_R1 + shared->dim_R12 + shared->dim_R13 + shared->dim_R2 + shared->dim_R3 + shared->dim_R4 + shared->dim_S + shared->dim_VE_seroneg1n + shared->dim_VE_seroneg1p + 47;
  shared->offset_variable_R2 = shared->dim_cum_infection_pri + shared->dim_cum_infection_priV + shared->dim_cum_infection_sec + shared->dim_cum_infection_secV + shared->dim_cum_infection_tq + shared->dim_cum_infection_tqV + shared->dim_I1 + shared->dim_I2 + shared->dim_I3 + shared->dim_I4 + shared->dim_Ntotal_out + shared->dim_out_dis_all_pop + shared->dim_out_dis_all_unvacc + shared->dim_out_dis_all_vacc + shared->dim_out_dis_all_vacc_neg + shared->dim_out_dis_all_vacc_pos + shared->dim_out_disc_dis_all_pop + shared->dim_out_disc_dis_all_vacc + shared->dim_out_disc_nvacc_all_pop + shared->dim_out_disc_sdis_all_pop + shared->dim_out_disc_sdis_all_vacc + shared->dim_out_disc_yll_all_pop + shared->dim_out_disc_yll_all_vacc + shared->dim_out_nvacc_all_neg + shared->dim_out_nvacc_all_pop + shared->dim_out_nvacc_all_pos + shared->dim_out_prop_seroneg_at_9 + shared->dim_out_prop_seroneg_at_vca + shared->dim_out_sdis_all_pop + shared->dim_out_sdis_all_unvacc + shared->dim_out_sdis_all_vacc + shared->dim_out_sdis_all_vacc_neg + shared->dim_out_sdis_all_vacc_pos + shared->dim_out_time_from_last_dose + shared->dim_out_yll_all_pop + shared->dim_out_yll_all_unvacc + shared->dim_out_yll_all_vacc + shared->dim_out_yll_all_vacc_neg + shared->dim_out_yll_all_vacc_pos + shared->dim_R1 + shared->dim_S + shared->dim_VE_seroneg1n + shared->dim_VE_seroneg1p + 47;
  shared->offset_variable_R23 = shared->dim_cum_infection_pri + shared->dim_cum_infection_priV + shared->dim_cum_infection_sec + shared->dim_cum_infection_secV + shared->dim_cum_infection_tq + shared->dim_cum_infection_tqV + shared->dim_I1 + shared->dim_I12 + shared->dim_I13 + shared->dim_I14 + shared->dim_I2 + shared->dim_I21 + shared->dim_I23 + shared->dim_I24 + shared->dim_I3 + shared->dim_I31 + shared->dim_I32 + shared->dim_I34 + shared->dim_I4 + shared->dim_I41 + shared->dim_I42 + shared->dim_I43 + shared->dim_Ntotal_out + shared->dim_out_dis_all_pop + shared->dim_out_dis_all_unvacc + shared->dim_out_dis_all_vacc + shared->dim_out_dis_all_vacc_neg + shared->dim_out_dis_all_vacc_pos + shared->dim_out_disc_dis_all_pop + shared->dim_out_disc_dis_all_vacc + shared->dim_out_disc_nvacc_all_pop + shared->dim_out_disc_sdis_all_pop + shared->dim_out_disc_sdis_all_vacc + shared->dim_out_disc_yll_all_pop + shared->dim_out_disc_yll_all_vacc + shared->dim_out_nvacc_all_neg + shared->dim_out_nvacc_all_pop + shared->dim_out_nvacc_all_pos + shared->dim_out_prop_seroneg_at_9 + shared->dim_out_prop_seroneg_at_vca + shared->dim_out_sdis_all_pop + shared->dim_out_sdis_all_unvacc + shared->dim_out_sdis_all_vacc + shared->dim_out_sdis_all_vacc_neg + shared->dim_out_sdis_all_vacc_pos + shared->dim_out_time_from_last_dose + shared->dim_out_yll_all_pop + shared->dim_out_yll_all_unvacc + shared->dim_out_yll_all_vacc + shared->dim_out_yll_all_vacc_neg + shared->dim_out_yll_all_vacc_pos + shared->dim_R1 + shared->dim_R12 + shared->dim_R13 + shared->dim_R14 + shared->dim_R2 + shared->dim_R3 + shared->dim_R4 + shared->dim_S + shared->dim_VE_seroneg1n + shared->dim_VE_seroneg1p + 47;
  shared->offset_variable_R234 = shared->dim_cum_infection_pri + shared->dim_cum_infection_priV + shared->dim_cum_infection_sec + shared->dim_cum_infection_secV + shared->dim_cum_infection_tq + shared->dim_cum_infection_tqV + shared->dim_I1 + shared->dim_I12 + shared->dim_I123 + shared->dim_I124 + shared->dim_I13 + shared->dim_I132 + shared->dim_I134 + shared->dim_I14 + shared->dim_I142 + shared->dim_I143 + shared->dim_I2 + shared->dim_I21 + shared->dim_I23 + shared->dim_I231 + shared->dim_I234 + shared->dim_I24 + shared->dim_I241 + shared->dim_I243 + shared->dim_I3 + shared->dim_I31 + shared->dim_I32 + shared->dim_I34 + shared->dim_I341 + shared->dim_I342 + shared->dim_I4 + shared->dim_I41 + shared->dim_I42 + shared->dim_I43 + shared->dim_Ntotal_out + shared->dim_out_dis_all_pop + shared->dim_out_dis_all_unvacc + shared->dim_out_dis_all_vacc + shared->dim_out_dis_all_vacc_neg + shared->dim_out_dis_all_vacc_pos + shared->dim_out_disc_dis_all_pop + shared->dim_out_disc_dis_all_vacc + shared->dim_out_disc_nvacc_all_pop + shared->dim_out_disc_sdis_all_pop + shared->dim_out_disc_sdis_all_vacc + shared->dim_out_disc_yll_all_pop + shared->dim_out_disc_yll_all_vacc + shared->dim_out_nvacc_all_neg + shared->dim_out_nvacc_all_pop + shared->dim_out_nvacc_all_pos + shared->dim_out_prop_seroneg_at_9 + shared->dim_out_prop_seroneg_at_vca + shared->dim_out_sdis_all_pop + shared->dim_out_sdis_all_unvacc + shared->dim_out_sdis_all_vacc + shared->dim_out_sdis_all_vacc_neg + shared->dim_out_sdis_all_vacc_pos + shared->dim_out_time_from_last_dose + shared->dim_out_yll_all_pop + shared->dim_out_yll_all_unvacc + shared->dim_out_yll_all_vacc + shared->dim_out_yll_all_vacc_neg + shared->dim_out_yll_all_vacc_pos + shared->dim_R1 + shared->dim_R12 + shared->dim_R123 + shared->dim_R124 + shared->dim_R13 + shared->dim_R134 + shared->dim_R14 + shared->dim_R2 + shared->dim_R23 + shared->dim_R24 + shared->dim_R3 + shared->dim_R34 + shared->dim_R4 + shared->dim_S + shared->dim_VE_seroneg1n + shared->dim_VE_seroneg1p + 47;
  shared->offset_variable_R24 = shared->dim_cum_infection_pri + shared->dim_cum_infection_priV + shared->dim_cum_infection_sec + shared->dim_cum_infection_secV + shared->dim_cum_infection_tq + shared->dim_cum_infection_tqV + shared->dim_I1 + shared->dim_I12 + shared->dim_I13 + shared->dim_I14 + shared->dim_I2 + shared->dim_I21 + shared->dim_I23 + shared->dim_I24 + shared->dim_I3 + shared->dim_I31 + shared->dim_I32 + shared->dim_I34 + shared->dim_I4 + shared->dim_I41 + shared->dim_I42 + shared->dim_I43 + shared->dim_Ntotal_out + shared->dim_out_dis_all_pop + shared->dim_out_dis_all_unvacc + shared->dim_out_dis_all_vacc + shared->dim_out_dis_all_vacc_neg + shared->dim_out_dis_all_vacc_pos + shared->dim_out_disc_dis_all_pop + shared->dim_out_disc_dis_all_vacc + shared->dim_out_disc_nvacc_all_pop + shared->dim_out_disc_sdis_all_pop + shared->dim_out_disc_sdis_all_vacc + shared->dim_out_disc_yll_all_pop + shared->dim_out_disc_yll_all_vacc + shared->dim_out_nvacc_all_neg + shared->dim_out_nvacc_all_pop + shared->dim_out_nvacc_all_pos + shared->dim_out_prop_seroneg_at_9 + shared->dim_out_prop_seroneg_at_vca + shared->dim_out_sdis_all_pop + shared->dim_out_sdis_all_unvacc + shared->dim_out_sdis_all_vacc + shared->dim_out_sdis_all_vacc_neg + shared->dim_out_sdis_all_vacc_pos + shared->dim_out_time_from_last_dose + shared->dim_out_yll_all_pop + shared->dim_out_yll_all_unvacc + shared->dim_out_yll_all_vacc + shared->dim_out_yll_all_vacc_neg + shared->dim_out_yll_all_vacc_pos + shared->dim_R1 + shared->dim_R12 + shared->dim_R13 + shared->dim_R14 + shared->dim_R2 + shared->dim_R23 + shared->dim_R3 + shared->dim_R4 + shared->dim_S + shared->dim_VE_seroneg1n + shared->dim_VE_seroneg1p + 47;
  shared->offset_variable_R3 = shared->dim_cum_infection_pri + shared->dim_cum_infection_priV + shared->dim_cum_infection_sec + shared->dim_cum_infection_secV + shared->dim_cum_infection_tq + shared->dim_cum_infection_tqV + shared->dim_I1 + shared->dim_I2 + shared->dim_I3 + shared->dim_I4 + shared->dim_Ntotal_out + shared->dim_out_dis_all_pop + shared->dim_out_dis_all_unvacc + shared->dim_out_dis_all_vacc + shared->dim_out_dis_all_vacc_neg + shared->dim_out_dis_all_vacc_pos + shared->dim_out_disc_dis_all_pop + shared->dim_out_disc_dis_all_vacc + shared->dim_out_disc_nvacc_all_pop + shared->dim_out_disc_sdis_all_pop + shared->dim_out_disc_sdis_all_vacc + shared->dim_out_disc_yll_all_pop + shared->dim_out_disc_yll_all_vacc + shared->dim_out_nvacc_all_neg + shared->dim_out_nvacc_all_pop + shared->dim_out_nvacc_all_pos + shared->dim_out_prop_seroneg_at_9 + shared->dim_out_prop_seroneg_at_vca + shared->dim_out_sdis_all_pop + shared->dim_out_sdis_all_unvacc + shared->dim_out_sdis_all_vacc + shared->dim_out_sdis_all_vacc_neg + shared->dim_out_sdis_all_vacc_pos + shared->dim_out_time_from_last_dose + shared->dim_out_yll_all_pop + shared->dim_out_yll_all_unvacc + shared->dim_out_yll_all_vacc + shared->dim_out_yll_all_vacc_neg + shared->dim_out_yll_all_vacc_pos + shared->dim_R1 + shared->dim_R2 + shared->dim_S + shared->dim_VE_seroneg1n + shared->dim_VE_seroneg1p + 47;
  shared->offset_variable_R34 = shared->dim_cum_infection_pri + shared->dim_cum_infection_priV + shared->dim_cum_infection_sec + shared->dim_cum_infection_secV + shared->dim_cum_infection_tq + shared->dim_cum_infection_tqV + shared->dim_I1 + shared->dim_I12 + shared->dim_I13 + shared->dim_I14 + shared->dim_I2 + shared->dim_I21 + shared->dim_I23 + shared->dim_I24 + shared->dim_I3 + shared->dim_I31 + shared->dim_I32 + shared->dim_I34 + shared->dim_I4 + shared->dim_I41 + shared->dim_I42 + shared->dim_I43 + shared->dim_Ntotal_out + shared->dim_out_dis_all_pop + shared->dim_out_dis_all_unvacc + shared->dim_out_dis_all_vacc + shared->dim_out_dis_all_vacc_neg + shared->dim_out_dis_all_vacc_pos + shared->dim_out_disc_dis_all_pop + shared->dim_out_disc_dis_all_vacc + shared->dim_out_disc_nvacc_all_pop + shared->dim_out_disc_sdis_all_pop + shared->dim_out_disc_sdis_all_vacc + shared->dim_out_disc_yll_all_pop + shared->dim_out_disc_yll_all_vacc + shared->dim_out_nvacc_all_neg + shared->dim_out_nvacc_all_pop + shared->dim_out_nvacc_all_pos + shared->dim_out_prop_seroneg_at_9 + shared->dim_out_prop_seroneg_at_vca + shared->dim_out_sdis_all_pop + shared->dim_out_sdis_all_unvacc + shared->dim_out_sdis_all_vacc + shared->dim_out_sdis_all_vacc_neg + shared->dim_out_sdis_all_vacc_pos + shared->dim_out_time_from_last_dose + shared->dim_out_yll_all_pop + shared->dim_out_yll_all_unvacc + shared->dim_out_yll_all_vacc + shared->dim_out_yll_all_vacc_neg + shared->dim_out_yll_all_vacc_pos + shared->dim_R1 + shared->dim_R12 + shared->dim_R13 + shared->dim_R14 + shared->dim_R2 + shared->dim_R23 + shared->dim_R24 + shared->dim_R3 + shared->dim_R4 + shared->dim_S + shared->dim_VE_seroneg1n + shared->dim_VE_seroneg1p + 47;
  shared->offset_variable_R4 = shared->dim_cum_infection_pri + shared->dim_cum_infection_priV + shared->dim_cum_infection_sec + shared->dim_cum_infection_secV + shared->dim_cum_infection_tq + shared->dim_cum_infection_tqV + shared->dim_I1 + shared->dim_I2 + shared->dim_I3 + shared->dim_I4 + shared->dim_Ntotal_out + shared->dim_out_dis_all_pop + shared->dim_out_dis_all_unvacc + shared->dim_out_dis_all_vacc + shared->dim_out_dis_all_vacc_neg + shared->dim_out_dis_all_vacc_pos + shared->dim_out_disc_dis_all_pop + shared->dim_out_disc_dis_all_vacc + shared->dim_out_disc_nvacc_all_pop + shared->dim_out_disc_sdis_all_pop + shared->dim_out_disc_sdis_all_vacc + shared->dim_out_disc_yll_all_pop + shared->dim_out_disc_yll_all_vacc + shared->dim_out_nvacc_all_neg + shared->dim_out_nvacc_all_pop + shared->dim_out_nvacc_all_pos + shared->dim_out_prop_seroneg_at_9 + shared->dim_out_prop_seroneg_at_vca + shared->dim_out_sdis_all_pop + shared->dim_out_sdis_all_unvacc + shared->dim_out_sdis_all_vacc + shared->dim_out_sdis_all_vacc_neg + shared->dim_out_sdis_all_vacc_pos + shared->dim_out_time_from_last_dose + shared->dim_out_yll_all_pop + shared->dim_out_yll_all_unvacc + shared->dim_out_yll_all_vacc + shared->dim_out_yll_all_vacc_neg + shared->dim_out_yll_all_vacc_pos + shared->dim_R1 + shared->dim_R2 + shared->dim_R3 + shared->dim_S + shared->dim_VE_seroneg1n + shared->dim_VE_seroneg1p + 47;
  {
     int i = 1;
     shared->ageb[i - 1] = 0;
  }
  for (int i = 2; i <= (shared->N_age_p1); ++i) {
    shared->ageb[i - 1] = shared->ageb[i - 1 - 1] + shared->agec[i - 1 - 1];
  }
  internal.age_I1 = std::vector<real_type>(shared->dim_age_I1);
  internal.age_I12 = std::vector<real_type>(shared->dim_age_I12);
  internal.age_I123 = std::vector<real_type>(shared->dim_age_I123);
  internal.age_I1234 = std::vector<real_type>(shared->dim_age_I1234);
  internal.age_I124 = std::vector<real_type>(shared->dim_age_I124);
  internal.age_I1243 = std::vector<real_type>(shared->dim_age_I1243);
  internal.age_I13 = std::vector<real_type>(shared->dim_age_I13);
  internal.age_I132 = std::vector<real_type>(shared->dim_age_I132);
  internal.age_I134 = std::vector<real_type>(shared->dim_age_I134);
  internal.age_I1342 = std::vector<real_type>(shared->dim_age_I1342);
  internal.age_I14 = std::vector<real_type>(shared->dim_age_I14);
  internal.age_I142 = std::vector<real_type>(shared->dim_age_I142);
  internal.age_I143 = std::vector<real_type>(shared->dim_age_I143);
  internal.age_I2 = std::vector<real_type>(shared->dim_age_I2);
  internal.age_I21 = std::vector<real_type>(shared->dim_age_I21);
  internal.age_I23 = std::vector<real_type>(shared->dim_age_I23);
  internal.age_I231 = std::vector<real_type>(shared->dim_age_I231);
  internal.age_I234 = std::vector<real_type>(shared->dim_age_I234);
  internal.age_I2341 = std::vector<real_type>(shared->dim_age_I2341);
  internal.age_I24 = std::vector<real_type>(shared->dim_age_I24);
  internal.age_I241 = std::vector<real_type>(shared->dim_age_I241);
  internal.age_I243 = std::vector<real_type>(shared->dim_age_I243);
  internal.age_I3 = std::vector<real_type>(shared->dim_age_I3);
  internal.age_I31 = std::vector<real_type>(shared->dim_age_I31);
  internal.age_I32 = std::vector<real_type>(shared->dim_age_I32);
  internal.age_I34 = std::vector<real_type>(shared->dim_age_I34);
  internal.age_I341 = std::vector<real_type>(shared->dim_age_I341);
  internal.age_I342 = std::vector<real_type>(shared->dim_age_I342);
  internal.age_I4 = std::vector<real_type>(shared->dim_age_I4);
  internal.age_I41 = std::vector<real_type>(shared->dim_age_I41);
  internal.age_I42 = std::vector<real_type>(shared->dim_age_I42);
  internal.age_I43 = std::vector<real_type>(shared->dim_age_I43);
  internal.age_R1 = std::vector<real_type>(shared->dim_age_R1);
  internal.age_R12 = std::vector<real_type>(shared->dim_age_R12);
  internal.age_R123 = std::vector<real_type>(shared->dim_age_R123);
  internal.age_R1234 = std::vector<real_type>(shared->dim_age_R1234);
  internal.age_R124 = std::vector<real_type>(shared->dim_age_R124);
  internal.age_R13 = std::vector<real_type>(shared->dim_age_R13);
  internal.age_R134 = std::vector<real_type>(shared->dim_age_R134);
  internal.age_R14 = std::vector<real_type>(shared->dim_age_R14);
  internal.age_R2 = std::vector<real_type>(shared->dim_age_R2);
  internal.age_R23 = std::vector<real_type>(shared->dim_age_R23);
  internal.age_R234 = std::vector<real_type>(shared->dim_age_R234);
  internal.age_R24 = std::vector<real_type>(shared->dim_age_R24);
  internal.age_R3 = std::vector<real_type>(shared->dim_age_R3);
  internal.age_R34 = std::vector<real_type>(shared->dim_age_R34);
  internal.age_R4 = std::vector<real_type>(shared->dim_age_R4);
  internal.age_S = std::vector<real_type>(shared->dim_age_S);
  internal.vacc_noncov = std::vector<real_type>(shared->dim_vacc_noncov);
  internal.vacc_noncov_S = std::vector<real_type>(shared->dim_vacc_noncov_S);
  for (int i = 1; i <= shared->N_age_p1; ++i) {
    shared->vacc_cu_age_weight[i - 1] = 1;
  }
  for (int i = 1; i <= shared->N_age; ++i) {
    shared->mean_age[i - 1] = (static_cast<real_type>(0.75) * shared->ageb[i - 1] + static_cast<real_type>(0.25) * shared->ageb[i + 1 - 1]);
  }
  shared->Beta_mh_mean = NA_REAL;
  shared->Beta_mh_season = NA_REAL;
  shared->CALIB_YEAR = NA_REAL;
  shared->cfr = NA_REAL;
  shared->daly_dis = NA_REAL;
  shared->daly_sdis = NA_REAL;
  shared->delta = NA_REAL;
  shared->disc_fact = NA_REAL;
  shared->disc_fact_vacc = NA_REAL;
  shared->DoVEInf = NA_REAL;
  shared->dur_cross_prot = NA_REAL;
  shared->eip = NA_REAL;
  shared->epsilon = NA_REAL;
  shared->EQUILIB_YEARS = NA_REAL;
  shared->extInf = NA_REAL;
  shared->FIRST_YEAR = NA_REAL;
  shared->incub = NA_REAL;
  shared->inf_per = NA_REAL;
  shared->kappa = NA_REAL;
  shared->Kc_season = NA_REAL;
  shared->LAST_YEAR = NA_REAL;
  shared->max_ve_decay_time = NA_REAL;
  shared->Mwt = NA_REAL;
  shared->N_sim = NA_REAL;
  shared->nc50_age_intercept = NA_REAL;
  shared->nc50_age_slope = NA_REAL;
  shared->omega = NA_REAL;
  shared->phi_dis_enhance = NA_REAL;
  shared->R0_req = NA_REAL;
  shared->Rel_R01 = NA_REAL;
  shared->Rel_R02 = NA_REAL;
  shared->Rel_R03 = NA_REAL;
  shared->Rel_R04 = NA_REAL;
  shared->Rm = NA_REAL;
  shared->sigma = NA_REAL;
  shared->VACC_END_YEAR = NA_REAL;
  shared->VACC_YEAR = NA_REAL;
  shared->VaccOn = NA_REAL;
  shared->VaccRoutineAge = NA_REAL;
  shared->YL = NA_REAL;
  shared->ZeroVE = NA_REAL;
  shared->Beta_mh_mean = user_get_scalar<real_type>(user, "Beta_mh_mean", shared->Beta_mh_mean, NA_REAL, NA_REAL);
  shared->Beta_mh_season = user_get_scalar<real_type>(user, "Beta_mh_season", shared->Beta_mh_season, NA_REAL, NA_REAL);
  shared->CALIB_YEAR = user_get_scalar<real_type>(user, "CALIB_YEAR", shared->CALIB_YEAR, NA_REAL, NA_REAL);
  shared->cfr = user_get_scalar<real_type>(user, "cfr", shared->cfr, NA_REAL, NA_REAL);
  shared->daly_dis = user_get_scalar<real_type>(user, "daly_dis", shared->daly_dis, NA_REAL, NA_REAL);
  shared->daly_sdis = user_get_scalar<real_type>(user, "daly_sdis", shared->daly_sdis, NA_REAL, NA_REAL);
  shared->delta = user_get_scalar<real_type>(user, "delta", shared->delta, NA_REAL, NA_REAL);
  shared->disc_fact = user_get_scalar<real_type>(user, "disc_fact", shared->disc_fact, NA_REAL, NA_REAL);
  shared->disc_fact_vacc = user_get_scalar<real_type>(user, "disc_fact_vacc", shared->disc_fact_vacc, NA_REAL, NA_REAL);
  shared->DoVEInf = user_get_scalar<real_type>(user, "DoVEInf", shared->DoVEInf, NA_REAL, NA_REAL);
  shared->dur_cross_prot = user_get_scalar<real_type>(user, "dur_cross_prot", shared->dur_cross_prot, NA_REAL, NA_REAL);
  shared->eip = user_get_scalar<real_type>(user, "eip", shared->eip, NA_REAL, NA_REAL);
  shared->epsilon = user_get_scalar<real_type>(user, "epsilon", shared->epsilon, NA_REAL, NA_REAL);
  shared->EQUILIB_YEARS = user_get_scalar<real_type>(user, "EQUILIB_YEARS", shared->EQUILIB_YEARS, NA_REAL, NA_REAL);
  shared->extInf = user_get_scalar<real_type>(user, "extInf", shared->extInf, NA_REAL, NA_REAL);
  shared->FIRST_YEAR = user_get_scalar<real_type>(user, "FIRST_YEAR", shared->FIRST_YEAR, NA_REAL, NA_REAL);
  shared->incub = user_get_scalar<real_type>(user, "incub", shared->incub, NA_REAL, NA_REAL);
  shared->inf_per = user_get_scalar<real_type>(user, "inf_per", shared->inf_per, NA_REAL, NA_REAL);
  shared->kappa = user_get_scalar<real_type>(user, "kappa", shared->kappa, NA_REAL, NA_REAL);
  shared->Kc_season = user_get_scalar<real_type>(user, "Kc_season", shared->Kc_season, NA_REAL, NA_REAL);
  shared->LAST_YEAR = user_get_scalar<real_type>(user, "LAST_YEAR", shared->LAST_YEAR, NA_REAL, NA_REAL);
  shared->max_ve_decay_time = user_get_scalar<real_type>(user, "max_ve_decay_time", shared->max_ve_decay_time, NA_REAL, NA_REAL);
  shared->Mwt = user_get_scalar<real_type>(user, "Mwt", shared->Mwt, NA_REAL, NA_REAL);
  shared->N_sim = user_get_scalar<real_type>(user, "N_sim", shared->N_sim, NA_REAL, NA_REAL);
  shared->nc50_age_intercept = user_get_scalar<real_type>(user, "nc50_age_intercept", shared->nc50_age_intercept, NA_REAL, NA_REAL);
  shared->nc50_age_slope = user_get_scalar<real_type>(user, "nc50_age_slope", shared->nc50_age_slope, NA_REAL, NA_REAL);
  shared->omega = user_get_scalar<real_type>(user, "omega", shared->omega, NA_REAL, NA_REAL);
  shared->phi_dis_enhance = user_get_scalar<real_type>(user, "phi_dis_enhance", shared->phi_dis_enhance, NA_REAL, NA_REAL);
  shared->R0_req = user_get_scalar<real_type>(user, "R0_req", shared->R0_req, NA_REAL, NA_REAL);
  shared->Rel_R01 = user_get_scalar<real_type>(user, "Rel_R01", shared->Rel_R01, NA_REAL, NA_REAL);
  shared->Rel_R02 = user_get_scalar<real_type>(user, "Rel_R02", shared->Rel_R02, NA_REAL, NA_REAL);
  shared->Rel_R03 = user_get_scalar<real_type>(user, "Rel_R03", shared->Rel_R03, NA_REAL, NA_REAL);
  shared->Rel_R04 = user_get_scalar<real_type>(user, "Rel_R04", shared->Rel_R04, NA_REAL, NA_REAL);
  shared->Rm = user_get_scalar<real_type>(user, "Rm", shared->Rm, NA_REAL, NA_REAL);
  shared->sigma = user_get_scalar<real_type>(user, "sigma", shared->sigma, NA_REAL, NA_REAL);
  shared->VACC_END_YEAR = user_get_scalar<real_type>(user, "VACC_END_YEAR", shared->VACC_END_YEAR, NA_REAL, NA_REAL);
  shared->VACC_YEAR = user_get_scalar<real_type>(user, "VACC_YEAR", shared->VACC_YEAR, NA_REAL, NA_REAL);
  shared->VaccOn = user_get_scalar<real_type>(user, "VaccOn", shared->VaccOn, NA_REAL, NA_REAL);
  shared->VaccRoutineAge = user_get_scalar<real_type>(user, "VaccRoutineAge", shared->VaccRoutineAge, NA_REAL, NA_REAL);
  shared->YL = user_get_scalar<real_type>(user, "YL", shared->YL, NA_REAL, NA_REAL);
  shared->ZeroVE = user_get_scalar<real_type>(user, "ZeroVE", shared->ZeroVE, NA_REAL, NA_REAL);
  shared->age_per = shared->YL;
  shared->delta_wb = shared->delta / (real_type) shared->Wb_fM;
  shared->dis_pri = user_get_array_fixed<real_type, 1>(user, "dis_pri", shared->dis_pri, {shared->dim_dis_pri}, NA_REAL, NA_REAL);
  shared->dis_quart = user_get_array_fixed<real_type, 1>(user, "dis_quart", shared->dis_quart, {shared->dim_dis_quart}, NA_REAL, NA_REAL);
  shared->dis_sec = user_get_array_fixed<real_type, 1>(user, "dis_sec", shared->dis_sec, {shared->dim_dis_sec}, NA_REAL, NA_REAL);
  shared->dis_tert = user_get_array_fixed<real_type, 1>(user, "dis_tert", shared->dis_tert, {shared->dim_dis_tert}, NA_REAL, NA_REAL);
  shared->extInfRand = shared->extInf;
  shared->gamma = shared->Rm * shared->delta * (shared->epsilon + shared->sigma) / (real_type) shared->epsilon;
  shared->hl = user_get_array_fixed<real_type, 1>(user, "hl", shared->hl, {shared->dim_hl}, NA_REAL, NA_REAL);
  shared->hs = user_get_array_fixed<real_type, 1>(user, "hs", shared->hs, {shared->dim_hs}, NA_REAL, NA_REAL);
  shared->max_rel_year = shared->LAST_YEAR - shared->FIRST_YEAR;
  shared->nu = shared->DT / (real_type) shared->dur_cross_prot;
  shared->phi_ed = shared->phi_dis_enhance - 1;
  shared->pop_size_d = user_get_array_fixed<real_type, 1>(user, "pop_size_d", shared->pop_size_d, {shared->dim_pop_size_d}, NA_REAL, NA_REAL);
  shared->sdis_pri = user_get_array_fixed<real_type, 1>(user, "sdis_pri", shared->sdis_pri, {shared->dim_sdis_pri}, NA_REAL, NA_REAL);
  shared->sdis_quart = user_get_array_fixed<real_type, 1>(user, "sdis_quart", shared->sdis_quart, {shared->dim_sdis_quart}, NA_REAL, NA_REAL);
  shared->sdis_sec = user_get_array_fixed<real_type, 1>(user, "sdis_sec", shared->sdis_sec, {shared->dim_sdis_sec}, NA_REAL, NA_REAL);
  shared->sdis_tert = user_get_array_fixed<real_type, 1>(user, "sdis_tert", shared->sdis_tert, {shared->dim_sdis_tert}, NA_REAL, NA_REAL);
  shared->ts = user_get_array_fixed<real_type, 1>(user, "ts", shared->ts, {shared->dim_ts}, NA_REAL, NA_REAL);
  shared->vacc_child_starttime = shared->EQUILIB_YEARS + shared->VACC_YEAR - shared->FIRST_YEAR;
  shared->vca = shared->VaccRoutineAge;
  shared->ws = user_get_array_fixed<real_type, 1>(user, "ws", shared->ws, {shared->dim_ws}, NA_REAL, NA_REAL);
  shared->year_calib = 1 + shared->CALIB_YEAR - shared->FIRST_YEAR;
  shared->age_rate_d = user_get_array_fixed<real_type, 2>(user, "age_rate_d", shared->age_rate_d, {shared->dim_age_rate_d_1, shared->dim_age_rate_d_2}, NA_REAL, NA_REAL);
  shared->age_removal_d = user_get_array_fixed<real_type, 2>(user, "age_removal_d", shared->age_removal_d, {shared->dim_age_removal_d_1, shared->dim_age_removal_d_2}, NA_REAL, NA_REAL);
  shared->births_d = user_get_array_fixed<real_type, 2>(user, "births_d", shared->births_d, {shared->dim_births_d_1, shared->dim_births_d_2}, NA_REAL, NA_REAL);
  shared->coverage_d = user_get_array_fixed<real_type, 2>(user, "coverage_d", shared->coverage_d, {shared->dim_coverage_d_1, shared->dim_coverage_d_2}, NA_REAL, NA_REAL);
  shared->Kc_mean = shared->Mwt * shared->delta * (dust::math::pow((shared->epsilon * (shared->gamma - shared->delta) / (real_type) (shared->delta * shared->sigma) - 1), (- 1 / (real_type) shared->omega))) / (real_type) shared->epsilon;
  shared->L_dis = user_get_array_fixed<real_type, 2>(user, "L_dis", shared->L_dis, {shared->dim_L_dis_1, shared->dim_L_dis_2}, NA_REAL, NA_REAL);
  shared->L_sdis = user_get_array_fixed<real_type, 2>(user, "L_sdis", shared->L_sdis, {shared->dim_L_sdis_1, shared->dim_L_sdis_2}, NA_REAL, NA_REAL);
  shared->life_expec_d = user_get_array_fixed<real_type, 2>(user, "life_expec_d", shared->life_expec_d, {shared->dim_life_expec_d_1, shared->dim_life_expec_d_2}, NA_REAL, NA_REAL);
  shared->nc0 = user_get_array_fixed<real_type, 2>(user, "nc0", shared->nc0, {shared->dim_nc0_1, shared->dim_nc0_2}, NA_REAL, NA_REAL);
  shared->nc50_dis = user_get_array_fixed<real_type, 2>(user, "nc50_dis", shared->nc50_dis, {shared->dim_nc50_dis_1, shared->dim_nc50_dis_2}, NA_REAL, NA_REAL);
  shared->nc50_sdis = user_get_array_fixed<real_type, 2>(user, "nc50_sdis", shared->nc50_sdis, {shared->dim_nc50_sdis_1, shared->dim_nc50_sdis_2}, NA_REAL, NA_REAL);
  for (int i = 1; i <= 4; ++i) {
    shared->phi_scale[i - 1] = 1 / (real_type) (1 + shared->dis_pri[i - 1] * shared->phi_ed);
  }
  shared->vacc_child_age = (shared->vca == 0 ? shared->N_age_p1 : shared->vca);
  shared->vacc_child_stoptime = shared->vacc_child_starttime + shared->VACC_END_YEAR - shared->VACC_YEAR;
  shared->vacc_cu_time = shared->vacc_child_starttime;
  for (int i = 1; i <= shared->N_age; ++i) {
    shared->init_life_expec[i - 1] = shared->life_expec_d[shared->dim_life_expec_d_1 * (1 + i - 1) + static_cast<int>(shared->year_calib) - 1];
  }
  shared->init_lifespan = shared->life_expec_d[shared->dim_life_expec_d_1 * 1 + static_cast<int>(shared->year_calib) - 1];
  for (int i = 1; i <= shared->N_age; ++i) {
    shared->N_init_age0[i - 1] = shared->pop_size_d[i + 1 - 1];
  }
  for (int i = 1; i <= 4; ++i) {
    shared->phi_pri[i - 1] = shared->phi_scale[i - 1];
  }
  for (int i = 1; i <= 4; ++i) {
    shared->phi_quart[i - 1] = shared->phi_scale[i - 1];
  }
  for (int i = 1; i <= 4; ++i) {
    shared->phi_sec[i - 1] = shared->phi_scale[i - 1];
  }
  for (int i = 1; i <= 4; ++i) {
    shared->phi_tert[i - 1] = shared->phi_scale[i - 1];
  }
  shared->vacc_cu_rndtime = dust::math::floor(shared->vacc_cu_time * shared->YL / (real_type) shared->age_per) * shared->age_per + 1;
  shared->N_init = odin_sum1<real_type>(shared->N_init_age0.data(), 0, shared->dim_N_init_age0);
  for (int i = 1; i <= shared->N_age; ++i) {
    shared->suscinitpop[i - 1] = shared->FOIas[i - 1] * shared->init_life_expec[i - 1];
  }
  for (int i = 1; i <= shared->N_age; ++i) {
    shared->nc50_age[i - 1] = (i < 5 ? 1 : dust::math::exp(- shared->nc50_age_intercept + shared->nc50_age_slope / (real_type) (shared->ageb[i - 1] + shared->agec[i - 1] / (real_type) 2)));
  }
  shared->pop_scale = (shared->N_sim <= 0 ? 1 : shared->N_sim / (real_type) shared->N_init);
  shared->R0agescale = odin_sum1<real_type>(shared->init_life_expec.data(), 0, shared->dim_init_life_expec) / (real_type) odin_sum1<real_type>(shared->suscinitpop.data(), 0, shared->dim_suscinitpop);
  shared->Beta_hm = shared->R0agescale * shared->R0_req / (real_type) (shared->kappa * shared->kappa * shared->Mwt * shared->inf_per * shared->Beta_mh_mean / (real_type) (1 + shared->delta * shared->eip) / (real_type) shared->delta);
  for (int i = 1; i <= shared->N_age; ++i) {
    shared->N_init_age[i - 1] = shared->pop_size_d[i + 1 - 1] * shared->pop_scale;
  }
  shared->Beta_hm_1 = shared->Beta_hm * shared->Rel_R01;
  shared->Beta_hm_2 = shared->Beta_hm * shared->Rel_R02;
  shared->Beta_hm_3 = shared->Beta_hm * shared->Rel_R03;
  shared->Beta_hm_4 = shared->Beta_hm * shared->Rel_R04;
  shared->initial_NT_out = odin_sum1<real_type>(shared->N_init_age.data(), 0, shared->dim_N_init_age);
  shared->initial_NTnv_out = odin_sum1<real_type>(shared->N_init_age.data(), 0, shared->dim_N_init_age);
  for (int i = 1; i <= shared->N_age; ++i) {
    shared->initial_Ntotal_out[i - 1] = shared->N_init_age[i - 1];
  }
  shared->N_eq = odin_sum1<real_type>(shared->N_init_age.data(), 0, shared->dim_N_init_age);
  shared->initial_Lwt = shared->Mwt * shared->N_eq * shared->delta / (real_type) shared->epsilon;
  shared->initial_Mwt_I1 = dust::math::floor(shared->Mwt * shared->N_eq * static_cast<real_type>(5.0000000000000002e-05));
  shared->initial_Mwt_I2 = dust::math::floor(shared->Mwt * shared->N_eq * static_cast<real_type>(6.0000000000000002e-05));
  shared->initial_Mwt_I3 = dust::math::floor(shared->Mwt * shared->N_eq * static_cast<real_type>(6.9999999999999994e-05));
  shared->initial_Mwt_I4 = dust::math::floor(shared->Mwt * shared->N_eq * static_cast<real_type>(8.0000000000000007e-05));
  shared->initial_Mwt_S = shared->Mwt * shared->N_eq * static_cast<real_type>(0.99970000000000003);
  shared->R0_1 = shared->kappa * shared->kappa * shared->Mwt * shared->Beta_hm_1 * shared->inf_per * shared->Beta_mh_mean / (real_type) (1 + shared->delta * shared->eip) / (real_type) shared->delta / (real_type) shared->R0agescale;
  shared->R0_2 = shared->kappa * shared->kappa * shared->Mwt * shared->Beta_hm_2 * shared->inf_per * shared->Beta_mh_mean / (real_type) (1 + shared->delta * shared->eip) / (real_type) shared->delta / (real_type) shared->R0agescale;
  shared->R0_3 = shared->kappa * shared->kappa * shared->Mwt * shared->Beta_hm_3 * shared->inf_per * shared->Beta_mh_mean / (real_type) (1 + shared->delta * shared->eip) / (real_type) shared->delta / (real_type) shared->R0agescale;
  shared->R0_4 = shared->kappa * shared->kappa * shared->Mwt * shared->Beta_hm_4 * shared->inf_per * shared->Beta_mh_mean / (real_type) (1 + shared->delta * shared->eip) / (real_type) shared->delta / (real_type) shared->R0agescale;
  shared->Wb_introrate = shared->Wb_introlevel * shared->Mwt * shared->N_eq * shared->DT / (real_type) shared->Wb_introduration;
  shared->eq_FOI1 = shared->R0_1 / (real_type) shared->init_lifespan;
  shared->eq_FOI2 = shared->R0_2 / (real_type) shared->init_lifespan;
  shared->eq_FOI3 = shared->R0_3 / (real_type) shared->init_lifespan;
  shared->eq_FOI4 = shared->R0_4 / (real_type) shared->init_lifespan;
  for (int i = 1; i <= shared->N_age; ++i) {
    int j = 1;
    shared->initial_R1[i - 1 + shared->dim_R1_1 * (j - 1)] = dust::math::floor(static_cast<real_type>(0.5) + shared->N_init_age[i - 1] * (1 - dust::math::exp(- shared->eq_FOI1 * shared->mean_age[i - 1])) * dust::math::exp(- (shared->eq_FOI2 + shared->eq_FOI3 + shared->eq_FOI4) * shared->mean_age[i - 1]));
  }
  for (int i = 1; i <= shared->N_age; ++i) {
    for (int j = 2; j <= 3; ++j) {
      shared->initial_R1[i - 1 + shared->dim_R1_1 * (j - 1)] = 0;
    }
  }
  for (int i = 1; i <= shared->N_age; ++i) {
    int j = 1;
    shared->initial_R12[i - 1 + shared->dim_R12_1 * (j - 1)] = dust::math::floor(static_cast<real_type>(0.5) + shared->N_init_age[i - 1] * (1 - dust::math::exp(- shared->eq_FOI1 * shared->mean_age[i - 1])) * (1 - dust::math::exp(- shared->eq_FOI2 * shared->mean_age[i - 1])) * dust::math::exp(- (shared->eq_FOI3 + shared->eq_FOI4) * shared->mean_age[i - 1]));
  }
  for (int i = 1; i <= shared->N_age; ++i) {
    for (int j = 2; j <= 3; ++j) {
      shared->initial_R12[i - 1 + shared->dim_R12_1 * (j - 1)] = 0;
    }
  }
  for (int i = 1; i <= shared->N_age; ++i) {
    int j = 1;
    shared->initial_R123[i - 1 + shared->dim_R123_1 * (j - 1)] = dust::math::floor(static_cast<real_type>(0.5) + shared->N_init_age[i - 1] * (1 - dust::math::exp(- shared->eq_FOI1 * shared->mean_age[i - 1])) * (1 - dust::math::exp(- shared->eq_FOI2 * shared->mean_age[i - 1])) * (1 - dust::math::exp(- shared->eq_FOI3 * shared->mean_age[i - 1])) * dust::math::exp(- shared->eq_FOI4 * shared->mean_age[i - 1]));
  }
  for (int i = 1; i <= shared->N_age; ++i) {
    for (int j = 2; j <= 3; ++j) {
      shared->initial_R123[i - 1 + shared->dim_R123_1 * (j - 1)] = 0;
    }
  }
  for (int i = 1; i <= shared->N_age; ++i) {
    int j = 1;
    shared->initial_R1234[i - 1 + shared->dim_R1234_1 * (j - 1)] = dust::math::floor(static_cast<real_type>(0.5) + shared->N_init_age[i - 1] * (1 - dust::math::exp(- shared->eq_FOI1 * shared->mean_age[i - 1])) * (1 - dust::math::exp(- shared->eq_FOI2 * shared->mean_age[i - 1])) * (1 - dust::math::exp(- shared->eq_FOI3 * shared->mean_age[i - 1])) * (1 - dust::math::exp(- shared->eq_FOI4 * shared->mean_age[i - 1])));
  }
  for (int i = 1; i <= shared->N_age; ++i) {
    for (int j = 2; j <= 3; ++j) {
      shared->initial_R1234[i - 1 + shared->dim_R1234_1 * (j - 1)] = 0;
    }
  }
  for (int i = 1; i <= shared->N_age; ++i) {
    int j = 1;
    shared->initial_R124[i - 1 + shared->dim_R124_1 * (j - 1)] = dust::math::floor(static_cast<real_type>(0.5) + shared->N_init_age[i - 1] * (1 - dust::math::exp(- shared->eq_FOI1 * shared->mean_age[i - 1])) * (1 - dust::math::exp(- shared->eq_FOI2 * shared->mean_age[i - 1])) * (1 - dust::math::exp(- shared->eq_FOI4 * shared->mean_age[i - 1])) * dust::math::exp(- shared->eq_FOI3 * shared->mean_age[i - 1]));
  }
  for (int i = 1; i <= shared->N_age; ++i) {
    for (int j = 2; j <= 3; ++j) {
      shared->initial_R124[i - 1 + shared->dim_R124_1 * (j - 1)] = 0;
    }
  }
  for (int i = 1; i <= shared->N_age; ++i) {
    int j = 1;
    shared->initial_R13[i - 1 + shared->dim_R13_1 * (j - 1)] = dust::math::floor(static_cast<real_type>(0.5) + shared->N_init_age[i - 1] * (1 - dust::math::exp(- shared->eq_FOI1 * shared->mean_age[i - 1])) * (1 - dust::math::exp(- shared->eq_FOI3 * shared->mean_age[i - 1])) * dust::math::exp(- (shared->eq_FOI2 + shared->eq_FOI4) * shared->mean_age[i - 1]));
  }
  for (int i = 1; i <= shared->N_age; ++i) {
    for (int j = 2; j <= 3; ++j) {
      shared->initial_R13[i - 1 + shared->dim_R13_1 * (j - 1)] = 0;
    }
  }
  for (int i = 1; i <= shared->N_age; ++i) {
    int j = 1;
    shared->initial_R134[i - 1 + shared->dim_R134_1 * (j - 1)] = dust::math::floor(static_cast<real_type>(0.5) + shared->N_init_age[i - 1] * (1 - dust::math::exp(- shared->eq_FOI1 * shared->mean_age[i - 1])) * (1 - dust::math::exp(- shared->eq_FOI3 * shared->mean_age[i - 1])) * (1 - dust::math::exp(- shared->eq_FOI4 * shared->mean_age[i - 1])) * dust::math::exp(- shared->eq_FOI2 * shared->mean_age[i - 1]));
  }
  for (int i = 1; i <= shared->N_age; ++i) {
    for (int j = 2; j <= 3; ++j) {
      shared->initial_R134[i - 1 + shared->dim_R134_1 * (j - 1)] = 0;
    }
  }
  for (int i = 1; i <= shared->N_age; ++i) {
    int j = 1;
    shared->initial_R14[i - 1 + shared->dim_R14_1 * (j - 1)] = dust::math::floor(static_cast<real_type>(0.5) + shared->N_init_age[i - 1] * (1 - dust::math::exp(- shared->eq_FOI1 * shared->mean_age[i - 1])) * (1 - dust::math::exp(- shared->eq_FOI4 * shared->mean_age[i - 1])) * dust::math::exp(- (shared->eq_FOI2 + shared->eq_FOI3) * shared->mean_age[i - 1]));
  }
  for (int i = 1; i <= shared->N_age; ++i) {
    for (int j = 2; j <= 3; ++j) {
      shared->initial_R14[i - 1 + shared->dim_R14_1 * (j - 1)] = 0;
    }
  }
  for (int i = 1; i <= shared->N_age; ++i) {
    int j = 1;
    shared->initial_R2[i - 1 + shared->dim_R2_1 * (j - 1)] = dust::math::floor(static_cast<real_type>(0.5) + shared->N_init_age[i - 1] * (1 - dust::math::exp(- shared->eq_FOI2 * shared->mean_age[i - 1])) * dust::math::exp(- (shared->eq_FOI1 + shared->eq_FOI3 + shared->eq_FOI4) * shared->mean_age[i - 1]));
  }
  for (int i = 1; i <= shared->N_age; ++i) {
    for (int j = 2; j <= 3; ++j) {
      shared->initial_R2[i - 1 + shared->dim_R2_1 * (j - 1)] = 0;
    }
  }
  for (int i = 1; i <= shared->N_age; ++i) {
    int j = 1;
    shared->initial_R23[i - 1 + shared->dim_R23_1 * (j - 1)] = dust::math::floor(static_cast<real_type>(0.5) + shared->N_init_age[i - 1] * (1 - dust::math::exp(- shared->eq_FOI2 * shared->mean_age[i - 1])) * (1 - dust::math::exp(- shared->eq_FOI3 * shared->mean_age[i - 1])) * dust::math::exp(- (shared->eq_FOI1 + shared->eq_FOI4) * shared->mean_age[i - 1]));
  }
  for (int i = 1; i <= shared->N_age; ++i) {
    for (int j = 2; j <= 3; ++j) {
      shared->initial_R23[i - 1 + shared->dim_R23_1 * (j - 1)] = 0;
    }
  }
  for (int i = 1; i <= shared->N_age; ++i) {
    int j = 1;
    shared->initial_R234[i - 1 + shared->dim_R234_1 * (j - 1)] = dust::math::floor(static_cast<real_type>(0.5) + shared->N_init_age[i - 1] * (1 - dust::math::exp(- shared->eq_FOI2 * shared->mean_age[i - 1])) * (1 - dust::math::exp(- shared->eq_FOI3 * shared->mean_age[i - 1])) * (1 - dust::math::exp(- shared->eq_FOI4 * shared->mean_age[i - 1])) * dust::math::exp(- shared->eq_FOI1 * shared->mean_age[i - 1]));
  }
  for (int i = 1; i <= shared->N_age; ++i) {
    for (int j = 2; j <= 3; ++j) {
      shared->initial_R234[i - 1 + shared->dim_R234_1 * (j - 1)] = 0;
    }
  }
  for (int i = 1; i <= shared->N_age; ++i) {
    int j = 1;
    shared->initial_R24[i - 1 + shared->dim_R24_1 * (j - 1)] = dust::math::floor(static_cast<real_type>(0.5) + shared->N_init_age[i - 1] * (1 - dust::math::exp(- shared->eq_FOI2 * shared->mean_age[i - 1])) * (1 - dust::math::exp(- shared->eq_FOI4 * shared->mean_age[i - 1])) * dust::math::exp(- (shared->eq_FOI1 + shared->eq_FOI3) * shared->mean_age[i - 1]));
  }
  for (int i = 1; i <= shared->N_age; ++i) {
    for (int j = 2; j <= 3; ++j) {
      shared->initial_R24[i - 1 + shared->dim_R24_1 * (j - 1)] = 0;
    }
  }
  for (int i = 1; i <= shared->N_age; ++i) {
    int j = 1;
    shared->initial_R3[i - 1 + shared->dim_R3_1 * (j - 1)] = dust::math::floor(static_cast<real_type>(0.5) + shared->N_init_age[i - 1] * (1 - dust::math::exp(- shared->eq_FOI3 * shared->mean_age[i - 1])) * dust::math::exp(- (shared->eq_FOI1 + shared->eq_FOI2 + shared->eq_FOI4) * shared->mean_age[i - 1]));
  }
  for (int i = 1; i <= shared->N_age; ++i) {
    for (int j = 2; j <= 3; ++j) {
      shared->initial_R3[i - 1 + shared->dim_R3_1 * (j - 1)] = 0;
    }
  }
  for (int i = 1; i <= shared->N_age; ++i) {
    int j = 1;
    shared->initial_R34[i - 1 + shared->dim_R34_1 * (j - 1)] = dust::math::floor(static_cast<real_type>(0.5) + shared->N_init_age[i - 1] * (1 - dust::math::exp(- shared->eq_FOI3 * shared->mean_age[i - 1])) * (1 - dust::math::exp(- shared->eq_FOI4 * shared->mean_age[i - 1])) * dust::math::exp(- (shared->eq_FOI1 + shared->eq_FOI2) * shared->mean_age[i - 1]));
  }
  for (int i = 1; i <= shared->N_age; ++i) {
    for (int j = 2; j <= 3; ++j) {
      shared->initial_R34[i - 1 + shared->dim_R34_1 * (j - 1)] = 0;
    }
  }
  for (int i = 1; i <= shared->N_age; ++i) {
    int j = 1;
    shared->initial_R4[i - 1 + shared->dim_R4_1 * (j - 1)] = dust::math::floor(static_cast<real_type>(0.5) + shared->N_init_age[i - 1] * (1 - dust::math::exp(- shared->eq_FOI4 * shared->mean_age[i - 1])) * dust::math::exp(- (shared->eq_FOI1 + shared->eq_FOI2 + shared->eq_FOI3) * shared->mean_age[i - 1]));
  }
  for (int i = 1; i <= shared->N_age; ++i) {
    for (int j = 2; j <= 3; ++j) {
      shared->initial_R4[i - 1 + shared->dim_R4_1 * (j - 1)] = 0;
    }
  }
  for (int i = 1; i <= shared->N_age; ++i) {
    int j = 1;
    shared->initial_S[i - 1 + shared->dim_S_1 * (j - 1)] = dust::math::floor(static_cast<real_type>(0.5) + shared->N_init_age[i - 1] * dust::math::exp(- (shared->eq_FOI1 + shared->eq_FOI2 + shared->eq_FOI3 + shared->eq_FOI4) * shared->mean_age[i - 1]));
  }
  for (int i = 1; i <= shared->N_age; ++i) {
    for (int j = 2; j <= 3; ++j) {
      shared->initial_S[i - 1 + shared->dim_S_1 * (j - 1)] = 0;
    }
  }
  return dust::pars_type<model>(shared, internal);
}
template <>
cpp11::sexp dust_info<model>(const dust::pars_type<model>& pars) {
  const std::shared_ptr<const model::shared_type> shared = pars.shared;
  cpp11::writable::strings nms({"Lwt", "Mwt_S", "Mwt_E1", "Mwt_E2", "Mwt_E3", "Mwt_E4", "Mwt_I1", "Mwt_I2", "Mwt_I3", "Mwt_I4", "Lwb", "Mwb_S", "Mwb_E1", "Mwb_E2", "Mwb_E3", "Mwb_E4", "Mwb_I1", "Mwb_I2", "Mwb_I3", "Mwb_I4", "NT_out", "NTv_out", "NTnv_out", "NTvS_out", "NTvE_out", "prop_seroneg_at_9_out", "prop_seroneg_at_vca_out", "Y1T_out", "Y2T_out", "Y3T_out", "Y4T_out", "exposed1", "exposed2", "exposed3", "exposed4", "infectious1", "infectious2", "infectious3", "infectious4", "inc_FOI1", "inc_FOI2", "inc_FOI3", "inc_FOI4", "tot_inc_FOI", "cum_prop_seroneg_at_9", "cum_prop_seroneg_at_vca", "tot_inc_dis", "out_time_from_last_dose", "Ntotal_out", "cum_infection_pri", "cum_infection_priV", "cum_infection_sec", "cum_infection_secV", "cum_infection_tq", "cum_infection_tqV", "VE_seroneg1n", "VE_seroneg1p", "out_prop_seroneg_at_9", "out_prop_seroneg_at_vca", "out_dis_all_pop", "out_dis_all_unvacc", "out_dis_all_vacc", "out_dis_all_vacc_neg", "out_dis_all_vacc_pos", "out_disc_dis_all_pop", "out_disc_dis_all_vacc", "out_sdis_all_pop", "out_sdis_all_unvacc", "out_sdis_all_vacc", "out_sdis_all_vacc_neg", "out_sdis_all_vacc_pos", "out_disc_sdis_all_pop", "out_disc_sdis_all_vacc", "out_yll_all_pop", "out_yll_all_unvacc", "out_yll_all_vacc", "out_yll_all_vacc_neg", "out_yll_all_vacc_pos", "out_disc_yll_all_pop", "out_disc_yll_all_vacc", "out_nvacc_all_pop", "out_nvacc_all_neg", "out_nvacc_all_pos", "out_disc_nvacc_all_pop", "S", "I1", "I2", "I3", "I4", "R1", "R2", "R3", "R4", "I21", "I31", "I41", "I12", "I32", "I42", "I13", "I23", "I43", "I14", "I24", "I34", "R12", "R13", "R14", "R23", "R24", "R34", "I231", "I241", "I341", "I132", "I142", "I342", "I123", "I143", "I243", "I124", "I134", "I234", "R123", "R124", "R134", "R234", "I2341", "I1342", "I1243", "I1234", "R1234", "out_dis_sero_pop", "out_dis_sero_unvacc", "out_dis_sero_vacc", "out_dis_sero_vacc_neg", "out_dis_sero_vacc_pos", "out_sdis_sero_pop", "out_sdis_sero_unvacc", "out_sdis_sero_vacc", "out_sdis_sero_vacc_neg", "out_sdis_sero_vacc_pos", "out_yll_sero_pop", "out_yll_sero_unvacc", "out_yll_sero_vacc", "out_yll_sero_vacc_neg", "out_yll_sero_vacc_pos", "out_nc", "out_RR"});
  cpp11::writable::list dim(149);
  dim[0] = cpp11::writable::integers({1});
  dim[1] = cpp11::writable::integers({1});
  dim[2] = cpp11::writable::integers({1});
  dim[3] = cpp11::writable::integers({1});
  dim[4] = cpp11::writable::integers({1});
  dim[5] = cpp11::writable::integers({1});
  dim[6] = cpp11::writable::integers({1});
  dim[7] = cpp11::writable::integers({1});
  dim[8] = cpp11::writable::integers({1});
  dim[9] = cpp11::writable::integers({1});
  dim[10] = cpp11::writable::integers({1});
  dim[11] = cpp11::writable::integers({1});
  dim[12] = cpp11::writable::integers({1});
  dim[13] = cpp11::writable::integers({1});
  dim[14] = cpp11::writable::integers({1});
  dim[15] = cpp11::writable::integers({1});
  dim[16] = cpp11::writable::integers({1});
  dim[17] = cpp11::writable::integers({1});
  dim[18] = cpp11::writable::integers({1});
  dim[19] = cpp11::writable::integers({1});
  dim[20] = cpp11::writable::integers({1});
  dim[21] = cpp11::writable::integers({1});
  dim[22] = cpp11::writable::integers({1});
  dim[23] = cpp11::writable::integers({1});
  dim[24] = cpp11::writable::integers({1});
  dim[25] = cpp11::writable::integers({1});
  dim[26] = cpp11::writable::integers({1});
  dim[27] = cpp11::writable::integers({1});
  dim[28] = cpp11::writable::integers({1});
  dim[29] = cpp11::writable::integers({1});
  dim[30] = cpp11::writable::integers({1});
  dim[31] = cpp11::writable::integers({1});
  dim[32] = cpp11::writable::integers({1});
  dim[33] = cpp11::writable::integers({1});
  dim[34] = cpp11::writable::integers({1});
  dim[35] = cpp11::writable::integers({1});
  dim[36] = cpp11::writable::integers({1});
  dim[37] = cpp11::writable::integers({1});
  dim[38] = cpp11::writable::integers({1});
  dim[39] = cpp11::writable::integers({1});
  dim[40] = cpp11::writable::integers({1});
  dim[41] = cpp11::writable::integers({1});
  dim[42] = cpp11::writable::integers({1});
  dim[43] = cpp11::writable::integers({1});
  dim[44] = cpp11::writable::integers({1});
  dim[45] = cpp11::writable::integers({1});
  dim[46] = cpp11::writable::integers({1});
  dim[47] = cpp11::writable::integers({shared->dim_out_time_from_last_dose});
  dim[48] = cpp11::writable::integers({shared->dim_Ntotal_out});
  dim[49] = cpp11::writable::integers({shared->dim_cum_infection_pri});
  dim[50] = cpp11::writable::integers({shared->dim_cum_infection_priV});
  dim[51] = cpp11::writable::integers({shared->dim_cum_infection_sec});
  dim[52] = cpp11::writable::integers({shared->dim_cum_infection_secV});
  dim[53] = cpp11::writable::integers({shared->dim_cum_infection_tq});
  dim[54] = cpp11::writable::integers({shared->dim_cum_infection_tqV});
  dim[55] = cpp11::writable::integers({shared->dim_VE_seroneg1n});
  dim[56] = cpp11::writable::integers({shared->dim_VE_seroneg1p});
  dim[57] = cpp11::writable::integers({shared->dim_out_prop_seroneg_at_9});
  dim[58] = cpp11::writable::integers({shared->dim_out_prop_seroneg_at_vca});
  dim[59] = cpp11::writable::integers({shared->dim_out_dis_all_pop});
  dim[60] = cpp11::writable::integers({shared->dim_out_dis_all_unvacc});
  dim[61] = cpp11::writable::integers({shared->dim_out_dis_all_vacc});
  dim[62] = cpp11::writable::integers({shared->dim_out_dis_all_vacc_neg});
  dim[63] = cpp11::writable::integers({shared->dim_out_dis_all_vacc_pos});
  dim[64] = cpp11::writable::integers({shared->dim_out_disc_dis_all_pop});
  dim[65] = cpp11::writable::integers({shared->dim_out_disc_dis_all_vacc});
  dim[66] = cpp11::writable::integers({shared->dim_out_sdis_all_pop});
  dim[67] = cpp11::writable::integers({shared->dim_out_sdis_all_unvacc});
  dim[68] = cpp11::writable::integers({shared->dim_out_sdis_all_vacc});
  dim[69] = cpp11::writable::integers({shared->dim_out_sdis_all_vacc_neg});
  dim[70] = cpp11::writable::integers({shared->dim_out_sdis_all_vacc_pos});
  dim[71] = cpp11::writable::integers({shared->dim_out_disc_sdis_all_pop});
  dim[72] = cpp11::writable::integers({shared->dim_out_disc_sdis_all_vacc});
  dim[73] = cpp11::writable::integers({shared->dim_out_yll_all_pop});
  dim[74] = cpp11::writable::integers({shared->dim_out_yll_all_unvacc});
  dim[75] = cpp11::writable::integers({shared->dim_out_yll_all_vacc});
  dim[76] = cpp11::writable::integers({shared->dim_out_yll_all_vacc_neg});
  dim[77] = cpp11::writable::integers({shared->dim_out_yll_all_vacc_pos});
  dim[78] = cpp11::writable::integers({shared->dim_out_disc_yll_all_pop});
  dim[79] = cpp11::writable::integers({shared->dim_out_disc_yll_all_vacc});
  dim[80] = cpp11::writable::integers({shared->dim_out_nvacc_all_pop});
  dim[81] = cpp11::writable::integers({shared->dim_out_nvacc_all_neg});
  dim[82] = cpp11::writable::integers({shared->dim_out_nvacc_all_pos});
  dim[83] = cpp11::writable::integers({shared->dim_out_disc_nvacc_all_pop});
  dim[84] = cpp11::writable::integers({shared->dim_S_1, shared->dim_S_2});
  dim[85] = cpp11::writable::integers({shared->dim_I1_1, shared->dim_I1_2});
  dim[86] = cpp11::writable::integers({shared->dim_I2_1, shared->dim_I2_2});
  dim[87] = cpp11::writable::integers({shared->dim_I3_1, shared->dim_I3_2});
  dim[88] = cpp11::writable::integers({shared->dim_I4_1, shared->dim_I4_2});
  dim[89] = cpp11::writable::integers({shared->dim_R1_1, shared->dim_R1_2});
  dim[90] = cpp11::writable::integers({shared->dim_R2_1, shared->dim_R2_2});
  dim[91] = cpp11::writable::integers({shared->dim_R3_1, shared->dim_R3_2});
  dim[92] = cpp11::writable::integers({shared->dim_R4_1, shared->dim_R4_2});
  dim[93] = cpp11::writable::integers({shared->dim_I21_1, shared->dim_I21_2});
  dim[94] = cpp11::writable::integers({shared->dim_I31_1, shared->dim_I31_2});
  dim[95] = cpp11::writable::integers({shared->dim_I41_1, shared->dim_I41_2});
  dim[96] = cpp11::writable::integers({shared->dim_I12_1, shared->dim_I12_2});
  dim[97] = cpp11::writable::integers({shared->dim_I32_1, shared->dim_I32_2});
  dim[98] = cpp11::writable::integers({shared->dim_I42_1, shared->dim_I42_2});
  dim[99] = cpp11::writable::integers({shared->dim_I13_1, shared->dim_I13_2});
  dim[100] = cpp11::writable::integers({shared->dim_I23_1, shared->dim_I23_2});
  dim[101] = cpp11::writable::integers({shared->dim_I43_1, shared->dim_I43_2});
  dim[102] = cpp11::writable::integers({shared->dim_I14_1, shared->dim_I14_2});
  dim[103] = cpp11::writable::integers({shared->dim_I24_1, shared->dim_I24_2});
  dim[104] = cpp11::writable::integers({shared->dim_I34_1, shared->dim_I34_2});
  dim[105] = cpp11::writable::integers({shared->dim_R12_1, shared->dim_R12_2});
  dim[106] = cpp11::writable::integers({shared->dim_R13_1, shared->dim_R13_2});
  dim[107] = cpp11::writable::integers({shared->dim_R14_1, shared->dim_R14_2});
  dim[108] = cpp11::writable::integers({shared->dim_R23_1, shared->dim_R23_2});
  dim[109] = cpp11::writable::integers({shared->dim_R24_1, shared->dim_R24_2});
  dim[110] = cpp11::writable::integers({shared->dim_R34_1, shared->dim_R34_2});
  dim[111] = cpp11::writable::integers({shared->dim_I231_1, shared->dim_I231_2});
  dim[112] = cpp11::writable::integers({shared->dim_I241_1, shared->dim_I241_2});
  dim[113] = cpp11::writable::integers({shared->dim_I341_1, shared->dim_I341_2});
  dim[114] = cpp11::writable::integers({shared->dim_I132_1, shared->dim_I132_2});
  dim[115] = cpp11::writable::integers({shared->dim_I142_1, shared->dim_I142_2});
  dim[116] = cpp11::writable::integers({shared->dim_I342_1, shared->dim_I342_2});
  dim[117] = cpp11::writable::integers({shared->dim_I123_1, shared->dim_I123_2});
  dim[118] = cpp11::writable::integers({shared->dim_I143_1, shared->dim_I143_2});
  dim[119] = cpp11::writable::integers({shared->dim_I243_1, shared->dim_I243_2});
  dim[120] = cpp11::writable::integers({shared->dim_I124_1, shared->dim_I124_2});
  dim[121] = cpp11::writable::integers({shared->dim_I134_1, shared->dim_I134_2});
  dim[122] = cpp11::writable::integers({shared->dim_I234_1, shared->dim_I234_2});
  dim[123] = cpp11::writable::integers({shared->dim_R123_1, shared->dim_R123_2});
  dim[124] = cpp11::writable::integers({shared->dim_R124_1, shared->dim_R124_2});
  dim[125] = cpp11::writable::integers({shared->dim_R134_1, shared->dim_R134_2});
  dim[126] = cpp11::writable::integers({shared->dim_R234_1, shared->dim_R234_2});
  dim[127] = cpp11::writable::integers({shared->dim_I2341_1, shared->dim_I2341_2});
  dim[128] = cpp11::writable::integers({shared->dim_I1342_1, shared->dim_I1342_2});
  dim[129] = cpp11::writable::integers({shared->dim_I1243_1, shared->dim_I1243_2});
  dim[130] = cpp11::writable::integers({shared->dim_I1234_1, shared->dim_I1234_2});
  dim[131] = cpp11::writable::integers({shared->dim_R1234_1, shared->dim_R1234_2});
  dim[132] = cpp11::writable::integers({shared->dim_out_dis_sero_pop_1, shared->dim_out_dis_sero_pop_2});
  dim[133] = cpp11::writable::integers({shared->dim_out_dis_sero_unvacc_1, shared->dim_out_dis_sero_unvacc_2});
  dim[134] = cpp11::writable::integers({shared->dim_out_dis_sero_vacc_1, shared->dim_out_dis_sero_vacc_2});
  dim[135] = cpp11::writable::integers({shared->dim_out_dis_sero_vacc_neg_1, shared->dim_out_dis_sero_vacc_neg_2});
  dim[136] = cpp11::writable::integers({shared->dim_out_dis_sero_vacc_pos_1, shared->dim_out_dis_sero_vacc_pos_2});
  dim[137] = cpp11::writable::integers({shared->dim_out_sdis_sero_pop_1, shared->dim_out_sdis_sero_pop_2});
  dim[138] = cpp11::writable::integers({shared->dim_out_sdis_sero_unvacc_1, shared->dim_out_sdis_sero_unvacc_2});
  dim[139] = cpp11::writable::integers({shared->dim_out_sdis_sero_vacc_1, shared->dim_out_sdis_sero_vacc_2});
  dim[140] = cpp11::writable::integers({shared->dim_out_sdis_sero_vacc_neg_1, shared->dim_out_sdis_sero_vacc_neg_2});
  dim[141] = cpp11::writable::integers({shared->dim_out_sdis_sero_vacc_pos_1, shared->dim_out_sdis_sero_vacc_pos_2});
  dim[142] = cpp11::writable::integers({shared->dim_out_yll_sero_pop_1, shared->dim_out_yll_sero_pop_2});
  dim[143] = cpp11::writable::integers({shared->dim_out_yll_sero_unvacc_1, shared->dim_out_yll_sero_unvacc_2});
  dim[144] = cpp11::writable::integers({shared->dim_out_yll_sero_vacc_1, shared->dim_out_yll_sero_vacc_2});
  dim[145] = cpp11::writable::integers({shared->dim_out_yll_sero_vacc_neg_1, shared->dim_out_yll_sero_vacc_neg_2});
  dim[146] = cpp11::writable::integers({shared->dim_out_yll_sero_vacc_pos_1, shared->dim_out_yll_sero_vacc_pos_2});
  dim[147] = cpp11::writable::integers({shared->dim_out_nc_1, shared->dim_out_nc_2, shared->dim_out_nc_3});
  dim[148] = cpp11::writable::integers({shared->dim_out_RR_1, shared->dim_out_RR_2, shared->dim_out_RR_3});
  dim.names() = nms;
  cpp11::writable::list index(149);
  index[0] = cpp11::writable::integers({1});
  index[1] = cpp11::writable::integers({2});
  index[2] = cpp11::writable::integers({3});
  index[3] = cpp11::writable::integers({4});
  index[4] = cpp11::writable::integers({5});
  index[5] = cpp11::writable::integers({6});
  index[6] = cpp11::writable::integers({7});
  index[7] = cpp11::writable::integers({8});
  index[8] = cpp11::writable::integers({9});
  index[9] = cpp11::writable::integers({10});
  index[10] = cpp11::writable::integers({11});
  index[11] = cpp11::writable::integers({12});
  index[12] = cpp11::writable::integers({13});
  index[13] = cpp11::writable::integers({14});
  index[14] = cpp11::writable::integers({15});
  index[15] = cpp11::writable::integers({16});
  index[16] = cpp11::writable::integers({17});
  index[17] = cpp11::writable::integers({18});
  index[18] = cpp11::writable::integers({19});
  index[19] = cpp11::writable::integers({20});
  index[20] = cpp11::writable::integers({21});
  index[21] = cpp11::writable::integers({22});
  index[22] = cpp11::writable::integers({23});
  index[23] = cpp11::writable::integers({24});
  index[24] = cpp11::writable::integers({25});
  index[25] = cpp11::writable::integers({26});
  index[26] = cpp11::writable::integers({27});
  index[27] = cpp11::writable::integers({28});
  index[28] = cpp11::writable::integers({29});
  index[29] = cpp11::writable::integers({30});
  index[30] = cpp11::writable::integers({31});
  index[31] = cpp11::writable::integers({32});
  index[32] = cpp11::writable::integers({33});
  index[33] = cpp11::writable::integers({34});
  index[34] = cpp11::writable::integers({35});
  index[35] = cpp11::writable::integers({36});
  index[36] = cpp11::writable::integers({37});
  index[37] = cpp11::writable::integers({38});
  index[38] = cpp11::writable::integers({39});
  index[39] = cpp11::writable::integers({40});
  index[40] = cpp11::writable::integers({41});
  index[41] = cpp11::writable::integers({42});
  index[42] = cpp11::writable::integers({43});
  index[43] = cpp11::writable::integers({44});
  index[44] = cpp11::writable::integers({45});
  index[45] = cpp11::writable::integers({46});
  index[46] = cpp11::writable::integers({47});
  index[47] = integer_sequence(48, shared->dim_out_time_from_last_dose);
  index[48] = integer_sequence(shared->offset_variable_Ntotal_out + 1, shared->dim_Ntotal_out);
  index[49] = integer_sequence(shared->offset_variable_cum_infection_pri + 1, shared->dim_cum_infection_pri);
  index[50] = integer_sequence(shared->offset_variable_cum_infection_priV + 1, shared->dim_cum_infection_priV);
  index[51] = integer_sequence(shared->offset_variable_cum_infection_sec + 1, shared->dim_cum_infection_sec);
  index[52] = integer_sequence(shared->offset_variable_cum_infection_secV + 1, shared->dim_cum_infection_secV);
  index[53] = integer_sequence(shared->offset_variable_cum_infection_tq + 1, shared->dim_cum_infection_tq);
  index[54] = integer_sequence(shared->offset_variable_cum_infection_tqV + 1, shared->dim_cum_infection_tqV);
  index[55] = integer_sequence(shared->offset_variable_VE_seroneg1n + 1, shared->dim_VE_seroneg1n);
  index[56] = integer_sequence(shared->offset_variable_VE_seroneg1p + 1, shared->dim_VE_seroneg1p);
  index[57] = integer_sequence(shared->offset_variable_out_prop_seroneg_at_9 + 1, shared->dim_out_prop_seroneg_at_9);
  index[58] = integer_sequence(shared->offset_variable_out_prop_seroneg_at_vca + 1, shared->dim_out_prop_seroneg_at_vca);
  index[59] = integer_sequence(shared->offset_variable_out_dis_all_pop + 1, shared->dim_out_dis_all_pop);
  index[60] = integer_sequence(shared->offset_variable_out_dis_all_unvacc + 1, shared->dim_out_dis_all_unvacc);
  index[61] = integer_sequence(shared->offset_variable_out_dis_all_vacc + 1, shared->dim_out_dis_all_vacc);
  index[62] = integer_sequence(shared->offset_variable_out_dis_all_vacc_neg + 1, shared->dim_out_dis_all_vacc_neg);
  index[63] = integer_sequence(shared->offset_variable_out_dis_all_vacc_pos + 1, shared->dim_out_dis_all_vacc_pos);
  index[64] = integer_sequence(shared->offset_variable_out_disc_dis_all_pop + 1, shared->dim_out_disc_dis_all_pop);
  index[65] = integer_sequence(shared->offset_variable_out_disc_dis_all_vacc + 1, shared->dim_out_disc_dis_all_vacc);
  index[66] = integer_sequence(shared->offset_variable_out_sdis_all_pop + 1, shared->dim_out_sdis_all_pop);
  index[67] = integer_sequence(shared->offset_variable_out_sdis_all_unvacc + 1, shared->dim_out_sdis_all_unvacc);
  index[68] = integer_sequence(shared->offset_variable_out_sdis_all_vacc + 1, shared->dim_out_sdis_all_vacc);
  index[69] = integer_sequence(shared->offset_variable_out_sdis_all_vacc_neg + 1, shared->dim_out_sdis_all_vacc_neg);
  index[70] = integer_sequence(shared->offset_variable_out_sdis_all_vacc_pos + 1, shared->dim_out_sdis_all_vacc_pos);
  index[71] = integer_sequence(shared->offset_variable_out_disc_sdis_all_pop + 1, shared->dim_out_disc_sdis_all_pop);
  index[72] = integer_sequence(shared->offset_variable_out_disc_sdis_all_vacc + 1, shared->dim_out_disc_sdis_all_vacc);
  index[73] = integer_sequence(shared->offset_variable_out_yll_all_pop + 1, shared->dim_out_yll_all_pop);
  index[74] = integer_sequence(shared->offset_variable_out_yll_all_unvacc + 1, shared->dim_out_yll_all_unvacc);
  index[75] = integer_sequence(shared->offset_variable_out_yll_all_vacc + 1, shared->dim_out_yll_all_vacc);
  index[76] = integer_sequence(shared->offset_variable_out_yll_all_vacc_neg + 1, shared->dim_out_yll_all_vacc_neg);
  index[77] = integer_sequence(shared->offset_variable_out_yll_all_vacc_pos + 1, shared->dim_out_yll_all_vacc_pos);
  index[78] = integer_sequence(shared->offset_variable_out_disc_yll_all_pop + 1, shared->dim_out_disc_yll_all_pop);
  index[79] = integer_sequence(shared->offset_variable_out_disc_yll_all_vacc + 1, shared->dim_out_disc_yll_all_vacc);
  index[80] = integer_sequence(shared->offset_variable_out_nvacc_all_pop + 1, shared->dim_out_nvacc_all_pop);
  index[81] = integer_sequence(shared->offset_variable_out_nvacc_all_neg + 1, shared->dim_out_nvacc_all_neg);
  index[82] = integer_sequence(shared->offset_variable_out_nvacc_all_pos + 1, shared->dim_out_nvacc_all_pos);
  index[83] = integer_sequence(shared->offset_variable_out_disc_nvacc_all_pop + 1, shared->dim_out_disc_nvacc_all_pop);
  index[84] = integer_sequence(shared->offset_variable_S + 1, shared->dim_S);
  index[85] = integer_sequence(shared->offset_variable_I1 + 1, shared->dim_I1);
  index[86] = integer_sequence(shared->offset_variable_I2 + 1, shared->dim_I2);
  index[87] = integer_sequence(shared->offset_variable_I3 + 1, shared->dim_I3);
  index[88] = integer_sequence(shared->offset_variable_I4 + 1, shared->dim_I4);
  index[89] = integer_sequence(shared->offset_variable_R1 + 1, shared->dim_R1);
  index[90] = integer_sequence(shared->offset_variable_R2 + 1, shared->dim_R2);
  index[91] = integer_sequence(shared->offset_variable_R3 + 1, shared->dim_R3);
  index[92] = integer_sequence(shared->offset_variable_R4 + 1, shared->dim_R4);
  index[93] = integer_sequence(shared->offset_variable_I21 + 1, shared->dim_I21);
  index[94] = integer_sequence(shared->offset_variable_I31 + 1, shared->dim_I31);
  index[95] = integer_sequence(shared->offset_variable_I41 + 1, shared->dim_I41);
  index[96] = integer_sequence(shared->offset_variable_I12 + 1, shared->dim_I12);
  index[97] = integer_sequence(shared->offset_variable_I32 + 1, shared->dim_I32);
  index[98] = integer_sequence(shared->offset_variable_I42 + 1, shared->dim_I42);
  index[99] = integer_sequence(shared->offset_variable_I13 + 1, shared->dim_I13);
  index[100] = integer_sequence(shared->offset_variable_I23 + 1, shared->dim_I23);
  index[101] = integer_sequence(shared->offset_variable_I43 + 1, shared->dim_I43);
  index[102] = integer_sequence(shared->offset_variable_I14 + 1, shared->dim_I14);
  index[103] = integer_sequence(shared->offset_variable_I24 + 1, shared->dim_I24);
  index[104] = integer_sequence(shared->offset_variable_I34 + 1, shared->dim_I34);
  index[105] = integer_sequence(shared->offset_variable_R12 + 1, shared->dim_R12);
  index[106] = integer_sequence(shared->offset_variable_R13 + 1, shared->dim_R13);
  index[107] = integer_sequence(shared->offset_variable_R14 + 1, shared->dim_R14);
  index[108] = integer_sequence(shared->offset_variable_R23 + 1, shared->dim_R23);
  index[109] = integer_sequence(shared->offset_variable_R24 + 1, shared->dim_R24);
  index[110] = integer_sequence(shared->offset_variable_R34 + 1, shared->dim_R34);
  index[111] = integer_sequence(shared->offset_variable_I231 + 1, shared->dim_I231);
  index[112] = integer_sequence(shared->offset_variable_I241 + 1, shared->dim_I241);
  index[113] = integer_sequence(shared->offset_variable_I341 + 1, shared->dim_I341);
  index[114] = integer_sequence(shared->offset_variable_I132 + 1, shared->dim_I132);
  index[115] = integer_sequence(shared->offset_variable_I142 + 1, shared->dim_I142);
  index[116] = integer_sequence(shared->offset_variable_I342 + 1, shared->dim_I342);
  index[117] = integer_sequence(shared->offset_variable_I123 + 1, shared->dim_I123);
  index[118] = integer_sequence(shared->offset_variable_I143 + 1, shared->dim_I143);
  index[119] = integer_sequence(shared->offset_variable_I243 + 1, shared->dim_I243);
  index[120] = integer_sequence(shared->offset_variable_I124 + 1, shared->dim_I124);
  index[121] = integer_sequence(shared->offset_variable_I134 + 1, shared->dim_I134);
  index[122] = integer_sequence(shared->offset_variable_I234 + 1, shared->dim_I234);
  index[123] = integer_sequence(shared->offset_variable_R123 + 1, shared->dim_R123);
  index[124] = integer_sequence(shared->offset_variable_R124 + 1, shared->dim_R124);
  index[125] = integer_sequence(shared->offset_variable_R134 + 1, shared->dim_R134);
  index[126] = integer_sequence(shared->offset_variable_R234 + 1, shared->dim_R234);
  index[127] = integer_sequence(shared->offset_variable_I2341 + 1, shared->dim_I2341);
  index[128] = integer_sequence(shared->offset_variable_I1342 + 1, shared->dim_I1342);
  index[129] = integer_sequence(shared->offset_variable_I1243 + 1, shared->dim_I1243);
  index[130] = integer_sequence(shared->offset_variable_I1234 + 1, shared->dim_I1234);
  index[131] = integer_sequence(shared->offset_variable_R1234 + 1, shared->dim_R1234);
  index[132] = integer_sequence(shared->offset_variable_out_dis_sero_pop + 1, shared->dim_out_dis_sero_pop);
  index[133] = integer_sequence(shared->offset_variable_out_dis_sero_unvacc + 1, shared->dim_out_dis_sero_unvacc);
  index[134] = integer_sequence(shared->offset_variable_out_dis_sero_vacc + 1, shared->dim_out_dis_sero_vacc);
  index[135] = integer_sequence(shared->offset_variable_out_dis_sero_vacc_neg + 1, shared->dim_out_dis_sero_vacc_neg);
  index[136] = integer_sequence(shared->offset_variable_out_dis_sero_vacc_pos + 1, shared->dim_out_dis_sero_vacc_pos);
  index[137] = integer_sequence(shared->offset_variable_out_sdis_sero_pop + 1, shared->dim_out_sdis_sero_pop);
  index[138] = integer_sequence(shared->offset_variable_out_sdis_sero_unvacc + 1, shared->dim_out_sdis_sero_unvacc);
  index[139] = integer_sequence(shared->offset_variable_out_sdis_sero_vacc + 1, shared->dim_out_sdis_sero_vacc);
  index[140] = integer_sequence(shared->offset_variable_out_sdis_sero_vacc_neg + 1, shared->dim_out_sdis_sero_vacc_neg);
  index[141] = integer_sequence(shared->offset_variable_out_sdis_sero_vacc_pos + 1, shared->dim_out_sdis_sero_vacc_pos);
  index[142] = integer_sequence(shared->offset_variable_out_yll_sero_pop + 1, shared->dim_out_yll_sero_pop);
  index[143] = integer_sequence(shared->offset_variable_out_yll_sero_unvacc + 1, shared->dim_out_yll_sero_unvacc);
  index[144] = integer_sequence(shared->offset_variable_out_yll_sero_vacc + 1, shared->dim_out_yll_sero_vacc);
  index[145] = integer_sequence(shared->offset_variable_out_yll_sero_vacc_neg + 1, shared->dim_out_yll_sero_vacc_neg);
  index[146] = integer_sequence(shared->offset_variable_out_yll_sero_vacc_pos + 1, shared->dim_out_yll_sero_vacc_pos);
  index[147] = integer_sequence(shared->offset_variable_out_nc + 1, shared->dim_out_nc);
  index[148] = integer_sequence(shared->offset_variable_out_RR + 1, shared->dim_out_RR);
  index.names() = nms;
  size_t len = shared->offset_variable_out_RR + shared->dim_out_RR;
  using namespace cpp11::literals;
  return cpp11::writable::list({
           "dim"_nm = dim,
           "len"_nm = len,
           "index"_nm = index});
}
}
